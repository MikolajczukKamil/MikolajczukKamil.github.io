(self.webpackChunkhelpHunter_ui=self.webpackChunkhelpHunter_ui||[]).push([[179],{3596:(un,vt,Ve)=>{"use strict";function be(e){return"function"==typeof e}function Fe(e){const t=e(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const at=Fe(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function m(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class xe{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(be(i))try{i()}catch(s){n=s instanceof at?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{tt(s)}catch(d){n=n??[],d instanceof at?n=[...n,...d.errors]:n.push(d)}}if(n)throw new at(n)}}add(n){var t;if(n&&n!==this)if(this.closed)tt(n);else{if(n instanceof xe){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&m(t,n)}remove(n){const{_finalizers:t}=this;t&&m(t,n),n instanceof xe&&n._removeParent(this)}}xe.EMPTY=(()=>{const e=new xe;return e.closed=!0,e})();const He=xe.EMPTY;function ct(e){return e instanceof xe||e&&"closed"in e&&be(e.remove)&&be(e.add)&&be(e.unsubscribe)}function tt(e){be(e)?e():e.unsubscribe()}const mt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Xt={setTimeout(e,n,...t){const{delegate:i}=Xt;return i?.setTimeout?i.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=Xt;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Mt(e){Xt.setTimeout(()=>{const{onUnhandledError:n}=mt;if(!n)throw e;n(e)})}function yt(){}const Rt=De("C",void 0,void 0);function De(e,n,t){return{kind:e,value:n,error:t}}let ce=null;function ge(e){if(mt.useDeprecatedSynchronousErrorHandling){const n=!ce;if(n&&(ce={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:i}=ce;if(ce=null,t)throw i}}else e()}class ze extends xe{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,ct(n)&&n.add(this)):this.destination=Me}static create(n,t,i){return new ne(n,t,i)}next(n){this.isStopped?Ke(function he(e){return De("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Ke(function pn(e){return De("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Ke(Rt,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const de=Function.prototype.bind;function re(e,n){return de.call(e,n)}class Ae{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(i){ot(i)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(i){ot(i)}else ot(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){ot(t)}}}class ne extends ze{constructor(n,t,i){let r;if(super(),be(n)||!n)r={next:n??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&mt.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&re(n.next,s),error:n.error&&re(n.error,s),complete:n.complete&&re(n.complete,s)}):r=n}this.destination=new Ae(r)}}function ot(e){mt.useDeprecatedSynchronousErrorHandling?function ue(e){mt.useDeprecatedSynchronousErrorHandling&&ce&&(ce.errorThrown=!0,ce.error=e)}(e):Mt(e)}function Ke(e,n){const{onStoppedNotification:t}=mt;t&&Xt.setTimeout(()=>t(e,n))}const Me={closed:!0,next:yt,error:function Ue(e){throw e},complete:yt},on="function"==typeof Symbol&&Symbol.observable||"@@observable";function Lt(e){return e}function dt(e){return 0===e.length?Lt:1===e.length?e[0]:function(t){return e.reduce((i,r)=>r(i),t)}}let Re=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Ie(e){return e&&e instanceof ze||function gt(e){return e&&be(e.next)&&be(e.error)&&be(e.complete)}(e)&&ct(e)}(t)?t:new ne(t,i,r);return ge(()=>{const{operator:d,source:p}=this;s.add(d?d.call(s,p):p?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=it(i))((r,s)=>{const d=new ne({next:p=>{try{t(p)}catch(v){s(v),d.unsubscribe()}},error:s,complete:r});this.subscribe(d)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[on](){return this}pipe(...t){return dt(t)(this)}toPromise(t){return new(t=it(t))((i,r)=>{let s;this.subscribe(d=>s=d,d=>r(d),()=>i(s))})}}return e.create=n=>new e(n),e})();function it(e){var n;return null!==(n=e??mt.Promise)&&void 0!==n?n:Promise}const qt=Fe(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ct=(()=>{class e extends Re{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Cn(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new qt}next(t){ge(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){ge(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){ge(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?He:(this.currentObservers=null,s.push(t),new xe(()=>{this.currentObservers=null,m(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Re;return t.source=this,t}}return e.create=(n,t)=>new Cn(n,t),e})();class Cn extends Ct{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,n)}error(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==i?i:He}}function Ut(e){return be(e?.lift)}function Bn(e){return n=>{if(Ut(n))return n.lift(function(t){try{return e(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function zn(e,n,t,i,r){return new Jn(e,n,t,i,r)}class Jn extends ze{constructor(n,t,i,r,s,d){super(n),this.onFinalize=s,this.shouldUnsubscribe=d,this._next=t?function(p){try{t(p)}catch(v){n.error(v)}}:super._next,this._error=r?function(p){try{r(p)}catch(v){n.error(v)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(p){n.error(p)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Kt(e,n){return Bn((t,i)=>{let r=0;t.subscribe(zn(i,s=>{i.next(e.call(n,s,r++))}))})}function Ci(e){return this instanceof Ci?(this.v=e,this):new Ci(e)}function cr(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function cn(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=e[s]&&function(d){return new Promise(function(p,v){!function r(s,d,p,v){Promise.resolve(v).then(function(x){s({value:x,done:p})},d)}(p,v,(d=e[s](d)).done,d.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Ye=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function Nt(e){return be(e?.then)}function _n(e){return be(e[on])}function Dn(e){return Symbol.asyncIterator&&be(e?.[Symbol.asyncIterator])}function yn(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Yi=function qi(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ji(e){return be(e?.[Yi])}function Fi(e){return function Nr(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),s=[];return r={},d("next"),d("throw"),d("return"),r[Symbol.asyncIterator]=function(){return this},r;function d(L){i[L]&&(r[L]=function(F){return new Promise(function(Y,X){s.push([L,F,Y,X])>1||p(L,F)})})}function p(L,F){try{!function v(L){L.value instanceof Ci?Promise.resolve(L.value.v).then(x,M):R(s[0][2],L)}(i[L](F))}catch(Y){R(s[0][3],Y)}}function x(L){p("next",L)}function M(L){p("throw",L)}function R(L,F){L(F),s.shift(),s.length&&p(s[0][0],s[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:i,done:r}=yield Ci(t.read());if(r)return yield Ci(void 0);yield yield Ci(i)}}finally{t.releaseLock()}})}function or(e){return be(e?.getReader)}function dr(e){if(e instanceof Re)return e;if(null!=e){if(_n(e))return function zo(e){return new Re(n=>{const t=e[on]();if(be(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Ye(e))return function Vi(e){return new Re(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(Nt(e))return function mo(e){return new Re(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,Mt)})}(e);if(Dn(e))return wo(e);if(ji(e))return function ta(e){return new Re(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(or(e))return function go(e){return wo(Fi(e))}(e)}throw yn(e)}function wo(e){return new Re(n=>{(function Ll(e,n){var t,i,r,s;return function $e(e,n,t,i){return new(t||(t=Promise))(function(s,d){function p(M){try{x(i.next(M))}catch(R){d(R)}}function v(M){try{x(i.throw(M))}catch(R){d(R)}}function x(M){M.done?s(M.value):function r(s){return s instanceof t?s:new t(function(d){d(s)})}(M.value).then(p,v)}x((i=i.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=cr(e);!(i=yield t.next()).done;)if(n.next(i.value),n.closed)return}catch(d){r={error:d}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Hs(e,n,t,i=0,r=!1){const s=n.schedule(function(){t(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(s),!r)return s}function _i(e,n,t=1/0){return be(n)?_i((i,r)=>Kt((s,d)=>n(i,s,r,d))(dr(e(i,r))),t):("number"==typeof n&&(t=n),Bn((i,r)=>function Vd(e,n,t,i,r,s,d,p){const v=[];let x=0,M=0,R=!1;const L=()=>{R&&!v.length&&!x&&n.complete()},F=X=>x<i?Y(X):v.push(X),Y=X=>{s&&n.next(X),x++;let ye=!1;dr(t(X,M++)).subscribe(zn(n,ae=>{r?.(ae),s?F(ae):n.next(ae)},()=>{ye=!0},void 0,()=>{if(ye)try{for(x--;v.length&&x<i;){const ae=v.shift();d?Hs(n,d,()=>Y(ae)):Y(ae)}L()}catch(ae){n.error(ae)}}))};return e.subscribe(zn(n,F,()=>{R=!0,L()})),()=>{p?.()}}(i,r,e,t)))}function kc(e=1/0){return _i(Lt,e)}const Cr=new Re(e=>e.complete());function is(e){return e&&be(e.schedule)}function xa(e){return e[e.length-1]}function rs(e){return be(xa(e))?e.pop():void 0}function ic(e){return is(xa(e))?e.pop():void 0}function da(e,n=0){return Bn((t,i)=>{t.subscribe(zn(i,r=>Hs(i,e,()=>i.next(r),n),()=>Hs(i,e,()=>i.complete(),n),r=>Hs(i,e,()=>i.error(r),n)))})}function ba(e,n=0){return Bn((t,i)=>{i.add(e.schedule(()=>t.subscribe(i),n))})}function Ko(e,n){if(!e)throw new Error("Iterable cannot be null");return new Re(t=>{Hs(t,n,()=>{const i=e[Symbol.asyncIterator]();Hs(t,n,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Ws(e,n){return n?function Fl(e,n){if(null!=e){if(_n(e))return function Qt(e,n){return dr(e).pipe(ba(n),da(n))}(e,n);if(Ye(e))return function fs(e,n){return new Re(t=>{let i=0;return n.schedule(function(){i===e.length?t.complete():(t.next(e[i++]),t.closed||this.schedule())})})}(e,n);if(Nt(e))return function Nl(e,n){return dr(e).pipe(ba(n),da(n))}(e,n);if(Dn(e))return Ko(e,n);if(ji(e))return function qs(e,n){return new Re(t=>{let i;return Hs(t,n,()=>{i=e[Yi](),Hs(t,n,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(d){return void t.error(d)}s?t.complete():t.next(r)},0,!0)}),()=>be(i?.return)&&i.return()})}(e,n);if(or(e))return function bc(e,n){return Ko(Fi(e),n)}(e,n)}throw yn(e)}(e,n):dr(e)}function eu(...e){const n=ic(e),t=function ka(e,n){return"number"==typeof xa(e)?e.pop():n}(e,1/0),i=e;return i.length?1===i.length?dr(i[0]):kc(t)(Ws(i,n)):Cr}class tn extends Ct{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:i}=this;if(n)throw t;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Ln(...e){return Ws(e,ic(e))}function Ai(e={}){const{connector:n=(()=>new Ct),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return s=>{let d,p,v,x=0,M=!1,R=!1;const L=()=>{p?.unsubscribe(),p=void 0},F=()=>{L(),d=v=void 0,M=R=!1},Y=()=>{const X=d;F(),X?.unsubscribe()};return Bn((X,ye)=>{x++,!R&&!M&&L();const ae=v=v??n();ye.add(()=>{x--,0===x&&!R&&!M&&(p=La(Y,r))}),ae.subscribe(ye),!d&&x>0&&(d=new ne({next:Q=>ae.next(Q),error:Q=>{R=!0,L(),p=La(F,t,Q),ae.error(Q)},complete:()=>{M=!0,L(),p=La(F,i),ae.complete()}}),dr(X).subscribe(d))})(s)}}function La(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new ne({next:()=>{i.unsubscribe(),e()}});return dr(n(...t)).subscribe(i)}function gi(e,n){return Bn((t,i)=>{let r=null,s=0,d=!1;const p=()=>d&&!r&&i.complete();t.subscribe(zn(i,v=>{r?.unsubscribe();let x=0;const M=s++;dr(e(v,M)).subscribe(r=zn(i,R=>i.next(n?n(v,R,M,x++):R),()=>{r=null,p()}))},()=>{d=!0,p()}))})}function sr(e,n=Lt){return e=e??Bl,Bn((t,i)=>{let r,s=!0;t.subscribe(zn(i,d=>{const p=n(d);(s||!e(r,p))&&(s=!1,r=p,i.next(d))}))})}function Bl(e,n){return e===n}function Ir(e){for(let n in e)if(e[n]===Ir)return n;throw Error("Could not find renamed property on target object.")}function na(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function br(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(br).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function Io(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const hf=Ir({__forward_ref__:Ir});function nn(e){return e.__forward_ref__=nn,e.toString=function(){return br(this())},e}function Bi(e){return Ia(e)?e():e}function Ia(e){return"function"==typeof e&&e.hasOwnProperty(hf)&&e.__forward_ref__===nn}function vl(e){return e&&!!e.\u0275providers}const Ts="https://g.co/ng/security#xss";class Ot extends Error{constructor(n,t){super(function mr(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function oi(e){return"string"==typeof e?e:null==e?"":String(e)}function Qo(e,n){throw new Ot(-201,!1)}function zl(e,n){null==e&&function xi(e,n,t,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${t} ${i} ${n} <=Actual]`))}(n,e,null,"!=")}function kn(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function wr(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ul(e){return sl(e,Na)||sl(e,jo)}function sl(e,n){return e.hasOwnProperty(n)?e[n]:null}function wc(e){return e&&(e.hasOwnProperty(tu)||e.hasOwnProperty(ci))?e[tu]:null}const Na=Ir({\u0275prov:Ir}),tu=Ir({\u0275inj:Ir}),jo=Ir({ngInjectableDef:Ir}),ci=Ir({ngInjectorDef:Ir});var si=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(si||{});let Wu;function os(e){const n=Wu;return Wu=e,n}function Ec(e,n,t){const i=Ul(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&si.Optional?null:void 0!==n?n:void Qo(br(e))}const Do=globalThis,hr={},wl="__NG_DI_FLAG__",gr="ngTempTokenPath",Xu=/\n/gm,Da="__source";let Ss;function nu(e){const n=Ss;return Ss=e,n}function Cc(e,n=si.Default){if(void 0===Ss)throw new Ot(-203,!1);return null===Ss?Ec(e,void 0,n):Ss.get(e,n&si.Optional?null:void 0,n)}function Dt(e,n=si.Default){return(function wa(){return Wu}()||Cc)(Bi(e),n)}function Rn(e,n=si.Default){return Dt(e,Ka(n))}function Ka(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function El(e){const n=[];for(let t=0;t<e.length;t++){const i=Bi(e[t]);if(Array.isArray(i)){if(0===i.length)throw new Ot(900,!1);let r,s=si.Default;for(let d=0;d<i.length;d++){const p=i[d],v=Cl(p);"number"==typeof v?-1===v?r=p.token:s|=v:r=p}n.push(Dt(r,s))}else n.push(Dt(i))}return n}function sc(e,n){return e[wl]=n,e.prototype[wl]=n,e}function Cl(e){return e[wl]}function Qa(e){return{toString:e}.toString()}var Ps=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Ps||{}),Lo=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Lo||{});const Ms={},Rr=[],Rs=Ir({\u0275cmp:Ir}),$d=Ir({\u0275dir:Ir}),iu=Ir({\u0275pipe:Ir}),Yu=Ir({\u0275mod:Ir}),ac=Ir({\u0275fac:Ir}),ru=Ir({__NG_ELEMENT_ID__:Ir}),lc=Ir({__NG_ENV_ID__:Ir});function jl(e,n,t){let i=e.length;for(;;){const r=e.indexOf(n,t);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const s=n.length;if(r+s===i||e.charCodeAt(r+s)<=32)return r}t=r+1}}function Is(e,n,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],d=t[i++],p=t[i++];e.setAttribute(n,d,p,s)}else{const s=r,d=t[++i];oa(s)?e.setProperty(n,s,d):e.setAttribute(n,s,d),i++}}return i}function Ku(e){return 3===e||4===e||6===e}function oa(e){return 64===e.charCodeAt(0)}function Ja(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?t=r:0===t||Gl(e,t,r,null,-1===t||2===t?n[++i]:null)}}return e}function Gl(e,n,t,i,r){let s=0,d=e.length;if(-1===n)d=-1;else for(;s<e.length;){const p=e[s++];if("number"==typeof p){if(p===n){d=-1;break}if(p>n){d=s-1;break}}}for(;s<e.length;){const p=e[s];if("number"==typeof p)break;if(p===t){if(null===i)return void(null!==r&&(e[s+1]=r));if(i===e[s+1])return void(e[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==d&&(e.splice(d,0,n),s=d+1),e.splice(s++,0,t),null!==i&&e.splice(s++,0,i),null!==r&&e.splice(s++,0,r)}const Hd="ng-template";function Lc(e,n,t){let i=0,r=!0;for(;i<e.length;){let s=e[i++];if("string"==typeof s&&r){const d=e[i++];if(t&&"class"===s&&-1!==jl(d.toLowerCase(),n,0))return!0}else{if(1===s){for(;i<e.length&&"string"==typeof(s=e[i++]);)if(s.toLowerCase()===n)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Mc(e){return 4===e.type&&e.value!==Hd}function al(e,n,t){return n===(4!==e.type||t?e.value:Hd)}function pa(e,n,t){let i=4;const r=e.attrs||[],s=function Au(e){for(let n=0;n<e.length;n++)if(Ku(e[n]))return n;return e.length}(r);let d=!1;for(let p=0;p<n.length;p++){const v=n[p];if("number"!=typeof v){if(!d)if(4&i){if(i=2|1&i,""!==v&&!al(e,v,t)||""===v&&1===n.length){if(Os(i))return!1;d=!0}}else{const x=8&i?v:n[++p];if(8&i&&null!==e.attrs){if(!Lc(e.attrs,x,t)){if(Os(i))return!1;d=!0}continue}const R=Ta(8&i?"class":v,r,Mc(e),t);if(-1===R){if(Os(i))return!1;d=!0;continue}if(""!==x){let L;L=R>s?"":r[R+1].toLowerCase();const F=8&i?L:null;if(F&&-1!==jl(F,x,0)||2&i&&x!==L){if(Os(i))return!1;d=!0}}}}else{if(!d&&!Os(i)&&!Os(v))return!1;if(d&&Os(v))continue;d=!1,i=v|1&i}}return Os(i)||d}function Os(e){return 0==(1&e)}function Ta(e,n,t,i){if(null===n)return-1;let r=0;if(i||!t){let s=!1;for(;r<n.length;){const d=n[r];if(d===e)return r;if(3===d||6===d)s=!0;else{if(1===d||2===d){let p=n[++r];for(;"string"==typeof p;)p=n[++r];continue}if(4===d)break;if(0===d){r+=4;continue}}r+=s?1:2}return-1}return function ks(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const i=e[t];if("number"==typeof i)return-1;if(i===n)return t;t++}return-1}(n,e)}function pf(e,n,t=!1){for(let i=0;i<n.length;i++)if(pa(e,n[i],t))return!0;return!1}function Ds(e,n){e:for(let t=0;t<n.length;t++){const i=n[t];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function Sl(e,n){return e?":not("+n.trim()+")":n}function ll(e){let n=e[0],t=1,i=2,r="",s=!1;for(;t<e.length;){let d=e[t];if("string"==typeof d)if(2&i){const p=e[++t];r+="["+d+(p.length>0?'="'+p+'"':"")+"]"}else 8&i?r+="."+d:4&i&&(r+=" "+d);else""!==r&&!Os(d)&&(n+=Sl(s,r),r=""),i=d,s=s||!Os(i);t++}return""!==r&&(n+=Sl(s,r)),n}function Gi(e){return Qa(()=>{const n=Fr(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Ps.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Lo.Emulated,styles:e.styles||Rr,_:null,schemas:e.schemas||null,tView:null,id:""};bh(t);const i=e.dependencies;return t.directiveDefs=Pu(i,!1),t.pipeDefs=Pu(i,!0),t.id=function Ml(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of t)n=Math.imul(31,n)+r.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function xh(e){return _r(e)||Eo(e)}function ss(e){return null!==e}function xr(e){return Qa(()=>({type:e.type,bootstrap:e.bootstrap||Rr,declarations:e.declarations||Rr,imports:e.imports||Rr,exports:e.exports||Rr,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function gs(e,n){if(null==e)return Ms;const t={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,n&&(n[r]=s)}return t}function vn(e){return Qa(()=>{const n=Fr(e);return bh(n),n})}function _r(e){return e[Rs]||null}function Eo(e){return e[$d]||null}function as(e){return e[iu]||null}function ls(e,n){const t=e[Yu]||null;if(!t&&!0===n)throw new Error(`Type ${br(e)} does not have '\u0275mod' property.`);return t}function Fr(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Ms,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Rr,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:gs(e.inputs,n),outputs:gs(e.outputs)}}function bh(e){e.features?.forEach(n=>n(e))}function Pu(e,n){if(!e)return null;const t=n?as:xh;return()=>("function"==typeof e?e():e).map(i=>t(i)).filter(ss)}const cs=0,Zn=1,ki=2,Qi=3,Co=4,Vn=5,yr=6,su=7,Go=8,So=9,Fs=10,Si=11,au=12,Ru=13,lu=14,Ys=15,Aa=16,el=17,za=18,Qu=19,Ou=20,ga=21,ul=22,cc=23,Il=24,jn=25,dc=1,Dc=2,ys=7,sa=9,Ca=11;function l(e){return Array.isArray(e)&&"object"==typeof e[dc]}function h(e){return Array.isArray(e)&&!0===e[dc]}function y(e){return 0!=(4&e.flags)}function w(e){return e.componentOffset>-1}function D(e){return 1==(1&e.flags)}function z(e){return!!e.template}function G(e){return 0!=(512&e[ki])}function Wd(e,n){return e.hasOwnProperty(ac)?e[ac]:null}let Va=null,ed=!1;function b(e){const n=Va;return Va=e,n}const u={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function C(e){if(!Ce(e)||e.dirty){if(!e.producerMustRecompute(e)&&!q(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function N(e){e.dirty=!0,function I(e){if(void 0===e.liveConsumerNode)return;const n=ed;ed=!0;try{for(const t of e.liveConsumerNode)t.dirty||N(t)}finally{ed=n}}(e),e.consumerMarkedDirty?.(e)}function B(e){return e&&(e.nextProducerIndex=0),b(e)}function U(e,n){if(b(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Ce(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)_e(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function q(e){Te(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],i=e.producerLastReadVersion[n];if(i!==t.version||(C(t),i!==t.version))return!0}return!1}function H(e){if(Te(e),Ce(e))for(let n=0;n<e.producerNode.length;n++)_e(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function _e(e,n){if(function Pe(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Te(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)_e(e.producerNode[i],e.producerIndexOfThis[i]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[n],r=e.liveConsumerNode[n];Te(r),r.producerIndexOfThis[i]=n}}function Ce(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Te(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let ft=null;const Sn=()=>{},yi=(()=>({...u,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:Sn}))();class ei{constructor(n,t,i){this.previousValue=n,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ii(){return fr}function fr(e){return e.type.prototype.ngOnChanges&&(e.setInput=di),pr}function pr(){const e=No(this),n=e?.current;if(n){const t=e.previous;if(t===Ms)e.previous=n;else for(let i in n)t[i]=n[i];e.current=null,this.ngOnChanges(n)}}function di(e,n,t,i){const r=this.declaredInputs[t],s=No(e)||function $o(e,n){return e[_o]=n}(e,{previous:Ms,current:null}),d=s.current||(s.current={}),p=s.previous,v=p[r];d[r]=new ei(v&&v.currentValue,n,p===Ms),e[i]=n}ii.ngInherit=!0;const _o="__ngSimpleChanges__";function No(e){return e[_o]||null}const vs=function(e,n,t){};function Hi(e){for(;Array.isArray(e);)e=e[cs];return e}function Tr(e,n){return Hi(n[e])}function yo(e,n){return Hi(n[e.index])}function us(e,n){return e.data[n]}function Tl(e,n){const t=n[e];return l(t)?t:t[cs]}function ql(e,n){return null==n?null:e[n]}function _d(e){e[el]=0}function ap(e){1024&e[ki]||(e[ki]|=1024,lp(e,1))}function wh(e){1024&e[ki]&&(e[ki]&=-1025,lp(e,-1))}function lp(e,n){let t=e[Qi];if(null===t)return;t[Vn]+=n;let i=t;for(t=t[Qi];null!==t&&(1===n&&1===i[Vn]||-1===n&&0===i[Vn]);)t[Vn]+=n,i=t,t=t[Qi]}const lr={lFrame:pm(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function yd(){return lr.bindingsEnabled}function Xd(){return null!==lr.skipHydrationRootTNode}function Mn(){return lr.lFrame.lView}function Br(){return lr.lFrame.tView}function Fc(e){return lr.lFrame.contextLView=e,e[Go]}function Wl(e){return lr.lFrame.contextLView=null,e}function Bs(){let e=Yd();for(;null!==e&&64===e.type;)e=e.parent;return e}function Yd(){return lr.lFrame.currentTNode}function fc(e,n){const t=lr.lFrame;t.currentTNode=e,t.isParent=n}function Ty(){return lr.lFrame.isParent}function Ay(){lr.lFrame.isParent=!1}function pc(){const e=lr.lFrame;let n=e.bindingRootIndex;return-1===n&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function cp(){return lr.lFrame.bindingIndex++}function Jo(e){const n=lr.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function kg(e,n){const t=lr.lFrame;t.bindingIndex=t.bindingRootIndex=e,Lg(n)}function Lg(e){lr.lFrame.currentDirectiveIndex=e}function Ng(e){const n=lr.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}function Nu(){return lr.lFrame.currentQueryIndex}function fm(e){lr.lFrame.currentQueryIndex=e}function gf(e){const n=e[Zn];return 2===n.type?n.declTNode:1===n.type?e[yr]:null}function up(e,n,t){if(t&si.SkipSelf){let r=n,s=e;for(;!(r=r.parent,null!==r||t&si.Host||(r=gf(s),null===r||(s=s[lu],10&r.type))););if(null===r)return!1;n=r,e=s}const i=lr.lFrame=Fg();return i.currentTNode=n,i.lView=e,!0}function Qd(e){const n=Fg(),t=e[Zn];lr.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function Fg(){const e=lr.lFrame,n=null===e?null:e.child;return null===n?pm(e):n}function pm(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function Ry(){const e=lr.lFrame;return lr.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Oy=Ry;function ky(){const e=Ry();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function hl(){return lr.lFrame.selectedIndex}function Fu(e){lr.lFrame.selectedIndex=e}function es(){const e=lr.lFrame;return us(e.tView,e.selectedIndex)}let dp=!0;function fl(){return dp}function pl(e){dp=e}function zs(e,n){for(let t=n.directiveStart,i=n.directiveEnd;t<i;t++){const s=e.data[t].type.prototype,{ngAfterContentInit:d,ngAfterContentChecked:p,ngAfterViewInit:v,ngAfterViewChecked:x,ngOnDestroy:M}=s;d&&(e.contentHooks??=[]).push(-t,d),p&&((e.contentHooks??=[]).push(t,p),(e.contentCheckHooks??=[]).push(t,p)),v&&(e.viewHooks??=[]).push(-t,v),x&&((e.viewHooks??=[]).push(t,x),(e.viewCheckHooks??=[]).push(t,x)),null!=M&&(e.destroyHooks??=[]).push(t,M)}}function _m(e,n,t){nb(e,n,3,t)}function Eh(e,n,t,i){(3&e[ki])===t&&nb(e,n,t,i)}function uu(e,n){let t=e[ki];(3&t)===n&&(t&=8191,t+=1,e[ki]=t)}function nb(e,n,t,i){const s=i??-1,d=n.length-1;let p=0;for(let v=void 0!==i?65535&e[el]:0;v<d;v++)if("number"==typeof n[v+1]){if(p=n[v],null!=i&&p>=i)break}else n[v]<0&&(e[el]+=65536),(p<s||-1==s)&&(rb(e,t,n,v),e[el]=(4294901760&e[el])+v+2),v++}function ib(e,n){vs(4,e,n);const t=b(null);try{n.call(e)}finally{b(t),vs(5,e,n)}}function rb(e,n,t,i){const r=t[i]<0,s=t[i+1],p=e[r?-t[i]:t[i]];r?e[ki]>>13<e[el]>>16&&(3&e[ki])===n&&(e[ki]+=8192,ib(p,s)):ib(p,s)}const _f=-1;class nd{constructor(n,t,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function yf(e){return e!==_f}function vf(e){return 32767&e}function xf(e,n){let t=function By(e){return e>>16}(e),i=n;for(;t>0;)i=i[lu],t--;return i}let Al=!0;function hp(e){const n=Al;return Al=e,n}const id=255,sb=5;let bf=0;const Vc={};function Ac(e,n){const t=ym(e,n);if(-1!==t)return t;const i=n[Zn];i.firstCreatePass&&(e.injectorIndex=n.length,zy(i.data,e),zy(n,null),zy(i.blueprint,null));const r=vm(e,n),s=e.injectorIndex;if(yf(r)){const d=vf(r),p=xf(r,n),v=p[Zn].data;for(let x=0;x<8;x++)n[s+x]=p[d+x]|v[d+x]}return n[s+8]=r,s}function zy(e,n){e.push(0,0,0,0,0,0,0,0,n)}function ym(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function vm(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,i=null,r=n;for(;null!==r;){if(i=zg(r),null===i)return _f;if(t++,r=r[lu],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return _f}function Vy(e,n,t){!function Bu(e,n,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ru)&&(i=t[ru]),null==i&&(i=t[ru]=bf++);const r=i&id;n.data[e+(r>>sb)]|=1<<r}(e,n,t)}function rd(e,n,t){if(t&si.Optional||void 0!==e)return e;Qo()}function Ch(e,n,t,i){if(t&si.Optional&&void 0===i&&(i=null),!(t&(si.Self|si.Host))){const r=e[So],s=os(void 0);try{return r?r.get(n,i,t&si.Optional):Ec(n,i,t&si.Optional)}finally{os(s)}}return rd(i,0,t)}function jy(e,n,t,i=si.Default,r){if(null!==e){if(2048&n[ki]&&!(i&si.Self)){const d=function lb(e,n,t,i,r){let s=e,d=n;for(;null!==s&&null!==d&&2048&d[ki]&&!(512&d[ki]);){const p=Gy(s,d,t,i|si.Self,Vc);if(p!==Vc)return p;let v=s.parent;if(!v){const x=d[Ou];if(x){const M=x.get(t,Vc,i);if(M!==Vc)return M}v=zg(d),d=d[lu]}s=v}return r}(e,n,t,i,Vc);if(d!==Vc)return d}const s=Gy(e,n,t,i,Vc);if(s!==Vc)return s}return Ch(n,t,i,r)}function Gy(e,n,t,i,r){const s=function fp(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(ru)?e[ru]:void 0;return"number"==typeof n?n>=0?n&id:$y:n}(t);if("function"==typeof s){if(!up(n,e,i))return i&si.Host?rd(r,0,i):Ch(n,t,i,r);try{let d;if(d=s(i),null!=d||i&si.Optional)return d;Qo()}finally{Oy()}}else if("number"==typeof s){let d=null,p=ym(e,n),v=_f,x=i&si.Host?n[Ys][yr]:null;for((-1===p||i&si.SkipSelf)&&(v=-1===p?vm(e,n):n[p+8],v!==_f&&pp(i,!1)?(d=n[Zn],p=vf(v),n=xf(v,n)):p=-1);-1!==p;){const M=n[Zn];if(Ef(s,p,M.data)){const R=EC(p,n,t,d,i,x);if(R!==Vc)return R}v=n[p+8],v!==_f&&pp(i,n[Zn].data[p+8]===x)&&Ef(s,p,n)?(d=M,p=vf(v),n=xf(v,n)):p=-1}}return r}function EC(e,n,t,i,r,s){const d=n[Zn],p=d.data[e+8],M=wf(p,d,t,null==i?w(p)&&Al:i!=d&&0!=(3&p.type),r&si.Host&&s===p);return null!==M?Jd(n,d,M,p):Vc}function wf(e,n,t,i,r){const s=e.providerIndexes,d=n.data,p=1048575&s,v=e.directiveStart,M=s>>20,L=r?p+M:e.directiveEnd;for(let F=i?p:p+M;F<L;F++){const Y=d[F];if(F<v&&t===Y||F>=v&&Y.type===t)return F}if(r){const F=d[v];if(F&&z(F)&&F.type===t)return v}return null}function Jd(e,n,t,i){let r=e[t];const s=n.data;if(function ob(e){return e instanceof nd}(r)){const d=r;d.resolving&&function Zs(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new Ot(-200,`Circular dependency in DI detected for ${e}${t}`)}(function ur(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():oi(e)}(s[t]));const p=hp(d.canSeeViewProviders);d.resolving=!0;const x=d.injectImpl?os(d.injectImpl):null;up(e,i,si.Default);try{r=e[t]=d.factory(void 0,s,e,i),n.firstCreatePass&&t>=i.directiveStart&&function Fy(e,n,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=n.type.prototype;if(i){const d=fr(n);(t.preOrderHooks??=[]).push(e,d),(t.preOrderCheckHooks??=[]).push(e,d)}r&&(t.preOrderHooks??=[]).push(0-e,r),s&&((t.preOrderHooks??=[]).push(e,s),(t.preOrderCheckHooks??=[]).push(e,s))}(t,s[t],n)}finally{null!==x&&os(x),hp(p),d.resolving=!1,Oy()}}return r}function Ef(e,n,t){return!!(t[n+(e>>sb)]&1<<e)}function pp(e,n){return!(e&si.Self||e&si.Host&&n)}class ml{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,i){return jy(this._tNode,this._lView,n,Ka(i),t)}}function $y(){return new ml(Bs(),Mn())}function gl(e){return Qa(()=>{const n=e.prototype.constructor,t=n[ac]||Mh(n),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const s=r[ac]||Mh(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Mh(e){return Ia(e)?()=>{const n=Mh(Bi(e));return n&&n()}:Wd(e)}function zg(e){const n=e[Zn],t=n.type;return 2===t?n.declTNode:1===t?e[yr]:null}function Cf(e){return function Uy(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Ku(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===n)return t[r+1];r+=2}}}return null}(Bs(),e)}const gp="__parameters__";function Ur(e,n,t){return Qa(()=>{const i=function xd(e){return function(...t){if(e){const i=e(...t);for(const r in i)this[r]=i[r]}}}(n);function r(...s){if(this instanceof r)return i.apply(this,s),this;const d=new r(...s);return p.annotation=d,p;function p(v,x,M){const R=v.hasOwnProperty(gp)?v[gp]:Object.defineProperty(v,gp,{value:[]})[gp];for(;R.length<=M;)R.push(null);return(R[M]=R[M]||[]).push(d),v}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function yp(e,n){e.forEach(t=>Array.isArray(t)?yp(t,n):n(t))}function Ed(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Cd(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function Ih(e,n){const t=[];for(let i=0;i<e;i++)t.push(n);return t}function Uc(e,n,t){let i=Dh(e,n);return i>=0?e[1|i]=t:(i=~i,function db(e,n,t,i){let r=e.length;if(r==n)e.push(t,i);else if(1===r)e.push(i,e[0]),e[0]=t;else{for(r--,e.push(e[r-1],e[r]);r>n;)e[r]=e[r-2],r--;e[n]=t,e[n+1]=i}}(e,i,n,t)),i}function Xy(e,n){const t=Dh(e,n);if(t>=0)return e[1|t]}function Dh(e,n){return function Ug(e,n,t){let i=0,r=e.length>>t;for(;r!==i;){const s=i+(r-i>>1),d=e[s<<t];if(n===d)return s<<t;d>n?r=s:i=s+1}return~(r<<t)}(e,n,1)}const If=sc(Ur("Optional"),8),bp=sc(Ur("SkipSelf"),4);function Sm(e){return 128==(128&e.flags)}var Lh=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Lh||{});const rv=/^>|^->|<!--|-->|--!>|<!-$/g,OC=/(<|>)/g,ov="\u200b$1\u200b";const Ep=new Map;let kC=0;const Nh="__ngContext__";function mc(e,n){l(n)?(e[Nh]=n[Qu],function NC(e){Ep.set(e[Qu],e)}(n)):e[Nh]=n}let uv;function Df(e,n){return uv(e,n)}function Cp(e){const n=e[Qi];return h(n)?n[Qi]:n}function Db(e){return hv(e[au])}function dv(e){return hv(e[Co])}function hv(e){for(;null!==e&&!h(e);)e=e[Co];return e}function Tf(e,n,t,i,r){if(null!=i){let s,d=!1;h(i)?s=i:l(i)&&(d=!0,i=i[cs]);const p=Hi(i);0===e&&null!==t?null==r?Rb(n,t,p):Pf(n,t,p,r||null,!0):1===e&&null!==t?Pf(n,t,p,r||null,!0):2===e?function Sp(e,n,t){const i=Om(e,n);i&&function $C(e,n,t,i){e.removeChild(n,t,i)}(e,i,n,t)}(n,p,d):3===e&&n.destroyNode(p),null!=s&&function WC(e,n,t,i,r){const s=t[ys];s!==Hi(t)&&Tf(n,e,i,s,r);for(let p=Ca;p<t.length;p++){const v=t[p];Fm(v[Zn],v,e,n,i,s)}}(n,e,s,t,r)}}function Yg(e,n){return e.createComment(function Zg(e){return e.replace(rv,n=>n.replace(OC,ov))}(n))}function Kg(e,n,t){return e.createElement(n,t)}function Af(e,n){const t=e[sa],i=t.indexOf(n);wh(n),t.splice(i,1)}function Fh(e,n){if(e.length<=Ca)return;const t=Ca+n,i=e[t];if(i){const r=i[Aa];null!==r&&r!==e&&Af(r,i),n>0&&(e[t-1][Co]=i[Co]);const s=Cd(e,Ca+n);!function UC(e,n){Fm(e,n,n[Si],2,null,null),n[cs]=null,n[yr]=null}(i[Zn],i);const d=s[za];null!==d&&d.detachView(s[Zn]),i[Qi]=null,i[Co]=null,i[ki]&=-129}return i}function Jg(e,n){if(!(256&n[ki])){const t=n[Si];n[cc]&&H(n[cc]),n[Il]&&H(n[Il]),t.destroyNode&&Fm(e,n,t,3,null,null),function Ab(e){let n=e[au];if(!n)return e_(e[Zn],e);for(;n;){let t=null;if(l(n))t=n[au];else{const i=n[Ca];i&&(t=i)}if(!t){for(;n&&!n[Co]&&n!==e;)l(n)&&e_(n[Zn],n),n=n[Qi];null===n&&(n=e),l(n)&&e_(n[Zn],n),t=n&&n[Co]}n=t}}(n)}}function e_(e,n){if(!(256&n[ki])){n[ki]&=-129,n[ki]|=256,function GC(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let i=0;i<t.length;i+=2){const r=n[t[i]];if(!(r instanceof nd)){const s=t[i+1];if(Array.isArray(s))for(let d=0;d<s.length;d+=2){const p=r[s[d]],v=s[d+1];vs(4,p,v);try{v.call(p)}finally{vs(5,p,v)}}else{vs(4,r,s);try{s.call(r)}finally{vs(5,r,s)}}}}}(e,n),function jC(e,n){const t=e.cleanup,i=n[su];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const d=t[s+3];d>=0?i[d]():i[-d].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(n[su]=null);const r=n[ga];if(null!==r){n[ga]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(e,n),1===n[Zn].type&&n[Si].destroy();const t=n[Aa];if(null!==t&&h(n[Qi])){t!==n[Qi]&&Af(t,n);const i=n[za];null!==i&&i.detachView(e)}!function FC(e){Ep.delete(e[Qu])}(n)}}function pv(e,n,t){return function Pb(e,n,t){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return t[cs];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=e.data[i.directiveStart+r];if(s===Lo.None||s===Lo.Emulated)return null}return yo(i,t)}}(e,n.parent,t)}function Pf(e,n,t,i,r){e.insertBefore(n,t,i,r)}function Rb(e,n,t){e.appendChild(n,t)}function Rm(e,n,t,i,r){null!==i?Pf(e,n,t,i,r):Rb(e,n,t)}function Om(e,n){return e.parentNode(n)}function kb(e,n,t){return Nb(e,n,t)}let mv,Ro,yv,t_,Nb=function Lb(e,n,t){return 40&e.type?yo(e,t):null};function km(e,n,t,i){const r=pv(e,i,n),s=n[Si],p=kb(i.parent||n[yr],i,n);if(null!=r)if(Array.isArray(t))for(let v=0;v<t.length;v++)Rm(s,r,t[v],p,!1);else Rm(s,r,t,p,!1);void 0!==mv&&mv(s,i,n,t,r)}function Lm(e,n){if(null!==n){const t=n.type;if(3&t)return yo(n,e);if(4&t)return fu(-1,e[n.index]);if(8&t){const i=n.child;if(null!==i)return Lm(e,i);{const r=e[n.index];return h(r)?fu(-1,r):Hi(r)}}if(32&t)return Df(n,e)()||Hi(e[n.index]);{const i=nl(e,n);return null!==i?Array.isArray(i)?i[0]:Lm(Cp(e[Ys]),i):Lm(e,n.next)}}return null}function nl(e,n){return null!==n?e[Ys][yr].projection[n.projection]:null}function fu(e,n){const t=Ca+e+1;if(t<n.length){const i=n[t],r=i[Zn].firstChild;if(null!==r)return Lm(i,r)}return n[ys]}function Bh(e,n,t,i,r,s,d){for(;null!=t;){const p=i[t.index],v=t.type;if(d&&0===n&&(p&&mc(Hi(p),i),t.flags|=2),32!=(32&t.flags))if(8&v)Bh(e,n,t.child,i,r,s,!1),Tf(n,e,r,p,s);else if(32&v){const x=Df(t,i);let M;for(;M=x();)Tf(n,e,r,M,s);Tf(n,e,r,p,s)}else 16&v?Mp(e,n,i,t,r,s):Tf(n,e,r,p,s);t=d?t.projectionNext:t.next}}function Fm(e,n,t,i,r,s){Bh(t,i,e.firstChild,n,r,s,!1)}function Mp(e,n,t,i,r,s){const d=t[Ys],v=d[yr].projection[i.projection];if(Array.isArray(v))for(let x=0;x<v.length;x++)Tf(n,e,r,v[x],s);else{let x=v;const M=d[Qi];Sm(i)&&(x.flags|=128),Bh(e,n,x,M,r,s,!0)}}function gv(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function _v(e,n,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Is(e,n,i),null!==r&&gv(e,n,r),null!==s&&function Bb(e,n,t){e.setAttribute(n,"style",t)}(e,n,s)}function Rf(e){return function Bm(){if(void 0===Ro&&(Ro=null,Do.trustedTypes))try{Ro=Do.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Ro}()?.createHTML(e)||e}function Gb(e){return function vv(){if(void 0===t_&&(t_=null,Do.trustedTypes))try{t_=Do.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return t_}()?.createScriptURL(e)||e}class Of{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ts})`}}class n_ extends Of{getTypeName(){return"HTML"}}class Dp extends Of{getTypeName(){return"Style"}}class $b extends Of{getTypeName(){return"Script"}}class i_ extends Of{getTypeName(){return"URL"}}class xv extends Of{getTypeName(){return"ResourceURL"}}function pu(e){return e instanceof Of?e.changingThisBreaksApplicationSecurity:e}function Sd(e,n){const t=function YC(e){return e instanceof Of&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${Ts})`)}return t===n}class Wb{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(Rf(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class Vm{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=Rf(n),t}}const Ev=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function kf(e){return(e=String(e)).match(Ev)?e:"unsafe:"+e}function nh(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function Ap(...e){const n={};for(const t of e)for(const i in t)t.hasOwnProperty(i)&&(n[i]=!0);return n}const Cv=nh("area,br,col,hr,img,wbr"),Zb=nh("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Sv=nh("rp,rt"),Mv=Ap(Cv,Ap(Zb,nh("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ap(Sv,nh("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ap(Sv,Zb)),r_=nh("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Iv=Ap(r_,nh("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),nh("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Yb=nh("script,style,template");class Kb{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!Mv.hasOwnProperty(t))return this.sanitizedSomething=!0,!Yb.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=n.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),d=s.name,p=d.toLowerCase();if(!Iv.hasOwnProperty(p)){this.sanitizedSomething=!0;continue}let v=s.value;r_[p]&&(v=kf(v)),this.buf.push(" ",d,'="',Dv(v),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();Mv.hasOwnProperty(t)&&!Cv.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(Dv(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const eS=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,tS=/([^\#-~ |!])/g;function Dv(e){return e.replace(/&/g,"&amp;").replace(eS,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(tS,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Um;function Pp(e,n){let t=null;try{Um=Um||function Gc(e){const n=new Vm(e);return function Tp(){try{return!!(new window.DOMParser).parseFromString(Rf(""),"text/html")}catch{return!1}}()?new Wb(n):n}(e);let i=n?String(n):"";t=Um.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=Um.getInertBodyElement(i)}while(i!==s);return Rf((new Kb).sanitizeChildren(o_(t)||t))}finally{if(t){const i=o_(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function o_(e){return"content"in e&&function Qb(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var Vs=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(Vs||{});function Vu(e){const n=jm();return n?n.sanitize(Vs.URL,e)||"":Sd(e,"URL")?pu(e):kf(oi(e))}function Av(e){const n=jm();if(n)return Gb(n.sanitize(Vs.RESOURCE_URL,e)||"");if(Sd(e,"ResourceURL"))return Gb(pu(e));throw new Ot(904,!1)}function jm(){const e=Mn();return e&&e[Fs].sanitizer}class Pn{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=kn({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Md=new Pn("ENVIRONMENT_INITIALIZER"),Lf=new Pn("INJECTOR",-1),c_=new Pn("INJECTOR_DEF_TYPES");class Pv{get(n,t=hr){if(t===hr){const i=new Error(`NullInjectorError: No provider for ${br(n)}!`);throw i.name="NullInjectorError",i}return t}}function nS(...e){return{\u0275providers:d_(0,e),\u0275fromNgModule:!0}}function d_(e,...n){const t=[],i=new Set;let r;const s=d=>{t.push(d)};return yp(n,d=>{const p=d;Vh(p,s,[],i)&&(r||=[],r.push(p))}),void 0!==r&&t1(r,s),t}function t1(e,n){for(let t=0;t<e.length;t++){const{ngModule:i,providers:r}=e[t];h_(r,s=>{n(s,i)})}}function Vh(e,n,t,i){if(!(e=Bi(e)))return!1;let r=null,s=wc(e);const d=!s&&_r(e);if(s||d){if(d&&!d.standalone)return!1;r=e}else{const v=e.ngModule;if(s=wc(v),!s)return!1;r=v}const p=i.has(r);if(d){if(p)return!1;if(i.add(r),d.dependencies){const v="function"==typeof d.dependencies?d.dependencies():d.dependencies;for(const x of v)Vh(x,n,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!p){let x;i.add(r);try{yp(s.imports,M=>{Vh(M,n,t,i)&&(x||=[],x.push(M))})}finally{}void 0!==x&&t1(x,n)}if(!p){const x=Wd(r)||(()=>new r);n({provide:r,useFactory:x,deps:Rr},r),n({provide:c_,useValue:r,multi:!0},r),n({provide:Md,useValue:()=>Dt(r),multi:!0},r)}const v=s.providers;if(null!=v&&!p){const x=e;h_(v,M=>{n(M,x)})}}}return r!==e&&void 0!==e.providers}function h_(e,n){for(let t of e)vl(t)&&(t=t.\u0275providers),Array.isArray(t)?h_(t,n):n(t)}const n1=Ir({provide:String,useValue:Ir});function Op(e){return null!==e&&"object"==typeof e&&n1 in e}function Uh(e){return"function"==typeof e}const Rv=new Pn("Set Injector scope."),od={},iS={};let Bf;function jh(){return void 0===Bf&&(Bf=new Pv),Bf}class Kl{}class Gh extends Kl{get destroyed(){return this._destroyed}constructor(n,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ov(n,d=>this.processProvider(d)),this.records.set(Lf,ih(void 0,this)),r.has("environment")&&this.records.set(Kl,ih(void 0,this));const s=this.records.get(Rv);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(c_.multi,Rr,si.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=nu(this),i=os(void 0);try{return n()}finally{nu(t),os(i)}}get(n,t=hr,i=si.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(lc))return n[lc](this);i=Ka(i);const s=nu(this),d=os(void 0);try{if(!(i&si.SkipSelf)){let v=this.records.get(n);if(void 0===v){const x=function s1(e){return"function"==typeof e||"object"==typeof e&&e instanceof Pn}(n)&&Ul(n);v=x&&this.injectableDefInScope(x)?ih(kp(n),od):null,this.records.set(n,v)}if(null!=v)return this.hydrate(n,v)}return(i&si.Self?jh():this.parent).get(n,t=i&si.Optional&&t===hr?null:t)}catch(p){if("NullInjectorError"===p.name){if((p[gr]=p[gr]||[]).unshift(br(n)),s)throw p;return function ms(e,n,t,i){const r=e[gr];throw n[Da]&&r.unshift(n[Da]),e.message=function vh(e,n,t,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=br(n);if(Array.isArray(n))r=n.map(br).join(" -> ");else if("object"==typeof n){let s=[];for(let d in n)if(n.hasOwnProperty(d)){let p=n[d];s.push(d+":"+("string"==typeof p?JSON.stringify(p):br(p)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${e.replace(Xu,"\n  ")}`}("\n"+e.message,r,t,i),e.ngTokenPath=r,e[gr]=null,e}(p,n,"R3InjectorError",this.source)}throw p}finally{os(d),nu(s)}}resolveInjectorInitializers(){const n=nu(this),t=os(void 0);try{const r=this.get(Md.multi,Rr,si.Self);for(const s of r)s()}finally{nu(n),os(t)}}toString(){const n=[],t=this.records;for(const i of t.keys())n.push(br(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ot(205,!1)}processProvider(n){let t=Uh(n=Bi(n))?n:Bi(n&&n.provide);const i=function oS(e){return Op(e)?ih(void 0,e.useValue):ih(zf(e),od)}(n);if(Uh(n)||!0!==n.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=ih(void 0,od,!0),r.factory=()=>El(r.multi),this.records.set(t,r)),t=n,r.multi.push(n)}this.records.set(t,i)}hydrate(n,t){return t.value===od&&(t.value=iS,t.value=t.factory()),"object"==typeof t.value&&t.value&&function o1(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=Bi(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function kp(e){const n=Ul(e),t=null!==n?n.factory:Wd(e);if(null!==t)return t;if(e instanceof Pn)throw new Ot(204,!1);if(e instanceof Function)return function rS(e){const n=e.length;if(n>0)throw Ih(n,"?"),new Ot(204,!1);const t=function Xs(e){return e&&(e[Na]||e[jo])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new Ot(204,!1)}function zf(e,n,t){let i;if(Uh(e)){const r=Bi(e);return Wd(r)||kp(r)}if(Op(e))i=()=>Bi(e.useValue);else if(function r1(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...El(e.deps||[]));else if(function f_(e){return!(!e||!e.useExisting)}(e))i=()=>Dt(Bi(e.useExisting));else{const r=Bi(e&&(e.useClass||e.provide));if(!function sS(e){return!!e.deps}(e))return Wd(r)||kp(r);i=()=>new r(...El(e.deps))}return i}function ih(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Ov(e,n){for(const t of e)Array.isArray(t)?Ov(t,n):t&&vl(t)?Ov(t.\u0275providers,n):n(t)}const Gm=new Pn("AppId",{providedIn:"root",factory:()=>aS}),aS="ng",kv=new Pn("Platform Initializer"),$h=new Pn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),rh=new Pn("AnimationModuleType"),Lv=new Pn("CSP nonce",{providedIn:"root",factory:()=>function Ip(){if(void 0!==yv)return yv;if(typeof document<"u")return document;throw new Ot(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Uv=(e,n,t)=>null;function $c(e,n,t=!1){return Uv(e,n,t)}class c1{}class Gv{}class d1{resolveComponentFactory(n){throw function u1(e){const n=Error(`No component factory found for ${br(e)}.`);return n.ngComponent=e,n}(n)}}let mu=(()=>{class e{static#e=this.NULL=new d1}return e})();function h1(){return Bp(Bs(),Mn())}function Bp(e,n){return new Ks(yo(e,n))}let Ks=(()=>{class e{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=h1}return e})();function b_(e){return e instanceof Ks?e.nativeElement:e}class Xm{}let Hc=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function Hv(){const e=Mn(),t=Tl(Bs().index,e);return(l(t)?t:e)[Si]}()}return e})(),qv=(()=>{class e{static#e=this.\u0275prov=kn({token:e,providedIn:"root",factory:()=>null})}return e})();class _c{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const Wv=new _c("16.2.10"),Ym={};function Yv(e,n=null,t=null,i){const r=g1(e,n,t,i);return r.resolveInjectorInitializers(),r}function g1(e,n=null,t=null,i,r=new Set){const s=[t||Rr,nS(e)];return i=i||("object"==typeof e?void 0:br(e)),new Gh(s,n||jh(),i||null,r)}let Qs=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=hr;static#t=this.NULL=new Pv;static create(t,i){if(Array.isArray(t))return Yv({name:""},i,t,"");{const r=t.name??"";return Yv({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=kn({token:e,providedIn:"any",factory:()=>Dt(Lf)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function w_(e){return e.ngOriginalError}class qc{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&w_(n);for(;t&&w_(t);)t=w_(t);return t||null}}function C_(e){return n=>{setTimeout(e,void 0,n)}}const a=class Qv extends Ct{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,i){let r=n,s=t||(()=>null),d=i;if(n&&"object"==typeof n){const v=n;r=v.next?.bind(v),s=v.error?.bind(v),d=v.complete?.bind(v)}this.__isAsync&&(s=C_(s),r&&(r=C_(r)),d&&(d=C_(d)));const p=super.subscribe({next:r,error:s,complete:d});return n instanceof xe&&n.add(p),p}};function o(...e){}class _{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new a(!1),this.onMicrotaskEmpty=new a(!1),this.onStable=new a(!1),this.onError=new a(!1),typeof Zone>"u")throw new Ot(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function c(){const e="function"==typeof Do.requestAnimationFrame;let n=Do[e?"requestAnimationFrame":"setTimeout"],t=Do[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function O(e){const n=()=>{!function T(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Do,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,k(e),e.isCheckStableRunning=!0,S(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),k(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,d,p)=>{if(function te(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(p))return t.invokeTask(r,s,d,p);try{return V(e),t.invokeTask(r,s,d,p)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&n(),j(e)}},onInvoke:(t,i,r,s,d,p,v)=>{try{return V(e),t.invoke(r,s,d,p,v)}finally{e.shouldCoalesceRunChangeDetection&&n(),j(e)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(e._hasPendingMicrotasks=s.microTask,k(e),S(e)):"macroTask"==s.change&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_.isInAngularZone())throw new Ot(909,!1)}static assertNotInAngularZone(){if(_.isInAngularZone())throw new Ot(909,!1)}run(n,t,i){return this._inner.run(n,t,i)}runTask(n,t,i,r){const s=this._inner,d=s.scheduleEventTask("NgZoneEvent: "+r,n,E,o,o);try{return s.runTask(d,t,i)}finally{s.cancelTask(d)}}runGuarded(n,t,i){return this._inner.runGuarded(n,t,i)}runOutsideAngular(n){return this._outer.run(n)}}const E={};function S(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function k(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function V(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function j(e){e._nesting--,S(e)}class ${constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new a,this.onMicrotaskEmpty=new a,this.onStable=new a,this.onError=new a}run(n,t,i){return n.apply(t,i)}runGuarded(n,t,i){return n.apply(t,i)}runOutsideAngular(n){return n()}runTask(n,t,i,r){return n.apply(t,i)}}const W=new Pn("",{providedIn:"root",factory:K});function K(){const e=Rn(_);let n=!0;return eu(new Re(r=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(n),r.complete()})}),new Re(r=>{let s;e.runOutsideAngular(()=>{s=e.onStable.subscribe(()=>{_.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,r.next(!0))})})});const d=e.onUnstable.subscribe(()=>{_.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),d.unsubscribe()}}).pipe(Ai()))}function Ze(e){return e instanceof Function?e():e}let bn=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=kn({token:e,providedIn:"root",factory:()=>new e})}return e})();function $t(e){for(;e;){e[ki]|=64;const n=Cp(e);if(G(e)&&!n)return e;e=n}return null}const gn=new Pn("",{providedIn:"root",factory:()=>!1});let Fo=null;function Ji(e,n){return e[n]??Wo()}function er(e,n){const t=Wo();t.producerNode?.length&&(e[n]=Fo,t.lView=e,Fo=qo())}const Ho={...u,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{$t(e.lView)},lView:null};function qo(){return Object.create(Ho)}function Wo(){return Fo??=qo(),Fo}const ai={};function Gn(e){Js(Br(),Mn(),hl()+e,!1)}function Js(e,n,t,i){if(!i)if(3==(3&n[ki])){const s=e.preOrderCheckHooks;null!==s&&_m(n,s,t)}else{const s=e.preOrderHooks;null!==s&&Eh(n,s,0,t)}Fu(t)}function Et(e,n=si.Default){const t=Mn();return null===t?Dt(e,n):jy(Bs(),t,Bi(e),n)}function Mo(){throw new Error("invalid")}function ea(e,n,t,i,r,s,d,p,v,x,M){const R=n.blueprint.slice();return R[cs]=r,R[ki]=140|i,(null!==x||e&&2048&e[ki])&&(R[ki]|=2048),_d(R),R[Qi]=R[lu]=e,R[Go]=t,R[Fs]=d||e&&e[Fs],R[Si]=p||e&&e[Si],R[So]=v||e&&e[So]||null,R[yr]=s,R[Qu]=function LC(){return kC++}(),R[ul]=M,R[Ou]=x,R[Ys]=2==n.type?e[Ys]:R,R}function ts(e,n,t,i,r){let s=e.data[n];if(null===s)s=function Lr(e,n,t,i,r){const s=Yd(),d=Ty(),v=e.data[n]=function x1(e,n,t,i,r,s){let d=n?n.injectorIndex:-1,p=0;return Xd()&&(p|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:d,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:p,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,d?s:s&&s.parent,t,n,i,r);return null===e.firstChild&&(e.firstChild=v),null!==s&&(d?null==s.child&&null!==v.parent&&(s.child=v):null===s.next&&(s.next=v,v.prev=s)),v}(e,n,t,i,r),function Ei(){return lr.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const d=function Lu(){const e=lr.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();s.injectorIndex=null===d?-1:d.injectorIndex}return fc(s,!0),s}function Us(e,n,t,i){if(0===t)return-1;const r=n.length;for(let s=0;s<t;s++)n.push(i),e.blueprint.push(i),e.data.push(null);return r}function Zo(e,n,t,i,r){const s=Ji(n,cc),d=hl(),p=2&i;try{Fu(-1),p&&n.length>jn&&Js(e,n,jn,!1),vs(p?2:0,r);const x=p?s:null,M=B(x);try{null!==x&&(x.dirty=!1),t(i,r)}finally{U(x,M)}}finally{p&&null===n[cc]&&er(n,cc),Fu(d),vs(p?3:1,r)}}function Pl(e,n,t){if(y(n)){const i=b(null);try{const s=n.directiveEnd;for(let d=n.directiveStart;d<s;d++){const p=e.data[d];p.contentQueries&&p.contentQueries(1,t[d],d)}}finally{b(i)}}}function aa(e,n,t){yd()&&(function Xc(e,n,t,i){const r=t.directiveStart,s=t.directiveEnd;w(t)&&function f4(e,n,t){const i=yo(n,e),r=Ga(t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const p=E1(e,ea(e,r,null,d,i,n,null,e[Fs].rendererFactory.createRenderer(i,t),null,null,null));e[n.index]=p}(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||Ac(t,n),mc(i,n);const d=t.initialInputs;for(let p=r;p<s;p++){const v=e.data[p],x=Jd(n,e,p,t);mc(x,n),null!==d&&p4(0,p-r,x,v,0,d),z(v)&&(Tl(t.index,n)[Go]=Jd(n,e,p,t))}}(e,n,t,yo(t,n)),64==(64&t.flags)&&Up(e,n,t))}function ja(e,n,t=yo){const i=n.localNames;if(null!==i){let r=n.index+1;for(let s=0;s<i.length;s+=2){const d=i[s+1],p=-1===d?t(n,e):e[d];e[r++]=p}}}function Ga(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=Rl(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Rl(e,n,t,i,r,s,d,p,v,x,M){const R=jn+i,L=R+r,F=function il(e,n){const t=[];for(let i=0;i<n;i++)t.push(i<e?null:ai);return t}(R,L),Y="function"==typeof x?x():x;return F[Zn]={type:e,blueprint:F,template:t,queries:null,viewQuery:p,declTNode:n,data:F.slice().fill(null,R),bindingStartIndex:R,expandoStartIndex:L,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof d?d():d,firstChild:null,schemas:v,consts:Y,incompleteFirstPass:!1,ssrId:M}}let Vp=e=>null;function Jv(e,n,t,i){for(let r in e)if(e.hasOwnProperty(r)){t=null===t?{}:t;const s=e[r];null===i?S_(t,n,r,s):i.hasOwnProperty(r)&&S_(t,n,i[r],s)}return t}function S_(e,n,t,i){e.hasOwnProperty(t)?e[t].push(n,i):e[t]=[n,i]}function Wc(e,n,t,i,r,s,d,p){const v=yo(n,t);let M,x=n.inputs;!p&&null!=x&&(M=x[i])?(yS(e,t,M,i,r),w(n)&&function jf(e,n){const t=Tl(n,e);16&t[ki]||(t[ki]|=64)}(t,n.index)):3&n.type&&(i=function Ad(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=d?d(r,n.value||"",i):r,s.setProperty(v,i,r))}function Pd(e,n,t,i){if(yd()){const r=null===i?null:{"":-1},s=function w1(e,n){const t=e.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const d=t[s];if(pf(n,d.selectors,!1))if(i||(i=[]),z(d))if(null!==d.findHostDirectiveDefs){const p=[];r=r||new Map,d.findHostDirectiveDefs(d,p,r),i.unshift(...p,d),sh(e,n,p.length)}else i.unshift(d),sh(e,n,0);else r=r||new Map,d.findHostDirectiveDefs?.(d,i,r),i.push(d)}return null===i?null:[i,r]}(e,t);let d,p;null===s?d=p=null:[d,p]=s,null!==d&&M_(e,n,t,d,r,p),r&&function c4(e,n,t){if(n){const i=e.localNames=[];for(let r=0;r<n.length;r+=2){const s=t[n[r+1]];if(null==s)throw new Ot(-301,!1);i.push(n[r],s)}}}(t,i,r)}t.mergedAttrs=Ja(t.mergedAttrs,t.attrs)}function M_(e,n,t,i,r,s){for(let x=0;x<i.length;x++)Vy(Ac(t,n),e,i[x].type);!function d4(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,i.length);for(let x=0;x<i.length;x++){const M=i[x];M.providersResolver&&M.providersResolver(M)}let d=!1,p=!1,v=Us(e,n,i.length,null);for(let x=0;x<i.length;x++){const M=i[x];t.mergedAttrs=Ja(t.mergedAttrs,M.hostAttrs),h4(e,t,n,v,M),u4(v,M,r),null!==M.contentQueries&&(t.flags|=4),(null!==M.hostBindings||null!==M.hostAttrs||0!==M.hostVars)&&(t.flags|=64);const R=M.type.prototype;!d&&(R.ngOnChanges||R.ngOnInit||R.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),d=!0),!p&&(R.ngOnChanges||R.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),p=!0),v++}!function e0(e,n,t){const r=n.directiveEnd,s=e.data,d=n.attrs,p=[];let v=null,x=null;for(let M=n.directiveStart;M<r;M++){const R=s[M],L=t?t.get(R):null,Y=L?L.outputs:null;v=Jv(R.inputs,M,v,L?L.inputs:null),x=Jv(R.outputs,M,x,Y);const X=null===v||null===d||Mc(n)?null:m4(v,M,d);p.push(X)}null!==v&&(v.hasOwnProperty("class")&&(n.flags|=8),v.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=p,n.inputs=v,n.outputs=x}(e,t,s)}function Up(e,n,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,d=function Bc(){return lr.lFrame.currentDirectiveIndex}();try{Fu(s);for(let p=i;p<r;p++){const v=e.data[p],x=n[p];Lg(p),(null!==v.hostBindings||0!==v.hostVars||null!==v.hostAttrs)&&n0(v,x)}}finally{Fu(-1),Lg(d)}}function n0(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function sh(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function u4(e,n,t){if(t){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)t[n.exportAs[i]]=e;z(n)&&(t[""]=e)}}function h4(e,n,t,i,r){e.data[i]=r;const s=r.factory||(r.factory=Wd(r.type)),d=new nd(s,z(r),Et);e.blueprint[i]=d,t[i]=d,function mS(e,n,t,i,r){const s=r.hostBindings;if(s){let d=e.hostBindingOpCodes;null===d&&(d=e.hostBindingOpCodes=[]);const p=~n.index;(function Zc(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(d)!=p&&d.push(p),d.push(t,i,s)}}(e,n,i,Us(e,t,r.hostVars,ai),r)}function Wh(e,n,t,i,r,s){const d=yo(e,n);!function gS(e,n,t,i,r,s,d){if(null==s)e.removeAttribute(n,r,t);else{const p=null==d?oi(s):d(s,i||"",r);e.setAttribute(n,r,p,t)}}(n[Si],d,s,e.value,t,i,r)}function p4(e,n,t,i,r,s){const d=s[n];if(null!==d)for(let p=0;p<d.length;)pA(i,t,d[p++],d[p++],d[p++])}function pA(e,n,t,i,r){const s=b(null);try{const d=e.inputTransforms;null!==d&&d.hasOwnProperty(i)&&(r=d[i].call(n,r)),null!==e.setInput?e.setInput(n,r,t,i):n[i]=r}finally{b(s)}}function m4(e,n,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(e.hasOwnProperty(s)){null===i&&(i=[]);const d=e[s];for(let p=0;p<d.length;p+=2)if(d[p]===n){i.push(s,d[p+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function mA(e,n,t,i){return[e,!0,!1,n,null,0,i,t,null,null,null]}function gA(e,n){const t=e.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const d=e.data[s];fm(t[i]),d.contentQueries(2,n[s],s)}}}function E1(e,n){return e[au]?e[Ru][Co]=n:e[au]=n,e[Ru]=n,n}function _S(e,n,t){fm(0);const i=b(null);try{n(e,t)}finally{b(i)}}function _A(e){return e[su]||(e[su]=[])}function yA(e){return e.cleanup||(e.cleanup=[])}function vA(e,n,t){return(null===e||z(e))&&(t=function Po(e){for(;Array.isArray(e);){if("object"==typeof e[dc])return e;e=e[cs]}return null}(t[n.index])),t[Si]}function xA(e,n){const t=e[So],i=t?t.get(qc,null):null;i&&i.handleError(n)}function yS(e,n,t,i,r){for(let s=0;s<t.length;){const d=t[s++],p=t[s++];pA(e.data[d],n[d],i,p,r)}}function Gf(e,n,t){const i=Tr(n,e);!function fv(e,n,t){e.setValue(n,t)}(e[Si],i,t)}function g4(e,n){const t=Tl(n,e),i=t[Zn];!function _4(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(i,t);const r=t[cs];null!==r&&null===t[ul]&&(t[ul]=$c(r,t[So])),vS(i,t,t[Go])}function vS(e,n,t){Qd(n);try{const i=e.viewQuery;null!==i&&_S(1,i,t);const r=e.template;null!==r&&Zo(e,n,r,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&gA(e,n),e.staticViewQueries&&_S(2,e.viewQuery,t);const s=e.components;null!==s&&function y4(e,n){for(let t=0;t<n.length;t++)g4(e,n[t])}(n,s)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{n[ki]&=-5,ky()}}let bA=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const s=typeof Zone>"u"?null:Zone.current,d=function hn(e,n,t){const i=Object.create(yi);t&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=n;const r=d=>{i.cleanupFn=d};return i.ref={notify:()=>N(i),run:()=>{if(i.dirty=!1,i.hasRun&&!q(i))return;i.hasRun=!0;const d=B(i);try{i.cleanupFn(),i.cleanupFn=Sn,i.fn(r)}finally{U(i,d)}},cleanup:()=>i.cleanupFn()},i.ref}(t,x=>{this.all.has(x)&&this.queue.set(x,s)},r);let p;this.all.add(d),d.notify();const v=()=>{d.cleanup(),p?.(),this.all.delete(d),this.queue.delete(d)};return p=i?.onDestroy(v),{destroy:v}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=kn({token:e,providedIn:"root",factory:()=>new e})}return e})();function C1(e,n,t){let i=t?e.styles:null,r=t?e.classes:null,s=0;if(null!==n)for(let d=0;d<n.length;d++){const p=n[d];"number"==typeof p?s=p:1==s?r=Io(r,p):2==s&&(i=Io(i,p+": "+n[++d]+";"))}t?e.styles=i:e.stylesWithoutHost=i,t?e.classes=r:e.classesWithoutHost=r}function r0(e,n,t,i,r=!1){for(;null!==t;){const s=n[t.index];null!==s&&i.push(Hi(s)),h(s)&&wA(s,i);const d=t.type;if(8&d)r0(e,n,t.child,i);else if(32&d){const p=Df(t,n);let v;for(;v=p();)i.push(v)}else if(16&d){const p=nl(n,t);if(Array.isArray(p))i.push(...p);else{const v=Cp(n[Ys]);r0(v[Zn],v,p,i,!0)}}t=r?t.projectionNext:t.next}return i}function wA(e,n){for(let t=Ca;t<e.length;t++){const i=e[t],r=i[Zn].firstChild;null!==r&&r0(i[Zn],i,r,n)}e[ys]!==e[cs]&&n.push(e[ys])}function S1(e,n,t,i=!0){const r=n[Fs],s=r.rendererFactory,d=r.afterRenderEventManager;s.begin?.(),d?.begin();try{EA(e,n,e.template,t)}catch(v){throw i&&xA(n,v),v}finally{s.end?.(),r.effectManager?.flush(),d?.end()}}function EA(e,n,t,i){const r=n[ki];if(256!=(256&r)){n[Fs].effectManager?.flush(),Qd(n);try{_d(n),function Jx(e){return lr.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&Zo(e,n,t,2,i);const d=3==(3&r);if(d){const x=e.preOrderCheckHooks;null!==x&&_m(n,x,null)}else{const x=e.preOrderHooks;null!==x&&Eh(n,x,0,null),uu(n,0)}if(function b4(e){for(let n=Db(e);null!==n;n=dv(n)){if(!n[Dc])continue;const t=n[sa];for(let i=0;i<t.length;i++){ap(t[i])}}}(n),CA(n,2),null!==e.contentQueries&&gA(e,n),d){const x=e.contentCheckHooks;null!==x&&_m(n,x)}else{const x=e.contentHooks;null!==x&&Eh(n,x,1),uu(n,1)}!function Ra(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const i=Ji(n,Il);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)Fu(~s);else{const d=s,p=t[++r],v=t[++r];kg(p,d),i.dirty=!1;const x=B(i);try{v(2,n[d])}finally{U(i,x)}}}}finally{null===n[Il]&&er(n,Il),Fu(-1)}}(e,n);const p=e.components;null!==p&&MA(n,p,0);const v=e.viewQuery;if(null!==v&&_S(2,v,i),d){const x=e.viewCheckHooks;null!==x&&_m(n,x)}else{const x=e.viewHooks;null!==x&&Eh(n,x,2),uu(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[ki]&=-73,wh(n)}finally{ky()}}}function CA(e,n){for(let t=Db(e);null!==t;t=dv(t))for(let i=Ca;i<t.length;i++)SA(t[i],n)}function w4(e,n,t){SA(Tl(n,e),t)}function SA(e,n){if(!function mf(e){return 128==(128&e[ki])}(e))return;const t=e[Zn],i=e[ki];if(80&i&&0===n||1024&i||2===n)EA(t,e,t.template,e[Go]);else if(e[Vn]>0){CA(e,1);const r=t.components;null!==r&&MA(e,r,1)}}function MA(e,n,t){for(let i=0;i<n.length;i++)w4(e,n[i],t)}class o0{get rootNodes(){const n=this._lView,t=n[Zn];return r0(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Go]}set context(n){this._lView[Go]=n}get destroyed(){return 256==(256&this._lView[ki])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Qi];if(h(n)){const t=n[8],i=t?t.indexOf(this):-1;i>-1&&(Fh(n,i),Cd(t,i))}this._attachedToViewContainer=!1}Jg(this._lView[Zn],this._lView)}onDestroy(n){!function My(e,n){if(256==(256&e[ki]))throw new Ot(911,!1);null===e[ga]&&(e[ga]=[]),e[ga].push(n)}(this._lView,n)}markForCheck(){$t(this._cdRefInjectingView||this._lView)}detach(){this._lView[ki]&=-129}reattach(){this._lView[ki]|=128}detectChanges(){S1(this._lView[Zn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ot(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Qg(e,n){Fm(e,n,n[Si],2,null,null)}(this._lView[Zn],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Ot(902,!1);this._appRef=n}}class E4 extends o0{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;S1(n[Zn],n,n[Go],!1)}checkNoChanges(){}get context(){return null}}class IA extends mu{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=_r(n);return new s0(t,this.ngModule)}}function DA(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class S4{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,i){i=Ka(i);const r=this.injector.get(n,Ym,i);return r!==Ym||t===Ym?r:this.parentInjector.get(n,t,i)}}class s0 extends Gv{get inputs(){const n=this.componentDef,t=n.inputTransforms,i=DA(n.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return DA(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function Ic(e){return e.map(ll).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,i,r){let s=(r=r||this.ngModule)instanceof Kl?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const d=s?new S4(n,s):n,p=d.get(Xm,null);if(null===p)throw new Ot(407,!1);const R={rendererFactory:p,sanitizer:d.get(qv,null),effectManager:d.get(bA,null),afterRenderEventManager:d.get(bn,null)},L=p.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",Y=i?function ad(e,n,t,i){const s=i.get(gn,!1)||t===Lo.ShadowDom,d=e.selectRootElement(n,s);return function zp(e){Vp(e)}(d),d}(L,i,this.componentDef.encapsulation,d):Kg(L,F,function C4(e){const n=e.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(F)),ae=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Q=null;null!==Y&&(Q=$c(Y,d,!0));const me=Rl(0,null,null,1,0,null,null,null,null,null,null),Xe=ea(null,me,null,ae,null,null,R,L,d,null,Q);let nt,wt;Qd(Xe);try{const xt=this.componentDef;let Ft,Qe=null;xt.findHostDirectiveDefs?(Ft=[],Qe=new Map,xt.findHostDirectiveDefs(xt,Ft,Qe),Ft.push(xt)):Ft=[xt];const vi=function I4(e,n){const t=e[Zn],i=jn;return e[i]=n,ts(t,i,2,"#host",null)}(Xe,Y),ri=function D4(e,n,t,i,r,s,d){const p=r[Zn];!function T4(e,n,t,i){for(const r of e)n.mergedAttrs=Ja(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(C1(n,n.mergedAttrs,!0),null!==t&&_v(i,t,n))}(i,e,n,d);let v=null;null!==n&&(v=$c(n,r[So]));const x=s.rendererFactory.createRenderer(n,t);let M=16;t.signals?M=4096:t.onPush&&(M=64);const R=ea(r,Ga(t),null,M,r[e.index],e,s,x,null,null,v);return p.firstCreatePass&&sh(p,e,i.length-1),E1(r,R),r[e.index]=R}(vi,Y,xt,Ft,Xe,R,L);wt=us(me,jn),Y&&function P4(e,n,t,i){if(i)Is(e,t,["ng-version",Wv.full]);else{const{attrs:r,classes:s}=function Nc(e){const n=[],t=[];let i=1,r=2;for(;i<e.length;){let s=e[i];if("string"==typeof s)2===r?""!==s&&n.push(s,e[++i]):8===r&&t.push(s);else{if(!Os(r))break;r=s}i++}return{attrs:n,classes:t}}(n.selectors[0]);r&&Is(e,t,r),s&&s.length>0&&gv(e,t,s.join(" "))}}(L,xt,Y,i),void 0!==t&&function R4(e,n,t){const i=e.projection=[];for(let r=0;r<n.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(wt,this.ngContentSelectors,t),nt=function A4(e,n,t,i,r,s){const d=Bs(),p=r[Zn],v=yo(d,r);M_(p,r,d,t,null,i);for(let M=0;M<t.length;M++)mc(Jd(r,p,d.directiveStart+M,d),r);Up(p,r,d),v&&mc(v,r);const x=Jd(r,p,d.directiveStart+d.componentOffset,d);if(e[Go]=r[Go]=x,null!==s)for(const M of s)M(x,n);return Pl(p,d,e),x}(ri,xt,Ft,Qe,Xe,[O4]),vS(me,Xe,null)}finally{ky()}return new M4(this.componentType,nt,Bp(wt,Xe),Xe,wt)}}class M4 extends c1{constructor(n,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new E4(r),this.componentType=n}setInput(n,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const s=this._rootLView;yS(s[Zn],s,r,n,t),this.previousInputValues.set(n,t),$t(Tl(this._tNode.index,s))}}get injector(){return new ml(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function O4(){const e=Bs();zs(Mn()[Zn],e)}function zr(e){let n=function TA(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const i=[e];for(;n;){let r;if(z(e))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Ot(903,!1);r=n.\u0275dir}if(r){if(t){i.push(r);const d=e;d.inputs=M1(e.inputs),d.inputTransforms=M1(e.inputTransforms),d.declaredInputs=M1(e.declaredInputs),d.outputs=M1(e.outputs);const p=r.hostBindings;p&&F4(e,p);const v=r.viewQuery,x=r.contentQueries;if(v&&L4(e,v),x&&N4(e,x),na(e.inputs,r.inputs),na(e.declaredInputs,r.declaredInputs),na(e.outputs,r.outputs),null!==r.inputTransforms&&(null===d.inputTransforms&&(d.inputTransforms={}),na(d.inputTransforms,r.inputTransforms)),z(r)&&r.data.animation){const M=e.data;M.animation=(M.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let d=0;d<s.length;d++){const p=s[d];p&&p.ngInherit&&p(e),p===zr&&(t=!1)}}n=Object.getPrototypeOf(n)}!function k4(e){let n=0,t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Ja(r.hostAttrs,t=Ja(t,r.hostAttrs))}}(i)}function M1(e){return e===Ms?{}:e===Rr?[]:e}function L4(e,n){const t=e.viewQuery;e.viewQuery=t?(i,r)=>{n(i,r),t(i,r)}:n}function N4(e,n){const t=e.contentQueries;e.contentQueries=t?(i,r,s)=>{n(i,r,s),t(i,r,s)}:n}function F4(e,n){const t=e.hostBindings;e.hostBindings=t?(i,r)=>{n(i,r),t(i,r)}:n}function OA(e){const n=e.inputConfig,t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];Array.isArray(r)&&r[2]&&(t[i]=r[2])}e.inputTransforms=t}function I1(e){return!!xS(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function xS(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Zh(e,n,t){return e[n]=t}function Yc(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function tg(e,n,t,i){const r=Yc(e,n,t);return Yc(e,n+1,i)||r}function $a(e,n,t,i){const r=Mn();return Yc(r,cp(),n)&&(Br(),Wh(es(),r,e,n,t,i)),$a}function D_(e,n,t,i){return Yc(e,cp(),t)?n+oi(t)+i:ai}function T_(e,n,t,i,r,s){const p=tg(e,function dl(){return lr.lFrame.bindingIndex}(),t,r);return Jo(2),p?n+oi(t)+i+oi(r)+s:ai}function Oo(e,n,t,i,r,s,d,p){const v=Mn(),x=Br(),M=e+jn,R=x.firstCreatePass?function c5(e,n,t,i,r,s,d,p,v){const x=n.consts,M=ts(n,e,4,d||null,ql(x,p));Pd(n,t,M,ql(x,v)),zs(n,M);const R=M.tView=Rl(2,M,i,r,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,x,null);return null!==n.queries&&(n.queries.template(n,M),R.queries=n.queries.embeddedTView(M)),M}(M,x,v,n,t,i,r,s,d):x.data[M];fc(R,!1);const L=qA(x,v,R,e);fl()&&km(x,v,L,R),mc(L,v),E1(v,v[M]=mA(L,v,L,R)),D(R)&&aa(x,v,R),null!=d&&ja(v,R,p)}let qA=function WA(e,n,t,i){return pl(!0),n[Si].createComment("")};function MS(e){return function Ua(e,n){return e[n]}(function mC(){return lr.lFrame.contextLView}(),jn+e)}function Di(e,n,t){const i=Mn();return Yc(i,cp(),n)&&Wc(Br(),es(),i,e,n,i[Si],t,!1),Di}function IS(e,n,t,i,r){const d=r?"class":"style";yS(e,t,n.inputs[d],d,i)}function jt(e,n,t,i){const r=Mn(),s=Br(),d=jn+e,p=r[Si],v=s.firstCreatePass?function f5(e,n,t,i,r,s){const d=n.consts,v=ts(n,e,2,i,ql(d,r));return Pd(n,t,v,ql(d,s)),null!==v.attrs&&C1(v,v.attrs,!1),null!==v.mergedAttrs&&C1(v,v.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,v),v}(d,s,r,n,t,i):s.data[d],x=ZA(s,r,v,p,n,e);r[d]=x;const M=D(v);return fc(v,!0),_v(p,x,v),32!=(32&v.flags)&&fl()&&km(s,r,x,v),0===function Yx(){return lr.lFrame.elementDepthCount}()&&mc(x,r),function Dy(){lr.lFrame.elementDepthCount++}(),M&&(aa(s,r,v),Pl(s,v,r)),null!==i&&ja(r,v),jt}function Yt(){let e=Bs();Ty()?Ay():(e=e.parent,fc(e,!1));const n=e;(function Kx(e){return lr.skipHydrationRootTNode===e})(n)&&function pC(){lr.skipHydrationRootTNode=null}(),function Og(){lr.lFrame.elementDepthCount--}();const t=Br();return t.firstCreatePass&&(zs(t,e),y(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function yC(e){return 0!=(8&e.flags)}(n)&&IS(t,n,Mn(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function vC(e){return 0!=(16&e.flags)}(n)&&IS(t,n,Mn(),n.stylesWithoutHost,!1),Yt}function Oi(e,n,t,i){return jt(e,n,t,i),Yt(),Oi}let ZA=(e,n,t,i,r,s)=>(pl(!0),Kg(i,r,function zc(){return lr.lFrame.currentNamespace}()));function d0(e,n,t){const i=Mn(),r=Br(),s=e+jn,d=r.firstCreatePass?function g5(e,n,t,i,r){const s=n.consts,d=ql(s,i),p=ts(n,e,8,"ng-container",d);return null!==d&&C1(p,d,!0),Pd(n,t,p,ql(s,r)),null!==n.queries&&n.queries.elementStart(n,p),p}(s,r,i,n,t):r.data[s];fc(d,!0);const p=YA(r,i,d,e);return i[s]=p,fl()&&km(r,i,p,d),mc(p,i),D(d)&&(aa(r,i,d),Pl(r,d,i)),null!=t&&ja(i,d),d0}function h0(){let e=Bs();const n=Br();return Ty()?Ay():(e=e.parent,fc(e,!1)),n.firstCreatePass&&(zs(n,e),y(e)&&n.queries.elementEnd(e)),h0}let YA=(e,n,t,i)=>(pl(!0),Yg(n[Si],""));function $f(){return Mn()}function f0(e){return!!e&&"function"==typeof e.then}function KA(e){return!!e&&"function"==typeof e.subscribe}function vo(e,n,t,i){const r=Mn(),s=Br(),d=Bs();return QA(s,r,r[Si],d,e,n,i),vo}function DS(e,n){const t=Bs(),i=Mn(),r=Br();return QA(r,i,vA(Ng(r.data),t,i),t,e,n),DS}function QA(e,n,t,i,r,s,d){const p=D(i),x=e.firstCreatePass&&yA(e),M=n[Go],R=_A(n);let L=!0;if(3&i.type||d){const X=yo(i,n),ye=d?d(X):X,ae=R.length,Q=d?Xe=>d(Hi(Xe[i.index])):i.index;let me=null;if(!d&&p&&(me=function v5(e,n,t,i){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const d=r[s];if(d===t&&r[s+1]===i){const p=n[su],v=r[s+2];return p.length>v?p[v]:null}"string"==typeof d&&(s+=2)}return null}(e,n,r,i.index)),null!==me)(me.__ngLastListenerFn__||me).__ngNextListenerFn__=s,me.__ngLastListenerFn__=s,L=!1;else{s=e2(i,n,M,s,!1);const Xe=t.listen(ye,r,s);R.push(s,Xe),x&&x.push(r,Q,ae,ae+1)}}else s=e2(i,n,M,s,!1);const F=i.outputs;let Y;if(L&&null!==F&&(Y=F[r])){const X=Y.length;if(X)for(let ye=0;ye<X;ye+=2){const nt=n[Y[ye]][Y[ye+1]].subscribe(s),wt=R.length;R.push(s,nt),x&&x.push(r,i.index,wt,-(wt+1))}}}function JA(e,n,t,i){try{return vs(6,n,t),!1!==t(i)}catch(r){return xA(e,r),!1}finally{vs(7,n,t)}}function e2(e,n,t,i,r){return function s(d){if(d===Function)return i;$t(e.componentOffset>-1?Tl(e.index,n):n);let v=JA(n,t,i,d),x=s.__ngNextListenerFn__;for(;x;)v=JA(n,t,x,d)&&v,x=x.__ngNextListenerFn__;return r&&!1===v&&d.preventDefault(),v}}function xs(e=1){return function Ly(e){return(lr.lFrame.contextLView=function eb(e,n){for(;e>0;)n=n[lu],e--;return n}(e,lr.lFrame.contextLView))[Go]}(e)}function x5(e,n){let t=null;const i=function ou(e){const n=e.attrs;if(null!=n){const t=n.indexOf(5);if(!(1&t))return n[t+1]}return null}(e);for(let r=0;r<n.length;r++){const s=n[r];if("*"!==s){if(null===i?pf(e,s,!0):Ds(i,s))return r}else t=r}return t}function Xh(e){const n=Mn()[Ys][yr];if(!n.projection){const i=n.projection=Ih(e?e.length:1,null),r=i.slice();let s=n.child;for(;null!==s;){const d=e?x5(s,e):0;null!==d&&(r[d]?r[d].projectionNext=s:i[d]=s,r[d]=s),s=s.next}}}function Kc(e,n=0,t){const i=Mn(),r=Br(),s=ts(r,jn+e,16,null,t||null);null===s.projection&&(s.projection=n),Ay(),(!i[ul]||Xd())&&32!=(32&s.flags)&&function qC(e,n,t){Mp(n[Si],0,n,t,pv(e,t,n),kb(t.parent||n[yr],t,n))}(r,i,s)}function Hf(e,n,t){return R1(e,"",n,"",t),Hf}function R1(e,n,t,i,r){const s=Mn(),d=D_(s,n,t,i);return d!==ai&&Wc(Br(),es(),s,e,d,s[Si],r,!1),R1}function O1(e,n){return e<<17|n<<2}function jp(e){return e>>17&32767}function TS(e){return 2|e}function ng(e){return(131068&e)>>2}function AS(e,n){return-131069&e|n<<2}function PS(e){return 1|e}function u2(e,n,t,i,r){const s=e[t+1],d=null===n;let p=i?jp(s):ng(s),v=!1;for(;0!==p&&(!1===v||d);){const M=e[p+1];M5(e[p],n)&&(v=!0,e[p+1]=i?PS(M):TS(M)),p=i?jp(M):ng(M)}v&&(e[t+1]=i?TS(s):PS(s))}function M5(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&Dh(e,n)>=0}const Ql={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function d2(e){return e.substring(Ql.key,Ql.keyEnd)}function I5(e){return e.substring(Ql.value,Ql.valueEnd)}function h2(e,n){const t=Ql.textEnd;return t===n?-1:(n=Ql.keyEnd=function A5(e,n,t){for(;n<t&&e.charCodeAt(n)>32;)n++;return n}(e,Ql.key=n,t),N_(e,n,t))}function f2(e,n){const t=Ql.textEnd;let i=Ql.key=N_(e,n,t);return t===i?-1:(i=Ql.keyEnd=function P5(e,n,t){let i;for(;n<t&&(45===(i=e.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(e,i,t),i=m2(e,i,t),i=Ql.value=N_(e,i,t),i=Ql.valueEnd=function R5(e,n,t){let i=-1,r=-1,s=-1,d=n,p=d;for(;d<t;){const v=e.charCodeAt(d++);if(59===v)return p;34===v||39===v?p=d=g2(e,v,d,t):n===d-4&&85===s&&82===r&&76===i&&40===v?p=d=g2(e,41,d,t):v>32&&(p=d),s=r,r=i,i=-33&v}return p}(e,i,t),m2(e,i,t))}function p2(e){Ql.key=0,Ql.keyEnd=0,Ql.value=0,Ql.valueEnd=0,Ql.textEnd=e.length}function N_(e,n,t){for(;n<t&&e.charCodeAt(n)<=32;)n++;return n}function m2(e,n,t,i){return(n=N_(e,n,t))<t&&n++,n}function g2(e,n,t,i){let r=-1,s=t;for(;s<i;){const d=e.charCodeAt(s++);if(d==n&&92!==r)return s;r=92==d&&92===r?0:d}throw new Error}function Uu(e,n){return function ah(e,n,t,i){const r=Mn(),s=Br(),d=Jo(2);s.firstUpdatePass&&v2(s,e,d,i),n!==ai&&Yc(r,d,n)&&b2(s,s.data[hl()],r,r[Si],e,r[d+1]=function U5(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=br(pu(e)))),e}(n,t),i,d)}(e,n,null,!0),Uu}function gu(e){lh(x2,O5,e,!1)}function O5(e,n){for(let t=function T5(e){return p2(e),f2(e,N_(e,0,Ql.textEnd))}(n);t>=0;t=f2(n,t))x2(e,d2(n),I5(n))}function F_(e){lh(z5,Yh,e,!0)}function Yh(e,n){for(let t=function D5(e){return p2(e),h2(e,N_(e,0,Ql.textEnd))}(n);t>=0;t=h2(n,t))Uc(e,d2(n),!0)}function lh(e,n,t,i){const r=Br(),s=Jo(2);r.firstUpdatePass&&v2(r,null,s,i);const d=Mn();if(t!==ai&&Yc(d,s,t)){const p=r.data[hl()];if(E2(p,i)&&!y2(r,s)){let v=i?p.classesWithoutHost:p.stylesWithoutHost;null!==v&&(t=Io(v,t||"")),IS(r,p,d,t,i)}else!function V5(e,n,t,i,r,s,d,p){r===ai&&(r=Rr);let v=0,x=0,M=0<r.length?r[0]:null,R=0<s.length?s[0]:null;for(;null!==M||null!==R;){const L=v<r.length?r[v+1]:void 0,F=x<s.length?s[x+1]:void 0;let X,Y=null;M===R?(v+=2,x+=2,L!==F&&(Y=R,X=F)):null===R||null!==M&&M<R?(v+=2,Y=M):(x+=2,Y=R,X=F),null!==Y&&b2(e,n,t,i,Y,X,d,p),M=v<r.length?r[v]:null,R=x<s.length?s[x]:null}}(r,p,d,d[Si],d[s+1],d[s+1]=function B5(e,n,t){if(null==t||""===t)return Rr;const i=[],r=pu(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)e(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&e(i,s,r[s]);else"string"==typeof r&&n(i,r);return i}(e,n,t),i,s)}}function y2(e,n){return n>=e.expandoStartIndex}function v2(e,n,t,i){const r=e.data;if(null===r[t+1]){const s=r[hl()],d=y2(e,t);E2(s,i)&&null===n&&!d&&(n=!1),n=function k5(e,n,t,i){const r=Ng(e);let s=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(t=p0(t=RS(null,e,n,t,i),n.attrs,i),s=null);else{const d=n.directiveStylingLast;if(-1===d||e[d]!==r)if(t=RS(r,e,n,t,i),null===s){let v=function L5(e,n,t){const i=t?n.classBindings:n.styleBindings;if(0!==ng(i))return e[jp(i)]}(e,n,i);void 0!==v&&Array.isArray(v)&&(v=RS(null,e,n,v[1],i),v=p0(v,n.attrs,i),function N5(e,n,t,i){e[jp(t?n.classBindings:n.styleBindings)]=i}(e,n,i,v))}else s=function F5(e,n,t){let i;const r=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<r;s++)i=p0(i,e[s].hostAttrs,t);return p0(i,n.attrs,t)}(e,n,i)}return void 0!==s&&(i?n.residualClasses=s:n.residualStyles=s),t}(r,s,n,i),function C5(e,n,t,i,r,s){let d=s?n.classBindings:n.styleBindings,p=jp(d),v=ng(d);e[i]=t;let M,x=!1;if(Array.isArray(t)?(M=t[1],(null===M||Dh(t,M)>0)&&(x=!0)):M=t,r)if(0!==v){const L=jp(e[p+1]);e[i+1]=O1(L,p),0!==L&&(e[L+1]=AS(e[L+1],i)),e[p+1]=function w5(e,n){return 131071&e|n<<17}(e[p+1],i)}else e[i+1]=O1(p,0),0!==p&&(e[p+1]=AS(e[p+1],i)),p=i;else e[i+1]=O1(v,0),0===p?p=i:e[v+1]=AS(e[v+1],i),v=i;x&&(e[i+1]=TS(e[i+1])),u2(e,M,i,!0),u2(e,M,i,!1),function S5(e,n,t,i,r){const s=r?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof n&&Dh(s,n)>=0&&(t[i+1]=PS(t[i+1]))}(n,M,e,i,s),d=O1(p,v),s?n.classBindings=d:n.styleBindings=d}(r,s,n,t,d,i)}}function RS(e,n,t,i,r){let s=null;const d=t.directiveEnd;let p=t.directiveStylingLast;for(-1===p?p=t.directiveStart:p++;p<d&&(s=n[p],i=p0(i,s.hostAttrs,r),s!==e);)p++;return null!==e&&(t.directiveStylingLast=p),i}function p0(e,n,t){const i=t?1:2;let r=-1;if(null!==n)for(let s=0;s<n.length;s++){const d=n[s];"number"==typeof d?r=d:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Uc(e,d,!!t||n[++s]))}return void 0===e?null:e}function x2(e,n,t){Uc(e,n,pu(t))}function z5(e,n,t){const i=String(n);""!==i&&!i.includes(" ")&&Uc(e,i,t)}function b2(e,n,t,i,r,s,d,p){if(!(3&n.type))return;const v=e.data,x=v[p+1],M=function E5(e){return 1==(1&e)}(x)?w2(v,n,t,r,ng(x),d):void 0;k1(M)||(k1(s)||function b5(e){return 2==(2&e)}(x)&&(s=w2(v,null,t,r,p,d)),function ZC(e,n,t,i,r){if(n)r?e.addClass(t,i):e.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Lh.DashCase;null==r?e.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Lh.Important),e.setStyle(t,i,r,s))}}(i,d,Tr(hl(),t),r,s))}function w2(e,n,t,i,r,s){const d=null===n;let p;for(;r>0;){const v=e[r],x=Array.isArray(v),M=x?v[1]:v,R=null===M;let L=t[r+1];L===ai&&(L=R?Rr:void 0);let F=R?Xy(L,i):M===i?L:void 0;if(x&&!k1(F)&&(F=Xy(v,i)),k1(F)&&(p=F,d))return p;const Y=e[r+1];r=d?jp(Y):ng(Y)}if(null!==n){let v=s?n.residualClasses:n.residualStyles;null!=v&&(p=Xy(v,i))}return p}function k1(e){return void 0!==e}function E2(e,n){return 0!=(e.flags&(n?8:16))}function An(e,n=""){const t=Mn(),i=Br(),r=e+jn,s=i.firstCreatePass?ts(i,r,1,n,null):i.data[r],d=C2(i,t,s,n,e);t[r]=d,fl()&&km(i,t,d,s),fc(s,!1)}let C2=(e,n,t,i,r)=>(pl(!0),function Am(e,n){return e.createText(n)}(n[Si],i));function Gp(e){return qf("",e,""),Gp}function qf(e,n,t){const i=Mn(),r=D_(i,e,n,t);return r!==ai&&Gf(i,hl(),r),qf}function OS(e,n,t,i,r){const s=Mn(),d=T_(s,e,n,t,i,r);return d!==ai&&Gf(s,hl(),d),OS}function kS(e,n,t){const i=Mn();return Yc(i,cp(),n)&&Wc(Br(),es(),i,e,n,i[Si],t,!0),kS}function LS(e,n,t){const i=Mn();if(Yc(i,cp(),n)){const s=Br(),d=es();Wc(s,d,i,e,n,vA(Ng(s.data),d,i),t,!0)}return LS}const z_="en-US";let G2=z_;function BS(e,n,t,i,r){if(e=Bi(e),Array.isArray(e))for(let s=0;s<e.length;s++)BS(e[s],n,t,i,r);else{const s=Br(),d=Mn(),p=Bs();let v=Uh(e)?e:Bi(e.provide);const x=zf(e),M=1048575&p.providerIndexes,R=p.directiveStart,L=p.providerIndexes>>20;if(Uh(e)||!e.multi){const F=new nd(x,r,Et),Y=VS(v,n,r?M:M+L,R);-1===Y?(Vy(Ac(p,d),s,v),zS(s,e,n.length),n.push(v),p.directiveStart++,p.directiveEnd++,r&&(p.providerIndexes+=1048576),t.push(F),d.push(F)):(t[Y]=F,d[Y]=F)}else{const F=VS(v,n,M+L,R),Y=VS(v,n,M,M+L),ye=Y>=0&&t[Y];if(r&&!ye||!r&&!(F>=0&&t[F])){Vy(Ac(p,d),s,v);const ae=function lU(e,n,t,i,r){const s=new nd(e,t,Et);return s.multi=[],s.index=n,s.componentProviders=0,pP(s,r,i&&!t),s}(r?aU:sU,t.length,r,i,x);!r&&ye&&(t[Y].providerFactory=ae),zS(s,e,n.length,0),n.push(v),p.directiveStart++,p.directiveEnd++,r&&(p.providerIndexes+=1048576),t.push(ae),d.push(ae)}else zS(s,e,F>-1?F:Y,pP(t[r?Y:F],x,!r&&i));!r&&i&&ye&&t[Y].componentProviders++}}}function zS(e,n,t,i){const r=Uh(n),s=function Ff(e){return!!e.useClass}(n);if(r||s){const v=(s?Bi(n.useClass):n).prototype.ngOnDestroy;if(v){const x=e.destroyHooks||(e.destroyHooks=[]);if(!r&&n.multi){const M=x.indexOf(t);-1===M?x.push(t,[i,v]):x[M+1].push(i,v)}else x.push(t,v)}}}function pP(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function VS(e,n,t,i){for(let r=t;r<i;r++)if(n[r]===e)return r;return-1}function sU(e,n,t,i){return US(this.multi,[])}function aU(e,n,t,i){const r=this.multi;let s;if(this.providerFactory){const d=this.providerFactory.componentProviders,p=Jd(t,t[Zn],this.providerFactory.index,i);s=p.slice(0,d),US(r,s);for(let v=d;v<p.length;v++)s.push(p[v])}else s=[],US(r,s);return s}function US(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function ya(e,n=[]){return t=>{t.providersResolver=(i,r)=>function oU(e,n,t){const i=Br();if(i.firstCreatePass){const r=z(e);BS(t,i.data,i.blueprint,r,!0),BS(n,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,n)}}class rg{}class mP{}class jS extends rg{constructor(n,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new IA(this);const r=ls(n);this._bootstrapComponents=Ze(r.bootstrap),this._r3Injector=g1(n,t,[{provide:rg,useValue:this},{provide:mu,useValue:this.componentFactoryResolver},...i],br(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class GS extends mP{constructor(n){super(),this.moduleType=n}create(n){return new jS(this.moduleType,n,[])}}class gP extends rg{constructor(n){super(),this.componentFactoryResolver=new IA(this),this.instance=null;const t=new Gh([...n.providers,{provide:rg,useValue:this},{provide:mu,useValue:this.componentFactoryResolver}],n.parent||jh(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function $S(e,n,t=null){return new gP({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let dU=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=d_(0,t.type),r=i.length>0?$S([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=kn({token:e,providedIn:"environment",factory:()=>new e(Dt(Kl))})}return e})();function _P(e){e.getStandaloneInjector=n=>n.get(dU).getOrCreateStandaloneInjector(e)}function Wf(e,n,t,i){return function SP(e,n,t,i,r,s){const d=n+t;return Yc(e,d,r)?Zh(e,d+1,s?i.call(s,r):i(r)):x0(e,d+1)}(Mn(),pc(),e,n,t,i)}function og(e,n,t,i,r){return function MP(e,n,t,i,r,s,d){const p=n+t;return tg(e,p,r,s)?Zh(e,p+2,d?i.call(d,r,s):i(r,s)):x0(e,p+2)}(Mn(),pc(),e,n,t,i,r)}function x0(e,n){const t=e[n];return t===ai?void 0:t}function kU(){return this._results[Symbol.iterator]()}class qS{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new a)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=qS.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=kU)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const i=this;i.dirty=!1;const r=function du(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function Zy(e,n,t){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=n[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function NU(e,n,t,i=!0){const r=n[Zn];if(function gc(e,n,t,i){const r=Ca+i,s=t.length;i>0&&(t[r-1][Co]=n),i<s-Ca?(n[Co]=t[r],Ed(t,Ca+i,n)):(t.push(n),n[Co]=null),n[Qi]=t;const d=n[Aa];null!==d&&t!==d&&function Pm(e,n){const t=e[sa];n[Ys]!==n[Qi][Qi][Ys]&&(e[Dc]=!0),null===t?e[sa]=[n]:t.push(n)}(d,n);const p=n[za];null!==p&&p.insertView(e),n[ki]|=128}(r,n,e,t),i){const s=fu(t,e),d=n[Si],p=Om(d,e[ys]);null!==p&&function Tb(e,n,t,i,r,s){i[cs]=r,i[yr]=n,Fm(e,i,t,1,r,s)}(r,e[yr],d,n,p,s)}}let ch=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=zU}return e})();const FU=ch,BU=class extends FU{constructor(n,t,i){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,i){const r=function LU(e,n,t,i){const r=n.tView,p=ea(e,r,t,4096&e[ki]?4096:16,null,n,null,null,null,i?.injector??null,i?.hydrationInfo??null);p[Aa]=e[n.index];const x=e[za];return null!==x&&(p[za]=x.createEmbeddedView(r)),vS(r,p,t),p}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:i});return new o0(r)}};function zU(){return z1(Bs(),Mn())}function z1(e,n){return 4&e.type?new BU(n,e,Bp(e,n)):null}let Od=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=HU}return e})();function HU(){return NP(Bs(),Mn())}const qU=Od,kP=class extends qU{constructor(n,t,i){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=i}get element(){return Bp(this._hostTNode,this._hostLView)}get injector(){return new ml(this._hostTNode,this._hostLView)}get parentInjector(){const n=vm(this._hostTNode,this._hostLView);if(yf(n)){const t=xf(n,this._hostLView),i=vf(n);return new ml(t[Zn].data[i+8],t)}return new ml(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=LP(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-Ca}createEmbeddedView(n,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const p=n.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(p,r,false),p}createComponent(n,t,i,r,s){const d=n&&!function xm(e){return"function"==typeof e}(n);let p;if(d)p=t;else{const X=t||{};p=X.index,i=X.injector,r=X.projectableNodes,s=X.environmentInjector||X.ngModuleRef}const v=d?n:new s0(_r(n)),x=i||this.parentInjector;if(!s&&null==v.ngModule){const ye=(d?x:this.parentInjector).get(Kl,null);ye&&(s=ye)}_r(v.componentType??{});const F=v.create(x,r,null,s);return this.insertImpl(F.hostView,p,false),F}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,i){const r=n._lView;if(function td(e){return h(e[Qi])}(r)){const v=this.indexOf(n);if(-1!==v)this.detach(v);else{const x=r[Qi],M=new kP(x,x[yr],x[Qi]);M.detach(M.indexOf(n))}}const d=this._adjustIndex(t),p=this._lContainer;return NU(p,r,d,!i),n.attachToViewContainerRef(),Ed(WS(p),d,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=LP(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),i=Fh(this._lContainer,t);i&&(Cd(WS(this._lContainer),t),Jg(i[Zn],i))}detach(n){const t=this._adjustIndex(n,-1),i=Fh(this._lContainer,t);return i&&null!=Cd(WS(this._lContainer),t)?new o0(i):null}_adjustIndex(n,t=0){return n??this.length+t}};function LP(e){return e[8]}function WS(e){return e[8]||(e[8]=[])}function NP(e,n){let t;const i=n[e.index];return h(i)?t=i:(t=mA(i,n,null,e),n[e.index]=t,E1(n,t)),FP(t,n,e,i),new kP(t,e,n)}let FP=function BP(e,n,t,i){if(e[ys])return;let r;r=8&t.type?Hi(i):function WU(e,n){const t=e[Si],i=t.createComment(""),r=yo(n,e);return Pf(t,Om(t,r),i,function Ob(e,n){return e.nextSibling(n)}(t,r),!1),i}(n,t),e[ys]=r};class ZS{constructor(n){this.queryList=n,this.matches=null}clone(){return new ZS(this.queryList)}setDirty(){this.queryList.setDirty()}}class XS{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const i=null!==n.contentQueries?n.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const d=t.getByIndex(s);r.push(this.queries[d.indexInDeclarationView].clone())}return new XS(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==GP(n,t).matches&&this.queries[t].setDirty()}}class zP{constructor(n,t,i=null){this.predicate=n,this.flags=t,this.read=i}}class YS{constructor(n=[]){this.queries=n}elementStart(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(n,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new YS(t):null}template(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class KS{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new KS(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(n,t,YU(t,s)),this.matchTNodeWithReadOption(n,t,wf(t,n,s,!1,!1))}else i===ch?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,wf(t,n,i,!1,!1))}matchTNodeWithReadOption(n,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Ks||r===Od||r===ch&&4&t.type)this.addMatch(t.index,-2);else{const s=wf(t,n,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function YU(e,n){const t=e.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===n)return t[i+1];return null}function QU(e,n,t,i){return-1===t?function KU(e,n){return 11&e.type?Bp(e,n):4&e.type?z1(e,n):null}(n,e):-2===t?function JU(e,n,t){return t===Ks?Bp(n,e):t===ch?z1(n,e):t===Od?NP(n,e):void 0}(e,n,i):Jd(e,e[Zn],t,n)}function VP(e,n,t,i){const r=n[za].queries[i];if(null===r.matches){const s=e.data,d=t.matches,p=[];for(let v=0;v<d.length;v+=2){const x=d[v];p.push(x<0?null:QU(n,s[x],d[v+1],t.metadata.read))}r.matches=p}return r.matches}function QS(e,n,t,i){const r=e.queries.getByIndex(t),s=r.matches;if(null!==s){const d=VP(e,n,r,t);for(let p=0;p<s.length;p+=2){const v=s[p];if(v>0)i.push(d[p/2]);else{const x=s[p+1],M=n[-v];for(let R=Ca;R<M.length;R++){const L=M[R];L[Aa]===L[Qi]&&QS(L[Zn],L,x,i)}if(null!==M[sa]){const R=M[sa];for(let L=0;L<R.length;L++){const F=R[L];QS(F[Zn],F,x,i)}}}}}return i}function Kh(e){const n=Mn(),t=Br(),i=Nu();fm(i+1);const r=GP(t,i);if(e.dirty&&function Zd(e){return 4==(4&e[ki])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?QS(t,n,i,[]):VP(t,n,r,i);e.reset(s,b_),e.notifyOnChanges()}return!0}return!1}function $p(e,n,t){const i=Br();i.firstCreatePass&&(jP(i,new zP(e,n,t),-1),2==(2&n)&&(i.staticViewQueries=!0)),UP(i,Mn(),n)}function JS(e,n,t,i){const r=Br();if(r.firstCreatePass){const s=Bs();jP(r,new zP(n,t,i),s.index),function tj(e,n){const t=e.contentQueries||(e.contentQueries=[]);n!==(t.length?t[t.length-1]:-1)&&t.push(e.queries.length-1,n)}(r,e),2==(2&t)&&(r.staticContentQueries=!0)}UP(r,Mn(),t)}function Qh(){return function ej(e,n){return e[za].queries[n].queryList}(Mn(),Nu())}function UP(e,n,t){const i=new qS(4==(4&t));(function v1(e,n,t,i){const r=_A(n);r.push(t),e.firstCreatePass&&yA(e).push(i,r.length-1)})(e,n,i,i.destroy),null===n[za]&&(n[za]=new XS),n[za].queries.push(new ZS(i))}function jP(e,n,t){null===e.queries&&(e.queries=new YS),e.queries.track(new KS(n,t))}function GP(e,n){return e.queries.getByIndex(n)}const oM=new Pn("Application Initializer");let sM=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Rn(oM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=r();if(f0(s))t.push(s);else if(KA(s)){const d=new Promise((p,v)=>{s.subscribe({complete:p,error:v})});t.push(d)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),sR=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const Jh=new Pn("LocaleId",{providedIn:"root",factory:()=>Rn(Jh,si.Optional|si.SkipSelf)||function Ej(){return typeof $localize<"u"&&$localize.locale||z_}()});let j1=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new tn(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Mj{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let aR=(()=>{class e{compileModuleSync(t){return new GS(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Ze(ls(t).declarations).reduce((d,p)=>{const v=_r(p);return v&&d.push(new s0(v)),d},[]);return new Mj(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const dR=new Pn(""),$1=new Pn("");let dM,cM=(()=>{class e{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,dM||(function qj(e){dM=e}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(d=>d.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_),Dt(uM),Dt($1))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),uM=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return dM?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),Hp=null;const hR=new Pn("AllowMultipleToken"),hM=new Pn("PlatformDestroyListeners"),fM=new Pn("appBootstrapListener");class pR{constructor(n,t){this.name=n,this.token=t}}function gR(e,n,t=[]){const i=`Platform: ${n}`,r=new Pn(i);return(s=[])=>{let d=pM();if(!d||d.injector.get(hR,!1)){const p=[...t,...s,{provide:r,useValue:!0}];e?e(p):function Xj(e){if(Hp&&!Hp.get(hR,!1))throw new Ot(400,!1);(function fR(){!function St(e){ft=e}(()=>{throw new Ot(600,!1)})})(),Hp=e;const n=e.get(yR);(function mR(e){e.get(kv,null)?.forEach(t=>t())})(e)}(function _R(e=[],n){return Qs.create({name:n,providers:[{provide:Rv,useValue:"platform"},{provide:hM,useValue:new Set([()=>Hp=null])},...e]})}(p,i))}return function Kj(e){const n=pM();if(!n)throw new Ot(401,!1);return n}()}}function pM(){return Hp?.get(yR)??null}let yR=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function Qj(e="zone.js",n){return"noop"===e?new $:"zone.js"===e?new _(n):e}(i?.ngZone,function vR(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const s=function uU(e,n,t){return new jS(e,n,t)}(t.moduleType,this.injector,function CR(e){return[{provide:_,useFactory:e},{provide:Md,multi:!0,useFactory:()=>{const n=Rn(e6,{optional:!0});return()=>n.initialize()}},{provide:ER,useFactory:Jj},{provide:W,useFactory:K}]}(()=>r)),d=s.injector.get(qc,null);return r.runOutsideAngular(()=>{const p=r.onError.subscribe({next:v=>{d.handleError(v)}});s.onDestroy(()=>{H1(this._modules,s),p.unsubscribe()})}),function xR(e,n,t){try{const i=t();return f0(i)?i.catch(r=>{throw n.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>e.handleError(i)),i}}(d,r,()=>{const p=s.injector.get(sM);return p.runInitializers(),p.donePromise.then(()=>(function $2(e){zl(e,"Expected localeId to be defined"),"string"==typeof e&&(G2=e.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Jh,z_)||z_),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,i=[]){const r=bR({},i);return function Wj(e,n,t){const i=new GS(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(qp);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Ot(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ot(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(hM,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Qs))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function bR(e,n){return Array.isArray(n)?n.reduce(bR,e):{...e,...n}}let qp=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Rn(ER),this.zoneIsStable=Rn(W),this.componentTypes=[],this.components=[],this.isStable=Rn(j1).hasPendingTasks.pipe(gi(t=>t?Ln(!1):this.zoneIsStable),sr(),Ai()),this._injector=Rn(Kl)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof Gv;if(!this._injector.get(sM).done)throw!r&&function Ls(e){const n=_r(e)||Eo(e)||as(e);return null!==n&&n.standalone}(t),new Ot(405,!1);let d;d=r?t:this._injector.get(mu).resolveComponentFactory(t),this.componentTypes.push(d.componentType);const p=function Zj(e){return e.isBoundToModule}(d)?void 0:this._injector.get(rg),x=d.create(Qs.NULL,[],i||d.selector,p),M=x.location.nativeElement,R=x.injector.get(dR,null);return R?.registerApplication(M),x.onDestroy(()=>{this.detachView(x.hostView),H1(this.components,x),R?.unregisterApplication(M)}),this._loadComponent(x),x}tick(){if(this._runningTick)throw new Ot(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;H1(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(fM,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>H1(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Ot(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function H1(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const ER=new Pn("",{providedIn:"root",factory:()=>Rn(qc).handleError.bind(void 0)});function Jj(){const e=Rn(_),n=Rn(qc);return t=>e.runOutsideAngular(()=>n.handleError(t))}let e6=(()=>{class e{constructor(){this.zone=Rn(_),this.applicationRef=Rn(qp)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let sg=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=n6}return e})();function n6(e){return function i6(e,n,t){if(w(e)&&!t){const i=Tl(e.index,n);return new o0(i,i)}return 47&e.type?new o0(n[Ys],n):null}(Bs(),Mn(),16==(16&e))}class DR{constructor(){}supports(n){return I1(n)}create(n){return new c6(n)}}const l6=(e,n)=>n;class c6{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||l6}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const d=!i||t&&t.currentIndex<AR(i,r,s)?t:i,p=AR(d,r,s),v=d.currentIndex;if(d===i)r--,i=i._nextRemoved;else if(t=t._next,null==d.previousIndex)r++;else{s||(s=[]);const x=p-r,M=v-r;if(x!=M){for(let L=0;L<x;L++){const F=L<s.length?s[L]:s[L]=0,Y=F+L;M<=Y&&Y<x&&(s[L]=F+1)}s[d.previousIndex]=M-x}}p!==v&&n(d,p,v)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!I1(n))throw new Ot(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,s,d,t=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let p=0;p<this.length;p++)s=n[p],d=this._trackByFn(p,s),null!==t&&Object.is(t.trackById,d)?(i&&(t=this._verifyReinsertion(t,s,d,p)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,d,p),i=!0),t=t._next}else r=0,function $4(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let i;for(;!(i=t.next()).done;)n(i.value)}}(n,p=>{d=this._trackByFn(r,p),null!==t&&Object.is(t.trackById,d)?(i&&(t=this._verifyReinsertion(t,p,d,r)),Object.is(t.item,p)||this._addIdentityChange(t,p)):(t=this._mismatch(t,p,d,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,i,r){let s;return null===n?s=this._itTail:(s=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,s,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,s,r)):n=this._addAfter(new u6(t,i),s,r),n}_verifyReinsertion(n,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?n=this._reinsertAfter(s,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,s=n._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(n,t,i),this._addToMoves(n,i),n}_moveAfter(n,t,i){return this._unlink(n),this._insertAfter(n,t,i),this._addToMoves(n,i),n}_addAfter(n,t,i){return this._insertAfter(n,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,i){const r=null===t?this._itHead:t._next;return n._next=r,n._prev=t,null===r?this._itTail=n:r._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new TR),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,i=n._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new TR),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class u6{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class d6{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const t=n._prevDup,i=n._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class TR{constructor(){this.map=new Map}put(n){const t=n.trackById;let i=this.map.get(t);i||(i=new d6,this.map.set(t,i)),i.add(n)}get(n,t){const r=this.map.get(n);return r?r.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function AR(e,n,t){const i=e.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+n+r}class PR{constructor(){}supports(n){return n instanceof Map||xS(n)}create(){return new h6}}class h6{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||xS(n)))throw new Ot(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const i=n._prev;return t._next=n,t._prev=i,n._prev=t,i&&(i._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,t);const s=r._prev,d=r._next;return s&&(s._next=d),d&&(d._prev=s),r._next=null,r._prev=null,r}const i=new f6(n);return this._records.set(n,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(i=>t(n[i],i))}}class f6{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function RR(){return new Z1([new DR])}let Z1=(()=>{class e{static#e=this.\u0275prov=kn({token:e,providedIn:"root",factory:RR});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||RR()),deps:[[e,new bp,new If]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Ot(901,!1)}}return e})();function OR(){return new C0([new PR])}let C0=(()=>{class e{static#e=this.\u0275prov=kn({token:e,providedIn:"root",factory:OR});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||OR()),deps:[[e,new bp,new If]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Ot(901,!1)}}return e})();const g6=gR(null,"core",[]);let _6=(()=>{class e{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(qp))};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})();function j_(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let xM=null;function Wp(){return xM}class P6{}const Ar=new Pn("DocumentToken");let bM=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return Rn(O6)},providedIn:"platform"})}return e})();const R6=new Pn("Location Initialized");let O6=(()=>{class e extends bM{constructor(){super(),this._doc=Rn(Ar),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Wp().getBaseHref(this._doc)}onPopState(t){const i=Wp().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Wp().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function wM(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function jR(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function Zf(e){return e&&"?"!==e[0]?"?"+e:e}let lg=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return Rn($R)},providedIn:"root"})}return e})();const GR=new Pn("appBaseHref");let $R=(()=>{class e extends lg{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Rn(Ar).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return wM(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Zf(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const d=this.prepareExternalUrl(r+Zf(s));this._platformLocation.pushState(t,i,d)}replaceState(t,i,r,s){const d=this.prepareExternalUrl(r+Zf(s));this._platformLocation.replaceState(t,i,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(bM),Dt(GR,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),k6=(()=>{class e extends lg{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=wM(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let d=this.prepareExternalUrl(r+Zf(s));0==d.length&&(d=this._platformLocation.pathname),this._platformLocation.pushState(t,i,d)}replaceState(t,i,r,s){let d=this.prepareExternalUrl(r+Zf(s));0==d.length&&(d=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(bM),Dt(GR,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),S0=(()=>{class e{constructor(t){this._subject=new a,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function F6(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(jR(HR(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Zf(i))}normalize(t){return e.stripTrailingSlash(function N6(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,HR(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zf(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zf(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=Zf;static#t=this.joinWithSlash=wM;static#n=this.stripTrailingSlash=jR;static#i=this.\u0275fac=function(i){return new(i||e)(Dt(lg))};static#r=this.\u0275prov=kn({token:e,factory:function(){return function L6(){return new S0(Dt(lg))}()},providedIn:"root"})}return e})();function HR(e){return e.replace(/\/index.html$/,"")}function eO(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===n)return decodeURIComponent(s)}return null}const RM=/\s+/,tO=[];let OM=(()=>{class e{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=tO,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(RM):tO}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(RM):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(RM).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Z1),Et(C0),Et(Ks),Et(Hc))};static#t=this.\u0275dir=vn({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return e})();class w8{constructor(n,t,i,r){this.$implicit=n,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let iO=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,d)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new w8(r.item,this._ngForOf,-1,-1),null===d?void 0:d);else if(null==d)i.remove(null===s?void 0:s);else if(null!==s){const p=i.get(s);i.move(p,d),rO(p,r)}});for(let r=0,s=i.length;r<s;r++){const p=i.get(r).context;p.index=r,p.count=s,p.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{rO(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Od),Et(ch),Et(Z1))};static#t=this.\u0275dir=vn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return e})();function rO(e,n){e.context.$implicit=n.item}let $_=(()=>{class e{constructor(t,i){this._viewContainer=t,this._context=new E8,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){oO("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){oO("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Od),Et(ch))};static#t=this.\u0275dir=vn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class E8{constructor(){this.$implicit=null,this.ngIf=null}}function oO(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${br(n)}'.`)}let NM=(()=>{class e{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),d=-1===r.indexOf("-")?void 0:Lh.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,d):this._renderer.removeStyle(this._ngEl.nativeElement,r,d)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(C0),Et(Hc))};static#t=this.\u0275dir=vn({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return e})(),D0=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})();const lO="browser";function cO(e){return"server"===e}let J8=(()=>{class e{static#e=this.\u0275prov=kn({token:e,providedIn:"root",factory:()=>new eG(Dt(Ar),window)})}return e})();class eG{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const t=function tG(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const d=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(d)return d}r=i.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const t=n.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class uO{}class CG extends P6{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class UM extends CG{static makeCurrent(){!function A6(e){xM||(xM=e)}(new UM)}onAndCancel(n,t,i){return n.addEventListener(t,i),()=>{n.removeEventListener(t,i)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function SG(){return A0=A0||document.querySelector("base"),A0?A0.getAttribute("href"):null}();return null==t?null:function MG(e){lw=lw||document.createElement("a"),lw.setAttribute("href",e);const n=lw.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){A0=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return eO(document.cookie,n)}}let lw,A0=null,DG=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const jM=new Pn("EventManagerPlugins");let mO=(()=>{class e{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new Ot(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(jM),Dt(_))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();class gO{constructor(n){this._doc=n}}const GM="ng-app-id";let _O=(()=>{class e{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=cO(s),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${GM}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(GM),s;{const d=this.doc.createElement("style");return this.nonce&&d.setAttribute("nonce",this.nonce),d.textContent=i,this.platformIsServer&&d.setAttribute(GM,this.appId),d}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const s=this.styleRef,d=s.get(i)?.elements;d?d.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar),Dt(Gm),Dt(Lv,8),Dt($h))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const $M={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},HM=/%COMP%/g,RG=new Pn("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function vO(e,n){return n.map(t=>t.replace(HM,e))}let qM=(()=>{class e{constructor(t,i,r,s,d,p,v,x=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=d,this.platformId=p,this.ngZone=v,this.nonce=x,this.rendererByCompId=new Map,this.platformIsServer=cO(p),this.defaultRenderer=new WM(t,d,v,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Lo.ShadowDom&&(i={...i,encapsulation:Lo.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof bO?r.applyToHost(t):r instanceof ZM&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const d=this.doc,p=this.ngZone,v=this.eventManager,x=this.sharedStylesHost,M=this.removeStylesOnCompDestroy,R=this.platformIsServer;switch(i.encapsulation){case Lo.Emulated:s=new bO(v,x,i,this.appId,M,d,p,R);break;case Lo.ShadowDom:return new NG(v,x,t,i,d,p,this.nonce,R);default:s=new ZM(v,x,i,M,d,p,R)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(mO),Dt(_O),Dt(Gm),Dt(RG),Dt(Ar),Dt($h),Dt(_),Dt(Lv))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();class WM{constructor(n,t,i,r){this.eventManager=n,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS($M[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(xO(n)?n.content:n).appendChild(t)}insertBefore(n,t,i){n&&(xO(n)?n.content:n).insertBefore(t,i)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new Ot(-5104,!1);return t||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,i,r){if(r){t=r+":"+t;const s=$M[r];s?n.setAttributeNS(s,t,i):n.setAttribute(t,i)}else n.setAttribute(t,i)}removeAttribute(n,t,i){if(i){const r=$M[i];r?n.removeAttributeNS(r,t):n.removeAttribute(`${i}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,i,r){r&(Lh.DashCase|Lh.Important)?n.style.setProperty(t,i,r&Lh.Important?"important":""):n.style[t]=i}removeStyle(n,t,i){i&Lh.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,i){n[t]=i}setValue(n,t){n.nodeValue=t}listen(n,t,i){if("string"==typeof n&&!(n=Wp().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(i))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function xO(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class NG extends WM{constructor(n,t,i,r,s,d,p,v){super(n,s,d,v),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const x=vO(r.id,r.styles);for(const M of x){const R=document.createElement("style");p&&R.setAttribute("nonce",p),R.textContent=M,this.shadowRoot.appendChild(R)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,i){return super.insertBefore(this.nodeOrShadowRoot(n),t,i)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class ZM extends WM{constructor(n,t,i,r,s,d,p,v){super(n,s,d,p),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=v?vO(v,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class bO extends ZM{constructor(n,t,i,r,s,d,p,v){const x=r+"-"+i.id;super(n,t,i,s,d,p,v,x),this.contentAttr=function OG(e){return"_ngcontent-%COMP%".replace(HM,e)}(x),this.hostAttr=function kG(e){return"_nghost-%COMP%".replace(HM,e)}(x)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const i=super.createElement(n,t);return super.setAttribute(i,this.contentAttr,""),i}}let FG=(()=>{class e extends gO{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const wO=["alt","control","meta","shift"],BG={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},zG={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let VG=(()=>{class e extends gO{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const s=e.parseEventName(i),d=e.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Wp().onAndCancel(t,s.domEventName,d))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=e._normalizeKey(i.pop());let d="",p=i.indexOf("code");if(p>-1&&(i.splice(p,1),d="code."),wO.forEach(x=>{const M=i.indexOf(x);M>-1&&(i.splice(M,1),d+=x+".")}),d+=s,0!=i.length||0===s.length)return null;const v={};return v.domEventName=r,v.fullKey=d,v}static matchEventFullKeyCode(t,i){let r=BG[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),wO.forEach(d=>{d!==r&&(0,zG[d])(t)&&(s+=d+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{e.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const $G=gR(g6,"browser",[{provide:$h,useValue:lO},{provide:kv,useValue:function UG(){UM.makeCurrent()},multi:!0},{provide:Ar,useFactory:function GG(){return function XC(e){yv=e}(document),document},deps:[]}]),HG=new Pn(""),SO=[{provide:$1,useClass:class IG{addToWindow(n){Do.getAngularTestability=(i,r=!0)=>{const s=n.findTestabilityInTree(i,r);if(null==s)throw new Ot(5103,!1);return s},Do.getAllAngularTestabilities=()=>n.getAllTestabilities(),Do.getAllAngularRootElements=()=>n.getAllRootElements(),Do.frameworkStabilizers||(Do.frameworkStabilizers=[]),Do.frameworkStabilizers.push(i=>{const r=Do.getAllAngularTestabilities();let s=r.length,d=!1;const p=function(v){d=d||v,s--,0==s&&i(d)};r.forEach(v=>{v.whenStable(p)})})}findTestabilityInTree(n,t,i){return null==t?null:n.getTestability(t)??(i?Wp().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:dR,useClass:cM,deps:[_,uM,$1]},{provide:cM,useClass:cM,deps:[_,uM,$1]}],MO=[{provide:Rv,useValue:"root"},{provide:qc,useFactory:function jG(){return new qc},deps:[]},{provide:jM,useClass:FG,multi:!0,deps:[Ar,_,$h]},{provide:jM,useClass:VG,multi:!0,deps:[Ar]},qM,_O,mO,{provide:Xm,useExisting:qM},{provide:uO,useClass:DG,deps:[]},[]];let IO=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:Gm,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(HG,12))};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:[...MO,...SO],imports:[D0,_6]})}return e})(),DO=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:function(i){let r=null;return r=i?new i:function WG(){return new DO(Dt(Ar))}(),r},providedIn:"root"})}return e})();typeof window<"u"&&window;let YM=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(i){let r=null;return r=i?new(i||e):Dt(PO),r},providedIn:"root"})}return e})(),PO=(()=>{class e extends YM{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case Vs.NONE:return i;case Vs.HTML:return Sd(i,"HTML")?pu(i):Pp(this._doc,String(i)).toString();case Vs.STYLE:return Sd(i,"Style")?pu(i):i;case Vs.SCRIPT:if(Sd(i,"Script"))return pu(i);throw new Ot(5200,!1);case Vs.URL:return Sd(i,"URL")?pu(i):kf(String(i));case Vs.RESOURCE_URL:if(Sd(i,"ResourceURL"))return pu(i);throw new Ot(5201,!1);default:throw new Ot(5202,!1)}}bypassSecurityTrustHtml(t){return function Hb(e){return new n_(e)}(t)}bypassSecurityTrustStyle(t){return function bv(e){return new Dp(e)}(t)}bypassSecurityTrustScript(t){return function Pc(e){return new $b(e)}(t)}bypassSecurityTrustUrl(t){return function wv(e){return new i_(e)}(t)}bypassSecurityTrustResourceUrl(t){return function qb(e){return new xv(e)}(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:function(i){let r=null;return r=i?new i:function KG(e){return new PO(e.get(Ar))}(Dt(Qs)),r},providedIn:"root"})}return e})();const{isArray:QG}=Array,{getPrototypeOf:JG,prototype:e$,keys:t$}=Object;function OO(e){if(1===e.length){const n=e[0];if(QG(n))return{args:n,keys:null};if(function n$(e){return e&&"object"==typeof e&&JG(e)===e$}(n)){const t=t$(n);return{args:t.map(i=>n[i]),keys:t}}}return{args:e,keys:null}}const{isArray:i$}=Array;function KM(e){return Kt(n=>function r$(e,n){return i$(n)?e(...n):e(n)}(e,n))}function kO(e,n){return e.reduce((t,i,r)=>(t[i]=n[r],t),{})}function LO(...e){const n=rs(e),{args:t,keys:i}=OO(e),r=new Re(s=>{const{length:d}=t;if(!d)return void s.complete();const p=new Array(d);let v=d,x=d;for(let M=0;M<d;M++){let R=!1;dr(t[M]).subscribe(zn(s,L=>{R||(R=!0,x--),p[M]=L},()=>v--,void 0,()=>{(!v||!R)&&(x||s.next(i?kO(i,p):p),s.complete())}))}});return n?r.pipe(KM(n)):r}let NO=(()=>{class e{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Hc),Et(Ks))};static#t=this.\u0275dir=vn({type:e})}return e})(),cg=(()=>{class e extends NO{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=gl(e)))(r||e)}}();static#t=this.\u0275dir=vn({type:e,features:[zr]})}return e})();const hh=new Pn("NgValueAccessor"),o$={provide:hh,useExisting:nn(()=>QM),multi:!0};let QM=(()=>{class e extends cg{writeValue(t){this.setProperty("checked",t)}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=gl(e)))(r||e)}}();static#t=this.\u0275dir=vn({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){1&i&&vo("change",function(d){return r.onChange(d.target.checked)})("blur",function(){return r.onTouched()})},features:[ya([o$]),zr]})}return e})();const s$={provide:hh,useExisting:nn(()=>P0),multi:!0},l$=new Pn("CompositionEventMode");let P0=(()=>{class e extends NO{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function a$(){const e=Wp()?Wp().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Hc),Et(Ks),Et(l$,8))};static#t=this.\u0275dir=vn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&vo("input",function(d){return r._handleInput(d.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(d){return r._compositionEnd(d.target.value)})},features:[ya([s$]),zr]})}return e})();function Xp(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}function FO(e){return null!=e&&"number"==typeof e.length}const Qc=new Pn("NgValidators"),Yp=new Pn("NgAsyncValidators"),c$=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Jl{static min(n){return function BO(e){return n=>{if(Xp(n.value)||Xp(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t<e?{min:{min:e,actual:n.value}}:null}}(n)}static max(n){return function zO(e){return n=>{if(Xp(n.value)||Xp(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t>e?{max:{max:e,actual:n.value}}:null}}(n)}static required(n){return function VO(e){return Xp(e.value)?{required:!0}:null}(n)}static requiredTrue(n){return function UO(e){return!0===e.value?null:{required:!0}}(n)}static email(n){return function jO(e){return Xp(e.value)||c$.test(e.value)?null:{email:!0}}(n)}static minLength(n){return function GO(e){return n=>Xp(n.value)||!FO(n.value)?null:n.value.length<e?{minlength:{requiredLength:e,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function $O(e){return n=>FO(n.value)&&n.value.length>e?{maxlength:{requiredLength:e,actualLength:n.value.length}}:null}(n)}static pattern(n){return function HO(e){if(!e)return cw;let n,t;return"string"==typeof e?(t="","^"!==e.charAt(0)&&(t+="^"),t+=e,"$"!==e.charAt(e.length-1)&&(t+="$"),n=new RegExp(t)):(t=e.toString(),n=e),i=>{if(Xp(i.value))return null;const r=i.value;return n.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(n)}static nullValidator(n){return null}static compose(n){return KO(n)}static composeAsync(n){return QO(n)}}function cw(e){return null}function qO(e){return null!=e}function WO(e){return f0(e)?Ws(e):e}function ZO(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function XO(e,n){return n.map(t=>t(e))}function YO(e){return e.map(n=>function u$(e){return!e.validate}(n)?n:t=>n.validate(t))}function KO(e){if(!e)return null;const n=e.filter(qO);return 0==n.length?null:function(t){return ZO(XO(t,n))}}function JM(e){return null!=e?KO(YO(e)):null}function QO(e){if(!e)return null;const n=e.filter(qO);return 0==n.length?null:function(t){return LO(XO(t,n).map(WO)).pipe(Kt(ZO))}}function eI(e){return null!=e?QO(YO(e)):null}function JO(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function ek(e){return e._rawValidators}function tk(e){return e._rawAsyncValidators}function tI(e){return e?Array.isArray(e)?e:[e]:[]}function uw(e,n){return Array.isArray(e)?e.includes(n):e===n}function nk(e,n){const t=tI(n);return tI(e).forEach(r=>{uw(t,r)||t.push(r)}),t}function ik(e,n){return tI(n).filter(t=>!uw(e,t))}class rk{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=JM(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=eI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class xu extends rk{get formDirective(){return null}get path(){return null}}class Kp extends rk{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ok{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let R0=(()=>{class e extends ok{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Kp,2))};static#t=this.\u0275dir=vn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Uu("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[zr]})}return e})(),dw=(()=>{class e extends ok{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Et(xu,10))};static#t=this.\u0275dir=vn({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&Uu("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[zr]})}return e})();const O0="VALID",fw="INVALID",H_="PENDING",k0="DISABLED";function rI(e){return(pw(e)?e.validators:e)||null}function oI(e,n){return(pw(n)?n.asyncValidators:e)||null}function pw(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class ck{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===O0}get invalid(){return this.status===fw}get pending(){return this.status==H_}get disabled(){return this.status===k0}get enabled(){return this.status!==k0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(nk(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(nk(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(ik(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(ik(n,this._rawAsyncValidators))}hasValidator(n){return uw(this._rawValidators,n)}hasAsyncValidator(n){return uw(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=H_,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=k0,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=O0,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===O0||this.status===H_)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?k0:O0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=H_,this._hasOwnPendingAsyncValidator=!0;const t=WO(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(n,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new a,this.statusChanges=new a}_calculateStatus(){return this._allControlsDisabled()?k0:this.errors?fw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(H_)?H_:this._anyControlsHaveStatus(fw)?fw:O0}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){pw(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function p$(e){return Array.isArray(e)?JM(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function m$(e){return Array.isArray(e)?eI(e):e||null}(this._rawAsyncValidators)}}class ef extends ck{constructor(n,t,i){super(rI(t),oI(i,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,i={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){(function lk(e,n,t){e._forEachChild((i,r)=>{if(void 0===t[r])throw new Ot(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function ak(e,n,t){const i=e.controls;if(!(n?Object.keys(i):i).length)throw new Ot(1e3,"");if(!i[t])throw new Ot(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((i,r)=>{i.reset(n?n[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,i)=>(n[i]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&n(i,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(n,t){let i=n;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const ug=new Pn("CallSetDisabledState",{providedIn:"root",factory:()=>L0}),L0="always";function mw(e,n){return[...n.path,e]}function N0(e,n,t=L0){sI(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function y$(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&uk(e,n)})}(e,n),function x$(e,n){const t=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function v$(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&uk(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function _$(e,n){if(n.valueAccessor.setDisabledState){const t=i=>{n.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function gw(e,n,t=!0){const i=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(i),n.valueAccessor.registerOnTouched(i)),yw(e,n),e&&(n._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function _w(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function sI(e,n){const t=ek(e);null!==n.validator?e.setValidators(JO(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const i=tk(e);null!==n.asyncValidator?e.setAsyncValidators(JO(i,n.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();_w(n._rawValidators,r),_w(n._rawAsyncValidators,r)}function yw(e,n){let t=!1;if(null!==e){if(null!==n.validator){const r=ek(e);if(Array.isArray(r)&&r.length>0){const s=r.filter(d=>d!==n.validator);s.length!==r.length&&(t=!0,e.setValidators(s))}}if(null!==n.asyncValidator){const r=tk(e);if(Array.isArray(r)&&r.length>0){const s=r.filter(d=>d!==n.asyncValidator);s.length!==r.length&&(t=!0,e.setAsyncValidators(s))}}}const i=()=>{};return _w(n._rawValidators,i),_w(n._rawAsyncValidators,i),t}function uk(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function lI(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}function cI(e,n){if(!n)return null;let t,i,r;return Array.isArray(n),n.forEach(s=>{s.constructor===P0?t=s:function E$(e){return Object.getPrototypeOf(e.constructor)===cg}(s)?i=s:r=s}),r||i||t||null}function fk(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function pk(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const js=class extends ck{constructor(n=null,t,i){super(rI(t),oI(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),pw(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=pk(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){fk(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){fk(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){pk(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},D$={provide:Kp,useExisting:nn(()=>dI)},_k=(()=>Promise.resolve())();let dI=(()=>{class e extends Kp{constructor(t,i,r,s,d,p){super(),this._changeDetectorRef=d,this.callSetDisabledState=p,this.control=new js,this._registered=!1,this.name="",this.update=new a,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=cI(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),lI(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){N0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){_k.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&j_(i);_k.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?mw(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||e)(Et(xu,9),Et(Qc,10),Et(Yp,10),Et(hh,10),Et(sg,8),Et(ug,8))};static#t=this.\u0275dir=vn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ya([D$]),zr,ii]})}return e})(),hI=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=vn({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return e})(),vk=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})();const fI=new Pn("NgModelWithFormControlWarning"),k$={provide:xu,useExisting:nn(()=>q_)};let q_=(()=>{class e extends xu{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new a,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(yw(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return N0(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){gw(t.control||null,t,!1),function C$(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,function hk(e,n){e._syncPendingControls(),n.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(gw(i||null,t),(e=>e instanceof js)(r)&&(N0(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);(function dk(e,n){sI(e,n)})(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function b$(e,n){return yw(e,n)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){sI(this.form,this),this._oldForm&&yw(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Qc,10),Et(Yp,10),Et(ug,8))};static#t=this.\u0275dir=vn({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&vo("submit",function(d){return r.onSubmit(d)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ya([k$]),zr,ii]})}return e})();const F$={provide:Kp,useExisting:nn(()=>B0)};let B0=(()=>{class e extends Kp{set isDisabled(t){}static#e=this._ngModelWarningSentOnce=!1;constructor(t,i,r,s,d){super(),this._ngModelWarningConfig=d,this._added=!1,this.name=null,this.update=new a,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=cI(0,s)}ngOnChanges(t){this._added||this._setUpControl(),lI(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return mw(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(i){return new(i||e)(Et(xu,13),Et(Qc,10),Et(Yp,10),Et(hh,10),Et(fI,8))};static#n=this.\u0275dir=vn({type:e,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[ya([F$]),zr,ii]})}return e})(),Lk=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[vk]})}return e})(),J$=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:ug,useValue:t.callSetDisabledState??L0}]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[Lk]})}return e})(),eH=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:fI,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:ug,useValue:t.callSetDisabledState??L0}]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[Lk]})}return e})();function vw(...e){const n=ic(e),t=rs(e),{args:i,keys:r}=OO(e);if(0===i.length)return Ws([],n);const s=new Re(function nH(e,n,t=Lt){return i=>{Nk(n,()=>{const{length:r}=e,s=new Array(r);let d=r,p=r;for(let v=0;v<r;v++)Nk(n,()=>{const x=Ws(e[v],n);let M=!1;x.subscribe(zn(i,R=>{s[v]=R,M||(M=!0,p--),p||i.next(t(s.slice()))},()=>{--d||i.complete()}))},i)},i)}}(i,n,r?d=>kO(r,d):Lt));return t?s.pipe(KM(t)):s}function Nk(e,n,t){e?Hs(t,e,n):n()}const z0=Fe(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function xw(...e){return function iH(){return kc(1)}()(Ws(e,ic(e)))}function bw(e){return new Re(n=>{dr(e()).subscribe(n)})}function W_(e,n){const t=be(e)?e:()=>e,i=r=>r.error(t());return new Re(n?r=>n.schedule(i,0,r):i)}function vI(){return Bn((e,n)=>{let t=null;e._refCount++;const i=zn(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const r=e._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),n.unsubscribe()});e.subscribe(i),i.closed||(t=e.connect())})}class Fk extends Re{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ut(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new xe;const t=this.getSubject();n.add(this.source.subscribe(zn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=xe.EMPTY)}return n}refCount(){return vI()(this)}}function $u(e){return e<=0?()=>Cr:Bn((n,t)=>{let i=0;n.subscribe(zn(t,r=>{++i<=e&&(t.next(r),e<=i&&t.complete())}))})}function V0(...e){const n=ic(e);return Bn((t,i)=>{(n?xw(e,t,n):xw(e,t)).subscribe(i)})}function Rc(e,n){return Bn((t,i)=>{let r=0;t.subscribe(zn(i,s=>e.call(n,s,r++)&&i.next(s)))})}function ww(e){return Bn((n,t)=>{let i=!1;n.subscribe(zn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(e),t.complete()}))})}function Bk(e=rH){return Bn((n,t)=>{let i=!1;n.subscribe(zn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(e())))})}function rH(){return new z0}function Qp(e,n){const t=arguments.length>=2;return i=>i.pipe(e?Rc((r,s)=>e(r,s,i)):Lt,$u(1),t?ww(n):Bk(()=>new z0))}function Z_(e,n){return be(n)?_i(e,n,1):_i(e,1)}function ec(e,n,t){const i=be(e)||n||t?{next:e,error:n,complete:t}:e;return i?Bn((r,s)=>{var d;null===(d=i.subscribe)||void 0===d||d.call(i);let p=!0;r.subscribe(zn(s,v=>{var x;null===(x=i.next)||void 0===x||x.call(i,v),s.next(v)},()=>{var v;p=!1,null===(v=i.complete)||void 0===v||v.call(i),s.complete()},v=>{var x;p=!1,null===(x=i.error)||void 0===x||x.call(i,v),s.error(v)},()=>{var v,x;p&&(null===(v=i.unsubscribe)||void 0===v||v.call(i)),null===(x=i.finalize)||void 0===x||x.call(i)}))}):Lt}function Kf(e){return Bn((n,t)=>{let s,i=null,r=!1;i=n.subscribe(zn(t,void 0,void 0,d=>{s=dr(e(d,Kf(e)(n))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function xI(e){return e<=0?()=>Cr:Bn((n,t)=>{let i=[];n.subscribe(zn(t,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function zk(e){return Kt(()=>e)}function X_(e){return Bn((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function Jp(e){return Bn((n,t)=>{dr(e).subscribe(zn(t,()=>t.complete(),yt)),!t.closed&&n.subscribe(t)})}const Pr="primary",U0=Symbol("RouteTitle");class lH{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Y_(e){return new lH(e)}function cH(e,n,t){const i=t.path.split("/");if(i.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||i.length<e.length))return null;const r={};for(let s=0;s<i.length;s++){const d=i[s],p=e[s];if(d.startsWith(":"))r[d.substring(1)]=p;else if(d!==p.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function tf(e,n){const t=e?Object.keys(e):void 0,i=n?Object.keys(n):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Vk(e[r],n[r]))return!1;return!0}function Vk(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),i=[...n].sort();return t.every((r,s)=>i[s]===r)}return e===n}function Uk(e){return e.length>0?e[e.length-1]:null}function em(e){return function tH(e){return!!e&&(e instanceof Re||be(e.lift)&&be(e.subscribe))}(e)?e:f0(e)?Ws(Promise.resolve(e)):Ln(e)}const dH={exact:function $k(e,n,t){if(!hg(e.segments,n.segments)||!Ew(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!e.children[i]||!$k(e.children[i],n.children[i],t))return!1;return!0},subset:Hk},jk={exact:function hH(e,n){return tf(e,n)},subset:function fH(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>Vk(e[t],n[t]))},ignored:()=>!0};function Gk(e,n,t){return dH[t.paths](e.root,n.root,t.matrixParams)&&jk[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function Hk(e,n,t){return qk(e,n,n.segments,t)}function qk(e,n,t,i){if(e.segments.length>t.length){const r=e.segments.slice(0,t.length);return!(!hg(r,t)||n.hasChildren()||!Ew(r,t,i))}if(e.segments.length===t.length){if(!hg(e.segments,t)||!Ew(e.segments,t,i))return!1;for(const r in n.children)if(!e.children[r]||!Hk(e.children[r],n.children[r],i))return!1;return!0}{const r=t.slice(0,e.segments.length),s=t.slice(e.segments.length);return!!(hg(e.segments,r)&&Ew(e.segments,r,i)&&e.children[Pr])&&qk(e.children[Pr],n,s,i)}}function Ew(e,n,t){return n.every((i,r)=>jk[t](e[r].parameters,i.parameters))}class K_{constructor(n=new Gs([],{}),t={},i=null){this.root=n,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Y_(this.queryParams)),this._queryParamMap}toString(){return gH.serialize(this)}}class Gs{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Cw(this)}}class j0{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Y_(this.parameters)),this._parameterMap}toString(){return Xk(this)}}function hg(e,n){return e.length===n.length&&e.every((t,i)=>t.path===n[i].path)}let G0=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return new bI},providedIn:"root"})}return e})();class bI{parse(n){const t=new IH(n);return new K_(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${$0(n.root,!0)}`,i=function vH(e){const n=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(r=>`${Sw(t)}=${Sw(r)}`).join("&"):`${Sw(t)}=${Sw(i)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${i}${"string"==typeof n.fragment?`#${function _H(e){return encodeURI(e)}(n.fragment)}`:""}`}}const gH=new bI;function Cw(e){return e.segments.map(n=>Xk(n)).join("/")}function $0(e,n){if(!e.hasChildren())return Cw(e);if(n){const t=e.children[Pr]?$0(e.children[Pr],!1):"",i=[];return Object.entries(e.children).forEach(([r,s])=>{r!==Pr&&i.push(`${r}:${$0(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function mH(e,n){let t=[];return Object.entries(e.children).forEach(([i,r])=>{i===Pr&&(t=t.concat(n(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==Pr&&(t=t.concat(n(r,i)))}),t}(e,(i,r)=>r===Pr?[$0(e.children[Pr],!1)]:[`${r}:${$0(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Pr]?`${Cw(e)}/${t[0]}`:`${Cw(e)}/(${t.join("//")})`}}function Wk(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Sw(e){return Wk(e).replace(/%3B/gi,";")}function wI(e){return Wk(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Mw(e){return decodeURIComponent(e)}function Zk(e){return Mw(e.replace(/\+/g,"%20"))}function Xk(e){return`${wI(e.path)}${function yH(e){return Object.keys(e).map(n=>`;${wI(n)}=${wI(e[n])}`).join("")}(e.parameters)}`}const xH=/^[^\/()?;#]+/;function EI(e){const n=e.match(xH);return n?n[0]:""}const bH=/^[^\/()?;=#]+/,EH=/^[^=?&#]+/,SH=/^[^&#]+/;class IH{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Gs([],{}):new Gs([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(i[Pr]=new Gs(n,t)),i}parseSegment(){const n=EI(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Ot(4009,!1);return this.capture(n),new j0(Mw(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function wH(e){const n=e.match(bH);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=EI(this.remaining);r&&(i=r,this.capture(i))}n[Mw(t)]=Mw(i)}parseQueryParam(n){const t=function CH(e){const n=e.match(EH);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const d=function MH(e){const n=e.match(SH);return n?n[0]:""}(this.remaining);d&&(i=d,this.capture(i))}const r=Zk(t),s=Zk(i);if(n.hasOwnProperty(r)){let d=n[r];Array.isArray(d)||(d=[d],n[r]=d),d.push(s)}else n[r]=s}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=EI(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Ot(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=Pr);const d=this.parseChildren();t[s]=1===Object.keys(d).length?d[Pr]:new Gs([],d),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Ot(4011,!1)}}function Yk(e){return e.segments.length>0?new Gs([],{[Pr]:e}):e}function Kk(e){const n={};for(const i of Object.keys(e.children)){const s=Kk(e.children[i]);if(i===Pr&&0===s.segments.length&&s.hasChildren())for(const[d,p]of Object.entries(s.children))n[d]=p;else(s.segments.length>0||s.hasChildren())&&(n[i]=s)}return function DH(e){if(1===e.numberOfChildren&&e.children[Pr]){const n=e.children[Pr];return new Gs(e.segments.concat(n.segments),n.children)}return e}(new Gs(e.segments,n))}function fg(e){return e instanceof K_}function Qk(e){let n;const r=Yk(function t(s){const d={};for(const v of s.children){const x=t(v);d[v.outlet]=x}const p=new Gs(s.url,d);return s===e&&(n=p),p}(e.root));return n??r}function Jk(e,n,t,i){let r=e;for(;r.parent;)r=r.parent;if(0===n.length)return CI(r,r,r,t,i);const s=function AH(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new tL(!0,0,e);let n=0,t=!1;const i=e.reduce((r,s,d)=>{if("object"==typeof s&&null!=s){if(s.outlets){const p={};return Object.entries(s.outlets).forEach(([v,x])=>{p[v]="string"==typeof x?x.split("/"):x}),[...r,{outlets:p}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===d?(s.split("/").forEach((p,v)=>{0==v&&"."===p||(0==v&&""===p?t=!0:".."===p?n++:""!=p&&r.push(p))}),r):[...r,s]},[]);return new tL(t,n,i)}(n);if(s.toRoot())return CI(r,r,new Gs([],{}),t,i);const d=function PH(e,n,t){if(e.isAbsolute)return new Dw(n,!0,0);if(!t)return new Dw(n,!1,NaN);if(null===t.parent)return new Dw(t,!0,0);const i=Iw(e.commands[0])?0:1;return function RH(e,n,t){let i=e,r=n,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Ot(4005,!1);r=i.segments.length}return new Dw(i,!1,r-s)}(t,t.segments.length-1+i,e.numberOfDoubleDots)}(s,r,e),p=d.processChildren?q0(d.segmentGroup,d.index,s.commands):nL(d.segmentGroup,d.index,s.commands);return CI(r,d.segmentGroup,p,t,i)}function Iw(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function H0(e){return"object"==typeof e&&null!=e&&e.outlets}function CI(e,n,t,i,r){let d,s={};i&&Object.entries(i).forEach(([v,x])=>{s[v]=Array.isArray(x)?x.map(M=>`${M}`):`${x}`}),d=e===n?t:eL(e,n,t);const p=Yk(Kk(d));return new K_(p,s,r)}function eL(e,n,t){const i={};return Object.entries(e.children).forEach(([r,s])=>{i[r]=s===n?t:eL(s,n,t)}),new Gs(e.segments,i)}class tL{constructor(n,t,i){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=i,n&&i.length>0&&Iw(i[0]))throw new Ot(4003,!1);const r=i.find(H0);if(r&&r!==Uk(i))throw new Ot(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Dw{constructor(n,t,i){this.segmentGroup=n,this.processChildren=t,this.index=i}}function nL(e,n,t){if(e||(e=new Gs([],{})),0===e.segments.length&&e.hasChildren())return q0(e,n,t);const i=function kH(e,n,t){let i=0,r=n;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=t.length)return s;const d=e.segments[r],p=t[i];if(H0(p))break;const v=`${p}`,x=i<t.length-1?t[i+1]:null;if(r>0&&void 0===v)break;if(v&&x&&"object"==typeof x&&void 0===x.outlets){if(!rL(v,x,d))return s;i+=2}else{if(!rL(v,{},d))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,n,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const s=new Gs(e.segments.slice(0,i.pathIndex),{});return s.children[Pr]=new Gs(e.segments.slice(i.pathIndex),e.children),q0(s,0,r)}return i.match&&0===r.length?new Gs(e.segments,{}):i.match&&!e.hasChildren()?SI(e,n,t):i.match?q0(e,0,r):SI(e,n,t)}function q0(e,n,t){if(0===t.length)return new Gs(e.segments,{});{const i=function OH(e){return H0(e[0])?e[0].outlets:{[Pr]:e}}(t),r={};if(Object.keys(i).some(s=>s!==Pr)&&e.children[Pr]&&1===e.numberOfChildren&&0===e.children[Pr].segments.length){const s=q0(e.children[Pr],n,t);return new Gs(e.segments,s.children)}return Object.entries(i).forEach(([s,d])=>{"string"==typeof d&&(d=[d]),null!==d&&(r[s]=nL(e.children[s],n,d))}),Object.entries(e.children).forEach(([s,d])=>{void 0===i[s]&&(r[s]=d)}),new Gs(e.segments,r)}}function SI(e,n,t){const i=e.segments.slice(0,n);let r=0;for(;r<t.length;){const s=t[r];if(H0(s)){const v=LH(s.outlets);return new Gs(i,v)}if(0===r&&Iw(t[0])){i.push(new j0(e.segments[n].path,iL(t[0]))),r++;continue}const d=H0(s)?s.outlets[Pr]:`${s}`,p=r<t.length-1?t[r+1]:null;d&&p&&Iw(p)?(i.push(new j0(d,iL(p))),r+=2):(i.push(new j0(d,{})),r++)}return new Gs(i,{})}function LH(e){const n={};return Object.entries(e).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(n[t]=SI(new Gs([],{}),0,i))}),n}function iL(e){const n={};return Object.entries(e).forEach(([t,i])=>n[t]=`${i}`),n}function rL(e,n,t){return e==t.path&&tf(n,t.parameters)}const W0="imperative";class nf{constructor(n,t){this.id=n,this.url=t}}class Tw extends nf{constructor(n,t,i="imperative",r=null){super(n,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class tm extends nf{constructor(n,t,i){super(n,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Z0 extends nf{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Q_ extends nf{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=16}}class Aw extends nf{constructor(n,t,i,r){super(n,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class oL extends nf{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class NH extends nf{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class FH extends nf{constructor(n,t,i,r,s){super(n,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class BH extends nf{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zH extends nf{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class VH{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class UH{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class jH{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class GH{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $H{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class HH{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sL{constructor(n,t,i){this.routerEvent=n,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class MI{}class II{constructor(n){this.url=n}}class qH{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new X0,this.attachRef=null}}let X0=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new qH,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class aL{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=DI(n,this._root);return t?t.children.map(i=>i.value):[]}firstChild(n){const t=DI(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=TI(n,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return TI(n,this._root).map(t=>t.value)}}function DI(e,n){if(e===n.value)return n;for(const t of n.children){const i=DI(e,t);if(i)return i}return null}function TI(e,n){if(e===n.value)return[n];for(const t of n.children){const i=TI(e,t);if(i.length)return i.unshift(n),i}return[]}class Qf{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function J_(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class lL extends aL{constructor(n,t){super(n),this.snapshot=t,AI(this,n)}toString(){return this.snapshot.toString()}}function cL(e,n){const t=function WH(e,n){const d=new Pw([],{},{},"",{},Pr,n,null,{});return new dL("",new Qf(d,[]))}(0,n),i=new tn([new j0("",{})]),r=new tn({}),s=new tn({}),d=new tn({}),p=new tn(""),v=new ey(i,r,d,p,s,Pr,n,t.root);return v.snapshot=t.root,new lL(new Qf(v,[]),t)}class ey{constructor(n,t,i,r,s,d,p,v){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=d,this.component=p,this._futureSnapshot=v,this.title=this.dataSubject?.pipe(Kt(x=>x[U0]))??Ln(void 0),this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Kt(n=>Y_(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Kt(n=>Y_(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function uL(e,n="emptyOnly"){const t=e.pathFromRoot;let i=0;if("always"!==n)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function ZH(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Pw{get title(){return this.data?.[U0]}constructor(n,t,i,r,s,d,p,v,x){this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=d,this.component=p,this.routeConfig=v,this._resolve=x}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Y_(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Y_(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class dL extends aL{constructor(n,t){super(t),this.url=n,AI(this,t)}toString(){return hL(this._root)}}function AI(e,n){n.value._routerState=e,n.children.forEach(t=>AI(e,t))}function hL(e){const n=e.children.length>0?` { ${e.children.map(hL).join(", ")} } `:"";return`${e.value}${n}`}function PI(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,tf(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),tf(n.params,t.params)||e.paramsSubject.next(t.params),function uH(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!tf(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),tf(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function RI(e,n){const t=tf(e.params,n.params)&&function pH(e,n){return hg(e,n)&&e.every((t,i)=>tf(t.parameters,n[i].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||RI(e.parent,n.parent))}let Rw=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Pr,this.activateEvents=new a,this.deactivateEvents=new a,this.attachEvents=new a,this.detachEvents=new a,this.parentContexts=Rn(X0),this.location=Rn(Od),this.changeDetector=Rn(sg),this.environmentInjector=Rn(Kl),this.inputBinder=Rn(Ow,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ot(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ot(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ot(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Ot(4013,!1);this._activatedRoute=t;const r=this.location,d=t.snapshot.component,p=this.parentContexts.getOrCreateContext(this.name).children,v=new XH(t,p,r.injector);this.activated=r.createComponent(d,{index:r.length,injector:v,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=vn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ii]})}return e})();class XH{constructor(n,t,i){this.route=n,this.childContexts=t,this.parent=i}get(n,t){return n===ey?this.route:n===X0?this.childContexts:this.parent.get(n,t)}}const Ow=new Pn("");let fL=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=vw([i.queryParams,i.params,i.data]).pipe(gi(([s,d,p],v)=>(p={...s,...d,...p},0===v?Ln(p):Promise.resolve(p)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const d=function T6(e){const n=_r(e);if(!n)return null;const t=new s0(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(i.component);if(d)for(const{templateName:p}of d.inputs)t.activatedComponentRef.setInput(p,s[p]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();function Y0(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=n.value;const r=function KH(e,n,t){return n.children.map(i=>{for(const r of t.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return Y0(e,i,r);return Y0(e,i)})}(e,n,t);return new Qf(i,r)}{if(e.shouldAttach(n.value)){const s=e.retrieve(n.value);if(null!==s){const d=s.route;return d.value._futureSnapshot=n.value,d.children=n.children.map(p=>Y0(e,p)),d}}const i=function QH(e){return new ey(new tn(e.url),new tn(e.params),new tn(e.queryParams),new tn(e.fragment),new tn(e.data),e.outlet,e.component,e)}(n.value),r=n.children.map(s=>Y0(e,s));return new Qf(i,r)}}const OI="ngNavigationCancelingError";function pL(e,n){const{redirectTo:t,navigationBehaviorOptions:i}=fg(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=mL(!1,0,n);return r.url=t,r.navigationBehaviorOptions=i,r}function mL(e,n,t){const i=new Error("NavigationCancelingError: "+(e||""));return i[OI]=!0,i.cancellationCode=n,t&&(i.url=t),i}function gL(e){return e&&e[OI]}let _L=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["ng-component"]],standalone:!0,features:[_P],decls:1,vars:0,template:function(i,r){1&i&&Oi(0,"router-outlet")},dependencies:[Rw],encapsulation:2})}return e})();function kI(e){const n=e.children&&e.children.map(kI),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Pr&&(t.component=_L),t}function fh(e){return e.outlet||Pr}function K0(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class sq{constructor(n,t,i,r,s){this.routeReuseStrategy=n,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(n){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,n),PI(this.futureState.root),this.activateChildRoutes(t,i,n)}deactivateChildRoutes(n,t,i){const r=J_(t);n.children.forEach(s=>{const d=s.value.outlet;this.deactivateRoutes(s,r[d],i),delete r[d]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(n,t,i){const r=n.value,s=t?t.value:null;if(r===s)if(r.component){const d=i.getContext(r.outlet);d&&this.deactivateChildRoutes(n,t,d.children)}else this.deactivateChildRoutes(n,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,s=J_(n);for(const d of Object.keys(s))this.deactivateRouteAndItsChildren(s[d],r);if(i&&i.outlet){const d=i.outlet.detach(),p=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:d,route:n,contexts:p})}}deactivateRouteAndOutlet(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,s=J_(n);for(const d of Object.keys(s))this.deactivateRouteAndItsChildren(s[d],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(n,t,i){const r=J_(t);n.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new HH(s.value.snapshot))}),n.children.length&&this.forwardEvent(new GH(n.value.snapshot))}activateRoutes(n,t,i){const r=n.value,s=t?t.value:null;if(PI(r),r===s)if(r.component){const d=i.getOrCreateContext(r.outlet);this.activateChildRoutes(n,t,d.children)}else this.activateChildRoutes(n,t,i);else if(r.component){const d=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const p=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),d.children.onOutletReAttached(p.contexts),d.attachRef=p.componentRef,d.route=p.route.value,d.outlet&&d.outlet.attach(p.componentRef,p.route.value),PI(p.route.value),this.activateChildRoutes(n,null,d.children)}else{const p=K0(r.snapshot);d.attachRef=null,d.route=r,d.injector=p,d.outlet&&d.outlet.activateWith(r,d.injector),this.activateChildRoutes(n,null,d.children)}}else this.activateChildRoutes(n,null,i)}}class yL{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class kw{constructor(n,t){this.component=n,this.route=t}}function aq(e,n,t){const i=e._root;return Q0(i,n?n._root:null,t,[i.value])}function ty(e,n){const t=Symbol(),i=n.get(e,t);return i===t?"function"!=typeof e||function ha(e){return null!==Ul(e)}(e)?n.get(e):e:i}function Q0(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=J_(n);return e.children.forEach(d=>{(function cq(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,d=n?n.value:null,p=t?t.getContext(e.value.outlet):null;if(d&&s.routeConfig===d.routeConfig){const v=function uq(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!hg(e.url,n.url);case"pathParamsOrQueryParamsChange":return!hg(e.url,n.url)||!tf(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!RI(e,n)||!tf(e.queryParams,n.queryParams);default:return!RI(e,n)}}(d,s,s.routeConfig.runGuardsAndResolvers);v?r.canActivateChecks.push(new yL(i)):(s.data=d.data,s._resolvedData=d._resolvedData),Q0(e,n,s.component?p?p.children:null:t,i,r),v&&p&&p.outlet&&p.outlet.isActivated&&r.canDeactivateChecks.push(new kw(p.outlet.component,d))}else d&&J0(n,p,r),r.canActivateChecks.push(new yL(i)),Q0(e,null,s.component?p?p.children:null:t,i,r)})(d,s[d.value.outlet],t,i.concat([d.value]),r),delete s[d.value.outlet]}),Object.entries(s).forEach(([d,p])=>J0(p,t.getContext(d),r)),r}function J0(e,n,t){const i=J_(e),r=e.value;Object.entries(i).forEach(([s,d])=>{J0(d,r.component?n?n.children.getContext(s):null:n,t)}),t.canDeactivateChecks.push(new kw(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function ex(e){return"function"==typeof e}function vL(e){return e instanceof z0||"EmptyError"===e?.name}const Lw=Symbol("INITIAL_VALUE");function ny(){return gi(e=>vw(e.map(n=>n.pipe($u(1),V0(Lw)))).pipe(Kt(n=>{for(const t of n)if(!0!==t){if(t===Lw)return Lw;if(!1===t||t instanceof K_)return t}return!0}),Rc(n=>n!==Lw),$u(1)))}function xL(e){return function Ee(...e){return dt(e)}(ec(n=>{if(fg(n))throw pL(0,n)}),Kt(n=>!0===n))}class Nw{constructor(n){this.segmentGroup=n||null}}class bL{constructor(n){this.urlTree=n}}function iy(e){return W_(new Nw(e))}function wL(e){return W_(new bL(e))}class Aq{constructor(n,t){this.urlSerializer=n,this.urlTree=t}noMatchError(n){return new Ot(4002,!1)}lineralizeSegments(n,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ln(i);if(r.numberOfChildren>1||!r.children[Pr])return W_(new Ot(4e3,!1));r=r.children[Pr]}}applyRedirectCommands(n,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,i)}applyRedirectCreateUrlTree(n,t,i,r){const s=this.createSegmentGroup(n,t.root,i,r);return new K_(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const i={};return Object.entries(n).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const p=s.substring(1);i[r]=t[p]}else i[r]=s}),i}createSegmentGroup(n,t,i,r){const s=this.createSegments(n,t.segments,i,r);let d={};return Object.entries(t.children).forEach(([p,v])=>{d[p]=this.createSegmentGroup(n,v,i,r)}),new Gs(s,d)}createSegments(n,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(n,s,r):this.findOrReturn(s,i))}findPosParam(n,t,i){const r=i[t.path.substring(1)];if(!r)throw new Ot(4001,!1);return r}findOrReturn(n,t){let i=0;for(const r of t){if(r.path===n.path)return t.splice(i),r;i++}return n}}const LI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Pq(e,n,t,i,r){const s=NI(e,n,t);return s.matched?(i=function eq(e,n){return e.providers&&!e._injector&&(e._injector=$S(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,i),function Iq(e,n,t,i){const r=n.canMatch;return r&&0!==r.length?Ln(r.map(d=>{const p=ty(d,e);return em(function gq(e){return e&&ex(e.canMatch)}(p)?p.canMatch(n,t):e.runInContext(()=>p(n,t)))})).pipe(ny(),xL()):Ln(!0)}(i,n,t).pipe(Kt(d=>!0===d?s:{...LI}))):Ln(s)}function NI(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...LI}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(n.matcher||cH)(t,e,n);if(!r)return{...LI};const s={};Object.entries(r.posParams??{}).forEach(([p,v])=>{s[p]=v.path});const d=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:d,positionalParamSegments:r.posParams??{}}}function EL(e,n,t,i){return t.length>0&&function kq(e,n,t){return t.some(i=>Fw(e,n,i)&&fh(i)!==Pr)}(e,t,i)?{segmentGroup:new Gs(n,Oq(i,new Gs(t,e.children))),slicedSegments:[]}:0===t.length&&function Lq(e,n,t){return t.some(i=>Fw(e,n,i))}(e,t,i)?{segmentGroup:new Gs(e.segments,Rq(e,0,t,i,e.children)),slicedSegments:t}:{segmentGroup:new Gs(e.segments,e.children),slicedSegments:t}}function Rq(e,n,t,i,r){const s={};for(const d of i)if(Fw(e,t,d)&&!r[fh(d)]){const p=new Gs([],{});s[fh(d)]=p}return{...r,...s}}function Oq(e,n){const t={};t[Pr]=n;for(const i of e)if(""===i.path&&fh(i)!==Pr){const r=new Gs([],{});t[fh(i)]=r}return t}function Fw(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class zq{constructor(n,t,i,r,s,d,p){this.injector=n,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=d,this.urlSerializer=p,this.allowRedirects=!0,this.applyRedirects=new Aq(this.urlSerializer,this.urlTree)}noMatchError(n){return new Ot(4002,!1)}recognize(){const n=EL(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Pr).pipe(Kf(t=>{if(t instanceof bL)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Nw?this.noMatchError(t):t}),Kt(t=>{const i=new Pw([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Pr,this.rootComponentType,null,{}),r=new Qf(i,t),s=new dL("",r),d=function TH(e,n,t=null,i=null){return Jk(Qk(e),n,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return d.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(d),this.inheritParamsAndData(s._root),{state:s,tree:d}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,Pr).pipe(Kf(i=>{throw i instanceof Nw?this.noMatchError(i):i}))}inheritParamsAndData(n){const t=n.value,i=uL(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),n.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(n,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(n,t,i):this.processSegment(n,t,i,i.segments,r,!0)}processChildren(n,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Ws(r).pipe(Z_(s=>{const d=i.children[s],p=function rq(e,n){const t=e.filter(i=>fh(i)===n);return t.push(...e.filter(i=>fh(i)!==n)),t}(t,s);return this.processSegmentGroup(n,p,d,s)}),function sH(e,n){return Bn(function oH(e,n,t,i,r){return(s,d)=>{let p=t,v=n,x=0;s.subscribe(zn(d,M=>{const R=x++;v=p?e(v,M,R):(p=!0,M),i&&d.next(v)},r&&(()=>{p&&d.next(v),d.complete()})))}}(e,n,arguments.length>=2,!0))}((s,d)=>(s.push(...d),s)),ww(null),function aH(e,n){const t=arguments.length>=2;return i=>i.pipe(e?Rc((r,s)=>e(r,s,i)):Lt,xI(1),t?ww(n):Bk(()=>new z0))}(),_i(s=>{if(null===s)return iy(i);const d=CL(s);return function Vq(e){e.sort((n,t)=>n.value.outlet===Pr?-1:t.value.outlet===Pr?1:n.value.outlet.localeCompare(t.value.outlet))}(d),Ln(d)}))}processSegment(n,t,i,r,s,d){return Ws(t).pipe(Z_(p=>this.processSegmentAgainstRoute(p._injector??n,t,p,i,r,s,d).pipe(Kf(v=>{if(v instanceof Nw)return Ln(null);throw v}))),Qp(p=>!!p),Kf(p=>{if(vL(p))return function Fq(e,n,t){return 0===n.length&&!e.children[t]}(i,r,s)?Ln([]):iy(i);throw p}))}processSegmentAgainstRoute(n,t,i,r,s,d,p){return function Nq(e,n,t,i){return!!(fh(e)===i||i!==Pr&&Fw(n,t,e))&&("**"===e.path||NI(n,e,t).matched)}(i,r,s,d)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,r,i,s,d,p):p&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,r,t,i,s,d):iy(r):iy(r)}expandSegmentAgainstRouteUsingRedirect(n,t,i,r,s,d){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,r,d):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,s,d)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,i,r){const s=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?wL(s):this.applyRedirects.lineralizeSegments(i,s).pipe(_i(d=>{const p=new Gs(d,{});return this.processSegment(n,t,p,d,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,s,d){const{matched:p,consumedSegments:v,remainingSegments:x,positionalParamSegments:M}=NI(t,r,s);if(!p)return iy(t);const R=this.applyRedirects.applyRedirectCommands(v,r.redirectTo,M);return r.redirectTo.startsWith("/")?wL(R):this.applyRedirects.lineralizeSegments(r,R).pipe(_i(L=>this.processSegment(n,i,t,L.concat(x),d,!1)))}matchSegmentAgainstRoute(n,t,i,r,s,d){let p;if("**"===i.path){const v=r.length>0?Uk(r).parameters:{};p=Ln({snapshot:new Pw(r,v,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,SL(i),fh(i),i.component??i._loadedComponent??null,i,ML(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else p=Pq(t,i,r,n).pipe(Kt(({matched:v,consumedSegments:x,remainingSegments:M,parameters:R})=>v?{snapshot:new Pw(x,R,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,SL(i),fh(i),i.component??i._loadedComponent??null,i,ML(i)),consumedSegments:x,remainingSegments:M}:null));return p.pipe(gi(v=>null===v?iy(t):this.getChildConfig(n=i._injector??n,i,r).pipe(gi(({routes:x})=>{const M=i._loadedInjector??n,{snapshot:R,consumedSegments:L,remainingSegments:F}=v,{segmentGroup:Y,slicedSegments:X}=EL(t,L,F,x);if(0===X.length&&Y.hasChildren())return this.processChildren(M,x,Y).pipe(Kt(ae=>null===ae?null:[new Qf(R,ae)]));if(0===x.length&&0===X.length)return Ln([new Qf(R,[])]);const ye=fh(i)===s;return this.processSegment(M,x,Y,X,ye?Pr:s,!0).pipe(Kt(ae=>[new Qf(R,ae)]))}))))}getChildConfig(n,t,i){return t.children?Ln({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?Ln({routes:t._loadedRoutes,injector:t._loadedInjector}):function Mq(e,n,t,i){const r=n.canLoad;return void 0===r||0===r.length?Ln(!0):Ln(r.map(d=>{const p=ty(d,e);return em(function hq(e){return e&&ex(e.canLoad)}(p)?p.canLoad(n,t):e.runInContext(()=>p(n,t)))})).pipe(ny(),xL())}(n,t,i).pipe(_i(r=>r?this.configLoader.loadChildren(n,t).pipe(ec(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Tq(e){return W_(mL(!1,3))}())):Ln({routes:[],injector:n})}}function Uq(e){const n=e.value.routeConfig;return n&&""===n.path}function CL(e){const n=[],t=new Set;for(const i of e){if(!Uq(i)){n.push(i);continue}const r=n.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):n.push(i)}for(const i of t){const r=CL(i.children);n.push(new Qf(i.value,r))}return n.filter(i=>!t.has(i))}function SL(e){return e.data||{}}function ML(e){return e.resolve||{}}function IL(e){return"string"==typeof e.title||null===e.title}function FI(e){return gi(n=>{const t=e(n);return t?Ws(t).pipe(Kt(()=>n)):Ln(n)})}const ry=new Pn("ROUTES");let BI=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Rn(aR)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ln(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=em(t.loadComponent()).pipe(Kt(DL),ec(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),X_(()=>{this.componentLoaders.delete(t)})),r=new Fk(i,()=>new Ct).pipe(vI());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ln({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function Zq(e,n,t,i){return em(e.loadChildren()).pipe(Kt(DL),_i(r=>r instanceof mP||Array.isArray(r)?Ln(r):Ws(n.compileModuleAsync(r))),Kt(r=>{i&&i(e);let s,d,p=!1;return Array.isArray(r)?(d=r,!0):(s=r.create(t).injector,d=s.get(ry,[],{optional:!0,self:!0}).flat()),{routes:d.map(kI),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(X_(()=>{this.childrenLoaders.delete(i)})),d=new Fk(s,()=>new Ct).pipe(vI());return this.childrenLoaders.set(i,d),d}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function DL(e){return function Xq(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let Bw=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ct,this.transitionAbortSubject=new Ct,this.configLoader=Rn(BI),this.environmentInjector=Rn(Kl),this.urlSerializer=Rn(G0),this.rootContexts=Rn(X0),this.inputBindingEnabled=null!==Rn(Ow,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Ln(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new UH(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new VH(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new tn({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:W0,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Rc(s=>0!==s.id),Kt(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),gi(s=>{this.currentTransition=s;let d=!1,p=!1;return Ln(s).pipe(ec(v=>{this.currentNavigation={id:v.id,initialUrl:v.rawUrl,extractedUrl:v.extractedUrl,trigger:v.source,extras:v.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),gi(v=>{const x=v.currentBrowserUrl.toString(),M=!t.navigated||v.extractedUrl.toString()!==x||x!==v.currentUrlTree.toString();if(!M&&"reload"!==(v.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const L="";return this.events.next(new Q_(v.id,this.urlSerializer.serialize(v.rawUrl),L,0)),v.resolve(null),Cr}if(t.urlHandlingStrategy.shouldProcessUrl(v.rawUrl))return Ln(v).pipe(gi(L=>{const F=this.transitions?.getValue();return this.events.next(new Tw(L.id,this.urlSerializer.serialize(L.extractedUrl),L.source,L.restoredState)),F!==this.transitions?.getValue()?Cr:Promise.resolve(L)}),function jq(e,n,t,i,r,s){return _i(d=>function Bq(e,n,t,i,r,s,d="emptyOnly"){return new zq(e,n,t,i,r,d,s).recognize()}(e,n,t,i,d.extractedUrl,r,s).pipe(Kt(({state:p,tree:v})=>({...d,targetSnapshot:p,urlAfterRedirects:v}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),ec(L=>{s.targetSnapshot=L.targetSnapshot,s.urlAfterRedirects=L.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:L.urlAfterRedirects};const F=new oL(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects),L.targetSnapshot);this.events.next(F)}));if(M&&t.urlHandlingStrategy.shouldProcessUrl(v.currentRawUrl)){const{id:L,extractedUrl:F,source:Y,restoredState:X,extras:ye}=v,ae=new Tw(L,this.urlSerializer.serialize(F),Y,X);this.events.next(ae);const Q=cL(0,this.rootComponentType).snapshot;return this.currentTransition=s={...v,targetSnapshot:Q,urlAfterRedirects:F,extras:{...ye,skipLocationChange:!1,replaceUrl:!1}},Ln(s)}{const L="";return this.events.next(new Q_(v.id,this.urlSerializer.serialize(v.extractedUrl),L,1)),v.resolve(null),Cr}}),ec(v=>{const x=new NH(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(x)}),Kt(v=>(this.currentTransition=s={...v,guards:aq(v.targetSnapshot,v.currentSnapshot,this.rootContexts)},s)),function yq(e,n){return _i(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:d}}=t;return 0===d.length&&0===s.length?Ln({...t,guardsResult:!0}):function vq(e,n,t,i){return Ws(e).pipe(_i(r=>function Sq(e,n,t,i,r){const s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return s&&0!==s.length?Ln(s.map(p=>{const v=K0(n)??r,x=ty(p,v);return em(function mq(e){return e&&ex(e.canDeactivate)}(x)?x.canDeactivate(e,n,t,i):v.runInContext(()=>x(e,n,t,i))).pipe(Qp())})).pipe(ny()):Ln(!0)}(r.component,r.route,t,n,i)),Qp(r=>!0!==r,!0))}(d,i,r,e).pipe(_i(p=>p&&function dq(e){return"boolean"==typeof e}(p)?function xq(e,n,t,i){return Ws(n).pipe(Z_(r=>xw(function wq(e,n){return null!==e&&n&&n(new jH(e)),Ln(!0)}(r.route.parent,i),function bq(e,n){return null!==e&&n&&n(new $H(e)),Ln(!0)}(r.route,i),function Cq(e,n,t){const i=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(d=>function lq(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(d)).filter(d=>null!==d).map(d=>bw(()=>Ln(d.guards.map(v=>{const x=K0(d.node)??t,M=ty(v,x);return em(function pq(e){return e&&ex(e.canActivateChild)}(M)?M.canActivateChild(i,e):x.runInContext(()=>M(i,e))).pipe(Qp())})).pipe(ny())));return Ln(s).pipe(ny())}(e,r.path,t),function Eq(e,n,t){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return Ln(!0);const r=i.map(s=>bw(()=>{const d=K0(n)??t,p=ty(s,d);return em(function fq(e){return e&&ex(e.canActivate)}(p)?p.canActivate(n,e):d.runInContext(()=>p(n,e))).pipe(Qp())}));return Ln(r).pipe(ny())}(e,r.route,t))),Qp(r=>!0!==r,!0))}(i,s,e,n):Ln(p)),Kt(p=>({...t,guardsResult:p})))})}(this.environmentInjector,v=>this.events.next(v)),ec(v=>{if(s.guardsResult=v.guardsResult,fg(v.guardsResult))throw pL(0,v.guardsResult);const x=new FH(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot,!!v.guardsResult);this.events.next(x)}),Rc(v=>!!v.guardsResult||(this.cancelNavigationTransition(v,"",3),!1)),FI(v=>{if(v.guards.canActivateChecks.length)return Ln(v).pipe(ec(x=>{const M=new BH(x.id,this.urlSerializer.serialize(x.extractedUrl),this.urlSerializer.serialize(x.urlAfterRedirects),x.targetSnapshot);this.events.next(M)}),gi(x=>{let M=!1;return Ln(x).pipe(function Gq(e,n){return _i(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Ln(t);let s=0;return Ws(r).pipe(Z_(d=>function $q(e,n,t,i){const r=e.routeConfig,s=e._resolve;return void 0!==r?.title&&!IL(r)&&(s[U0]=r.title),function Hq(e,n,t,i){const r=function qq(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===r.length)return Ln({});const s={};return Ws(r).pipe(_i(d=>function Wq(e,n,t,i){const r=K0(n)??i,s=ty(e,r);return em(s.resolve?s.resolve(n,t):r.runInContext(()=>s(n,t)))}(e[d],n,t,i).pipe(Qp(),ec(p=>{s[d]=p}))),xI(1),zk(s),Kf(d=>vL(d)?Cr:W_(d)))}(s,e,n,i).pipe(Kt(d=>(e._resolvedData=d,e.data=uL(e,t).resolve,r&&IL(r)&&(e.data[U0]=r.title),null)))}(d.route,i,e,n)),ec(()=>s++),xI(1),_i(d=>s===r.length?Ln(t):Cr))})}(t.paramsInheritanceStrategy,this.environmentInjector),ec({next:()=>M=!0,complete:()=>{M||this.cancelNavigationTransition(x,"",2)}}))}),ec(x=>{const M=new zH(x.id,this.urlSerializer.serialize(x.extractedUrl),this.urlSerializer.serialize(x.urlAfterRedirects),x.targetSnapshot);this.events.next(M)}))}),FI(v=>{const x=M=>{const R=[];M.routeConfig?.loadComponent&&!M.routeConfig._loadedComponent&&R.push(this.configLoader.loadComponent(M.routeConfig).pipe(ec(L=>{M.component=L}),Kt(()=>{})));for(const L of M.children)R.push(...x(L));return R};return vw(x(v.targetSnapshot.root)).pipe(ww(),$u(1))}),FI(()=>this.afterPreactivation()),Kt(v=>{const x=function YH(e,n,t){const i=Y0(e,n._root,t?t._root:void 0);return new lL(i,n)}(t.routeReuseStrategy,v.targetSnapshot,v.currentRouterState);return this.currentTransition=s={...v,targetRouterState:x},s}),ec(()=>{this.events.next(new MI)}),((e,n,t,i)=>Kt(r=>(new sq(n,r.targetRouterState,r.currentRouterState,t,i).activate(e),r)))(this.rootContexts,t.routeReuseStrategy,v=>this.events.next(v),this.inputBindingEnabled),$u(1),ec({next:v=>{d=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new tm(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects))),t.titleStrategy?.updateTitle(v.targetRouterState.snapshot),v.resolve(!0)},complete:()=>{d=!0}}),Jp(this.transitionAbortSubject.pipe(ec(v=>{throw v}))),X_(()=>{d||p||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Kf(v=>{if(p=!0,gL(v))this.events.next(new Z0(s.id,this.urlSerializer.serialize(s.extractedUrl),v.message,v.cancellationCode)),function JH(e){return gL(e)&&fg(e.url)}(v)?this.events.next(new II(v.url)):s.resolve(!1);else{this.events.next(new Aw(s.id,this.urlSerializer.serialize(s.extractedUrl),v,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(v))}catch(x){s.reject(x)}}return Cr}))}))}cancelNavigationTransition(t,i,r){const s=new Z0(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function TL(e){return e!==W0}let AL=(()=>{class e{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Pr);return i}getResolvedTitleForRoute(t){return t.data[U0]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return Rn(Yq)},providedIn:"root"})}return e})(),Yq=(()=>{class e extends AL{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(DO))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Kq=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return Rn(Jq)},providedIn:"root"})}return e})();class Qq{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let Jq=(()=>{class e extends Qq{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=gl(e)))(r||e)}}();static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const zw=new Pn("",{providedIn:"root",factory:()=>({})});let e9=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:function(){return Rn(t9)},providedIn:"root"})}return e})(),t9=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var tx=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(tx||{});function PL(e,n){e.events.pipe(Rc(t=>t instanceof tm||t instanceof Z0||t instanceof Aw||t instanceof Q_),Kt(t=>t instanceof tm||t instanceof Q_?tx.COMPLETE:t instanceof Z0&&(0===t.code||1===t.code)?tx.REDIRECTING:tx.FAILED),Rc(t=>t!==tx.REDIRECTING),$u(1)).subscribe(()=>{n()})}function n9(e){throw e}function i9(e,n,t){return n.parse("/")}const r9={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},o9={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let bu=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Rn(sR),this.isNgZoneEnabled=!1,this._events=new Ct,this.options=Rn(zw,{optional:!0})||{},this.pendingTasks=Rn(j1),this.errorHandler=this.options.errorHandler||n9,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||i9,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Rn(e9),this.routeReuseStrategy=Rn(Kq),this.titleStrategy=Rn(AL),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Rn(ry,{optional:!0})?.flat()??[],this.navigationTransitions=Rn(Bw),this.urlSerializer=Rn(G0),this.location=Rn(S0),this.componentInputBindingEnabled=!!Rn(Ow,{optional:!0}),this.eventsSubscription=new xe,this.isNgZoneEnabled=Rn(_)instanceof _&&_.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new K_,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=cL(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(RL(i)&&this._events.next(i));if(i instanceof Tw)TL(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof Q_)this.rawUrlTree=r.rawUrl;else if(i instanceof oL){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(s,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof MI)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof Z0)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof II){const s=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||TL(r.source)};this.scheduleNavigation(s,W0,null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof Aw&&this.restoreHistory(r,!0),i instanceof tm&&(this.navigated=!0),RL(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),W0,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},d=r?.navigationId?r:null;if(r){const v={...r};delete v.navigationId,delete v.\u0275routerPageId,0!==Object.keys(v).length&&(s.state=v)}const p=this.parseUrl(t);this.scheduleNavigation(p,i,d,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(kI),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:d,queryParamsHandling:p,preserveFragment:v}=i,x=v?this.currentUrlTree.fragment:d;let R,M=null;switch(p){case"merge":M={...this.currentUrlTree.queryParams,...s};break;case"preserve":M=this.currentUrlTree.queryParams;break;default:M=s||null}null!==M&&(M=this.removeEmptyProps(M));try{R=Qk(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),R=this.currentUrlTree.root}return Jk(R,t,M,x??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=fg(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,W0,null,i)}navigate(t,i={skipLocationChange:!1}){return function s9(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new Ot(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...r9}:!1===i?{...o9}:i,fg(t))return Gk(this.currentUrlTree,t,r);const s=this.parseUrl(t);return Gk(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,d){if(this.disposed)return Promise.resolve(!1);let p,v,x;d?(p=d.resolve,v=d.reject,x=d.promise):x=new Promise((R,L)=>{p=R,v=L});const M=this.pendingTasks.add();return PL(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(M))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:p,reject:v,promise:x,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),x.catch(R=>Promise.reject(R))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const d={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",d)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function RL(e){return!(e instanceof MI||e instanceof II)}let nx=(()=>{class e{constructor(t,i,r,s,d,p){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=d,this.locationStrategy=p,this.href=null,this.commands=null,this.onChanges=new Ct,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const v=d.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===v||"area"===v,this.isAnchorElement?this.subscription=t.events.subscribe(x=>{x instanceof tm&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,d){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||r||s||d||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function e1(e,n,t){return function l_(e,n){return"src"===n&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===n&&("base"===e||"link"===e)?Av:Vu}(n,t)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(bu),Et(ey),Cf("tabindex"),Et(Hc),Et(Ks),Et(lg))};static#t=this.\u0275dir=vn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&vo("click",function(d){return r.onClick(d.button,d.ctrlKey,d.shiftKey,d.altKey,d.metaKey)}),2&i&&$a("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",j_],skipLocationChange:["skipLocationChange","skipLocationChange",j_],replaceUrl:["replaceUrl","replaceUrl",j_],routerLink:"routerLink"},standalone:!0,features:[OA,ii]})}return e})(),OL=(()=>{class e{get isActive(){return this._isActive}constructor(t,i,r,s,d){this.router=t,this.element=i,this.renderer=r,this.cdr=s,this.link=d,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new a,this.routerEventsSubscription=t.events.subscribe(p=>{p instanceof tm&&this.update()})}ngAfterContentInit(){Ln(this.links.changes,Ln(null)).pipe(kc()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=Ws(t).pipe(kc()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){const i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const t=this.hasActiveLinks();this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(t))})}isLinkActive(t){const i=function a9(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&t.isActive(r.urlTree,i)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Et(bu),Et(Ks),Et(Hc),Et(sg),Et(nx,8))};static#t=this.\u0275dir=vn({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,s){if(1&i&&JS(s,nx,5),2&i){let d;Kh(d=Qh())&&(r.links=d)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[ii]})}return e})();class kL{}let l9=(()=>{class e{preload(t,i){return i().pipe(Kf(()=>Ln(null)))}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),c9=(()=>{class e{constructor(t,i,r,s,d){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=d}setUpPreloading(){this.subscription=this.router.events.pipe(Rc(t=>t instanceof tm),Z_(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=$S(s.providers,t,`Route: ${s.path}`));const d=s._injector??t,p=s._loadedInjector??d;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(d,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(p,s.children??s._loadedRoutes))}return Ws(r).pipe(kc())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Ln(null);const s=r.pipe(_i(d=>null===d?Ln(void 0):(i._loadedRoutes=d.routes,i._loadedInjector=d.injector,this.processRoutes(d.injector??t,d.routes))));return i.loadComponent&&!i._loadedComponent?Ws([s,this.loader.loadComponent(i)]).pipe(kc()):s})}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(bu),Dt(aR),Dt(Kl),Dt(kL),Dt(BI))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const zI=new Pn("");let LL=(()=>{class e{constructor(t,i,r,s,d={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=d,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},d.scrollPositionRestoration=d.scrollPositionRestoration||"disabled",d.anchorScrolling=d.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Tw?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof tm?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Q_&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof sL&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new sL(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){Mo()};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();function Jf(e,n){return{\u0275kind:e,\u0275providers:n}}function FL(){const e=Rn(Qs);return n=>{const t=e.get(qp);if(n!==t.components[0])return;const i=e.get(bu),r=e.get(BL);1===e.get(VI)&&i.initialNavigation(),e.get(zL,null,si.Optional)?.setUpPreloading(),e.get(zI,null,si.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const BL=new Pn("",{factory:()=>new Ct}),VI=new Pn("",{providedIn:"root",factory:()=>1}),zL=new Pn("");function f9(e){return Jf(0,[{provide:zL,useExisting:c9},{provide:kL,useExisting:e}])}const VL=new Pn("ROUTER_FORROOT_GUARD"),m9=[S0,{provide:G0,useClass:bI},bu,X0,{provide:ey,useFactory:function NL(e){return e.routerState.root},deps:[bu]},BI,[]];function g9(){return new pR("Router",bu)}let UL=(()=>{class e{constructor(t){}static forRoot(t,i){return{ngModule:e,providers:[m9,[],{provide:ry,multi:!0,useValue:t},{provide:VL,useFactory:x9,deps:[[bu,new If,new bp]]},{provide:zw,useValue:i||{}},i?.useHash?{provide:lg,useClass:k6}:{provide:lg,useClass:$R},{provide:zI,useFactory:()=>{const e=Rn(J8),n=Rn(_),t=Rn(zw),i=Rn(Bw),r=Rn(G0);return t.scrollOffset&&e.setOffset(t.scrollOffset),new LL(r,i,e,n,t)}},i?.preloadingStrategy?f9(i.preloadingStrategy).\u0275providers:[],{provide:pR,multi:!0,useFactory:g9},i?.initialNavigation?b9(i):[],i?.bindToComponentInputs?Jf(8,[fL,{provide:Ow,useExisting:fL}]).\u0275providers:[],[{provide:jL,useFactory:FL},{provide:fM,multi:!0,useExisting:jL}]]}}static forChild(t){return{ngModule:e,providers:[{provide:ry,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(VL,8))};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})();function x9(e){return"guarded"}function b9(e){return["disabled"===e.initialNavigation?Jf(3,[{provide:oM,multi:!0,useFactory:()=>{const n=Rn(bu);return()=>{n.setUpLocationChangeListener()}}},{provide:VI,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Jf(2,[{provide:VI,useValue:0},{provide:oM,multi:!0,deps:[Qs],useFactory:n=>{const t=n.get(R6,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=n.get(bu),s=n.get(BL);PL(r,()=>{i(!0)}),n.get(Bw).afterPreactivation=()=>(i(!0),s.closed?Ln(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const jL=new Pn("");let UI,E9=(()=>{class e{constructor(){this.title="helpHunter-ui"}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&Oi(0,"router-outlet")},dependencies:[Rw]})}return e})();try{UI=typeof Intl<"u"&&Intl.v8BreakIterator}catch{UI=!1}let ix,pg,jI,wu=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function Q8(e){return e===lO}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!UI)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||e)(Dt($h))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function rx(e){return function C9(){if(null==ix&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ix=!0}))}finally{ix=ix||!1}return ix}()?e:!!e.capture}function S9(){if(null==pg){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return pg=!1,pg;if("scrollBehavior"in document.documentElement.style)pg=!0;else{const e=Element.prototype.scrollTo;pg=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return pg}function GI(){let e=typeof document<"u"&&document?document.activeElement:null;for(;e&&e.shadowRoot;){const n=e.shadowRoot.activeElement;if(n===e)break;e=n}return e}function nm(e){return e.composedPath?e.composedPath()[0]:e.target}function $I(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function HL(e,...n){return n.length?n.some(t=>e[t]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function qL(e){return Rc((n,t)=>e<=t)}function rf(e){return null!=e&&"false"!=`${e}`}function WL(e,n=0){return function O9(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):n}function Uw(e){return Array.isArray(e)?e:[e]}function kl(e){return null==e?"":"string"==typeof e?e:`${e}px`}function sy(e){return e instanceof Ks?e.nativeElement:e}let k9=(()=>{class e{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ZL=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:[k9]})}return e})();class L9 extends xe{constructor(n,t){super()}schedule(n,t=0){return this}}const jw={setInterval(e,n,...t){const{delegate:i}=jw;return i?.setInterval?i.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=jw;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};class HI extends L9{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(n,t,i=0){return jw.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&jw.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r,i=!1;try{this.work(n)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,m(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}const XL={now:()=>(XL.delegate||Date).now(),delegate:void 0};class ox{constructor(n,t=ox.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}ox.now=XL.now;class qI extends ox{constructor(n,t=ox.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}const WI=new qI(HI),N9=WI,YL=new Set;let mg,B9=(()=>{class e{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):V9}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function z9(e,n){if(!YL.has(e))try{mg||(mg=document.createElement("style"),n&&(mg.nonce=n),mg.setAttribute("type","text/css"),document.head.appendChild(mg)),mg.sheet&&(mg.sheet.insertRule(`@media ${e} {body{ }}`,0),YL.add(e))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(wu),Dt(Lv,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function V9(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let Gw=(()=>{class e{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new Ct}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return KL(Uw(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=vw(KL(Uw(t)).map(d=>this._registerQuery(d).observable));return s=xw(s.pipe($u(1)),s.pipe(qL(1),function F9(e,n=WI){return Bn((t,i)=>{let r=null,s=null,d=null;const p=()=>{if(r){r.unsubscribe(),r=null;const x=s;s=null,i.next(x)}};function v(){const x=d+e,M=n.now();if(M<x)return r=this.schedule(void 0,x-M),void i.add(r);p()}t.subscribe(zn(i,x=>{s=x,d=n.now(),r||(r=n.schedule(v,e),i.add(r))},()=>{p(),i.complete()},void 0,()=>{s=r=null}))})}(0))),s.pipe(Kt(d=>{const p={matches:!1,breakpoints:{}};return d.forEach(({matches:v,query:x})=>{p.matches=p.matches||v,p.breakpoints[x]=v}),p}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Re(d=>{const p=v=>this._zone.run(()=>d.next(v));return i.addListener(p),()=>{i.removeListener(p)}}).pipe(V0(i),Kt(({matches:d})=>({query:t,matches:d})),Jp(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(B9),Dt(_))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function KL(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}let $w=(()=>{class e{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function H9(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function $9(e){try{return e.frameElement}catch{return null}}(function J9(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}(t));if(i&&(-1===tN(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=tN(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function K9(e){let n=e.nodeName.toLowerCase(),t="input"===n&&e.type;return"text"===t||"password"===t||"select"===n||"textarea"===n}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function Q9(e){return!function W9(e){return function X9(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function q9(e){let n=e.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(e)||function Z9(e){return function Y9(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||eN(e))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(wu))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function eN(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;let n=e.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function tN(e){if(!eN(e))return null;const n=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class e7{get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}constructor(n,t,i,r,s=!1){this._element=n,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}destroy(){const n=this._startAnchor,t=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){const t=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);return"start"==n?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(n),!!i}return t.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const t=this._getRegionBoundary("start");return t&&t.focus(n),!!t}focusLastTabbableElement(n){const t=this._getRegionBoundary("end");return t&&t.focus(n),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const t=n.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const t=n.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,t){n?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._ngZone.isStable?n():this._ngZone.onStable.pipe($u(1)).subscribe(n)}}let ZI=(()=>{class e{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new e7(t,this._checker,this._ngZone,this._document,i)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt($w),Dt(_),Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function nN(e){return 0===e.buttons||0===e.offsetX&&0===e.offsetY}function iN(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const t7=new Pn("cdk-input-modality-detector-options"),n7={ignoreKeys:[18,17,224,91,16]},ay=rx({passive:!0,capture:!0});let i7=(()=>{class e{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new tn(null),this._lastTouchMs=0,this._onKeydown=d=>{this._options?.ignoreKeys?.some(p=>p===d.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=nm(d))},this._onMousedown=d=>{Date.now()-this._lastTouchMs<650||(this._modality.next(nN(d)?"keyboard":"mouse"),this._mostRecentTarget=nm(d))},this._onTouchstart=d=>{iN(d)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=nm(d))},this._options={...n7,...s},this.modalityDetected=this._modality.pipe(qL(1)),this.modalityChanged=this.modalityDetected.pipe(sr()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,ay),r.addEventListener("mousedown",this._onMousedown,ay),r.addEventListener("touchstart",this._onTouchstart,ay)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,ay),document.removeEventListener("mousedown",this._onMousedown,ay),document.removeEventListener("touchstart",this._onTouchstart,ay))}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(wu),Dt(_),Dt(Ar),Dt(t7,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const r7=new Pn("liveAnnouncerElement",{providedIn:"root",factory:function o7(){return null}}),s7=new Pn("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let a7=0,oN=(()=>{class e{constructor(t,i,r,s){this._ngZone=i,this._defaultOptions=s,this._document=r,this._liveElement=t||this._createLiveElement()}announce(t,...i){const r=this._defaultOptions;let s,d;return 1===i.length&&"number"==typeof i[0]?d=i[0]:[s,d]=i,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),null==d&&r&&(d=r.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(p=>this._currentResolve=p)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof d&&(this._previousTimeout=setTimeout(()=>this.clear(),d)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let s=0;s<i.length;s++)i[s].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+a7++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(t){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const s=i[r],d=s.getAttribute("aria-owns");d?-1===d.indexOf(t)&&s.setAttribute("aria-owns",d+" "+t):s.setAttribute("aria-owns",t)}}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(r7,8),Dt(_),Dt(Ar),Dt(s7,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const l7=new Pn("cdk-focus-monitor-default-options"),Hw=rx({passive:!0,capture:!0});let sx=(()=>{class e{constructor(t,i,r,s,d){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ct,this._rootNodeFocusAndBlurListener=p=>{for(let x=nm(p);x;x=x.parentElement)"focus"===p.type?this._onFocus(p,x):this._onBlur(p,x)},this._document=s,this._detectionMode=d?.detectionMode||0}monitor(t,i=!1){const r=sy(t);if(!this._platform.isBrowser||1!==r.nodeType)return Ln();const s=function I9(e){if(function M9(){if(null==jI){const e=typeof document<"u"?document.head:null;jI=!(!e||!e.createShadowRoot&&!e.attachShadow)}return jI}()){const n=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(r)||this._getDocument(),d=this._elementInfo.get(r);if(d)return i&&(d.checkChildren=!0),d.subject;const p={checkChildren:i,subject:new Ct,rootNode:s};return this._elementInfo.set(r,p),this._registerGlobalListeners(p),p.subject}stopMonitoring(t){const i=sy(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=sy(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([p,v])=>this._originChanged(p,i,v)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=nm(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Hw),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Hw)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Jp(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Hw),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Hw),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let d=0;d<s.length;d++)if(s[d].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_),Dt(wu),Dt(i7),Dt(Ar,8),Dt(l7,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const sN="cdk-high-contrast-black-on-white",aN="cdk-high-contrast-white-on-black",XI="cdk-high-contrast-active";let lN=(()=>{class e{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Rn(Gw).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(XI,sN,aN),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(XI,sN):2===i&&t.add(XI,aN)}}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(wu),Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),c7=(()=>{class e{constructor(t){t._applyBodyHighContrastModeCssClasses()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(lN))};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[ZL]})}return e})();const u7=new Pn("cdk-dir-doc",{providedIn:"root",factory:function d7(){return Rn(Ar)}}),h7=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let YI=(()=>{class e{constructor(t){this.value="ltr",this.change=new a,t&&(this.value=function f7(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?h7.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(u7,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ax=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})();const m7=new Pn("mat-sanity-checks",{providedIn:"root",factory:function p7(){return!0}});let yc=(()=>{class e{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!$I()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(lN),Dt(m7,8),Dt(Ar))};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[ax,ax]})}return e})();function g7(e){return class extends e{get disabled(){return this._disabled}set disabled(n){this._disabled=rf(n)}constructor(...n){super(...n),this._disabled=!1}}}function dN(e,n){return class extends e{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=n,this.color=n}}}function hN(e){return class extends e{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=rf(n)}constructor(...n){super(...n),this._disableRipple=!1}}}class y7{constructor(n,t,i,r=!1){this._renderer=n,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const fN=rx({passive:!0,capture:!0});class v7{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const t=nm(n);t&&this._events.get(n.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(n))})}}addHandler(n,t,i,r){const s=this._events.get(t);if(s){const d=s.get(i);d?d.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,fN)})}removeHandler(n,t,i){const r=this._events.get(n);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,fN)))}}const pN={enterDuration:225,exitDuration:150},mN=rx({passive:!0,capture:!0}),gN=["mousedown","touchstart"],_N=["mouseup","mouseleave","touchend","touchcancel"];class qw{static#e=this._eventManager=new v7;constructor(n,t,i,r){this._target=n,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=sy(i))}fadeInRipple(n,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...pN,...i.animation};i.centered&&(n=r.left+r.width/2,t=r.top+r.height/2);const d=i.radius||function b7(e,n,t){const i=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),r=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(i*i+r*r)}(n,t,r),p=n-r.left,v=t-r.top,x=s.enterDuration,M=document.createElement("div");M.classList.add("mat-ripple-element"),M.style.left=p-d+"px",M.style.top=v-d+"px",M.style.height=2*d+"px",M.style.width=2*d+"px",null!=i.color&&(M.style.backgroundColor=i.color),M.style.transitionDuration=`${x}ms`,this._containerElement.appendChild(M);const R=window.getComputedStyle(M),F=R.transitionDuration,Y="none"===R.transitionProperty||"0s"===F||"0s, 0s"===F||0===r.width&&0===r.height,X=new y7(this,M,i,Y);M.style.transform="scale3d(1, 1, 1)",X.state=0,i.persistent||(this._mostRecentTransientRipple=X);let ye=null;return!Y&&(x||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ae=()=>this._finishRippleTransition(X),Q=()=>this._destroyRipple(X);M.addEventListener("transitionend",ae),M.addEventListener("transitioncancel",Q),ye={onTransitionEnd:ae,onTransitionCancel:Q}}),this._activeRipples.set(X,ye),(Y||!x)&&this._finishRippleTransition(X),X}fadeOutRipple(n){if(2===n.state||3===n.state)return;const t=n.element,i={...pN,...n.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=sy(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,gN.forEach(i=>{qw._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{_N.forEach(t=>{this._triggerElement.addEventListener(t,this,mN)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:i}=n.config;n.state=1,!i&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel)),n.element.remove()}_onMousedown(n){const t=nN(n),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!iN(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(gN.forEach(t=>qw._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&_N.forEach(t=>n.removeEventListener(t,this,mN)))}}const yN=new Pn("mat-ripple-global-options");let vN=(()=>{class e{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,d){this._elementRef=t,this._animationMode=d,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new qw(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(_),Et(wu),Et(yN,8),Et(rh,8))};static#t=this.\u0275dir=vn({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&Uu("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return e})(),xN=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,yc]})}return e})();const bN={capture:!0},wN=["focus","click","mouseenter","touchstart"],KI="mat-ripple-loader-uninitialized",QI="mat-ripple-loader-class-name",EN="mat-ripple-loader-centered",Ww="mat-ripple-loader-disabled";let w7=(()=>{class e{constructor(){this._document=Rn(Ar,{optional:!0}),this._animationMode=Rn(rh,{optional:!0}),this._globalRippleOptions=Rn(yN,{optional:!0}),this._platform=Rn(wu),this._ngZone=Rn(_),this._onInteraction=t=>{if(!(t.target instanceof HTMLElement))return;const r=t.target.closest(`[${KI}]`);r&&this.createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const t of wN)this._document?.addEventListener(t,this._onInteraction,bN)})}ngOnDestroy(){for(const t of wN)this._document?.removeEventListener(t,this._onInteraction,bN)}configureRipple(t,i){t.setAttribute(KI,""),(i.className||!t.hasAttribute(QI))&&t.setAttribute(QI,i.className||""),i.centered&&t.setAttribute(EN,""),i.disabled&&t.setAttribute(Ww,"")}getRipple(t){return t.matRipple?t.matRipple:this.createRipple(t)}setDisabled(t,i){const r=t.matRipple;r?r.disabled=i:i?t.setAttribute(Ww,""):t.removeAttribute(Ww)}createRipple(t){if(!this._document)return;t.querySelector(".mat-ripple")?.remove();const i=this._document.createElement("span");i.classList.add("mat-ripple",t.getAttribute(QI)),t.append(i);const r=new vN(new Ks(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=t,r.centered=t.hasAttribute(EN),r.disabled=t.hasAttribute(Ww),this.attachRipple(t,r),r}attachRipple(t,i){t.removeAttribute(KI),t.matRipple=i}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const E7=["mat-button",""],C7=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],S7=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],I7=["mat-icon-button",""],D7=["*"],T7=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],A7=dN(g7(hN(class{constructor(e){this._elementRef=e}})));let CN=(()=>{class e extends A7{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(t){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,t)}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=rf(t),this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(t){this._disabled=rf(t),this._updateRippleDisabled()}constructor(t,i,r,s){super(t),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=Rn(sx),this._rippleLoader=Rn(w7),this._isFab=!1,this._disableRipple=!1,this._disabled=!1,this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-button-ripple"});const d=t.nativeElement.classList;for(const p of T7)this._hasHostAttributes(p.selector)&&p.mdcClasses.forEach(v=>{d.add(v)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){Mo()};static#t=this.\u0275dir=vn({type:e,features:[zr]})}return e})(),JI=(()=>{class e extends CN{constructor(t,i,r,s){super(t,i,r,s)}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(wu),Et(_),Et(rh,8))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(i,r){2&i&&($a("disabled",r.disabled||null),Uu("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[zr],attrs:E7,ngContentSelectors:S7,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(Xh(C7),Oi(0,"span",0),Kc(1),jt(2,"span",1),Kc(3,1),Yt(),Kc(4,2),Oi(5,"span",2)(6,"span",3)),2&i&&Uu("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return e})(),O7=(()=>{class e extends CN{constructor(t,i,r,s){super(t,i,r,s),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(wu),Et(_),Et(rh,8))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(i,r){2&i&&($a("disabled",r.disabled||null),Uu("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[zr],attrs:I7,ngContentSelectors:D7,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(Xh(),Oi(0,"span",0),Kc(1),Oi(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return e})(),SN=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,xN,yc]})}return e})();class MN{}class k7{}const ep="*";function eD(e,n){return{type:7,name:e,definitions:n,options:{}}}function cx(e,n=null){return{type:4,styles:n,timings:e}}function DN(e,n=null){return{type:2,steps:e,options:n}}function ph(e){return{type:6,styles:e,offset:null}}function ux(e,n,t){return{type:0,name:e,styles:n,options:t}}function dx(e,n,t=null){return{type:1,expr:e,animation:n,options:t}}class hx{constructor(n=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class PN{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let t=0,i=0,r=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(d=>{d.onDone(()=>{++t==s&&this._onFinish()}),d.onDestroy(()=>{++i==s&&this._onDestroy()}),d.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((d,p)=>Math.max(d,p.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const t=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class nD{attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class fx extends nD{constructor(n,t,i,r,s){super(),this.component=n,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class iD extends nD{constructor(n,t,i,r){super(),this.templateRef=n,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(n,t=this.context){return this.context=t,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class L7 extends nD{constructor(n){super(),this.element=n instanceof Ks?n.nativeElement:n}}class Zw{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof fx?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof iD?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof L7?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class N7 extends Zw{constructor(n,t,i,r,s){super(),this.outletElement=n,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=d=>{const p=d.element,v=this._document.createComment("dom-portal");p.parentNode.insertBefore(v,p),this.outletElement.appendChild(p),this._attachedPortal=d,super.setDisposeFn(()=>{v.parentNode&&v.parentNode.replaceChild(p,v)})},this._document=s}attachComponentPortal(n){const i=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component);let r;return n.viewContainerRef?(r=n.viewContainerRef.createComponent(i,n.viewContainerRef.length,n.injector||n.viewContainerRef.injector,n.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(n.injector||this._defaultInjector||Qs.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=n,r}attachTemplatePortal(n){let t=n.viewContainerRef,i=t.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=n,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let px=(()=>{class e extends Zw{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new a,this.attachDomPortal=s=>{const d=s.element,p=this._document.createComment("dom-portal");s.setAttachedHost(this),d.parentNode.insertBefore(p,d),this._getRootNode().appendChild(d),this._attachedPortal=s,super.setDisposeFn(()=>{p.parentNode&&p.parentNode.replaceChild(d,p)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),d=i.createComponent(s,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(d.hostView.rootNodes[0]),super.setDisposeFn(()=>d.destroy()),this._attachedPortal=t,this._attachedRef=d,this.attached.emit(d),d}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static#e=this.\u0275fac=function(i){return new(i||e)(Et(mu),Et(Od),Et(Ar))};static#t=this.\u0275dir=vn({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[zr]})}return e})(),mx=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})();const F7=["addListener","removeListener"],B7=["addEventListener","removeEventListener"],z7=["on","off"];function Xw(e,n,t,i){if(be(t)&&(i=t,t=void 0),i)return Xw(e,n,t).pipe(KM(i));const[r,s]=function j7(e){return be(e.addEventListener)&&be(e.removeEventListener)}(e)?B7.map(d=>p=>e[d](n,p,t)):function V7(e){return be(e.addListener)&&be(e.removeListener)}(e)?F7.map(RN(e,n)):function U7(e){return be(e.on)&&be(e.off)}(e)?z7.map(RN(e,n)):[];if(!r&&Ye(e))return _i(d=>Xw(d,n,t))(dr(e));if(!r)throw new TypeError("Invalid event target");return new Re(d=>{const p=(...v)=>d.next(1<v.length?v:v[0]);return r(p),()=>s(p)})}function RN(e,n){return t=>i=>e[t](n,i)}const gx={schedule(e){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=gx;i&&(n=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=n(s=>{t=void 0,e(s)});return new xe(()=>t?.(r))},requestAnimationFrame(...e){const{delegate:n}=gx;return(n?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:n}=gx;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0};new class $7 extends qI{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class G7 extends HI{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=gx.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:s}=n;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(gx.cancelAnimationFrame(t),n._scheduled=void 0)}});let rD,q7=1;const Yw={};function ON(e){return e in Yw&&(delete Yw[e],!0)}const W7={setImmediate(e){const n=q7++;return Yw[n]=!0,rD||(rD=Promise.resolve()),rD.then(()=>ON(n)&&e()),n},clearImmediate(e){ON(e)}},{setImmediate:Z7,clearImmediate:X7}=W7,Kw={setImmediate(...e){const{delegate:n}=Kw;return(n?.setImmediate||Z7)(...e)},clearImmediate(e){const{delegate:n}=Kw;return(n?.clearImmediate||X7)(e)},delegate:void 0};new class K7 extends qI{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class Y7 extends HI{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=Kw.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:s}=n;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(Kw.clearImmediate(t),n._scheduled===t&&(n._scheduled=void 0))}});function kN(e,n=WI){return function J7(e){return Bn((n,t)=>{let i=!1,r=null,s=null,d=!1;const p=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const x=r;r=null,t.next(x)}d&&t.complete()},v=()=>{s=null,d&&t.complete()};n.subscribe(zn(t,x=>{i=!0,r=x,s||dr(e(x)).subscribe(s=zn(t,p,v))},()=>{d=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function tW(e=0,n,t=N9){let i=-1;return null!=n&&(is(n)?t=n:i=n),new Re(r=>{let s=function eW(e){return e instanceof Date&&!isNaN(e)}(e)?+e-t.now():e;s<0&&(s=0);let d=0;return t.schedule(function(){r.closed||(r.next(d++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(e,n))}let iW=(()=>{class e{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new Ct,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Re(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(kN(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ln()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Rc(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=sy(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Xw(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_),Dt(wu),Dt(Ar,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),LN=(()=>{class e{constructor(t,i,r){this._platform=t,this._change=new Ct,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(kN(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(wu),Dt(_),Dt(Ar,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),NN=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})(),FN=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[ax,NN,ax,NN]})}return e})();const BN=S9();class oW{constructor(n,t){this._viewportRuler=n,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=kl(-this._previousScrollPosition.left),n.style.top=kl(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,i=n.style,r=this._document.body.style,s=i.scrollBehavior||"",d=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),BN&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),BN&&(i.scrollBehavior=s,r.scrollBehavior=d)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class sW{constructor(n,t,i,r){this._scrollDispatcher=n,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(Rc(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class zN{enable(){}disable(){}attach(){}}function oD(e,n){return n.some(t=>e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right)}function VN(e,n){return n.some(t=>e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}class aW{constructor(n,t,i,r){this._scrollDispatcher=n,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();oD(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let lW=(()=>{class e{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new zN,this.close=d=>new sW(this._scrollDispatcher,this._ngZone,this._viewportRuler,d),this.block=()=>new oW(this._viewportRuler,this._document),this.reposition=d=>new aW(this._scrollDispatcher,this._viewportRuler,this._ngZone,d),this._document=s}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(iW),Dt(LN),Dt(_),Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class sD{constructor(n){if(this.scrollStrategy=new zN,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,n){const t=Object.keys(n);for(const i of t)void 0!==n[i]&&(this[i]=n[i])}}}class cW{constructor(n,t){this.connectionPair=n,this.scrollableViewProperties=t}}let UN=(()=>{class e{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),uW=(()=>{class e extends UN{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let d=s.length-1;d>-1;d--)if(s[d]._keydownEvents.observers.length>0){const p=s[d]._keydownEvents;this._ngZone?this._ngZone.run(()=>p.next(r)):p.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar),Dt(_,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),dW=(()=>{class e extends UN{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=nm(s)},this._clickListener=s=>{const d=nm(s),p="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:d;this._pointerDownEventTarget=null;const v=this._attachedOverlays.slice();for(let x=v.length-1;x>-1;x--){const M=v[x];if(M._outsidePointerEvents.observers.length<1||!M.hasAttached())continue;if(M.overlayElement.contains(d)||M.overlayElement.contains(p))break;const R=M._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>R.next(s)):R.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar),Dt(wu),Dt(_,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Qw=(()=>{class e{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||$I()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),$I()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar),Dt(wu))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class _x{constructor(n,t,i,r,s,d,p,v,x,M=!1){this._portalOutlet=n,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=d,this._document=p,this._location=v,this._outsideClickDispatcher=x,this._animationsDisabled=M,this._backdropElement=null,this._backdropClick=new Ct,this._attachments=new Ct,this._detachments=new Ct,this._locationChanges=xe.EMPTY,this._backdropClickHandler=R=>this._backdropClick.next(R),this._backdropTransitionendHandler=R=>{this._disposeBackdrop(R.target)},this._keydownEvents=new Ct,this._outsidePointerEvents=new Ct,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(n){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(n);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe($u(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,n&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=kl(this._config.width),n.height=kl(this._config.height),n.minWidth=kl(this._config.minWidth),n.minHeight=kl(this._config.minHeight),n.maxWidth=kl(this._config.maxWidth),n.maxHeight=kl(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(n)})}):this._backdropElement.classList.add(n)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const n=this._backdropElement;if(n){if(this._animationsDisabled)return void this._disposeBackdrop(n);n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{n.addEventListener("transitionend",this._backdropTransitionendHandler)}),n.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(n)},500))}}_toggleClasses(n,t,i){const r=Uw(t||[]).filter(s=>!!s);r.length&&(i?n.classList.add(...r):n.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const n=this._ngZone.onStable.pipe(Jp(eu(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),n.unsubscribe())})})}_disposeScrollStrategy(){const n=this._scrollStrategy;n&&(n.disable(),n.detach&&n.detach())}_disposeBackdrop(n){n&&(n.removeEventListener("click",this._backdropClickHandler),n.removeEventListener("transitionend",this._backdropTransitionendHandler),n.remove(),this._backdropElement===n&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const jN="cdk-overlay-connected-position-bounding-box",hW=/([A-Za-z%]+)$/;class fW{get positions(){return this._preferredPositions}constructor(n,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Ct,this._resizeSubscription=xe.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(jN),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let d;for(let p of this._preferredPositions){let v=this._getOriginPoint(n,r,p),x=this._getOverlayPoint(v,t,p),M=this._getOverlayFit(x,t,i,p);if(M.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(p,v);this._canFitWithFlexibleDimensions(M,x,i)?s.push({position:p,origin:v,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(v,p)}):(!d||d.overlayFit.visibleArea<M.visibleArea)&&(d={overlayFit:M,overlayPoint:x,originPoint:v,position:p,overlayRect:t})}if(s.length){let p=null,v=-1;for(const x of s){const M=x.boundingBoxRect.width*x.boundingBoxRect.height*(x.position.weight||1);M>v&&(v=M,p=x)}return this._isPushed=!1,void this._applyPosition(p.position,p.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(d.position,d.originPoint);this._applyPosition(d.position,d.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&gg(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(jN),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;if(n){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,n);this._applyPosition(n,t)}else this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}_getOriginPoint(n,t,i){let r,s;if("center"==i.originX)r=n.left+n.width/2;else{const d=this._isRtl()?n.right:n.left,p=this._isRtl()?n.left:n.right;r="start"==i.originX?d:p}return t.left<0&&(r-=t.left),s="center"==i.originY?n.top+n.height/2:"top"==i.originY?n.top:n.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(n,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:n.x+r,y:n.y+s}}_getOverlayFit(n,t,i,r){const s=$N(t);let{x:d,y:p}=n,v=this._getOffset(r,"x"),x=this._getOffset(r,"y");v&&(d+=v),x&&(p+=x);let L=0-p,F=p+s.height-i.height,Y=this._subtractOverflows(s.width,0-d,d+s.width-i.width),X=this._subtractOverflows(s.height,L,F),ye=Y*X;return{visibleArea:ye,isCompletelyWithinViewport:s.width*s.height===ye,fitsInViewportVertically:X===s.height,fitsInViewportHorizontally:Y==s.width}}_canFitWithFlexibleDimensions(n,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,d=GN(this._overlayRef.getConfig().minHeight),p=GN(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=d&&d<=r)&&(n.fitsInViewportHorizontally||null!=p&&p<=s)}return!1}_pushOverlayOnScreen(n,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const r=$N(t),s=this._viewportRect,d=Math.max(n.x+r.width-s.width,0),p=Math.max(n.y+r.height-s.height,0),v=Math.max(s.top-i.top-n.y,0),x=Math.max(s.left-i.left-n.x,0);let M=0,R=0;return M=r.width<=s.width?x||-d:n.x<this._viewportMargin?s.left-i.left-n.x:0,R=r.height<=s.height?v||-p:n.y<this._viewportMargin?s.top-i.top-n.y:0,this._previousPushAmount={x:M,y:R},{x:n.x+M,y:n.y+R}}_applyPosition(n,t){if(this._setTransformOrigin(n),this._setOverlayElementStyles(t,n),this._setBoundingBoxStyles(t,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._lastPosition=n,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new cW(n,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=n.overlayY;i="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(n,t){const i=this._viewportRect,r=this._isRtl();let s,d,p,M,R,L;if("top"===t.overlayY)d=n.y,s=i.height-d+this._viewportMargin;else if("bottom"===t.overlayY)p=i.height-n.y+2*this._viewportMargin,s=i.height-p+this._viewportMargin;else{const F=Math.min(i.bottom-n.y+i.top,n.y),Y=this._lastBoundingBoxSize.height;s=2*F,d=n.y-F,s>Y&&!this._isInitialRender&&!this._growAfterOpen&&(d=n.y-Y/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)L=i.width-n.x+this._viewportMargin,M=n.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)R=n.x,M=i.right-n.x;else{const F=Math.min(i.right-n.x+i.left,n.x),Y=this._lastBoundingBoxSize.width;M=2*F,R=n.x-F,M>Y&&!this._isInitialRender&&!this._growAfterOpen&&(R=n.x-Y/2)}return{top:d,left:R,bottom:p,right:L,width:M,height:s}}_setBoundingBoxStyles(n,t){const i=this._calculateBoundingBoxRect(n,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,d=this._overlayRef.getConfig().maxWidth;r.height=kl(i.height),r.top=kl(i.top),r.bottom=kl(i.bottom),r.width=kl(i.width),r.left=kl(i.left),r.right=kl(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=kl(s)),d&&(r.maxWidth=kl(d))}this._lastBoundingBoxSize=i,gg(this._boundingBox.style,r)}_resetBoundingBoxStyles(){gg(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){gg(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,d=this._overlayRef.getConfig();if(r){const M=this._viewportRuler.getViewportScrollPosition();gg(i,this._getExactOverlayY(t,n,M)),gg(i,this._getExactOverlayX(t,n,M))}else i.position="static";let p="",v=this._getOffset(t,"x"),x=this._getOffset(t,"y");v&&(p+=`translateX(${v}px) `),x&&(p+=`translateY(${x}px)`),i.transform=p.trim(),d.maxHeight&&(r?i.maxHeight=kl(d.maxHeight):s&&(i.maxHeight="")),d.maxWidth&&(r?i.maxWidth=kl(d.maxWidth):s&&(i.maxWidth="")),gg(this._pane.style,i)}_getExactOverlayY(n,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===n.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=kl(s.y),r}_getExactOverlayX(n,t,i){let d,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),d=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===d?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=kl(s.x),r}_getScrollVisibility(){const n=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:VN(n,i),isOriginOutsideView:oD(n,i),isOverlayClipped:VN(t,i),isOverlayOutsideView:oD(t,i)}}_subtractOverflows(n,...t){return t.reduce((i,r)=>i-Math.max(r,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+n-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:n-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,t){return"x"===t?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&Uw(n).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getOriginRect(){const n=this._origin;if(n instanceof Ks)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const t=n.width||0,i=n.height||0;return{top:n.y,bottom:n.y+i,left:n.x,right:n.x+t,height:i,width:t}}}function gg(e,n){for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function GN(e){if("number"!=typeof e&&null!=e){const[n,t]=e.split(hW);return t&&"px"!==t?null:parseFloat(n)}return e||null}function $N(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const HN="cdk-global-overlay-wrapper";class pW{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(n){const t=n.getConfig();this._overlayRef=n,this._width&&!t.width&&n.updateSize({width:this._width}),this._height&&!t.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(HN),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:d,maxHeight:p}=i,v=!("100%"!==r&&"100vw"!==r||d&&"100%"!==d&&"100vw"!==d),x=!("100%"!==s&&"100vh"!==s||p&&"100%"!==p&&"100vh"!==p),M=this._xPosition,R=this._xOffset,L="rtl"===this._overlayRef.getConfig().direction;let F="",Y="",X="";v?X="flex-start":"center"===M?(X="center",L?Y=R:F=R):L?"left"===M||"end"===M?(X="flex-end",F=R):("right"===M||"start"===M)&&(X="flex-start",Y=R):"left"===M||"start"===M?(X="flex-start",F=R):("right"===M||"end"===M)&&(X="flex-end",Y=R),n.position=this._cssPosition,n.marginLeft=v?"0":F,n.marginTop=x?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=v?"0":Y,t.justifyContent=X,t.alignItems=x?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(HN),i.justifyContent=i.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let mW=(()=>{class e{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new pW}flexibleConnectedTo(t){return new fW(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(LN),Dt(Ar),Dt(wu),Dt(Qw))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),gW=0,im=(()=>{class e{constructor(t,i,r,s,d,p,v,x,M,R,L,F){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=d,this._injector=p,this._ngZone=v,this._document=x,this._directionality=M,this._location=R,this._outsideClickDispatcher=L,this._animationsModuleType=F}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),d=new sD(t);return d.direction=d.direction||this._directionality.value,new _x(s,i,r,d,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+gW++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(qp)),new N7(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(lW),Dt(Qw),Dt(mu),Dt(mW),Dt(uW),Dt(Qs),Dt(_),Dt(Ar),Dt(YI),Dt(S0),Dt(dW),Dt(rh,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const vW={provide:new Pn("cdk-connected-overlay-scroll-strategy"),deps:[im],useFactory:function yW(e){return()=>e.scrollStrategies.reposition()}};let aD=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:[im,vW],imports:[ax,mx,FN,FN]})}return e})();function xW(e,n){if(1&e){const t=$f();jt(0,"div",2)(1,"button",3),vo("click",function(){return Fc(t),Wl(xs().action())}),An(2),Yt()()}if(2&e){const t=xs();Gn(2),qf(" ",t.data.action," ")}}const bW=["label"];function wW(e,n){}const EW=Math.pow(2,31)-1;class lD{constructor(n,t){this._overlayRef=t,this._afterDismissed=new Ct,this._afterOpened=new Ct,this._onAction=new Ct,this._dismissedByAction=!1,this.containerInstance=n,n._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(n){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(n,EW))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const qN=new Pn("MatSnackBarData");class Jw{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let CW=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=vn({type:e,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return e})(),SW=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=vn({type:e,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return e})(),MW=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=vn({type:e,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return e})(),IW=(()=>{class e{constructor(t,i){this.snackBarRef=t,this.data=i}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static#e=this.\u0275fac=function(i){return new(i||e)(Et(lD),Et(qN))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions","",4,"ngIf"],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(i,r){1&i&&(jt(0,"div",0),An(1),Yt(),Oo(2,xW,3,1,"div",1)),2&i&&(Gn(1),qf(" ",r.data.message,"\n"),Gn(1),Di("ngIf",r.hasAction))},dependencies:[$_,JI,CW,SW,MW],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}return e})();const DW={snackBarState:eD("state",[ux("void, hidden",ph({transform:"scale(0.8)",opacity:0})),ux("visible",ph({transform:"scale(1)",opacity:1})),dx("* => visible",cx("150ms cubic-bezier(0, 0, 0.2, 1)")),dx("* => void, * => hidden",cx("75ms cubic-bezier(0.4, 0.0, 1, 1)",ph({opacity:0})))])};let TW=0,AW=(()=>{class e extends Zw{constructor(t,i,r,s,d){super(),this._ngZone=t,this._elementRef=i,this._changeDetectorRef=r,this._platform=s,this.snackBarConfig=d,this._document=Rn(Ar),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new Ct,this._onExit=new Ct,this._onEnter=new Ct,this._animationState="void",this._liveElementId="mat-snack-bar-container-live-"+TW++,this.attachDomPortal=p=>{this._assertNotAttached();const v=this._portalOutlet.attachDomPortal(p);return this._afterPortalAttached(),v},this._live="assertive"!==d.politeness||d.announcementMessage?"off"===d.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(t){this._assertNotAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._afterPortalAttached(),i}attachTemplatePortal(t){this._assertNotAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._afterPortalAttached(),i}onAnimationEnd(t){const{fromState:i,toState:r}=t;if(("void"===r&&"void"!==i||"hidden"===r)&&this._completeExit(),"visible"===r){const s=this._onEnter;this._ngZone.run(()=>{s.next(),s.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe($u(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const t=this._elementRef.nativeElement,i=this.snackBarConfig.panelClass;i&&(Array.isArray(i)?i.forEach(r=>t.classList.add(r)):t.classList.add(i)),this._exposeToModals()}_exposeToModals(){const t=this._liveElementId,i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const s=i[r],d=s.getAttribute("aria-owns");this._trackedModals.add(s),d?-1===d.indexOf(t)&&s.setAttribute("aria-owns",d+" "+t):s.setAttribute("aria-owns",t)}}_clearFromModals(){this._trackedModals.forEach(t=>{const i=t.getAttribute("aria-owns");if(i){const r=i.replace(this._liveElementId,"").trim();r.length>0?t.setAttribute("aria-owns",r):t.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const t=this._elementRef.nativeElement.querySelector("[aria-hidden]"),i=this._elementRef.nativeElement.querySelector("[aria-live]");if(t&&i){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&t.contains(document.activeElement)&&(r=document.activeElement),t.removeAttribute("aria-hidden"),i.appendChild(t),r?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(_),Et(Ks),Et(sg),Et(wu),Et(Jw))};static#t=this.\u0275dir=vn({type:e,viewQuery:function(i,r){if(1&i&&$p(px,7),2&i){let s;Kh(s=Qh())&&(r._portalOutlet=s.first)}},features:[zr]})}return e})(),PW=(()=>{class e extends AW{_afterPortalAttached(){super._afterPortalAttached();const t=this._label.nativeElement,i="mdc-snackbar__label";t.classList.toggle(i,!t.querySelector(`.${i}`))}static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=gl(e)))(r||e)}}();static#t=this.\u0275cmp=Gi({type:e,selectors:[["mat-snack-bar-container"]],viewQuery:function(i,r){if(1&i&&$p(bW,7),2&i){let s;Kh(s=Qh())&&(r._label=s.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container","mdc-snackbar--open"],hostVars:1,hostBindings:function(i,r){1&i&&DS("@state.done",function(d){return r.onAnimationEnd(d)}),2&i&&LS("@state",r._animationState)},features:[zr],decls:6,vars:3,consts:[[1,"mdc-snackbar__surface"],[1,"mat-mdc-snack-bar-label"],["label",""],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"div",1,2)(3,"div",3),Oo(4,wW,0,0,"ng-template",4),Yt(),Oi(5,"div"),Yt()()),2&i&&(Gn(5),$a("aria-live",r._live)("role",r._role)("id",r._liveElementId))},dependencies:[px],styles:['.mdc-snackbar{display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-snackbar--opening,.mdc-snackbar--open,.mdc-snackbar--closing{display:flex}.mdc-snackbar--open .mdc-snackbar__label,.mdc-snackbar--open .mdc-snackbar__actions{visibility:visible}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(0.8);opacity:0}.mdc-snackbar__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-snackbar__surface::before{border-color:CanvasText}}[dir=rtl] .mdc-snackbar__surface,.mdc-snackbar__surface[dir=rtl]{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1)}.mdc-snackbar__label{padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}[dir=rtl] .mdc-snackbar__label,.mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss,.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-snack-bar-container{margin:8px;--mdc-snackbar-container-shape:4px;position:static}.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:344px}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:100%}}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container{width:100vw}}.mat-mdc-snack-bar-container .mdc-snackbar__surface{max-width:672px}.mat-mdc-snack-bar-container .mdc-snackbar__surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{background-color:var(--mdc-snackbar-container-color)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{border-radius:var(--mdc-snackbar-container-shape)}.mat-mdc-snack-bar-container .mdc-snackbar__label{color:var(--mdc-snackbar-supporting-text-color)}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-size:var(--mdc-snackbar-supporting-text-size);font-family:var(--mdc-snackbar-supporting-text-font);font-weight:var(--mdc-snackbar-supporting-text-weight);line-height:var(--mdc-snackbar-supporting-text-line-height)}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color);--mat-mdc-button-persistent-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{background-color:currentColor;opacity:.1}.mat-mdc-snack-bar-container .mdc-snackbar__label::before{display:none}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-handset .mdc-snackbar__surface{width:100%}'],encapsulation:2,data:{animation:[DW.snackBarState]}})}return e})(),WN=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[aD,mx,D0,SN,yc,yc]})}return e})();const ZN=new Pn("mat-snack-bar-default-options",{providedIn:"root",factory:function RW(){return new Jw}});let OW=(()=>{class e{get _openedSnackBarRef(){const t=this._parentSnackBar;return t?t._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(t){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=t:this._snackBarRefAtThisLevel=t}constructor(t,i,r,s,d,p){this._overlay=t,this._live=i,this._injector=r,this._breakpointObserver=s,this._parentSnackBar=d,this._defaultConfig=p,this._snackBarRefAtThisLevel=null}openFromComponent(t,i){return this._attach(t,i)}openFromTemplate(t,i){return this._attach(t,i)}open(t,i="",r){const s={...this._defaultConfig,...r};return s.data={message:t,action:i},s.announcementMessage===t&&(s.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,s)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(t,i){const s=Qs.create({parent:i&&i.viewContainerRef&&i.viewContainerRef.injector||this._injector,providers:[{provide:Jw,useValue:i}]}),d=new fx(this.snackBarContainerComponent,i.viewContainerRef,s),p=t.attach(d);return p.instance.snackBarConfig=i,p.instance}_attach(t,i){const r={...new Jw,...this._defaultConfig,...i},s=this._createOverlay(r),d=this._attachSnackBarContainer(s,r),p=new lD(d,s);if(t instanceof ch){const v=new iD(t,null,{$implicit:r.data,snackBarRef:p});p.instance=d.attachTemplatePortal(v)}else{const v=this._createInjector(r,p),x=new fx(t,void 0,v),M=d.attachComponentPortal(x);p.instance=M.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(Jp(s.detachments())).subscribe(v=>{s.overlayElement.classList.toggle(this.handsetCssClass,v.matches)}),r.announcementMessage&&d._onAnnounce.subscribe(()=>{this._live.announce(r.announcementMessage,r.politeness)}),this._animateSnackBar(p,r),this._openedSnackBarRef=p,this._openedSnackBarRef}_animateSnackBar(t,i){t.afterDismissed().subscribe(()=>{this._openedSnackBarRef==t&&(this._openedSnackBarRef=null),i.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{t.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):t.containerInstance.enter(),i.duration&&i.duration>0&&t.afterOpened().subscribe(()=>t._dismissAfter(i.duration))}_createOverlay(t){const i=new sD;i.direction=t.direction;let r=this._overlay.position().global();const s="rtl"===t.direction,d="left"===t.horizontalPosition||"start"===t.horizontalPosition&&!s||"end"===t.horizontalPosition&&s,p=!d&&"center"!==t.horizontalPosition;return d?r.left("0"):p?r.right("0"):r.centerHorizontally(),"top"===t.verticalPosition?r.top("0"):r.bottom("0"),i.positionStrategy=r,this._overlay.create(i)}_createInjector(t,i){return Qs.create({parent:t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,providers:[{provide:lD,useValue:i},{provide:qN,useValue:t.data}]})}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(im),Dt(oN),Dt(Qs),Dt(Gw),Dt(e,12),Dt(ZN))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),XN=(()=>{class e extends OW{constructor(t,i,r,s,d,p){super(t,i,r,s,d,p),this.simpleSnackBarComponent=IW,this.snackBarContainerComponent=PW,this.handsetCssClass="mat-mdc-snack-bar-handset"}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(im),Dt(oN),Dt(Qs),Dt(Gw),Dt(e,12),Dt(ZN))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:WN})}return e})();const eE=function(e){return{height:e}};function kW(e,n){if(1&e&&(jt(0,"button",4),An(1),Yt()),2&e){const t=xs();gu(t.style),F_(t.class),Di("ngStyle",Wf(9,eE,"small"===t.size?"28px":"medium"===t.size?"44px":"52px"))("color",t.color)("disabled",t.disabled),$a("type",t.submit?"submit":"button"),Gn(1),qf(" ",t.text,"\n")}}function LW(e,n){if(1&e&&(jt(0,"button",5),An(1),Yt()),2&e){const t=xs();gu(t.style),F_(t.class),Di("ngStyle",Wf(9,eE,"small"===t.size?"28px":"medium"===t.size?"44px":"52px"))("color",t.color)("disabled",t.disabled),$a("type",t.submit?"submit":"button"),Gn(1),qf(" ",t.text,"\n")}}function NW(e,n){if(1&e&&(jt(0,"button",6),An(1),Yt()),2&e){const t=xs();gu(t.style),F_(t.class),Di("ngStyle",Wf(9,eE,"small"===t.size?"28px":"medium"===t.size?"44px":"52px"))("color",t.color)("disabled",t.disabled),$a("type",t.submit?"submit":"button"),Gn(1),qf(" ",t.text,"\n")}}function FW(e,n){if(1&e&&(jt(0,"button",7),An(1),Yt()),2&e){const t=xs();gu(t.style),F_(t.class),Di("ngStyle",Wf(9,eE,"small"===t.size?"28px":"medium"===t.size?"44px":"52px"))("color",t.color)("disabled",t.disabled),$a("type",t.submit?"submit":"button"),Gn(1),qf(" ",t.text,"\n")}}let tE=(()=>{class e{constructor(){this.type="flat",this.size="medium",this.color="primary",this.text="",this.disabled=!1,this.submit=!1,this.class="",this.style=""}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-button"]],inputs:{type:"type",size:"size",color:"color",text:"text",disabled:"disabled",submit:"submit",class:"class",style:"style"},decls:4,vars:4,consts:[["mat-button","","class","button",3,"ngStyle","color","disabled","class","style",4,"ngIf"],["mat-raised-button","","class","button",3,"ngStyle","color","disabled","class","style",4,"ngIf"],["mat-stroked-button","","class","button",3,"ngStyle","color","disabled","class","style",4,"ngIf"],["mat-flat-button","","class","button",3,"ngStyle","color","disabled","class","style",4,"ngIf"],["mat-button","",1,"button",3,"ngStyle","color","disabled"],["mat-raised-button","",1,"button",3,"ngStyle","color","disabled"],["mat-stroked-button","",1,"button",3,"ngStyle","color","disabled"],["mat-flat-button","",1,"button",3,"ngStyle","color","disabled"]],template:function(i,r){1&i&&(Oo(0,kW,2,11,"button",0),Oo(1,LW,2,11,"button",1),Oo(2,NW,2,11,"button",2),Oo(3,FW,2,11,"button",3)),2&i&&(Di("ngIf","basic"===r.type),Gn(1),Di("ngIf","raised"===r.type),Gn(1),Di("ngIf","stroked"===r.type),Gn(1),Di("ngIf","flat"===r.type))},dependencies:[$_,NM,JI],styles:[".button[_ngcontent-%COMP%]{border-radius:8px;font-size:14px;font-weight:500;line-height:36px}"]})}return e})();const nE=function(e,n){return{avatar_image_show:e,avatar_image_hide:n}};let BW=(()=>{class e{constructor(t,i){this._router=t,this.snackBar=i,this.shouldShowImage1=!1,this.shouldShowImage2=!1,this.shouldShowImage3=!1,this.shouldShowImage4=!1,this.imageUrls1="",this.imageUrls2="",this.imageUrls3="",this.imageUrls4="",this.chosenImage="",this.registerForm=new ef({firstName:new js("",{nonNullable:!0,validators:[Jl.required,Jl.minLength(2),Jl.pattern("[a-zA-Z].*")]}),lastName:new js("",{nonNullable:!0,validators:[Jl.required,Jl.minLength(2),Jl.pattern("[a-zA-Z].*")]}),address:new js("",{nonNullable:!0,validators:[Jl.required,Jl.minLength(4)]}),mobile:new js("",{nonNullable:!0,validators:[Jl.required,Jl.minLength(9),Jl.maxLength(9),Jl.pattern("[0-9].*")]}),email:new js("",{nonNullable:!0,validators:[Jl.required,Jl.email]}),pwd:new js("",{nonNullable:!0,validators:[Jl.required,Jl.minLength(8)]})}),this.imageUrls=["assets/images/avatars/avatar1.png","assets/images/avatars/avatar2.png","assets/images/avatars/avatar3.png","assets/images/avatars/avatar4.png","assets/images/avatars/avatar5.png"],this.shuffledImageUrls=this.shuffleArray([...this.imageUrls]),this.currentIndex=0,this.getRandomImageUrl()}ngOnInit(){}registerSubmit(){this.registerForm.valid&&this.chosenImage.length>0?this.navigateToLogin():this.registerForm.get("firstName")?.invalid?this.snackBar.open("Wprowad\u017a poprawne imie","Close",{duration:3e3}):this.registerForm.get("lastName")?.invalid?this.snackBar.open("Wprowad\u017a poprawne nazwisko","Close",{duration:3e3}):this.registerForm.get("mobile")?.invalid?this.snackBar.open("Wprowad\u017a poprawny numer telefonu","Close",{duration:3e3}):this.registerForm.get("email")?.invalid?this.snackBar.open("Wprowad\u017a poprawny adres email","Close",{duration:3e3}):this.registerForm.get("pwd")?.invalid?this.snackBar.open("Wprowad\u017a poprawne has\u0142o","Close",{duration:3e3}):0==this.chosenImage.length&&this.snackBar.open("Wybierz avatar","Close",{duration:3e3})}navigateToLogin(){this._router.navigateByUrl("/login")}navigateToHomePage(){this._router.navigateByUrl("/home")}shuffleArray(t){let r,s,i=t.length;for(;0!==i;)s=Math.floor(Math.random()*i),i--,r=t[i],t[i]=t[s],t[s]=r;return t}getRandomImageUrl(){this.imageUrls1=this.shuffledImageUrls[this.currentIndex],this.currentIndex++,this.imageUrls2=this.shuffledImageUrls[this.currentIndex],this.currentIndex++,this.imageUrls3=this.shuffledImageUrls[this.currentIndex],this.currentIndex++,this.imageUrls4=this.shuffledImageUrls[this.currentIndex],this.currentIndex++}getImageUrls1(){return this.imageUrls1}getImageUrls2(){return this.imageUrls2}getImageUrls3(){return this.imageUrls3}getImageUrls4(){return this.imageUrls4}choseImage1(){this.shouldShowImage1=!0,this.shouldShowImage2=!1,this.shouldShowImage3=!1,this.shouldShowImage4=!1,this.chosenImage=this.getImageUrls1()}choseImage2(){this.shouldShowImage1=!1,this.shouldShowImage2=!0,this.shouldShowImage3=!1,this.shouldShowImage4=!1,this.chosenImage=this.getImageUrls2()}choseImage3(){this.shouldShowImage1=!1,this.shouldShowImage2=!1,this.shouldShowImage3=!0,this.shouldShowImage4=!1,this.chosenImage=this.getImageUrls3()}choseImage4(){this.shouldShowImage1=!1,this.shouldShowImage2=!1,this.shouldShowImage3=!1,this.shouldShowImage4=!0,this.chosenImage=this.getImageUrls4()}static#e=this.\u0275fac=function(i){return new(i||e)(Et(bu),Et(XN))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-random-image"]],decls:63,vars:22,consts:[[3,"formGroup","ngSubmit"],[2,"align-self","stretch","height","100%","background","white","justify-content","flex-start","align-items","center","display","inline-flex"],[2,"flex","1 1 0","align-self","stretch","flex-direction","column","justify-content","space-between","align-items","center","display","inline-flex"],[2,"align-self","stretch","height","70px","padding","32px","justify-content","flex-start","align-items","center","display","inline-flex"],[2,"width","400px","height","44px","color","#7f56d9","font-size","36px","font-family","Inter","font-weight","700","line-height","44px","word-wrap","break-word","background-color","white","border","none","text-align","left",3,"click"],[2,"align-self","stretch","height","800px","padding-left","32px","padding-right","32px","flex-direction","column","justify-content","flex-start","align-items","center","display","flex"],[2,"height","728.5px","flex-direction","column","justify-content","flex-start","align-items","center","gap","16px","display","flex"],[2,"align-self","stretch","height","74px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","12px","display","flex"],[2,"align-self","stretch","color","#121212","font-size","30px","font-family","Inter","font-weight","700","line-height","38px","word-wrap","break-word"],[2,"align-self","stretch","color","#667085","font-size","16px","font-family","Inter","font-weight","400","line-height","24px","word-wrap","break-word"],[2,"align-self","stretch","height","542.5px","border-radius","12px","flex-direction","column","justify-content","flex-start","align-items","center","gap","24px","display","flex"],[2,"align-self","stretch","height","542.5px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","10px","display","flex"],[2,"width","400px","justify-content","flex-start","align-items","flex-start","gap","10px","display","inline-flex"],[2,"flex","1 1 0","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","6px","display","inline-flex"],[1,"font"],["type","text","id","firstName","formControlName","firstName","placeholder","Wpisz swoje imie",1,"input",2,"width","170px"],["type","text","id","lastName","formControlName","lastName","placeholder","Wpisz swoje nazwisko",1,"input",2,"width","170px"],[2,"align-self","stretch","height","70px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","6px","display","flex"],["type","text","id","address","formControlName","address","placeholder","Wpisz sw\xf3j adres",1,"input"],["type","text","id","mobile","formControlName","mobile","placeholder","Wpisz sw\xf3j telefon",1,"input"],["type","text","id","email","formControlName","email","placeholder","Wpisz sw\xf3j email",1,"input"],[2,"align-self","stretch","height","94px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","6px","display","flex"],["type","password","id","pwd","formControlName","pwd","placeholder","Wpisz swoje has\u0142o",1,"input"],[2,"width","360px","color","#667085","font-size","12px","font-family","Inter","font-weight","400","line-height","18px","word-wrap","break-word"],[2,"flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","6px","display","flex"],[3,"ngClass","src","click"],["text","Zarejestruj si\u0119",2,"width","100%",3,"submit"],[2,"align-self","stretch","justify-content","flex-end","align-items","flex-start","gap","4px","display","inline-flex"],[2,"color","#667085","font-size","14px","font-family","Inter","font-weight","400","line-height","20px","word-wrap","break-word"],[2,"justify-content","flex-start","align-items","flex-start","display","flex"],[2,"justify-content","center","align-items","center","gap","8px","display","flex"],[1,"button_zaloguj",3,"click"],[1,"image_content"],["src","./assets/images/image.png",2,"width","600px","height","436.507px"]],template:function(i,r){1&i&&(jt(0,"form",0),vo("ngSubmit",function(){return r.registerSubmit()}),jt(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),vo("click",function(){return r.navigateToHomePage()}),An(5," HelpHunter "),Yt()(),jt(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),An(10," Rejestracja "),Yt(),jt(11,"div",9),An(12," Zarejestruj si\u0119 i do\u0142\u0105cz do naszej spo\u0142eczno\u015bci "),Yt()(),jt(13,"div",10)(14,"div",11)(15,"div",12)(16,"div",13)(17,"div",14),An(18,"Imi\u0119*"),Yt(),Oi(19,"input",15),Yt(),jt(20,"div",13)(21,"div",14),An(22,"Nazwisko*"),Yt(),Oi(23,"input",16),Yt()(),jt(24,"div",17)(25,"div",14),An(26,"Adres*"),Yt(),Oi(27,"input",18),Yt(),jt(28,"div",17)(29,"div",14),An(30,"Telefon*"),Yt(),Oi(31,"input",19),Yt(),jt(32,"div",17)(33,"div",14),An(34,"Email*"),Yt(),Oi(35,"input",20),Yt(),jt(36,"div",21)(37,"div",14),An(38,"Has\u0142o*"),Yt(),Oi(39,"input",22),jt(40,"div",23),An(41," Musi mie\u0107 co najmniej 8 znak\xf3w "),Yt()(),jt(42,"div",24)(43,"div",14),An(44,"Avatar"),Yt(),jt(45,"div",12)(46,"img",25),vo("click",function(){return r.choseImage1()}),Yt(),jt(47,"img",25),vo("click",function(){return r.choseImage2()}),Yt(),jt(48,"img",25),vo("click",function(){return r.choseImage3()}),Yt(),jt(49,"img",25),vo("click",function(){return r.choseImage4()}),Yt()()()()(),Oi(50,"app-button",26),jt(51,"div",27)(52,"div",28),An(53," Posiadasz ju\u017c konto? "),Yt(),jt(54,"div",29)(55,"div",30)(56,"button",31),vo("click",function(){return r.navigateToLogin()}),An(57,"Zaloguj si\u0119"),Yt()()()()()(),jt(58,"div",3)(59,"div",28),An(60," \xa9 HelpHunter 2023 "),Yt()()(),jt(61,"div",32),Oi(62,"img",33),Yt()()()),2&i&&(Di("formGroup",r.registerForm),Gn(46),Di("ngClass",og(10,nE,r.shouldShowImage1,!r.shouldShowImage1))("src",r.getImageUrls1(),Vu),Gn(1),Di("ngClass",og(13,nE,r.shouldShowImage2,!r.shouldShowImage2))("src",r.getImageUrls2(),Vu),Gn(1),Di("ngClass",og(16,nE,r.shouldShowImage3,!r.shouldShowImage3))("src",r.getImageUrls3(),Vu),Gn(1),Di("ngClass",og(19,nE,r.shouldShowImage4,!r.shouldShowImage4))("src",r.getImageUrls4(),Vu),Gn(1),Di("submit",!0))},dependencies:[OM,hI,P0,R0,dw,q_,B0,tE],styles:["form[_ngcontent-%COMP%]{width:100%;height:100%;background:white;flex-direction:column;justify-content:flex-start;align-items:center;display:inline-flex}.error_text[_ngcontent-%COMP%]{color:red;font-size:10px;font-family:Inter;font-weight:400;line-height:20px;word-wrap:break-word}.font[_ngcontent-%COMP%]{color:#121212;font-size:14px;font-family:Inter;font-weight:400;line-height:20px;word-wrap:break-word}.button_zaloguj[_ngcontent-%COMP%]{color:#6941c6;font-size:14px;font-family:Inter;font-weight:600;line-height:20px;word-wrap:break-word;border:none;background-color:#fff}.button_zaloguj[_ngcontent-%COMP%]:hover{color:#946fe2}.input[_ngcontent-%COMP%]{color:#121212;font-size:16px;font-family:Inter;font-weight:400;line-height:24px;word-wrap:break-word;align-self:stretch;height:42px;padding-left:12px;padding-right:12px;border-radius:8px;overflow:hidden;border:1px #d0d5dd solid;justify-content:flex-start;align-items:center;gap:10px;display:inline-flex}.avatar_image_hide[_ngcontent-%COMP%]:hover{opacity:1}.avatar_image_show[_ngcontent-%COMP%]{width:92.5px;height:92.5px;opacity:1;transition:opacity .5s}.avatar_image_hide[_ngcontent-%COMP%]{width:92.5px;height:92.5px;opacity:.5;transition:opacity .5s}.image_content[_ngcontent-%COMP%]{width:720px;height:100%;padding-left:60px;padding-right:60px;background:#7f56d9;flex-direction:column;justify-content:center;align-items:center;display:inline-flex}@media (max-width: 1185px){.image_content[_ngcontent-%COMP%]{display:none}}"]})}return e})();function zW(e,n){}class iE{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let YN=(()=>{class e extends Zw{constructor(t,i,r,s,d,p,v,x){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=d,this._ngZone=p,this._overlayRef=v,this._focusMonitor=x,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this.attachDomPortal=M=>{this._portalOutlet.hasAttached();const R=this._portalOutlet.attachDomPortal(M);return this._contentAttached(),R},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=GI(),s=this._elementRef.nativeElement;(!r||r===this._document.body||r===s||s.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=GI();return t===i||t.contains(i)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=GI())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(ZI),Et(Ar,8),Et(iE),Et($w),Et(_),Et(_x),Et(sx))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&$p(px,7),2&i){let s;Kh(s=Qh())&&(r._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&$a("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},features:[zr],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&Oo(0,zW,0,0,"ng-template",0)},dependencies:[px],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return e})();class cD{constructor(n,t){this.overlayRef=n,this.config=t,this.closed=new Ct,this.disableClose=t.disableClose,this.backdropClick=n.backdropClick(),this.keydownEvents=n.keydownEvents(),this.outsidePointerEvents=n.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!HL(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=n.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(n,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(n),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(n="",t=""){return this.overlayRef.updateSize({width:n,height:t}),this}addPanelClass(n){return this.overlayRef.addPanelClass(n),this}removePanelClass(n){return this.overlayRef.removePanelClass(n),this}}const KN=new Pn("DialogScrollStrategy"),VW=new Pn("DialogData"),UW=new Pn("DefaultDialogConfig"),GW={provide:KN,deps:[im],useFactory:function jW(e){return()=>e.scrollStrategies.block()}};let $W=0,QN=(()=>{class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,r,s,d,p){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=d,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Ct,this._afterOpenedAtThisLevel=new Ct,this._ariaHiddenElements=new Map,this.afterAllClosed=bw(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(V0(void 0))),this._scrollStrategy=p}open(t,i){(i={...this._defaultOptions||new iE,...i}).id=i.id||"cdk-dialog-"+$W++,i.id&&this.getDialogById(i.id);const s=this._getOverlayConfig(i),d=this._overlay.create(s),p=new cD(d,i),v=this._attachContainer(d,p,i);return p.containerInstance=v,this._attachDialogContent(t,p,v,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(p),p.closed.subscribe(()=>this._removeOpenDialog(p,!0)),this.afterOpened.next(p),p}closeAll(){uD(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){uD(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),uD(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new sD({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,r){const s=r.injector||r.viewContainerRef?.injector,d=[{provide:iE,useValue:r},{provide:cD,useValue:i},{provide:_x,useValue:t}];let p;r.container?"function"==typeof r.container?p=r.container:(p=r.container.type,d.push(...r.container.providers(r))):p=YN;const v=new fx(p,r.viewContainerRef,Qs.create({parent:s||this._injector,providers:d}),r.componentFactoryResolver);return t.attach(v).instance}_attachDialogContent(t,i,r,s){if(t instanceof ch){const d=this._createInjector(s,i,r,void 0);let p={$implicit:s.data,dialogRef:i};s.templateContext&&(p={...p,..."function"==typeof s.templateContext?s.templateContext():s.templateContext}),r.attachTemplatePortal(new iD(t,null,p,d))}else{const d=this._createInjector(s,i,r,this._injector),p=r.attachComponentPortal(new fx(t,s.viewContainerRef,d,s.componentFactoryResolver));i.componentRef=p,i.componentInstance=p.instance}}_createInjector(t,i,r,s){const d=t.injector||t.viewContainerRef?.injector,p=[{provide:VW,useValue:t.data},{provide:cD,useValue:i}];return t.providers&&("function"==typeof t.providers?p.push(...t.providers(i,t,r)):p.push(...t.providers)),t.direction&&(!d||!d.get(YI,null,{optional:!0}))&&p.push({provide:YI,useValue:{value:t.direction,change:Ln()}}),Qs.create({parent:d||s,providers:p})}_removeOpenDialog(t,i){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,d)=>{s?d.setAttribute("aria-hidden",s):d.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){const s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(im),Dt(Qs),Dt(UW,8),Dt(e,12),Dt(Qw),Dt(KN))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();function uD(e,n){let t=e.length;for(;t--;)n(e[t])}let HW=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:[QN,GW],imports:[aD,mx,c7,mx]})}return e})();function qW(e,n){}class rE{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const dD="mdc-dialog--open",JN="mdc-dialog--opening",eF="mdc-dialog--closing";let XW=(()=>{class e extends YN{constructor(t,i,r,s,d,p,v,x){super(t,i,r,s,d,p,v,x),this._animationStateChanged=new a}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(ZI),Et(Ar,8),Et(rE),Et($w),Et(_),Et(_x),Et(sx))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["ng-component"]],features:[zr],decls:0,vars:0,template:function(i,r){},encapsulation:2})}return e})();const tF="--mat-dialog-transition-duration";function nF(e){return null==e?null:"number"==typeof e?e:e.endsWith("ms")?WL(e.substring(0,e.length-2)):e.endsWith("s")?1e3*WL(e.substring(0,e.length-1)):"0"===e?0:null}let YW=(()=>{class e extends XW{constructor(t,i,r,s,d,p,v,x,M){super(t,i,r,s,d,p,v,M),this._animationMode=x,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?nF(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?nF(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(tF,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(JN,dD)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(dD),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(dD),this._animationsEnabled?(this._hostElement.style.setProperty(tF,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(eF)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove(JN,eF)}_waitForAnimationToComplete(t,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(ZI),Et(Ar,8),Et(rE),Et($w),Et(_),Et(_x),Et(rh,8),Et(sx))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(i,r){2&i&&(kS("id",r._config.id),$a("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),Uu("_mat-animation-noopable",!r._animationsEnabled))},features:[zr],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"div",1),Oo(2,qW,0,0,"ng-template",2),Yt()())},dependencies:[px],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{--mdc-dialog-container-elevation-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);--mdc-dialog-container-shadow-color:#000;--mdc-dialog-container-shape:4px;--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2})}return e})();class iF{constructor(n,t,i){this._ref=n,this._containerInstance=i,this._afterOpened=new Ct,this._beforeClosed=new Ct,this._state=0,this.disableClose=t.disableClose,this.id=n.id,i._animationStateChanged.pipe(Rc(r=>"opened"===r.state),$u(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(Rc(r=>"closed"===r.state),$u(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),n.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),eu(this.backdropClick(),this.keydownEvents().pipe(Rc(r=>27===r.keyCode&&!this.disableClose&&!HL(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function KW(e,n,t){e._closeInteractionType=n,e.close(t)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(n){this._result=n,this._containerInstance._animationStateChanged.pipe(Rc(t=>"closing"===t.state),$u(1)).subscribe(t=>{this._beforeClosed.next(n),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(n){let t=this._ref.config.positionStrategy;return n&&(n.left||n.right)?n.left?t.left(n.left):t.right(n.right):t.centerHorizontally(),n&&(n.top||n.bottom)?n.top?t.top(n.top):t.bottom(n.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(n="",t=""){return this._ref.updateSize(n,t),this}addPanelClass(n){return this._ref.addPanelClass(n),this}removePanelClass(n){return this._ref.removePanelClass(n),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const QW=new Pn("MatMdcDialogData"),JW=new Pn("mat-mdc-dialog-default-options"),rF=new Pn("mat-mdc-dialog-scroll-strategy"),tZ={provide:rF,deps:[im],useFactory:function eZ(e){return()=>e.scrollStrategies.block()}};let nZ=0,iZ=(()=>{class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,i,r,s,d,p,v,x,M,R){this._overlay=t,this._defaultOptions=r,this._parentDialog=s,this._dialogRefConstructor=v,this._dialogContainerType=x,this._dialogDataToken=M,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Ct,this._afterOpenedAtThisLevel=new Ct,this._idPrefix="mat-dialog-",this.dialogConfigClass=rE,this.afterAllClosed=bw(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(V0(void 0))),this._scrollStrategy=p,this._dialog=i.get(QN)}open(t,i){let r;(i={...this._defaultOptions||new rE,...i}).id=i.id||`${this._idPrefix}${nZ++}`,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const s=this._dialog.open(t,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:iE,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(d,p,v)=>(r=new this._dialogRefConstructor(d,i,v),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:v},{provide:this._dialogDataToken,useValue:p.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=s.componentRef,r.componentInstance=s.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const d=this.openDialogs.indexOf(r);d>-1&&(this.openDialogs.splice(d,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}static#e=this.\u0275fac=function(i){Mo()};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),oF=(()=>{class e extends iZ{constructor(t,i,r,s,d,p,v,x){super(t,i,s,p,v,d,iF,YW,QW,x),this._idPrefix="mat-mdc-dialog-"}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(im),Dt(Qs),Dt(S0,8),Dt(JW,8),Dt(rF),Dt(e,12),Dt(Qw),Dt(rh,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),rZ=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:[oF,tZ],imports:[HW,aD,mx,yc,yc]})}return e})();class oE{}class sE{}class sf{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),d=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(d):this.headers.set(s,[d])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof sf?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new sf;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof sf?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,t);const r=("a"===n.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=n.value;if(s){let d=this.headers.get(t);if(!d)return;d=d.filter(p=>-1===s.indexOf(p)),0===d.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,d)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=n.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(n,r)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class oZ{encodeKey(n){return aF(n)}encodeValue(n){return aF(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const aZ=/%(\d[a-f0-9])/gi,lZ={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function aF(e){return encodeURIComponent(e).replace(aZ,(n,t)=>lZ[t]??n)}function aE(e){return`${e}`}class rm{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new oZ,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function sZ(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[d,p]=-1==s?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,s)),n.decodeValue(r.slice(s+1))],v=t.get(d)||[];v.push(p),t.set(d,v)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const i=n.fromObject[t],r=Array.isArray(i)?i.map(aE):[aE(i)];this.map.set(t,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(i=>{const r=n[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new rm({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(aE(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const r=i.indexOf(aE(n.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class cZ{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function lF(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function cF(e){return typeof Blob<"u"&&e instanceof Blob}function uF(e){return typeof FormData<"u"&&e instanceof FormData}class yx{constructor(n,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function uZ(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new sf),this.context||(this.context=new cZ),this.params){const d=this.params.toString();if(0===d.length)this.urlWithParams=t;else{const p=t.indexOf("?");this.urlWithParams=t+(-1===p?"?":p<t.length-1?"&":"")+d}}else this.params=new rm,this.urlWithParams=t}serializeBody(){return null===this.body?null:lF(this.body)||cF(this.body)||uF(this.body)||function dZ(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof rm?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||uF(this.body)?null:cF(this.body)?this.body.type||null:lF(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof rm?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,i=n.url||this.url,r=n.responseType||this.responseType,s=void 0!==n.body?n.body:this.body,d=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,p=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let v=n.headers||this.headers,x=n.params||this.params;const M=n.context??this.context;return void 0!==n.setHeaders&&(v=Object.keys(n.setHeaders).reduce((R,L)=>R.set(L,n.setHeaders[L]),v)),n.setParams&&(x=Object.keys(n.setParams).reduce((R,L)=>R.set(L,n.setParams[L]),x)),new yx(t,i,s,{params:x,headers:v,context:M,reportProgress:p,responseType:r,withCredentials:d})}}var ly=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(ly||{});class hD{constructor(n,t=200,i="OK"){this.headers=n.headers||new sf,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class fD extends hD{constructor(n={}){super(n),this.type=ly.ResponseHeader}clone(n={}){return new fD({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class cy extends hD{constructor(n={}){super(n),this.type=ly.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new cy({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class dF extends hD{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function pD(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let _g=(()=>{class e{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof yx)s=t;else{let v,x;v=r.headers instanceof sf?r.headers:new sf(r.headers),r.params&&(x=r.params instanceof rm?r.params:new rm({fromObject:r.params})),s=new yx(t,i,void 0!==r.body?r.body:null,{headers:v,context:r.context,params:x,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const d=Ln(s).pipe(Z_(v=>this.handler.handle(v)));if(t instanceof yx||"events"===r.observe)return d;const p=d.pipe(Rc(v=>v instanceof cy));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return p.pipe(Kt(v=>{if(null!==v.body&&!(v.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return v.body}));case"blob":return p.pipe(Kt(v=>{if(null!==v.body&&!(v.body instanceof Blob))throw new Error("Response is not a Blob.");return v.body}));case"text":return p.pipe(Kt(v=>{if(null!==v.body&&"string"!=typeof v.body)throw new Error("Response is not a string.");return v.body}));default:return p.pipe(Kt(v=>v.body))}case"response":return p;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new rm).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,pD(r,i))}post(t,i,r={}){return this.request("POST",t,pD(r,i))}put(t,i,r={}){return this.request("PUT",t,pD(r,i))}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(oE))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();function pF(e,n){return n(e)}function fZ(e,n){return(t,i)=>n.intercept(t,{handle:r=>e(r,i)})}const mF=new Pn(""),vx=new Pn(""),gF=new Pn("");function mZ(){let e=null;return(n,t)=>{null===e&&(e=(Rn(mF,{optional:!0})??[]).reduceRight(fZ,pF));const i=Rn(j1),r=i.add();return e(n,t).pipe(X_(()=>i.remove(r)))}}let _F=(()=>{class e extends oE{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=Rn(j1)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(vx),...this.injector.get(gF,[])]));this.chain=r.reduceRight((s,d)=>function pZ(e,n,t){return(i,r)=>t.runInContext(()=>n(i,s=>e(s,r)))}(s,d,this.injector),pF)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(X_(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(sE),Dt(Kl))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const vZ=/^\)\]\}',?\n/;let vF=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Ot(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Ws(i.\u0275loadImpl()):Ln(null)).pipe(gi(()=>new Re(s=>{const d=i.build();if(d.open(t.method,t.urlWithParams),t.withCredentials&&(d.withCredentials=!0),t.headers.forEach((X,ye)=>d.setRequestHeader(X,ye.join(","))),t.headers.has("Accept")||d.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const X=t.detectContentTypeHeader();null!==X&&d.setRequestHeader("Content-Type",X)}if(t.responseType){const X=t.responseType.toLowerCase();d.responseType="json"!==X?X:"text"}const p=t.serializeBody();let v=null;const x=()=>{if(null!==v)return v;const X=d.statusText||"OK",ye=new sf(d.getAllResponseHeaders()),ae=function xZ(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(d)||t.url;return v=new fD({headers:ye,status:d.status,statusText:X,url:ae}),v},M=()=>{let{headers:X,status:ye,statusText:ae,url:Q}=x(),me=null;204!==ye&&(me=typeof d.response>"u"?d.responseText:d.response),0===ye&&(ye=me?200:0);let Xe=ye>=200&&ye<300;if("json"===t.responseType&&"string"==typeof me){const nt=me;me=me.replace(vZ,"");try{me=""!==me?JSON.parse(me):null}catch(wt){me=nt,Xe&&(Xe=!1,me={error:wt,text:me})}}Xe?(s.next(new cy({body:me,headers:X,status:ye,statusText:ae,url:Q||void 0})),s.complete()):s.error(new dF({error:me,headers:X,status:ye,statusText:ae,url:Q||void 0}))},R=X=>{const{url:ye}=x(),ae=new dF({error:X,status:d.status||0,statusText:d.statusText||"Unknown Error",url:ye||void 0});s.error(ae)};let L=!1;const F=X=>{L||(s.next(x()),L=!0);let ye={type:ly.DownloadProgress,loaded:X.loaded};X.lengthComputable&&(ye.total=X.total),"text"===t.responseType&&d.responseText&&(ye.partialText=d.responseText),s.next(ye)},Y=X=>{let ye={type:ly.UploadProgress,loaded:X.loaded};X.lengthComputable&&(ye.total=X.total),s.next(ye)};return d.addEventListener("load",M),d.addEventListener("error",R),d.addEventListener("timeout",R),d.addEventListener("abort",R),t.reportProgress&&(d.addEventListener("progress",F),null!==p&&d.upload&&d.upload.addEventListener("progress",Y)),d.send(p),s.next({type:ly.Sent}),()=>{d.removeEventListener("error",R),d.removeEventListener("abort",R),d.removeEventListener("load",M),d.removeEventListener("timeout",R),t.reportProgress&&(d.removeEventListener("progress",F),null!==p&&d.upload&&d.upload.removeEventListener("progress",Y)),d.readyState!==d.DONE&&d.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(uO))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const mD=new Pn("XSRF_ENABLED"),xF=new Pn("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),bF=new Pn("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class wF{}let EZ=(()=>{class e{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=eO(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar),Dt($h),Dt(xF))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();function CZ(e,n){const t=e.url.toLowerCase();if(!Rn(mD)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const i=Rn(wF).getToken(),r=Rn(bF);return null!=i&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,i)})),n(e)}var om=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(om||{});function SZ(...e){const n=[_g,vF,_F,{provide:oE,useExisting:_F},{provide:sE,useExisting:vF},{provide:vx,useValue:CZ,multi:!0},{provide:mD,useValue:!0},{provide:wF,useClass:EZ}];for(const t of e)n.push(...t.\u0275providers);return function u_(e){return{\u0275providers:e}}(n)}const EF=new Pn("LEGACY_INTERCEPTOR_FN");function MZ(){return function yg(e,n){return{\u0275kind:e,\u0275providers:n}}(om.LegacyInterceptors,[{provide:EF,useFactory:mZ},{provide:vx,useExisting:EF,multi:!0}])}let IZ=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:[SZ(MZ())]})}return e})();const OZ=["*"];let cE;function xx(e){return function kZ(){if(void 0===cE&&(cE=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(cE=e.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return cE}()?.createHTML(e)||e}function CF(e){return Error(`Unable to find icon with the name "${e}"`)}function SF(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function MF(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class vg{constructor(n,t,i){this.url=n,this.svgText=t,this.options=i}}let uE=(()=>{class e{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new vg(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const d=this._sanitizer.sanitize(Vs.HTML,r);if(!d)throw MF(r);const p=xx(d);return this._addSvgIconConfig(t,i,new vg("",p,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new vg(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(Vs.HTML,i);if(!s)throw MF(i);const d=xx(s);return this._addSvgIconSetConfig(t,new vg("",d,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(Vs.RESOURCE_URL,t);if(!i)throw SF(t);const r=this._cachedIconsByUrl.get(i);return r?Ln(dE(r)):this._loadSvgIconFromConfig(new vg(t,null)).pipe(ec(s=>this._cachedIconsByUrl.set(i,s)),Kt(s=>dE(s)))}getNamedSvgIcon(t,i=""){const r=IF(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const d=this._iconSetConfigs.get(i);return d?this._getSvgFromIconSetConfigs(t,d):W_(CF(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Ln(dE(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(Kt(i=>dE(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Ln(r):LO(i.filter(d=>!d.svgText).map(d=>this._loadSvgIconSetFromConfig(d).pipe(Kf(p=>{const x=`Loading icon set URL: ${this._sanitizer.sanitize(Vs.RESOURCE_URL,d.url)} failed: ${p.message}`;return this._errorHandler.handleError(new Error(x)),Ln(null)})))).pipe(Kt(()=>{const d=this._extractIconWithNameFromAnySet(t,i);if(!d)throw CF(t);return d}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const d=this._svgElementFromConfig(s),p=this._extractSvgIconFromSet(d,t,s.options);if(p)return p}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(ec(i=>t.svgText=i),Kt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Ln(null):this._fetchIcon(t).pipe(ec(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const d=s.cloneNode(!0);if(d.removeAttribute("id"),"svg"===d.nodeName.toLowerCase())return this._setSvgAttributes(d,r);if("symbol"===d.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(d),r);const p=this._svgElementFromString(xx("<svg></svg>"));return p.appendChild(d),this._setSvgAttributes(p,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(xx("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:d,value:p}=r[s];"id"!==d&&i.setAttribute(d,p)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function LZ(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const d=this._sanitizer.sanitize(Vs.RESOURCE_URL,i);if(!d)throw SF(i);const p=this._inProgressUrlFetches.get(d);if(p)return p;const v=this._httpClient.get(d,{responseType:"text",withCredentials:s}).pipe(Kt(x=>xx(x)),X_(()=>this._inProgressUrlFetches.delete(d)),Ai());return this._inProgressUrlFetches.set(d,v),v}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(IF(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return FZ(s)?new vg(s.url,null,s.options):new vg(s,null)}}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_g,8),Dt(YM),Dt(Ar,8),Dt(qc))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function dE(e){return e.cloneNode(!0)}function IF(e,n){return e+":"+n}function FZ(e){return!(!e.url||!e.options)}const BZ=dN(class{constructor(e){this._elementRef=e}}),zZ=new Pn("MAT_ICON_DEFAULT_OPTIONS"),VZ=new Pn("mat-icon-location",{providedIn:"root",factory:function UZ(){const e=Rn(Ar),n=e?e.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),DF=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],jZ=DF.map(e=>`[${e}]`).join(", "),GZ=/^url\(['"]?#(.*?)['"]?\)$/;let gD=(()=>{class e extends BZ{get inline(){return this._inline}set inline(t){this._inline=rf(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,s,d,p){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=d,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=xe.EMPTY,p&&(p.color&&(this.color=this.defaultColor=p.color),p.fontSet&&(this.fontSet=p.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(d=>{s.setAttribute(d.name,`url('${t}#${d.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(jZ),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)DF.forEach(d=>{const p=i[s],v=p.getAttribute(d),x=v?v.match(GZ):null;if(x){let M=r.get(p);M||(M=[],r.set(p,M)),M.push({name:d,value:x[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe($u(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Ks),Et(uE),Cf("aria-hidden"),Et(VZ),Et(qc),Et(zZ,8))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(i,r){2&i&&($a("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),Uu("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[zr],ngContentSelectors:OZ,decls:1,vars:0,template:function(i,r){1&i&&(Xh(),Kc(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return e})(),$Z=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,yc]})}return e})(),HZ=(()=>{class e{constructor(t){this.modalRef=t,this.size=new ef({5:new js(!1),10:new js(!1),15:new js(!1),20:new js(!1)}),this.work=new ef({office:new js(!1),remote:new js(!1)}),this.builder=new ef({tiles:new js(!1),painting:new js(!1),bath:new js(!1),hydraulics:new js(!1)}),this.it=new ef({printer:new js(!1),laptop:new js(!1),phone:new js(!1),network:new js(!1)}),this.mechanic=new ef({oil:new js(!1),filter:new js(!1),tire:new js(!1),diagnostics:new js(!1),geometry:new js(!1)}),this.close=close}reset(){this.size.reset(),this.work.reset(),this.builder.reset(),this.it.reset(),this.mechanic.reset()}save(){this.modalRef.close({size:this.getCorrespondingValues(this.size),work:this.getCorrespondingValues(this.work),builder:this.getCorrespondingValues(this.builder),it:this.getCorrespondingValues(this.it),mechanic:this.getCorrespondingValues(this.mechanic)})}closeModal(){this.modalRef.close()}getCorrespondingValues(t){const i={};return Object.keys(t.controls).forEach(r=>{i[r]=!0===t.get(r)?.value}),i}static#e=this.\u0275fac=function(i){return new(i||e)(Et(iF))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-filters"]],decls:110,vars:5,consts:[[1,"filters"],[1,"title"],[1,"close",3,"click"],[1,"section-container"],[1,"choice-container",3,"formGroup"],["type","checkbox","value","5","id","5","formControlName","5",2,"display","none"],["for","5",1,"choice"],["type","checkbox","value","10","id","10","formControlName","10",2,"display","none"],["for","10",1,"choice"],["type","checkbox","value","10","id","15","formControlName","15",2,"display","none"],["for","15",1,"choice"],["type","checkbox","value","20","id","20","formControlName","20",2,"display","none"],["for","20",1,"choice"],["type","checkbox","id","office","formControlName","office",2,"display","none"],["for","office",1,"choice"],["type","checkbox","id","remote","formControlName","remote",2,"display","none"],["for","remote",1,"choice"],[1,"categories-container"],[1,"categories"],[3,"formGroup"],[1,"choice-container"],["type","checkbox","id","tiles","formControlName","tiles",2,"display","none"],["for","tiles",1,"choice"],["type","checkbox","id","painting","formControlName","painting",2,"display","none"],["for","painting",1,"choice"],["type","checkbox","id","bath","formControlName","bath",2,"display","none"],["for","bath",1,"choice"],["type","checkbox","id","hydraulics","formControlName","hydraulics",2,"display","none"],["for","hydraulics",1,"choice"],["type","checkbox","id","printer","formControlName","printer",2,"display","none"],["for","printer",1,"choice"],["type","checkbox","id","laptop","formControlName","laptop",2,"display","none"],["for","laptop",1,"choice"],["type","checkbox","id","phone","formControlName","phone",2,"display","none"],["for","phone",1,"choice"],["type","checkbox","id","network","formControlName","network",2,"display","none"],["for","network",1,"choice"],["type","checkbox","id","oil","formControlName","oil",2,"display","none"],["for","oil",1,"choice"],["type","checkbox","id","filter","formControlName","filter",2,"display","none"],["for","filter",1,"choice"],["type","checkbox","id","tire","formControlName","tire",2,"display","none"],["for","tire",1,"choice"],["type","checkbox","id","diagnostics","formControlName","diagnostics",2,"display","none"],["for","diagnostics",1,"choice"],["type","checkbox","id","geometry","formControlName","geometry",2,"display","none"],["for","geometry",1,"choice"],[1,"buttons"],["value","Wyczy\u015b\u0107",1,"choice-clear",3,"click"],["value","Zastosuj",1,"choice-accept",3,"click"]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"div",1)(2,"h1"),An(3,"Filtry"),Yt(),jt(4,"mat-icon",2),vo("click",function(){return r.closeModal()}),An(5,"close"),Yt()(),jt(6,"div")(7,"div",3)(8,"div"),An(9," Obszar obecnej lokalizacji "),Yt(),jt(10,"div",4)(11,"div"),Oi(12,"input",5),jt(13,"label",6),An(14,"5"),Yt()(),jt(15,"div"),Oi(16,"input",7),jt(17,"label",8),An(18,"10"),Yt()(),jt(19,"div"),Oi(20,"input",9),jt(21,"label",10),An(22,"15"),Yt()(),jt(23,"div"),Oi(24,"input",11),jt(25,"label",12),An(26,"20"),Yt()()()(),jt(27,"div",3)(28,"div"),An(29," Tryb pracy "),Yt(),jt(30,"div",4)(31,"div"),Oi(32,"input",13),jt(33,"label",14),An(34,"Stacjonarna"),Yt()(),jt(35,"div"),Oi(36,"input",15),jt(37,"label",16),An(38,"Dojazdowa"),Yt()()()(),jt(39,"div",17)(40,"div",18),An(41,"Kategorie"),Yt(),jt(42,"div",19)(43,"div"),An(44,"Budowlanka"),Yt(),jt(45,"div",20)(46,"div"),Oi(47,"input",21),jt(48,"label",22),An(49,"P\u0142ytki"),Yt()(),jt(50,"div"),Oi(51,"input",23),jt(52,"label",24),An(53,"Malowanie"),Yt()(),jt(54,"div"),Oi(55,"input",25),jt(56,"label",26),An(57,"Monta\u017c wanny"),Yt()(),jt(58,"div"),Oi(59,"input",27),jt(60,"label",28),An(61,"Hydraulika"),Yt()()()(),jt(62,"div",19)(63,"div"),An(64,"IT"),Yt(),jt(65,"div",20)(66,"div"),Oi(67,"input",29),jt(68,"label",30),An(69,"Instalacja drukarki"),Yt()(),jt(70,"div"),Oi(71,"input",31),jt(72,"label",32),An(73,"Naprawa laptopa"),Yt()(),jt(74,"div"),Oi(75,"input",33),jt(76,"label",34),An(77,"Wymiana ekranu telefonu"),Yt()(),jt(78,"div"),Oi(79,"input",35),jt(80,"label",36),An(81,"Konfiguracja sieci"),Yt()()()(),jt(82,"div",19)(83,"div"),An(84,"Mechanicy"),Yt(),jt(85,"div",20)(86,"div"),Oi(87,"input",37),jt(88,"label",38),An(89,"Wymiana oleju"),Yt()(),jt(90,"div"),Oi(91,"input",39),jt(92,"label",40),An(93,"Wymiana filtr\xf3w"),Yt()(),jt(94,"div"),Oi(95,"input",41),jt(96,"label",42),An(97,"Wymiana opon"),Yt()(),jt(98,"div"),Oi(99,"input",43),jt(100,"label",44),An(101,"Diagnostyka"),Yt()(),Oi(102,"input",45),jt(103,"label",46),An(104,"Geometria"),Yt()()()(),jt(105,"div",47)(106,"button",48),vo("click",function(){return r.reset()}),An(107,"Wyczy\u015b\u0107"),Yt(),jt(108,"button",49),vo("click",function(){return r.save()}),An(109,"Zastosuj"),Yt()()()()),2&i&&(Gn(10),Di("formGroup",r.size),Gn(20),Di("formGroup",r.work),Gn(12),Di("formGroup",r.builder),Gn(20),Di("formGroup",r.it),Gn(20),Di("formGroup",r.mechanic))},dependencies:[QM,R0,dw,q_,B0,gD],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.filters[_ngcontent-%COMP%]{border:2px solid black;padding:30px;font-size:12px}.filters[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}.section-container[_ngcontent-%COMP%]{margin:1em 0 2em;border-bottom:1px solid #EAECF0;padding-bottom:10px}.choice-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin:1em 0}.choice[_ngcontent-%COMP%]{display:block;color:#7f56d9;border:2px solid #7f56d9;border-radius:10px;text-align:center;padding:5px 10px}input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{background:#7f56d9;border:1px solid inherit;color:#fff}.choice[_ngcontent-%COMP%]:hover{cursor:pointer}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px}.choice-clear[_ngcontent-%COMP%]{display:block;color:#000;background:#ffffff;border:2px solid #EAECF0;border-radius:10px;text-align:center;padding:15px 20px}.choice-clear[_ngcontent-%COMP%]:hover{background:#f9fafb;cursor:pointer}.choice-clear[_ngcontent-%COMP%]:active{background:#EAECF0}.choice-accept[_ngcontent-%COMP%]{display:block;color:#fff;background:#7f56d9;border:2px solid #7f56d9;border-radius:10px;text-align:center;padding:15px 20px}.choice-accept[_ngcontent-%COMP%]:hover{background:#6941c6;cursor:pointer}.choice-accept[_ngcontent-%COMP%]:active{background:#53389e}.categories-container[_ngcontent-%COMP%]{padding-bottom:1em}.categories[_ngcontent-%COMP%]{font-weight:700;margin-bottom:10px}.close[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}return e})(),uy=(()=>{class e{constructor(t,i){this.http=t,this.router=i,this.token=null,this.token=localStorage.getItem("token")}login(t,i){return new Promise((r,s)=>{this.http.post("/api/login",{username:t,password:i}).subscribe({next:d=>{this.token=d.token,localStorage.setItem("token",d.token),r(!0)},error:d=>{s(d)}})})}getToken(){return this.token}isLogged(){return null!==this.token}logout(){this.token=null,localStorage.removeItem("token"),this.router.navigate(["/login"])}canActivate(){return null!==this.token||this.router.parseUrl("/login")}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_g),Dt(bu))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),_D=(()=>{class e{constructor(t){this.breakpointObserver=t,this.isSmallScreen=new tn(!1),this.breakpointObserver.observe(["(max-width: 768px)"]).subscribe(i=>{this.isSmallScreen.next(i.matches)})}getIsSmallScreen(){return this.isSmallScreen.asObservable()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Gw))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class qZ{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(n=!1,t,i=!0,r){this._multiple=n,this._emitChanges=i,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Ct,t&&t.length&&(n?t.forEach(s=>this._markSelected(s)):this._markSelected(t[0]),this._selectedToEmit.length=0)}select(...n){this._verifyValueAssignment(n),n.forEach(i=>this._markSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}deselect(...n){this._verifyValueAssignment(n),n.forEach(i=>this._unmarkSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}setSelection(...n){this._verifyValueAssignment(n);const t=this.selected,i=new Set(n);n.forEach(s=>this._markSelected(s)),t.filter(s=>!i.has(s)).forEach(s=>this._unmarkSelected(s));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(n){return this.isSelected(n)?this.deselect(n):this.select(n)}clear(n=!0){this._unmarkAll();const t=this._hasQueuedChanges();return n&&this._emitChangeEvent(),t}isSelected(n){return this._selection.has(this._getConcreteValue(n))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(n){this._multiple&&this.selected&&this._selected.sort(n)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(n){n=this._getConcreteValue(n),this.isSelected(n)||(this._multiple||this._unmarkAll(),this.isSelected(n)||this._selection.add(n),this._emitChanges&&this._selectedToEmit.push(n))}_unmarkSelected(n){n=this._getConcreteValue(n),this.isSelected(n)&&(this._selection.delete(n),this._emitChanges&&this._deselectedToEmit.push(n))}_unmarkAll(){this.isEmpty()||this._selection.forEach(n=>this._unmarkSelected(n))}_verifyValueAssignment(n){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(n){if(this.compareWith){for(let t of this._selection)if(this.compareWith(n,t))return t;return n}return n}}const WZ=["button"],ZZ=["*"],TF=new Pn("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),AF=new Pn("MatButtonToggleGroup"),XZ={provide:hh,useExisting:nn(()=>OF),multi:!0};let PF=0;class RF{constructor(n,t){this.source=n,this.value=t}}let OF=(()=>{class e{get name(){return this._name}set name(t){this._name=t,this._markButtonsForCheck()}get vertical(){return this._vertical}set vertical(t){this._vertical=rf(t)}get value(){const t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t.map(i=>i.value):t[0]?t[0].value:void 0}set value(t){this._setSelectionByValue(t),this.valueChange.emit(this.value)}get selected(){const t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t:t[0]||null}get multiple(){return this._multiple}set multiple(t){this._multiple=rf(t),this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(t){this._disabled=rf(t),this._markButtonsForCheck()}constructor(t,i){this._changeDetector=t,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+PF++,this.valueChange=new a,this.change=new a,this.appearance=i&&i.appearance?i.appearance:"standard"}ngOnInit(){this._selectionModel=new qZ(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(t=>t.checked))}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}_emitChangeEvent(t){const i=new RF(t,this.value);this._rawValue=i.value,this._controlValueAccessorChangeFn(i.value),this.change.emit(i)}_syncButtonToggle(t,i,r=!1,s=!1){!this.multiple&&this.selected&&!t.checked&&(this.selected.checked=!1),this._selectionModel?i?this._selectionModel.select(t):this._selectionModel.deselect(t):s=!0,s?Promise.resolve().then(()=>this._updateModelValue(t,r)):this._updateModelValue(t,r)}_isSelected(t){return this._selectionModel&&this._selectionModel.isSelected(t)}_isPrechecked(t){return!(typeof this._rawValue>"u")&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(i=>null!=t.value&&i===t.value):t.value===this._rawValue)}_setSelectionByValue(t){this._rawValue=t,this._buttonToggles&&(this.multiple&&t?(Array.isArray(t),this._clearSelection(),t.forEach(i=>this._selectValue(i))):(this._clearSelection(),this._selectValue(t)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(t=>t.checked=!1)}_selectValue(t){const i=this._buttonToggles.find(r=>null!=r.value&&r.value===t);i&&(i.checked=!0,this._selectionModel.select(i))}_updateModelValue(t,i){i&&this._emitChangeEvent(t),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(t=>t._markForCheck())}static#e=this.\u0275fac=function(i){return new(i||e)(Et(sg),Et(TF,8))};static#t=this.\u0275dir=vn({type:e,selectors:[["mat-button-toggle-group"]],contentQueries:function(i,r,s){if(1&i&&JS(s,kF,5),2&i){let d;Kh(d=Qh())&&(r._buttonToggles=d)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(i,r){2&i&&($a("aria-disabled",r.disabled),Uu("mat-button-toggle-vertical",r.vertical)("mat-button-toggle-group-appearance-standard","standard"===r.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[ya([XZ,{provide:AF,useExisting:e}])]})}return e})();const YZ=hN(class{});let kF=(()=>{class e extends YZ{get buttonId(){return`${this.id}-button`}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(t){this._appearance=t}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(t){const i=rf(t);i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(t){this._disabled=rf(t)}constructor(t,i,r,s,d,p){super(),this._changeDetectorRef=i,this._elementRef=r,this._focusMonitor=s,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new a;const v=Number(d);this.tabIndex=v||0===v?v:null,this.buttonToggleGroup=t,this.appearance=p&&p.appearance?p.appearance:"standard"}ngOnInit(){const t=this.buttonToggleGroup;this.id=this.id||"mat-button-toggle-"+PF++,t&&(t._isPrechecked(this)?this.checked=!0:t._isSelected(this)!==this._checked&&t._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const t=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),t&&t._isSelected(this)&&t._syncButtonToggle(this,!1,!1,!0)}focus(t){this._buttonElement.nativeElement.focus(t)}_onButtonClick(){const t=!!this._isSingleSelector()||!this._checked;t!==this._checked&&(this._checked=t,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new RF(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this._isSingleSelector()?this.buttonToggleGroup.name:this.name||null}_isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static#e=this.\u0275fac=function(i){return new(i||e)(Et(AF,8),Et(sg),Et(Ks),Et(sx),Cf("tabindex"),Et(TF,8))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mat-button-toggle"]],viewQuery:function(i,r){if(1&i&&$p(WZ,5),2&i){let s;Kh(s=Qh())&&(r._buttonElement=s.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(i,r){1&i&&vo("focus",function(){return r.focus()}),2&i&&($a("aria-label",null)("aria-labelledby",null)("id",r.id)("name",null),Uu("mat-button-toggle-standalone",!r.buttonToggleGroup)("mat-button-toggle-checked",r.checked)("mat-button-toggle-disabled",r.disabled)("mat-button-toggle-appearance-standard","standard"===r.appearance))},inputs:{disableRipple:"disableRipple",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[zr],ngContentSelectors:ZZ,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(i,r){if(1&i&&(Xh(),jt(0,"button",0,1),vo("click",function(){return r._onButtonClick()}),jt(2,"span",2),Kc(3),Yt()(),Oi(4,"span",3)(5,"span",4)),2&i){const s=MS(1);Di("id",r.buttonId)("disabled",r.disabled||null),$a("tabindex",r.disabled?-1:r.tabIndex)("aria-pressed",r.checked)("name",r._getButtonName())("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby),Gn(5),Di("matRippleTrigger",s)("matRippleDisabled",r.disableRipple||r.disabled)}},dependencies:[vN],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{--mat-legacy-button-toggle-height:36px;--mat-legacy-button-toggle-shape:2px;--mat-legacy-button-toggle-focus-state-layer-opacity:1;position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);border-radius:var(--mat-legacy-button-toggle-shape)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{--mat-standard-button-toggle-shape:4px;--mat-standard-button-toggle-hover-state-layer-opacity:0.04;--mat-standard-button-toggle-focus-state-layer-opacity:0.12;border-radius:var(--mat-standard-button-toggle-shape);border:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-legacy-button-toggle-text-color);font-family:var(--mat-legacy-button-toggle-text-font)}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-legacy-button-toggle-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle-checked{color:var(--mat-legacy-button-toggle-selected-state-text-color);background-color:var(--mat-legacy-button-toggle-selected-state-background-color)}.mat-button-toggle-disabled{color:var(--mat-legacy-button-toggle-disabled-state-text-color);background-color:var(--mat-legacy-button-toggle-disabled-state-background-color)}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-legacy-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard{--mat-standard-button-toggle-shape:4px;--mat-standard-button-toggle-hover-state-layer-opacity:0.04;--mat-standard-button-toggle-focus-state-layer-opacity:0.12;color:var(--mat-standard-button-toggle-text-color);background-color:var(--mat-standard-button-toggle-background-color);font-family:var(--mat-standard-button-toggle-text-font)}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-standard-button-toggle-divider-color)}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-selected-state-text-color);background-color:var(--mat-standard-button-toggle-selected-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-standard-button-toggle-disabled-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-disabled-selected-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-standard-button-toggle-state-layer-color)}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-hover-state-layer-opacity)}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-focus-state-layer-opacity)}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-legacy-button-toggle-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-standard-button-toggle-height)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-legacy-button-toggle-state-layer-color)}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}"],encapsulation:2,changeDetection:0})}return e})(),KZ=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,xN,yc]})}return e})();var Eu=6371008.8,LF={centimeters:100*Eu,centimetres:100*Eu,degrees:Eu/111325,feet:3.28084*Eu,inches:39.37*Eu,kilometers:Eu/1e3,kilometres:Eu/1e3,meters:Eu,metres:Eu,miles:Eu/1609.344,millimeters:1e3*Eu,millimetres:1e3*Eu,nauticalmiles:Eu/1852,radians:1,yards:1.0936*Eu};function tp(e,n,t){void 0===t&&(t={});var i={type:"Feature"};return(0===t.id||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=n||{},i.geometry=e,i}function bx(e,n,t){if(void 0===t&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ED(e[0])||!ED(e[1]))throw new Error("coordinates must contain numbers");return tp({type:"Point",coordinates:e},n,t)}function wx(e,n,t){void 0===t&&(t={});for(var i=0,r=e;i<r.length;i++){var s=r[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var d=0;d<s[s.length-1].length;d++)if(s[s.length-1][d]!==s[0][d])throw new Error("First and last Position are not equivalent.")}return tp({type:"Polygon",coordinates:e},n,t)}function bD(e){return e%(2*Math.PI)*180/Math.PI}function wD(e){return e%360*Math.PI/180}function ED(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function Ex(e,n,t){if(null!==e)for(var i,r,s,d,p,v,x,L,M=0,R=0,F=e.type,Y="FeatureCollection"===F,X="Feature"===F,ye=Y?e.features.length:1,ae=0;ae<ye;ae++){p=(L=!!(x=Y?e.features[ae].geometry:X?e.geometry:e)&&"GeometryCollection"===x.type)?x.geometries.length:1;for(var Q=0;Q<p;Q++){var me=0,Xe=0;if(null!==(d=L?x.geometries[Q]:x)){v=d.coordinates;var nt=d.type;switch(M=!t||"Polygon"!==nt&&"MultiPolygon"!==nt?0:1,nt){case null:break;case"Point":if(!1===n(v,R,ae,me,Xe))return!1;R++,me++;break;case"LineString":case"MultiPoint":for(i=0;i<v.length;i++){if(!1===n(v[i],R,ae,me,Xe))return!1;R++,"MultiPoint"===nt&&me++}"LineString"===nt&&me++;break;case"Polygon":case"MultiLineString":for(i=0;i<v.length;i++){for(r=0;r<v[i].length-M;r++){if(!1===n(v[i][r],R,ae,me,Xe))return!1;R++}"MultiLineString"===nt&&me++,"Polygon"===nt&&Xe++}"Polygon"===nt&&me++;break;case"MultiPolygon":for(i=0;i<v.length;i++){for(Xe=0,r=0;r<v[i].length;r++){for(s=0;s<v[i][r].length-M;s++){if(!1===n(v[i][r][s],R,ae,me,Xe))return!1;R++}Xe++}me++}break;case"GeometryCollection":for(i=0;i<d.geometries.length;i++)if(!1===Ex(d.geometries[i],n,t))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function hE(e,n){!function BF(e,n){var t,i,r,s,d,p,v,x,M,R,L=0,F="FeatureCollection"===e.type,Y="Feature"===e.type,X=F?e.features.length:1;for(t=0;t<X;t++){for(x=F?e.features[t].properties:Y?e.properties:{},M=F?e.features[t].bbox:Y?e.bbox:void 0,R=F?e.features[t].id:Y?e.id:void 0,d=(v=!!(p=F?e.features[t].geometry:Y?e.geometry:e)&&"GeometryCollection"===p.type)?p.geometries.length:1,r=0;r<d;r++)if(null!==(s=v?p.geometries[r]:p))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===n(s,L,x,M,R))return!1;break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===n(s.geometries[i],L,x,M,R))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===n(null,L,x,M,R))return!1;L++}}(e,function(t,i,r,s,d){var v,p=null===t?null:t.type;switch(p){case null:case"Point":case"LineString":case"Polygon":return!1!==n(tp(t,r,{bbox:s,id:d}),i,0)&&void 0}switch(p){case"MultiPoint":v="Point";break;case"MultiLineString":v="LineString";break;case"MultiPolygon":v="Polygon"}for(var x=0;x<t.coordinates.length;x++)if(!1===n(tp({type:v,coordinates:t.coordinates[x]},r),i,x))return!1})}function CD(e){var n=[1/0,1/0,-1/0,-1/0];return Ex(e,function(t){n[0]>t[0]&&(n[0]=t[0]),n[1]>t[1]&&(n[1]=t[1]),n[2]<t[0]&&(n[2]=t[0]),n[3]<t[1]&&(n[3]=t[1])}),n}CD.default=CD;const sX=CD;function zF(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function GF(e,n,t){if(void 0===t&&(t={}),!e)throw new Error("point is required");if(!n)throw new Error("polygon is required");var i=zF(e),r=function cX(e){return"Feature"===e.type?e.geometry:e}(n),s=r.type,d=n.bbox,p=r.coordinates;if(d&&!1===function vX(e,n){return n[0]<=e[0]&&n[1]<=e[1]&&n[2]>=e[0]&&n[3]>=e[1]}(i,d))return!1;"Polygon"===s&&(p=[p]);for(var v=!1,x=0;x<p.length&&!v;x++)if($F(i,p[x][0],t.ignoreBoundary)){for(var M=!1,R=1;R<p[x].length&&!M;)$F(i,p[x][R],!t.ignoreBoundary)&&(M=!0),R++;M||(v=!0)}return v}function $F(e,n,t){var i=!1;n[0][0]===n[n.length-1][0]&&n[0][1]===n[n.length-1][1]&&(n=n.slice(0,n.length-1));for(var r=0,s=n.length-1;r<n.length;s=r++){var d=n[r][0],p=n[r][1],v=n[s][0],x=n[s][1];if(e[1]*(d-v)+p*(v-e[0])+x*(e[0]-d)==0&&(d-e[0])*(v-e[0])<=0&&(p-e[1])*(x-e[1])<=0)return!t;p>e[1]!=x>e[1]&&e[0]<(v-d)*(e[1]-p)/(x-p)+d&&(i=!i)}return i}Ve(4772),Ve(3664);var qF=new ArrayBuffer(16);new Float64Array(qF),new Uint32Array(qF),Ve(7861),function(){function e(n){this.points=n.points||[],this.duration=n.duration||1e4,this.sharpness=n.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=n.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(t=0;t<this.length-1;t++){var i=this.points[t],r=this.points[t+1];this.centers.push({x:(i.x+r.x)/2,y:(i.y+r.y)/2,z:(i.z+r.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),t=0;t<this.centers.length-1;t++){var s=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,d=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,p=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+s),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+d),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+p)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+s),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+d),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+p)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}e.prototype.cacheSteps=function(n){var t=[],i=this.pos(0);t.push(0);for(var r=0;r<this.duration;r+=10){var s=this.pos(r);Math.sqrt((s.x-i.x)*(s.x-i.x)+(s.y-i.y)*(s.y-i.y)+(s.z-i.z)*(s.z-i.z))>n&&(t.push(r),i=s)}return t},e.prototype.vector=function(n){var t=this.pos(n+10),i=this.pos(n-10);return{angle:180*Math.atan2(t.y-i.y,t.x-i.x)/3.14,speed:Math.sqrt((i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y)+(i.z-t.z)*(i.z-t.z))}},e.prototype.pos=function(n){var t=n-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);var i=t/this.duration;if(i>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*i);return function LX(e,n,t,i,r){var s=function NX(e){var n=e*e;return[n*e,3*n*(1-e),3*e*(1-e)*(1-e),(1-e)*(1-e)*(1-e)]}(e);return{x:r.x*s[0]+i.x*s[1]+t.x*s[2]+n.x*s[3],y:r.y*s[0]+i.y*s[1]+t.y*s[2]+n.y*s[3],z:r.z*s[0]+i.z*s[1]+t.z*s[2]+n.z*s[3]}}((this.length-1)*i-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])}}();function UX(e,n,t,i){void 0===i&&(i={});var r=zF(e),s=wD(r[0]),d=wD(r[1]),p=wD(t),v=function xD(e,n){void 0===n&&(n="kilometers");var t=LF[n];if(!t)throw new Error(n+" units is invalid");return e/t}(n,i.units),x=Math.asin(Math.sin(d)*Math.cos(v)+Math.cos(d)*Math.sin(v)*Math.cos(p));return bx([bD(s+Math.atan2(Math.sin(p)*Math.sin(v)*Math.cos(d),Math.cos(v)-Math.sin(d)*Math.sin(x))),bD(x)],i.properties)}Ve(9145),Ve(5665);var cB=Math.PI/180,uB=180/Math.PI,Mx=function(e,n){this.lon=e,this.lat=n,this.x=cB*e,this.y=cB*n};Mx.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Mx.prototype.antipode=function(){return new Mx(this.lon<0?180+this.lon:-1*(180-this.lon),-1*this.lat)};var dB=function(){this.coords=[],this.length=0};dB.prototype.move_to=function(e){this.length++,this.coords.push(e)};var RD=function(e){this.properties=e||{},this.geometries=[]};RD.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],n=0;n<this.geometries.length;n++)e.push(this.geometries[n].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}},RD.prototype.wkt=function(){for(var e="",n="LINESTRING(",t=function(s){n+=s[0]+" "+s[1]+","},i=0;i<this.geometries.length;i++){if(0===this.geometries[i].coords.length)return"LINESTRING(empty)";this.geometries[i].coords.forEach(t),e+=n.substring(0,n.length-1)+")"}return e};var OD=function(e,n,t){if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!n||void 0===n.x||void 0===n.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Mx(e.x,e.y),this.end=new Mx(n.x,n.y),this.properties=t||{};var i=this.start.x-this.end.x,s=Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(s)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+n.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+n)};OD.prototype.interpolate=function(e){var n=Math.sin((1-e)*this.g)/Math.sin(this.g),t=Math.sin(e*this.g)/Math.sin(this.g),i=n*Math.cos(this.start.y)*Math.cos(this.start.x)+t*Math.cos(this.end.y)*Math.cos(this.end.x),r=n*Math.cos(this.start.y)*Math.sin(this.start.x)+t*Math.cos(this.end.y)*Math.sin(this.end.x),s=n*Math.sin(this.start.y)+t*Math.sin(this.end.y),d=uB*Math.atan2(s,Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));return[uB*Math.atan2(r,i),d]},OD.prototype.Arc=function(e,n){var t=[];if(!e||e<=2)t.push([this.start.lon,this.start.lat]),t.push([this.end.lon,this.end.lat]);else for(var i=1/(e-1),r=0;r<e;++r){var d=this.interpolate(i*r);t.push(d)}for(var p=!1,v=0,x=n&&n.offset?n.offset:10,M=180-x,R=-180+x,L=360-x,F=1;F<t.length;++F){var Y=t[F-1][0],X=t[F][0],ye=Math.abs(X-Y);ye>L&&(X>M&&Y<R||Y>M&&X<R)?p=!0:ye>v&&(v=ye)}var ae=[];if(p&&v<x){var Q=[];ae.push(Q);for(var me=0;me<t.length;++me){var Xe=parseFloat(t[me][0]);if(me>0&&Math.abs(Xe-t[me-1][0])>L){var nt=parseFloat(t[me-1][0]),wt=parseFloat(t[me-1][1]),xt=parseFloat(t[me][0]),Ft=parseFloat(t[me][1]);if(nt>-180&&nt<R&&180===xt&&me+1<t.length&&t[me-1][0]>-180&&t[me-1][0]<R){Q.push([-180,t[me][1]]),me++,Q.push([t[me][0],t[me][1]]);continue}if(nt>M&&nt<180&&-180===xt&&me+1<t.length&&t[me-1][0]>M&&t[me-1][0]<180){Q.push([180,t[me][1]]),me++,Q.push([t[me][0],t[me][1]]);continue}if(nt<R&&xt>M){var Qe=nt;nt=xt,xt=Qe;var vi=wt;wt=Ft,Ft=vi}if(nt>M&&xt<R&&(xt+=360),nt<=180&&xt>=180&&nt<xt){var ri=(180-nt)/(xt-nt),Ui=ri*Ft+(1-ri)*wt;Q.push([t[me-1][0]>M?180:-180,Ui]),(Q=[]).push([t[me-1][0]>M?-180:180,Ui]),ae.push(Q)}else ae.push(Q=[]);Q.push([Xe,t[me][1]])}else Q.push([t[me][0],t[me][1]])}}else{var Xi=[];ae.push(Xi);for(var $n=0;$n<t.length;++$n)Xi.push([t[$n][0],t[$n][1]])}for(var Li=new RD(this.properties),dn=0;dn<ae.length;++dn){var Yn=new dB;Li.geometries.push(Yn);for(var Kn=ae[dn],li=0;li<Kn.length;++li)Yn.move_to(Kn[li])}return Li},Ve(3970);var jr=[],Gr=[],$r=[],Hr=[],qr=[],Wr=[],Zr=[],Xr=[],Yr=[],Kr=[],Qr=[],Jr=[],eo=[],to=[],no=[],io=[],ro=[],oo=[],so=[],ao=[],lo=[],co=[],uo=[],ho=[];Zr[85]=Kr[85]=-1,Xr[85]=Qr[85]=0,Yr[85]=Jr[85]=1,so[85]=co[85]=1,ao[85]=uo[85]=0,lo[85]=ho[85]=1,jr[85]=Hr[85]=0,Gr[85]=qr[85]=-1,$r[85]=no[85]=0,io[85]=eo[85]=0,ro[85]=to[85]=1,Wr[85]=oo[85]=1,co[1]=co[169]=0,uo[1]=uo[169]=-1,ho[1]=ho[169]=0,eo[1]=eo[169]=-1,to[1]=to[169]=0,no[1]=no[169]=0,Kr[4]=Kr[166]=0,Qr[4]=Qr[166]=-1,Jr[4]=Jr[166]=1,io[4]=io[166]=1,ro[4]=ro[166]=0,oo[4]=oo[166]=0,Zr[16]=Zr[154]=0,Xr[16]=Xr[154]=1,Yr[16]=Yr[154]=1,Hr[16]=Hr[154]=1,qr[16]=qr[154]=0,Wr[16]=Wr[154]=1,so[64]=so[106]=0,ao[64]=ao[106]=1,lo[64]=lo[106]=0,jr[64]=jr[106]=-1,Gr[64]=Gr[106]=0,$r[64]=$r[106]=1,so[2]=so[168]=0,ao[2]=ao[168]=-1,lo[2]=lo[168]=1,co[2]=co[168]=0,uo[2]=uo[168]=-1,ho[2]=ho[168]=0,eo[2]=eo[168]=-1,to[2]=to[168]=0,no[2]=no[168]=0,io[2]=io[168]=-1,ro[2]=ro[168]=0,oo[2]=oo[168]=1,Zr[8]=Zr[162]=0,Xr[8]=Xr[162]=-1,Yr[8]=Yr[162]=0,Kr[8]=Kr[162]=0,Qr[8]=Qr[162]=-1,Jr[8]=Jr[162]=1,eo[8]=eo[162]=1,to[8]=to[162]=0,no[8]=no[162]=1,io[8]=io[162]=1,ro[8]=ro[162]=0,oo[8]=oo[162]=0,Zr[32]=Zr[138]=0,Xr[32]=Xr[138]=1,Yr[32]=Yr[138]=1,Kr[32]=Kr[138]=0,Qr[32]=Qr[138]=1,Jr[32]=Jr[138]=0,jr[32]=jr[138]=1,Gr[32]=Gr[138]=0,$r[32]=$r[138]=0,Hr[32]=Hr[138]=1,qr[32]=qr[138]=0,Wr[32]=Wr[138]=1,co[128]=co[42]=0,uo[128]=uo[42]=1,ho[128]=ho[42]=1,so[128]=so[42]=0,ao[128]=ao[42]=1,lo[128]=lo[42]=0,jr[128]=jr[42]=-1,Gr[128]=Gr[42]=0,$r[128]=$r[42]=1,Hr[128]=Hr[42]=-1,qr[128]=qr[42]=0,Wr[128]=Wr[42]=0,Kr[5]=Kr[165]=-1,Qr[5]=Qr[165]=0,Jr[5]=Jr[165]=0,co[5]=co[165]=1,uo[5]=uo[165]=0,ho[5]=ho[165]=0,io[20]=io[150]=0,ro[20]=ro[150]=1,oo[20]=oo[150]=1,Hr[20]=Hr[150]=0,qr[20]=qr[150]=-1,Wr[20]=Wr[150]=1,Zr[80]=Zr[90]=-1,Xr[80]=Xr[90]=0,Yr[80]=Yr[90]=1,so[80]=so[90]=1,ao[80]=ao[90]=0,lo[80]=lo[90]=1,eo[65]=eo[105]=0,to[65]=to[105]=1,no[65]=no[105]=0,jr[65]=jr[105]=0,Gr[65]=Gr[105]=-1,$r[65]=$r[105]=0,Zr[160]=Zr[10]=-1,Xr[160]=Xr[10]=0,Yr[160]=Yr[10]=1,Kr[160]=Kr[10]=-1,Qr[160]=Qr[10]=0,Jr[160]=Jr[10]=0,co[160]=co[10]=1,uo[160]=uo[10]=0,ho[160]=ho[10]=0,so[160]=so[10]=1,ao[160]=ao[10]=0,lo[160]=lo[10]=1,io[130]=io[40]=0,ro[130]=ro[40]=1,oo[130]=oo[40]=1,eo[130]=eo[40]=0,to[130]=to[40]=1,no[130]=no[40]=0,jr[130]=jr[40]=0,Gr[130]=Gr[40]=-1,$r[130]=$r[40]=0,Hr[130]=Hr[40]=0,qr[130]=qr[40]=-1,Wr[130]=Wr[40]=1,Kr[37]=Kr[133]=0,Qr[37]=Qr[133]=1,Jr[37]=Jr[133]=1,co[37]=co[133]=0,uo[37]=uo[133]=1,ho[37]=ho[133]=0,jr[37]=jr[133]=-1,Gr[37]=Gr[133]=0,$r[37]=$r[133]=0,Hr[37]=Hr[133]=1,qr[37]=qr[133]=0,Wr[37]=Wr[133]=0,io[148]=io[22]=-1,ro[148]=ro[22]=0,oo[148]=oo[22]=0,co[148]=co[22]=0,uo[148]=uo[22]=-1,ho[148]=ho[22]=1,so[148]=so[22]=0,ao[148]=ao[22]=1,lo[148]=lo[22]=1,Hr[148]=Hr[22]=-1,qr[148]=qr[22]=0,Wr[148]=Wr[22]=1,Zr[82]=Zr[88]=0,Xr[82]=Xr[88]=-1,Yr[82]=Yr[88]=1,io[82]=io[88]=1,ro[82]=ro[88]=0,oo[82]=oo[88]=1,eo[82]=eo[88]=-1,to[82]=to[88]=0,no[82]=no[88]=1,so[82]=so[88]=0,ao[82]=ao[88]=-1,lo[82]=lo[88]=0,Zr[73]=Zr[97]=0,Xr[73]=Xr[97]=1,Yr[73]=Yr[97]=0,Kr[73]=Kr[97]=0,Qr[73]=Qr[97]=-1,Jr[73]=Jr[97]=0,eo[73]=eo[97]=1,to[73]=to[97]=0,no[73]=no[97]=0,jr[73]=jr[97]=1,Gr[73]=Gr[97]=0,$r[73]=$r[97]=1,Zr[145]=Zr[25]=0,Xr[145]=Xr[25]=-1,Yr[145]=Yr[25]=0,eo[145]=eo[25]=1,to[145]=to[25]=0,no[145]=no[25]=1,co[145]=co[25]=0,uo[145]=uo[25]=1,ho[145]=ho[25]=1,Hr[145]=Hr[25]=-1,qr[145]=qr[25]=0,Wr[145]=Wr[25]=0,Kr[70]=Kr[100]=0,Qr[70]=Qr[100]=1,Jr[70]=Jr[100]=0,io[70]=io[100]=-1,ro[70]=ro[100]=0,oo[70]=oo[100]=1,so[70]=so[100]=0,ao[70]=ao[100]=-1,lo[70]=lo[100]=1,jr[70]=jr[100]=1,Gr[70]=Gr[100]=0,$r[70]=$r[100]=0,Kr[101]=Kr[69]=0,Qr[101]=Qr[69]=1,Jr[101]=Jr[69]=0,jr[101]=jr[69]=1,Gr[101]=Gr[69]=0,$r[101]=$r[69]=0,co[149]=co[21]=0,uo[149]=uo[21]=1,ho[149]=ho[21]=1,Hr[149]=Hr[21]=-1,qr[149]=qr[21]=0,Wr[149]=Wr[21]=0,io[86]=io[84]=-1,ro[86]=ro[84]=0,oo[86]=oo[84]=1,so[86]=so[84]=0,ao[86]=ao[84]=-1,lo[86]=lo[84]=1,Zr[89]=Zr[81]=0,Xr[89]=Xr[81]=-1,Yr[89]=Yr[81]=0,eo[89]=eo[81]=1,to[89]=to[81]=0,no[89]=no[81]=1,Zr[96]=Zr[74]=0,Xr[96]=Xr[74]=1,Yr[96]=Yr[74]=0,Kr[96]=Kr[74]=-1,Qr[96]=Qr[74]=0,Jr[96]=Jr[74]=1,so[96]=so[74]=1,ao[96]=ao[74]=0,lo[96]=lo[74]=0,jr[96]=jr[74]=1,Gr[96]=Gr[74]=0,$r[96]=$r[74]=1,Zr[24]=Zr[146]=0,Xr[24]=Xr[146]=-1,Yr[24]=Yr[146]=1,io[24]=io[146]=1,ro[24]=ro[146]=0,oo[24]=oo[146]=1,eo[24]=eo[146]=0,to[24]=to[146]=1,no[24]=no[146]=1,Hr[24]=Hr[146]=0,qr[24]=qr[146]=-1,Wr[24]=Wr[146]=0,Kr[6]=Kr[164]=-1,Qr[6]=Qr[164]=0,Jr[6]=Jr[164]=1,io[6]=io[164]=-1,ro[6]=ro[164]=0,oo[6]=oo[164]=0,co[6]=co[164]=0,uo[6]=uo[164]=-1,ho[6]=ho[164]=1,so[6]=so[164]=1,ao[6]=ao[164]=0,lo[6]=lo[164]=0,eo[129]=eo[41]=0,to[129]=to[41]=1,no[129]=no[41]=1,co[129]=co[41]=0,uo[129]=uo[41]=1,ho[129]=ho[41]=0,jr[129]=jr[41]=-1,Gr[129]=Gr[41]=0,$r[129]=$r[41]=0,Hr[129]=Hr[41]=0,qr[129]=qr[41]=-1,Wr[129]=Wr[41]=0,io[66]=io[104]=0,ro[66]=ro[104]=1,oo[66]=oo[104]=0,eo[66]=eo[104]=-1,to[66]=to[104]=0,no[66]=no[104]=1,so[66]=so[104]=0,ao[66]=ao[104]=-1,lo[66]=lo[104]=0,jr[66]=jr[104]=0,Gr[66]=Gr[104]=-1,$r[66]=$r[104]=1,Zr[144]=Zr[26]=-1,Xr[144]=Xr[26]=0,Yr[144]=Yr[26]=0,co[144]=co[26]=1,uo[144]=uo[26]=0,ho[144]=ho[26]=1,so[144]=so[26]=0,ao[144]=ao[26]=1,lo[144]=lo[26]=1,Hr[144]=Hr[26]=-1,qr[144]=qr[26]=0,Wr[144]=Wr[26]=1,Kr[36]=Kr[134]=0,Qr[36]=Qr[134]=1,Jr[36]=Jr[134]=1,io[36]=io[134]=0,ro[36]=ro[134]=1,oo[36]=oo[134]=0,jr[36]=jr[134]=0,Gr[36]=Gr[134]=-1,$r[36]=$r[134]=1,Hr[36]=Hr[134]=1,qr[36]=qr[134]=0,Wr[36]=Wr[134]=0,Zr[9]=Zr[161]=-1,Xr[9]=Xr[161]=0,Yr[9]=Yr[161]=0,Kr[9]=Kr[161]=0,Qr[9]=Qr[161]=-1,Jr[9]=Jr[161]=0,eo[9]=eo[161]=1,to[9]=to[161]=0,no[9]=no[161]=0,co[9]=co[161]=1,uo[9]=uo[161]=0,ho[9]=ho[161]=1,Zr[136]=0,Xr[136]=1,Yr[136]=1,Kr[136]=0,Qr[136]=1,Jr[136]=0,io[136]=-1,ro[136]=0,oo[136]=1,eo[136]=-1,to[136]=0,no[136]=0,co[136]=0,uo[136]=-1,ho[136]=0,so[136]=0,ao[136]=-1,lo[136]=1,jr[136]=1,Gr[136]=0,$r[136]=0,Hr[136]=1,qr[136]=0,Wr[136]=1,Zr[34]=0,Xr[34]=-1,Yr[34]=0,Kr[34]=0,Qr[34]=-1,Jr[34]=1,io[34]=1,ro[34]=0,oo[34]=0,eo[34]=1,to[34]=0,no[34]=1,co[34]=0,uo[34]=1,ho[34]=1,so[34]=0,ao[34]=1,lo[34]=0,jr[34]=-1,Gr[34]=0,$r[34]=1,Hr[34]=-1,qr[34]=0,Wr[34]=0,Zr[35]=0,Xr[35]=1,Yr[35]=1,Kr[35]=0,Qr[35]=-1,Jr[35]=1,io[35]=1,ro[35]=0,oo[35]=0,eo[35]=-1,to[35]=0,no[35]=0,co[35]=0,uo[35]=-1,ho[35]=0,so[35]=0,ao[35]=1,lo[35]=0,jr[35]=-1,Gr[35]=0,$r[35]=1,Hr[35]=1,qr[35]=0,Wr[35]=1,Zr[153]=0,Xr[153]=1,Yr[153]=1,eo[153]=-1,to[153]=0,no[153]=0,co[153]=0,uo[153]=-1,ho[153]=0,Hr[153]=1,qr[153]=0,Wr[153]=1,Kr[102]=0,Qr[102]=-1,Jr[102]=1,io[102]=1,ro[102]=0,oo[102]=0,so[102]=0,ao[102]=1,lo[102]=0,jr[102]=-1,Gr[102]=0,$r[102]=1,Zr[155]=0,Xr[155]=-1,Yr[155]=0,eo[155]=1,to[155]=0,no[155]=1,co[155]=0,uo[155]=1,ho[155]=1,Hr[155]=-1,qr[155]=0,Wr[155]=0,Kr[103]=0,Qr[103]=1,Jr[103]=0,io[103]=-1,ro[103]=0,oo[103]=1,so[103]=0,ao[103]=-1,lo[103]=1,jr[103]=1,Gr[103]=0,$r[103]=0,Zr[152]=0,Xr[152]=1,Yr[152]=1,io[152]=-1,ro[152]=0,oo[152]=1,eo[152]=-1,to[152]=0,no[152]=0,co[152]=0,uo[152]=-1,ho[152]=0,so[152]=0,ao[152]=-1,lo[152]=1,Hr[152]=1,qr[152]=0,Wr[152]=1,Zr[156]=0,Xr[156]=-1,Yr[156]=1,io[156]=1,ro[156]=0,oo[156]=1,eo[156]=-1,to[156]=0,no[156]=0,co[156]=0,uo[156]=-1,ho[156]=0,so[156]=0,ao[156]=1,lo[156]=1,Hr[156]=-1,qr[156]=0,Wr[156]=1,Zr[137]=0,Xr[137]=1,Yr[137]=1,Kr[137]=0,Qr[137]=1,Jr[137]=0,eo[137]=-1,to[137]=0,no[137]=0,co[137]=0,uo[137]=-1,ho[137]=0,jr[137]=1,Gr[137]=0,$r[137]=0,Hr[137]=1,qr[137]=0,Wr[137]=1,Zr[139]=0,Xr[139]=1,Yr[139]=1,Kr[139]=0,Qr[139]=-1,Jr[139]=0,eo[139]=1,to[139]=0,no[139]=0,co[139]=0,uo[139]=1,ho[139]=0,jr[139]=-1,Gr[139]=0,$r[139]=0,Hr[139]=1,qr[139]=0,Wr[139]=1,Zr[98]=0,Xr[98]=-1,Yr[98]=0,Kr[98]=0,Qr[98]=-1,Jr[98]=1,io[98]=1,ro[98]=0,oo[98]=0,eo[98]=1,to[98]=0,no[98]=1,so[98]=0,ao[98]=1,lo[98]=0,jr[98]=-1,Gr[98]=0,$r[98]=1,Zr[99]=0,Xr[99]=1,Yr[99]=0,Kr[99]=0,Qr[99]=-1,Jr[99]=1,io[99]=1,ro[99]=0,oo[99]=0,eo[99]=-1,to[99]=0,no[99]=1,so[99]=0,ao[99]=-1,lo[99]=0,jr[99]=1,Gr[99]=0,$r[99]=1,Kr[38]=0,Qr[38]=-1,Jr[38]=1,io[38]=1,ro[38]=0,oo[38]=0,co[38]=0,uo[38]=1,ho[38]=1,so[38]=0,ao[38]=1,lo[38]=0,jr[38]=-1,Gr[38]=0,$r[38]=1,Hr[38]=-1,qr[38]=0,Wr[38]=0,Kr[39]=0,Qr[39]=1,Jr[39]=1,io[39]=-1,ro[39]=0,oo[39]=0,co[39]=0,uo[39]=-1,ho[39]=1,so[39]=0,ao[39]=1,lo[39]=0,jr[39]=-1,Gr[39]=0,$r[39]=1,Hr[39]=1,qr[39]=0,Wr[39]=0;var FD=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},BD=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},zD=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},VD=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},UD=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},jD=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},GD=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},$D=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},fi=[],ui=[],zi=[],Ti=[],tr=[],Zi=[],fo=[],xo=[];Ti[1]=tr[1]=18,Ti[169]=tr[169]=18,zi[4]=ui[4]=12,zi[166]=ui[166]=12,fi[16]=xo[16]=4,fi[154]=xo[154]=4,Zi[64]=fo[64]=22,Zi[106]=fo[106]=22,zi[2]=Zi[2]=17,Ti[2]=tr[2]=18,zi[168]=Zi[168]=17,Ti[168]=tr[168]=18,fi[8]=Ti[8]=9,ui[8]=zi[8]=12,fi[162]=Ti[162]=9,ui[162]=zi[162]=12,fi[32]=xo[32]=4,ui[32]=fo[32]=1,fi[138]=xo[138]=4,ui[138]=fo[138]=1,tr[128]=xo[128]=21,Zi[128]=fo[128]=22,tr[42]=xo[42]=21,Zi[42]=fo[42]=22,ui[5]=tr[5]=14,ui[165]=tr[165]=14,zi[20]=xo[20]=6,zi[150]=xo[150]=6,fi[80]=Zi[80]=11,fi[90]=Zi[90]=11,Ti[65]=fo[65]=3,Ti[105]=fo[105]=3,fi[160]=Zi[160]=11,ui[160]=tr[160]=14,fi[10]=Zi[10]=11,ui[10]=tr[10]=14,zi[130]=xo[130]=6,Ti[130]=fo[130]=3,zi[40]=xo[40]=6,Ti[40]=fo[40]=3,ui[101]=fo[101]=1,ui[69]=fo[69]=1,tr[149]=xo[149]=21,tr[21]=xo[21]=21,zi[86]=Zi[86]=17,zi[84]=Zi[84]=17,fi[89]=Ti[89]=9,fi[81]=Ti[81]=9,fi[96]=fo[96]=0,ui[96]=Zi[96]=15,fi[74]=fo[74]=0,ui[74]=Zi[74]=15,fi[24]=zi[24]=8,Ti[24]=xo[24]=7,fi[146]=zi[146]=8,Ti[146]=xo[146]=7,ui[6]=Zi[6]=15,zi[6]=tr[6]=16,ui[164]=Zi[164]=15,zi[164]=tr[164]=16,Ti[129]=xo[129]=7,tr[129]=fo[129]=20,Ti[41]=xo[41]=7,tr[41]=fo[41]=20,zi[66]=fo[66]=2,Ti[66]=Zi[66]=19,zi[104]=fo[104]=2,Ti[104]=Zi[104]=19,fi[144]=tr[144]=10,Zi[144]=xo[144]=23,fi[26]=tr[26]=10,Zi[26]=xo[26]=23,ui[36]=xo[36]=5,zi[36]=fo[36]=2,ui[134]=xo[134]=5,zi[134]=fo[134]=2,fi[9]=tr[9]=10,ui[9]=Ti[9]=13,fi[161]=tr[161]=10,ui[161]=Ti[161]=13,ui[37]=xo[37]=5,tr[37]=fo[37]=20,ui[133]=xo[133]=5,tr[133]=fo[133]=20,zi[148]=tr[148]=16,Zi[148]=xo[148]=23,zi[22]=tr[22]=16,Zi[22]=xo[22]=23,fi[82]=zi[82]=8,Ti[82]=Zi[82]=19,fi[88]=zi[88]=8,Ti[88]=Zi[88]=19,fi[73]=fo[73]=0,ui[73]=Ti[73]=13,fi[97]=fo[97]=0,ui[97]=Ti[97]=13,fi[145]=Ti[145]=9,tr[145]=xo[145]=21,fi[25]=Ti[25]=9,tr[25]=xo[25]=21,ui[70]=fo[70]=1,zi[70]=Zi[70]=17,ui[100]=fo[100]=1,zi[100]=Zi[100]=17,fi[34]=Ti[34]=9,ui[34]=zi[34]=12,tr[34]=xo[34]=21,Zi[34]=fo[34]=22,fi[136]=xo[136]=4,ui[136]=fo[136]=1,zi[136]=Zi[136]=17,Ti[136]=tr[136]=18,fi[35]=xo[35]=4,ui[35]=zi[35]=12,Ti[35]=tr[35]=18,Zi[35]=fo[35]=22,fi[153]=xo[153]=4,Ti[153]=tr[153]=18,ui[102]=zi[102]=12,Zi[102]=fo[102]=22,fi[155]=Ti[155]=9,tr[155]=xo[155]=23,ui[103]=fo[103]=1,zi[103]=Zi[103]=17,fi[152]=xo[152]=4,zi[152]=Zi[152]=17,Ti[152]=tr[152]=18,fi[156]=zi[156]=8,Ti[156]=tr[156]=18,Zi[156]=xo[156]=23,fi[137]=xo[137]=4,ui[137]=fo[137]=1,Ti[137]=tr[137]=18,fi[139]=xo[139]=4,ui[139]=Ti[139]=13,tr[139]=fo[139]=20,fi[98]=Ti[98]=9,ui[98]=zi[98]=12,Zi[98]=fo[98]=22,fi[99]=fo[99]=0,ui[99]=zi[99]=12,Ti[99]=Zi[99]=19,ui[38]=zi[38]=12,tr[38]=xo[38]=21,Zi[38]=fo[38]=22,ui[39]=xo[39]=5,zi[39]=tr[39]=16,Zi[39]=fo[39]=22;var ni=[];function WD(e,n,t){return function IK(e){return(e>0)-(e<0)||+e}((n[0]-e[0])*(t[1]-n[1])-(t[0]-n[0])*(n[1]-e[1]))}function IB(e,n){return n.geometry.coordinates[0].every(function(t){return GF(bx(t),e)})}ni[1]=ni[169]=FD,ni[4]=ni[166]=BD,ni[16]=ni[154]=zD,ni[64]=ni[106]=VD,ni[168]=ni[2]=UD,ni[162]=ni[8]=jD,ni[138]=ni[32]=GD,ni[42]=ni[128]=$D,ni[5]=ni[165]=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},ni[20]=ni[150]=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},ni[80]=ni[90]=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},ni[65]=ni[105]=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},ni[160]=ni[10]=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},ni[130]=ni[40]=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},ni[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},ni[101]=ni[69]=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},ni[149]=ni[21]=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},ni[86]=ni[84]=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},ni[89]=ni[81]=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},ni[96]=ni[74]=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},ni[24]=ni[146]=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},ni[6]=ni[164]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},ni[129]=ni[41]=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},ni[66]=ni[104]=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},ni[144]=ni[26]=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},ni[36]=ni[134]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},ni[9]=ni[161]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},ni[37]=ni[133]=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},ni[148]=ni[22]=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},ni[82]=ni[88]=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},ni[73]=ni[97]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},ni[145]=ni[25]=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},ni[70]=ni[100]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},ni[34]=function(e){return[$D(e),jD(e)]},ni[35]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},ni[136]=function(e){return[GD(e),UD(e)]},ni[153]=function(e){return[zD(e),FD(e)]},ni[102]=function(e){return[BD(e),VD(e)]},ni[155]=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},ni[103]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},ni[152]=function(e){return[zD(e),UD(e)]},ni[156]=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},ni[137]=function(e){return[GD(e),FD(e)]},ni[139]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},ni[98]=function(e){return[jD(e),VD(e)]},ni[99]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},ni[38]=function(e){return[BD(e),$D(e)]},ni[39]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]};const DB=function(){function e(n){this.id=e.buildId(n),this.coordinates=n,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return e.buildId=function(n){return n.join(",")},e.prototype.removeInnerEdge=function(n){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==n.from.id})},e.prototype.removeOuterEdge=function(n){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==n.to.id})},e.prototype.addOuterEdge=function(n){this.outerEdges.push(n),this.outerEdgesSorted=!1},e.prototype.sortOuterEdges=function(){var n=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,i){var r=t.to,s=i.to;if(r.coordinates[0]-n.coordinates[0]>=0&&s.coordinates[0]-n.coordinates[0]<0)return 1;if(r.coordinates[0]-n.coordinates[0]<0&&s.coordinates[0]-n.coordinates[0]>=0)return-1;if(r.coordinates[0]-n.coordinates[0]==0&&s.coordinates[0]-n.coordinates[0]==0)return r.coordinates[1]-n.coordinates[1]>=0||s.coordinates[1]-n.coordinates[1]>=0?r.coordinates[1]-s.coordinates[1]:s.coordinates[1]-r.coordinates[1];var d=WD(n.coordinates,r.coordinates,s.coordinates);return d<0?1:d>0?-1:Math.pow(r.coordinates[0]-n.coordinates[0],2)+Math.pow(r.coordinates[1]-n.coordinates[1],2)-(Math.pow(s.coordinates[0]-n.coordinates[0],2)+Math.pow(s.coordinates[1]-n.coordinates[1],2))}),this.outerEdgesSorted=!0)},e.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},e.prototype.getOuterEdge=function(n){return this.sortOuterEdges(),this.outerEdges[n]},e.prototype.addInnerEdge=function(n){this.innerEdges.push(n)},e}(),RK=function(){function e(n,t){this.from=n,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return e.prototype.getSymetric=function(){return this.symetric||(this.symetric=new e(this.to,this.from),this.symetric.symetric=this),this.symetric},e.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},e.prototype.isEqual=function(n){return this.from.id===n.from.id&&this.to.id===n.to.id},e.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},e.prototype.toLineString=function(){return function yD(e,n,t){if(void 0===t&&(t={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return tp({type:"LineString",coordinates:e},n,t)}([this.from.coordinates,this.to.coordinates])},e.prototype.compareTo=function(n){return WD(n.from.coordinates,n.to.coordinates,this.to.coordinates)},e}(),kK=function(){function e(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return e.prototype.push=function(n){this.edges.push(n),this.polygon=this.envelope=void 0},e.prototype.get=function(n){return this.edges[n]},Object.defineProperty(e.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),e.prototype.forEach=function(n){this.edges.forEach(n)},e.prototype.map=function(n){return this.edges.map(n)},e.prototype.some=function(n){return this.edges.some(n)},e.prototype.isValid=function(){return!0},e.prototype.isHole=function(){var n=this,t=this.edges.reduce(function(d,p,v){return p.from.coordinates[1]>n.edges[d].from.coordinates[1]&&(d=v),d},0),i=(0===t?this.length:t)-1,r=(t+1)%this.length,s=WD(this.edges[i].from.coordinates,this.edges[t].from.coordinates,this.edges[r].from.coordinates);return 0===s?this.edges[i].from.coordinates[0]>this.edges[r].from.coordinates[0]:s>0},e.prototype.toMultiPoint=function(){return function FF(e,n,t){return void 0===t&&(t={}),tp({type:"MultiPoint",coordinates:e},n,t)}(this.edges.map(function(n){return n.from.coordinates}))},e.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var n=this.edges.map(function(t){return t.from.coordinates});return n.push(this.edges[0].from.coordinates),this.polygon=wx([n])},e.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=function zX(e){return function BX(e,n){void 0===n&&(n={});var t=Number(e[0]),i=Number(e[1]),r=Number(e[2]),s=Number(e[3]);if(6===e.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var d=[t,i];return wx([[d,[r,i],[r,s],[t,s],d]],n.properties,{bbox:e,id:n.id})}(sX(e))}(this.toPolygon())},e.findEdgeRingContaining=function(n,t){var r,s,i=n.getEnvelope();return t.forEach(function(d){var p=d.getEnvelope();if(s&&(r=s.getEnvelope()),!function DK(e,n){var t=e.geometry.coordinates[0].map(function(d){return d[0]}),i=e.geometry.coordinates[0].map(function(d){return d[1]}),r=n.geometry.coordinates[0].map(function(d){return d[0]}),s=n.geometry.coordinates[0].map(function(d){return d[1]});return Math.max.apply(null,t)===Math.max.apply(null,r)&&Math.max.apply(null,i)===Math.max.apply(null,s)&&Math.min.apply(null,t)===Math.min.apply(null,r)&&Math.min.apply(null,i)===Math.min.apply(null,s)}(p,i)&&IB(p,i)){for(var v=n.map(function(Y){return Y.from.coordinates}),x=void 0,M=function(Y){d.some(function(X){return function TK(e,n){return e[0]===n[0]&&e[1]===n[1]}(Y,X.from.coordinates)})||(x=Y)},R=0,L=v;R<L.length;R++)M(L[R]);x&&d.inside(bx(x))&&(!s||IB(r,p))&&(s=d)}}),s},e.prototype.inside=function(n){return GF(n,this.toPolygon())},e}();function FB(e){for(var n=e,t=[];n.parent;)t.unshift(n),n=n.parent;return t}!function(){function e(){this.edges=[],this.nodes={}}e.fromGeoJson=function(n){!function LK(e){if(!e)throw new Error("No geojson passed");if("FeatureCollection"!==e.type&&"GeometryCollection"!==e.type&&"MultiLineString"!==e.type&&"LineString"!==e.type&&"Feature"!==e.type)throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(n);var t=new e;return hE(n,function(i){(function lX(e,n,t){if(!e)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!e.geometry||e.geometry.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+e.geometry.type)})(i,"LineString","Graph::fromGeoJson"),function tX(e,n,t,i){var r=t;Ex(e,function(s,d,p,v,x){r=0===d&&void 0===t?s:n(r,s,d,p,v,x)},i)}(i,function(r,s){if(r){var d=t.getNode(r),p=t.getNode(s);t.addEdge(d,p)}return s})}),t},e.prototype.getNode=function(n){var t=DB.buildId(n),i=this.nodes[t];return i||(i=this.nodes[t]=new DB(n)),i},e.prototype.addEdge=function(n,t){var i=new RK(n,t),r=i.getSymetric();this.edges.push(i),this.edges.push(r)},e.prototype.deleteDangles=function(){var n=this;Object.keys(this.nodes).map(function(t){return n.nodes[t]}).forEach(function(t){return n._removeIfDangle(t)})},e.prototype._removeIfDangle=function(n){var t=this;if(n.innerEdges.length<=1){var i=n.getOuterEdges().map(function(r){return r.to});this.removeNode(n),i.forEach(function(r){return t._removeIfDangle(r)})}},e.prototype.deleteCutEdges=function(){var n=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(n.removeEdge(t.symetric),n.removeEdge(t))})},e.prototype._computeNextCWEdges=function(n){var t=this;typeof n>"u"?Object.keys(this.nodes).forEach(function(i){return t._computeNextCWEdges(t.nodes[i])}):n.getOuterEdges().forEach(function(i,r){n.getOuterEdge((0===r?n.getOuterEdges().length:r)-1).symetric.next=i})},e.prototype._computeNextCCWEdges=function(n,t){for(var r,s,i=n.getOuterEdges(),d=i.length-1;d>=0;--d){var p=i[d],v=p.symetric,x=void 0,M=void 0;p.label===t&&(x=p),v.label===t&&(M=v),x&&M&&(M&&(s=M),x&&(s&&(s.next=x,s=void 0),r||(r=x)))}s&&(s.next=r)},e.prototype._findLabeledEdgeRings=function(){var n=[],t=0;return this.edges.forEach(function(i){if(!(i.label>=0)){n.push(i);var r=i;do{r.label=t,r=r.next}while(!i.isEqual(r));t++}}),n},e.prototype.getEdgeRings=function(){var n=this;this._computeNextCWEdges(),this.edges.forEach(function(i){i.label=void 0}),this._findLabeledEdgeRings().forEach(function(i){n._findIntersectionNodes(i).forEach(function(r){n._computeNextCCWEdges(r,i.label)})});var t=[];return this.edges.forEach(function(i){i.ring||t.push(n._findEdgeRing(i))}),t},e.prototype._findIntersectionNodes=function(n){var t=[],i=n,r=function(){var s=0;i.from.getOuterEdges().forEach(function(d){d.label===n.label&&++s}),s>1&&t.push(i.from),i=i.next};do{r()}while(!n.isEqual(i));return t},e.prototype._findEdgeRing=function(n){var t=n,i=new kK;do{i.push(t),t.ring=i,t=t.next}while(!n.isEqual(t));return i},e.prototype.removeNode=function(n){var t=this;n.getOuterEdges().forEach(function(i){return t.removeEdge(i)}),n.innerEdges.forEach(function(i){return t.removeEdge(i)}),delete this.nodes[n.id]},e.prototype.removeEdge=function(n){this.edges=this.edges.filter(function(t){return!t.isEqual(n)}),n.deleteEdge()}}(),Ve(3198),Ve(3367),Ve(3282);var vE={search:function(e,n,t,i){e.cleanDirty();var r=(i=i||{}).heuristic||vE.heuristics.manhattan,s=i.closest||!1,d=function KK(){return new BB(function(e){return e.f})}(),p=n;for(n.h=r(n,t),d.push(n);d.size()>0;){var v=d.pop();if(v===t)return FB(v);v.closed=!0;for(var x=e.neighbors(v),M=0,R=x.length;M<R;++M){var L=x[M];if(!L.closed&&!L.isWall()){var F=v.g+L.getCost(v),Y=L.visited;(!Y||F<L.g)&&(L.visited=!0,L.parent=v,L.h=L.h||r(L,t),L.g=F,L.f=L.g+L.h,e.markDirty(L),s&&(L.h<p.h||L.h===p.h&&L.g<p.g)&&(p=L),Y?d.rescoreElement(L):d.push(L))}}}return s?FB(p):[]},heuristics:{manhattan:function(e,n){return Math.abs(n.x-e.x)+Math.abs(n.y-e.y)},diagonal:function(e,n){var i=Math.sqrt(2),r=Math.abs(n.x-e.x),s=Math.abs(n.y-e.y);return 1*(r+s)+(i-2)*Math.min(r,s)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function hy(e,n){n=n||{},this.nodes=[],this.diagonal=!!n.diagonal,this.grid=[];for(var t=0;t<e.length;t++){this.grid[t]=[];for(var i=0,r=e[t];i<r.length;i++){var s=new xE(t,i,r[i]);this.grid[t][i]=s,this.nodes.push(s)}}this.init()}function xE(e,n,t){this.x=e,this.y=n,this.weight=t}function BB(e){this.content=[],this.scoreFunction=e}function XD(){this._=null}function bE(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Dx(e,n){var t=n,i=n.R,r=t.U;r?r.L===t?r.L=i:r.R=i:e._=i,i.U=r,t.U=i,t.R=i.L,t.R&&(t.R.U=t),i.L=t}function Tx(e,n){var t=n,i=n.L,r=t.U;r?r.L===t?r.L=i:r.R=i:e._=i,i.U=r,t.U=i,t.L=i.R,t.L&&(t.L.U=t),i.R=t}function zB(e){for(;e.L;)e=e.L;return e}hy.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)vE.cleanNode(this.nodes[e])},hy.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)vE.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]},hy.prototype.markDirty=function(e){this.dirtyNodes.push(e)},hy.prototype.neighbors=function(e){var n=[],t=e.x,i=e.y,r=this.grid;return r[t-1]&&r[t-1][i]&&n.push(r[t-1][i]),r[t+1]&&r[t+1][i]&&n.push(r[t+1][i]),r[t]&&r[t][i-1]&&n.push(r[t][i-1]),r[t]&&r[t][i+1]&&n.push(r[t][i+1]),this.diagonal&&(r[t-1]&&r[t-1][i-1]&&n.push(r[t-1][i-1]),r[t+1]&&r[t+1][i-1]&&n.push(r[t+1][i-1]),r[t-1]&&r[t-1][i+1]&&n.push(r[t-1][i+1]),r[t+1]&&r[t+1][i+1]&&n.push(r[t+1][i+1])),n},hy.prototype.toString=function(){for(var t,i,r,s,e=[],n=this.grid,d=0,p=n.length;d<p;d++){for(t=[],r=0,s=(i=n[d]).length;r<s;r++)t.push(i[r].weight);e.push(t.join(" "))}return e.join("\n")},xE.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},xE.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?1.41421*this.weight:this.weight},xE.prototype.isWall=function(){return 0===this.weight},BB.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),e},remove:function(e){var n=this.content.indexOf(e),t=this.content.pop();n!==this.content.length-1&&(this.content[n]=t,this.scoreFunction(t)<this.scoreFunction(e)?this.sinkDown(n):this.bubbleUp(n))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var n=this.content[e];e>0;){var t=(e+1>>1)-1,i=this.content[t];if(!(this.scoreFunction(n)<this.scoreFunction(i)))break;this.content[t]=n,this.content[e]=i,e=t}},bubbleUp:function(e){for(var n=this.content.length,t=this.content[e],i=this.scoreFunction(t);;){var p,r=e+1<<1,s=r-1,d=null;if(s<n&&(p=this.scoreFunction(this.content[s]))<i&&(d=s),r<n&&this.scoreFunction(this.content[r])<(null===d?i:p)&&(d=r),null===d)break;this.content[e]=this.content[d],this.content[d]=t,e=d}}},XD.prototype={constructor:XD,insert:function(e,n){var t,i,r;if(e){if(n.P=e,n.N=e.N,e.N&&(e.N.P=n),e.N=n,e.R){for(e=e.R;e.L;)e=e.L;e.L=n}else e.R=n;t=e}else this._?(e=zB(this._),n.P=null,n.N=e,e.P=e.L=n,t=e):(n.P=n.N=null,this._=n,t=null);for(n.L=n.R=null,n.U=t,n.C=!0,e=n;t&&t.C;)t===(i=t.U).L?(r=i.R)&&r.C?(t.C=r.C=!1,i.C=!0,e=i):(e===t.R&&(Dx(this,t),t=(e=t).U),t.C=!1,i.C=!0,Tx(this,i)):(r=i.L)&&r.C?(t.C=r.C=!1,i.C=!0,e=i):(e===t.L&&(Tx(this,t),t=(e=t).U),t.C=!1,i.C=!0,Dx(this,i)),t=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,s,d,n=e.U,i=e.L,r=e.R;if(s=i?r?zB(r):i:r,n?n.L===e?n.L=s:n.R=s:this._=s,i&&r?(d=s.C,s.C=e.C,s.L=i,i.U=s,s!==r?(n=s.U,s.U=e.U,n.L=e=s.R,s.R=r,r.U=s):(s.U=n,n=s,e=s.R)):(d=e.C,e=s),e&&(e.U=n),!d){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===n.L){if((t=n.R).C&&(t.C=!1,n.C=!0,Dx(this,n),t=n.R),t.L&&t.L.C||t.R&&t.R.C){(!t.R||!t.R.C)&&(t.L.C=!1,t.C=!0,Tx(this,t),t=n.R),t.C=n.C,n.C=t.R.C=!1,Dx(this,n),e=this._;break}}else if((t=n.L).C&&(t.C=!1,n.C=!0,Tx(this,n),t=n.L),t.L&&t.L.C||t.R&&t.R.C){(!t.L||!t.L.C)&&(t.R.C=!1,t.C=!0,Dx(this,t),t=n.L),t.C=n.C,n.C=t.L.C=!1,Tx(this,n),e=this._;break}t.C=!0,e=n,n=n.U}while(!e.C);e&&(e.C=!1)}}};const VB=XD;function Ax(e,n,t,i){var r=[null,null],s=Jc.push(r)-1;return r.left=e,r.right=n,t&&wE(r,e,n,t),i&&wE(r,n,e,i),cd[e.index].halfedges.push(s),cd[n.index].halfedges.push(s),r}function Px(e,n,t){var i=[n,t];return i.left=e,i}function wE(e,n,t,i){e[0]||e[1]?e.left===t?e[1]=i:e[0]=i:(e[0]=i,e.left=n,e.right=t)}function JK(e,n,t,i,r){var X,s=e[0],d=e[1],p=s[0],v=s[1],R=0,L=1,F=d[0]-p,Y=d[1]-v;if(X=n-p,F||!(X>0)){if(X/=F,F<0){if(X<R)return;X<L&&(L=X)}else if(F>0){if(X>L)return;X>R&&(R=X)}if(X=i-p,F||!(X<0)){if(X/=F,F<0){if(X>L)return;X>R&&(R=X)}else if(F>0){if(X<R)return;X<L&&(L=X)}if(X=t-v,Y||!(X>0)){if(X/=Y,Y<0){if(X<R)return;X<L&&(L=X)}else if(Y>0){if(X>L)return;X>R&&(R=X)}if(X=r-v,Y||!(X<0)){if(X/=Y,Y<0){if(X>L)return;X>R&&(R=X)}else if(Y>0){if(X<R)return;X<L&&(L=X)}return!(R>0)&&!(L<1)||(R>0&&(e[0]=[p+R*F,v+R*Y]),L<1&&(e[1]=[p+L*F,v+L*Y])),!0}}}}}function eQ(e,n,t,i,r){var s=e[1];if(s)return!0;var X,ye,d=e[0],p=e.left,v=e.right,x=p[0],M=p[1],R=v[0],L=v[1],F=(x+R)/2;if(L===M){if(F<n||F>=i)return;if(x>R){if(d){if(d[1]>=r)return}else d=[F,t];s=[F,r]}else{if(d){if(d[1]<t)return}else d=[F,r];s=[F,t]}}else if(ye=(M+L)/2-(X=(x-R)/(L-M))*F,X<-1||X>1)if(x>R){if(d){if(d[1]>=r)return}else d=[(t-ye)/X,t];s=[(r-ye)/X,r]}else{if(d){if(d[1]<t)return}else d=[(r-ye)/X,r];s=[(t-ye)/X,t]}else if(M<L){if(d){if(d[0]>=i)return}else d=[n,X*n+ye];s=[i,X*i+ye]}else{if(d){if(d[0]<n)return}else d=[i,X*i+ye];s=[n,X*n+ye]}return e[0]=d,e[1]=s,!0}function iQ(e,n){var t=e.site,i=n.left,r=n.right;return t===r&&(r=i,i=t),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(t===i?(i=n[1],r=n[0]):(i=n[0],r=n[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function UB(e,n){return n[+(n.left!==e.site)]}function rQ(e,n){return n[+(n.left===e.site)]}var YD,jB=[];function aQ(){bE(this),this.x=this.y=this.arc=this.site=this.cy=null}function fy(e){var n=e.P,t=e.N;if(n&&t){var i=n.site,r=e.site,s=t.site;if(i!==s){var d=r[0],p=r[1],v=i[0]-d,x=i[1]-p,M=s[0]-d,R=s[1]-p,L=2*(v*R-x*M);if(!(L>=-hQ)){var F=v*v+x*x,Y=M*M+R*R,X=(R*F-x*Y)/L,ye=(v*Y-M*F)/L,ae=jB.pop()||new aQ;ae.arc=e,ae.site=r,ae.x=X+d,ae.y=(ae.cy=ye+p)+Math.sqrt(X*X+ye*ye),e.circle=ae;for(var Q=null,me=Rx._;me;)if(ae.y<me.y||ae.y===me.y&&ae.x<=me.x){if(!me.L){Q=me.P;break}me=me.L}else{if(!me.R){Q=me;break}me=me.R}Rx.insert(Q,ae),Q||(YD=ae)}}}}function py(e){var n=e.circle;n&&(n.P||(YD=n.N),Rx.remove(n),jB.push(n),bE(n),e.circle=null)}var GB=[];function lQ(){bE(this),this.edge=this.site=this.circle=null}function $B(e){var n=GB.pop()||new lQ;return n.site=e,n}function KD(e){py(e),my.remove(e),GB.push(e),bE(e)}function cQ(e){var n=e.circle,t=n.x,i=n.cy,r=[t,i],s=e.P,d=e.N,p=[e];KD(e);for(var v=s;v.circle&&Math.abs(t-v.circle.x)<Oa&&Math.abs(i-v.circle.cy)<Oa;)s=v.P,p.unshift(v),KD(v),v=s;p.unshift(v),py(v);for(var x=d;x.circle&&Math.abs(t-x.circle.x)<Oa&&Math.abs(i-x.circle.cy)<Oa;)d=x.N,p.push(x),KD(x),x=d;p.push(x),py(x);var R,M=p.length;for(R=1;R<M;++R)wE((x=p[R]).edge,(v=p[R-1]).site,x.site,r);(x=p[M-1]).edge=Ax((v=p[0]).site,x.site,null,r),fy(v),fy(x)}function uQ(e){for(var i,r,s,d,n=e[0],t=e[1],p=my._;p;)if((s=HB(p,t)-n)>Oa)p=p.L;else{if(!((d=n-dQ(p,t))>Oa)){s>-Oa?(i=p.P,r=p):d>-Oa?(i=p,r=p.N):i=r=p;break}if(!p.R){i=p;break}p=p.R}!function nQ(e){cd[e.index]={site:e,halfedges:[]}}(e);var v=$B(e);if(my.insert(i,v),i||r){if(i===r)return py(i),r=$B(i.site),my.insert(v,r),v.edge=r.edge=Ax(i.site,v.site),fy(i),void fy(r);if(!r)return void(v.edge=Ax(i.site,v.site));py(i),py(r);var x=i.site,M=x[0],R=x[1],L=e[0]-M,F=e[1]-R,Y=r.site,X=Y[0]-M,ye=Y[1]-R,ae=2*(L*ye-F*X),Q=L*L+F*F,me=X*X+ye*ye,Xe=[(ye*Q-F*me)/ae+M,(L*me-X*Q)/ae+R];wE(r.edge,x,Y,Xe),v.edge=Ax(x,e,null,Xe),r.edge=Ax(e,Y,null,Xe),fy(i),fy(r)}}function HB(e,n){var t=e.site,i=t[0],r=t[1],s=r-n;if(!s)return i;var d=e.P;if(!d)return-1/0;var p=(t=d.site)[0],v=t[1],x=v-n;if(!x)return p;var M=p-i,R=1/s-1/x,L=M/x;return R?(-L+Math.sqrt(L*L-2*R*(M*M/(-2*x)-v+x/2+r-s/2)))/R+i:(i+p)/2}function dQ(e,n){var t=e.N;if(t)return HB(t,n);var i=e.site;return i[1]===n?i[0]:1/0}var my,cd,Rx,Jc,Oa=1e-6,hQ=1e-12;function fQ(e,n,t){return(e[0]-t[0])*(n[1]-e[1])-(e[0]-n[0])*(t[1]-e[1])}function pQ(e,n){return n[1]-e[1]||n[0]-e[0]}function qB(e,n){var i,r,s,t=e.sort(pQ).pop();for(Jc=[],cd=new Array(e.length),my=new VB,Rx=new VB;;)if(s=YD,t&&(!s||t[1]<s.y||t[1]===s.y&&t[0]<s.x))(t[0]!==i||t[1]!==r)&&(uQ(t),i=t[0],r=t[1]),t=e.pop();else{if(!s)break;cQ(s.arc)}if(function oQ(){for(var t,i,r,s,e=0,n=cd.length;e<n;++e)if((t=cd[e])&&(s=(i=t.halfedges).length)){var d=new Array(s),p=new Array(s);for(r=0;r<s;++r)d[r]=r,p[r]=iQ(t,Jc[i[r]]);for(d.sort(function(v,x){return p[x]-p[v]}),r=0;r<s;++r)p[r]=i[d[r]];for(r=0;r<s;++r)i[r]=p[r]}}(),n){var d=+n[0][0],p=+n[0][1],v=+n[1][0],x=+n[1][1];(function tQ(e,n,t,i){for(var s,r=Jc.length;r--;)eQ(s=Jc[r],e,n,t,i)&&JK(s,e,n,t,i)&&(Math.abs(s[0][0]-s[1][0])>Oa||Math.abs(s[0][1]-s[1][1])>Oa)||delete Jc[r]})(d,p,v,x),function sQ(e,n,t,i){var s,d,p,v,x,M,R,L,F,Y,X,ye,r=cd.length,ae=!0;for(s=0;s<r;++s)if(d=cd[s]){for(p=d.site,v=(x=d.halfedges).length;v--;)Jc[x[v]]||x.splice(v,1);for(v=0,M=x.length;v<M;)X=(Y=rQ(d,Jc[x[v]]))[0],ye=Y[1],L=(R=UB(d,Jc[x[++v%M]]))[0],F=R[1],(Math.abs(X-L)>Oa||Math.abs(ye-F)>Oa)&&(x.splice(v,0,Jc.push(Px(p,Y,Math.abs(X-e)<Oa&&i-ye>Oa?[e,Math.abs(L-e)<Oa?F:i]:Math.abs(ye-i)<Oa&&t-X>Oa?[Math.abs(F-i)<Oa?L:t,i]:Math.abs(X-t)<Oa&&ye-n>Oa?[t,Math.abs(L-t)<Oa?F:n]:Math.abs(ye-n)<Oa&&X-e>Oa?[Math.abs(F-n)<Oa?L:e,n]:null))-1),++M);M&&(ae=!1)}if(ae){var Q,me,Xe,nt=1/0;for(s=0,ae=null;s<r;++s)(d=cd[s])&&(Xe=(Q=(p=d.site)[0]-e)*Q+(me=p[1]-n)*me)<nt&&(nt=Xe,ae=d);if(ae){var wt=[e,n],xt=[e,i],Ft=[t,i],Qe=[t,n];ae.halfedges.push(Jc.push(Px(p=ae.site,wt,xt))-1,Jc.push(Px(p,xt,Ft))-1,Jc.push(Px(p,Ft,Qe))-1,Jc.push(Px(p,Qe,wt))-1)}}for(s=0;s<r;++s)(d=cd[s])&&(d.halfedges.length||delete cd[s])}(d,p,v,x)}this.edges=Jc,this.cells=cd,my=Rx=Jc=cd=null}function sm(){return new EE}function EE(){this.reset()}qB.prototype={constructor:qB,polygons:function(){var e=this.edges;return this.cells.map(function(n){var t=n.halfedges.map(function(i){return UB(n,e[i])});return t.data=n.site.data,t})},triangles:function(){var e=[],n=this.edges;return this.cells.forEach(function(t,i){if(p=(s=t.halfedges).length)for(var s,p,v,r=t.site,d=-1,x=n[s[p-1]],M=x.left===r?x.right:x.left;++d<p;)v=M,M=(x=n[s[d]]).left===r?x.right:x.left,v&&M&&i<v.index&&i<M.index&&fQ(r,v,M)<0&&e.push([r.data,v.data,M.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,n,t){for(var r,p,i=this,s=i._found||0,d=i.cells.length;!(p=i.cells[s]);)if(++s>=d)return null;var v=e-p.site[0],x=n-p.site[1],M=v*v+x*x;do{p=i.cells[r=s],s=null,p.halfedges.forEach(function(R){var L=i.edges[R],F=L.left;if(F!==p.site&&F||(F=L.right)){var Y=e-F[0],X=n-F[1],ye=Y*Y+X*X;ye<M&&(M=ye,s=F.index)}})}while(null!==s);return i._found=r,null==t||M<=t*t?p.site:null}},Ve(8464),Ve(4855),EE.prototype={constructor:EE,reset:function(){this.s=this.t=0},add:function(e){iz(CE,e,this.t),iz(this,CE.s,this.s),this.s?this.t+=CE.t:this.s=CE.t},valueOf:function(){return this.s}};var CE=new EE;function iz(e,n,t){var i=e.s=n+t,r=i-n;e.t=n-(i-r)+(t-r)}var Ha=Math.PI,Hu=Ha/2,gy=2*Ha,Ma=Ha/180,Ox=(Math,Math.atan),_y=Math.atan2,ns=Math.cos,bo=(Math,Math,Math,Math,Math,Math.sin),np=(Math,Math.sqrt);Math;function yy(e){return e>1?Hu:e<-1?-Hu:Math.asin(e)}function dT(e,n){return[e>Ha?e-gy:e<-Ha?e+gy:e,n]}function Az(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}sm(),sm(),sm(),dT.invert=dT,function qQ(e){1===e.length&&(e=function WQ(e){return function(n,t){return Az(e(n),t)}}(e))}(Az),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);sm();function AT(){}function n3(e){return function(n,t){var i=ns(n),r=ns(t),s=e(i*r);return[s*r*bo(n),s*bo(t)]}}function Gx(e){return function(n,t){var i=np(n*n+t*t),r=e(i),s=bo(r),d=ns(r);return[_y(n*s,i*d),yy(i&&t*s/i)]}}function RT(e,n){return[e,n]}function m3(e,n,t,i,r,s,d){try{var p=e[s](d),v=p.value}catch(x){return void t(x)}p.done?n(v):Promise.resolve(v).then(i,r)}function g3(e){return function(){var n=this,t=arguments;return new Promise(function(i,r){var s=e.apply(n,t);function d(v){m3(s,i,r,d,p,"next",v)}function p(v){m3(s,i,r,d,p,"throw",v)}d(void 0)})}}sm(),sm(),sm(),sm(),function Jz(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}(4.5),AT.prototype={constructor:AT,point:function(e,n){this.stream.point(e,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ns(30*Ma),function e3(e){return function(n){var t=new AT;for(var i in e)t[i]=e[i];return t.stream=n,t}}({point:function(e,n){this.stream.point(e*Ma,n*Ma)}}),n3(function(e){return np(2/(1+e))}).invert=Gx(function(e){return 2*yy(e/2)}),n3(function(e){return(e=function DQ(e){return e>1?0:e<-1?Ha:Math.acos(e)}(e))&&e/bo(e)}).invert=Gx(function(e){return e}),RT.invert=RT,Gx(Ox),Gx(yy),Gx(function(e){return 2*Ox(e)});var YE=Ve(2574);class _3 extends Ct{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(n){const{hasError:t,_hasValue:i,_value:r,thrownError:s,isStopped:d,_isComplete:p}=this;t?n.error(s):(d||p)&&(i&&n.next(r),n.complete())}next(n){this.isStopped||(this._value=n,this._hasValue=!0)}complete(){const{_hasValue:n,_value:t,_isComplete:i}=this;i||(this._isComplete=!0,n&&super.next(t),super.complete())}}const y3=["content"],v3=["*"],UJ=["container"],b3=new Pn("MapboxApiKey");let $x=(()=>{class e{constructor(t,i){this.zone=t,this.MAPBOX_API_KEY=i,this.mapCreated=new _3,this.mapLoaded=new _3,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new xe,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(t){this.zone.onStable.pipe(Qp()).subscribe(()=>{t.customMapboxApiUrl&&(YE.baseApiUrl=t.customMapboxApiUrl),this.createMap({...t.mapOptions,accessToken:t.accessToken||this.MAPBOX_API_KEY||""}),this.hookEvents(t.mapEvents),this.mapEvents=t.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete(),t.mapEvents.mapCreate.observed&&this.zone.run(()=>{t.mapEvents.mapCreate.emit(this.mapInstance)})})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateProjection(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setProjection(t)})}updateMinZoom(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(t)})}updateMaxZoom(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(t)})}updateMinPitch(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(t)})}updateMaxPitch(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(t)})}updateRenderWorldCopies(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(t)})}updateScrollZoom(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(t)})}updateMaxBounds(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(t)})}changeCanvasCursor(t){this.mapInstance.getCanvasContainer().style.cursor=t}queryRenderedFeatures(t,i){return this.mapInstance.queryRenderedFeatures(t,i)}panTo(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(t,i)})}move(t,i,r,s,d,p){return this.zone.runOutsideAngular(()=>{this.mapInstance[t]({...i,zoom:r??this.mapInstance.getZoom(),center:s??this.mapInstance.getCenter(),bearing:d??this.mapInstance.getBearing(),pitch:p??this.mapInstance.getPitch()})})}addLayer(t,i,r){this.zone.runOutsideAngular(()=>{Object.keys(t.layerOptions).forEach(s=>{void 0===t.layerOptions[s]&&delete t.layerOptions[s]}),this.mapInstance.addLayer(t.layerOptions,r),i&&((t.layerEvents.layerClick.observed||t.layerEvents.click.observed)&&this.mapInstance.on("click",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerClick.emit(s),t.layerEvents.click.emit(s)})}),(t.layerEvents.layerDblClick.observed||t.layerEvents.dblClick.observed)&&this.mapInstance.on("dblclick",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerDblClick.emit(s),t.layerEvents.dblClick.emit(s)})}),(t.layerEvents.layerMouseDown.observed||t.layerEvents.mouseDown.observed)&&this.mapInstance.on("mousedown",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseDown.emit(s),t.layerEvents.mouseDown.emit(s)})}),(t.layerEvents.layerMouseUp.observed||t.layerEvents.mouseUp.observed)&&this.mapInstance.on("mouseup",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseUp.emit(s),t.layerEvents.mouseUp.emit(s)})}),(t.layerEvents.layerMouseEnter.observed||t.layerEvents.mouseEnter.observed)&&this.mapInstance.on("mouseenter",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseEnter.emit(s),t.layerEvents.mouseEnter.emit(s)})}),(t.layerEvents.layerMouseLeave.observed||t.layerEvents.mouseLeave.observed)&&this.mapInstance.on("mouseleave",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseLeave.emit(s),t.layerEvents.mouseLeave.emit(s)})}),(t.layerEvents.layerMouseMove.observed||t.layerEvents.mouseMove.observed)&&this.mapInstance.on("mousemove",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseMove.emit(s),t.layerEvents.mouseMove.emit(s)})}),(t.layerEvents.layerMouseOver.observed||t.layerEvents.mouseOver.observed)&&this.mapInstance.on("mouseover",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseOver.emit(s),t.layerEvents.mouseOver.emit(s)})}),(t.layerEvents.layerMouseOut.observed||t.layerEvents.mouseOut.observed)&&this.mapInstance.on("mouseout",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerMouseOut.emit(s),t.layerEvents.mouseOut.emit(s)})}),(t.layerEvents.layerContextMenu.observed||t.layerEvents.contextMenu.observed)&&this.mapInstance.on("contextmenu",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerContextMenu.emit(s),t.layerEvents.contextMenu.emit(s)})}),(t.layerEvents.layerTouchStart.observed||t.layerEvents.touchStart.observed)&&this.mapInstance.on("touchstart",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerTouchStart.emit(s),t.layerEvents.touchStart.emit(s)})}),(t.layerEvents.layerTouchEnd.observed||t.layerEvents.touchEnd.observed)&&this.mapInstance.on("touchend",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerTouchEnd.emit(s),t.layerEvents.touchEnd.emit(s)})}),(t.layerEvents.layerTouchCancel.observed||t.layerEvents.touchCancel.observed)&&this.mapInstance.on("touchcancel",t.layerOptions.id,s=>{this.zone.run(()=>{t.layerEvents.layerTouchCancel.emit(s),t.layerEvents.touchCancel.emit(s)})}))})}removeLayer(t){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(t)&&this.mapInstance.removeLayer(t)})}addMarker(t){const i={offset:t.markersOptions.offset,anchor:t.markersOptions.anchor,draggable:!!t.markersOptions.draggable,rotationAlignment:t.markersOptions.rotationAlignment,pitchAlignment:t.markersOptions.pitchAlignment,clickTolerance:t.markersOptions.clickTolerance};t.markersOptions.element.childNodes.length>0&&(i.element=t.markersOptions.element);const r=new YE.Marker(i);return(t.markersEvents.markerDragStart.observed||t.markersEvents.dragStart.observed)&&r.on("dragstart",d=>{if(d){const{target:p}=d;this.zone.run(()=>{t.markersEvents.markerDragStart.emit(p),t.markersEvents.dragStart.emit(p)})}}),(t.markersEvents.markerDrag.observed||t.markersEvents.drag.observed)&&r.on("drag",d=>{if(d){const{target:p}=d;this.zone.run(()=>{t.markersEvents.markerDrag.emit(p),t.markersEvents.drag.emit(p)})}}),(t.markersEvents.markerDragEnd.observed||t.markersEvents.dragEnd.observed)&&r.on("dragend",d=>{if(d){const{target:p}=d;this.zone.run(()=>{t.markersEvents.markerDragEnd.emit(p),t.markersEvents.dragEnd.emit(p)})}}),r.setLngLat(t.markersOptions.feature?t.markersOptions.feature.geometry.coordinates:t.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(r.addTo(this.mapInstance),r))}removeMarker(t){this.markersToRemove.push(t)}createPopup(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(t.popupOptions).forEach(s=>void 0===t.popupOptions[s]&&delete t.popupOptions[s]);const r=new YE.Popup(t.popupOptions);return r.setDOMContent(i),(t.popupEvents.popupClose.observed||t.popupEvents.close.observed)&&r.on("close",()=>{this.zone.run(()=>{t.popupEvents.popupClose.emit(),t.popupEvents.close.emit()})}),(t.popupEvents.popupOpen.observed||t.popupEvents.open.observed)&&r.on("open",()=>{this.zone.run(()=>{t.popupEvents.popupOpen.emit(),t.popupEvents.open.emit()})}),r})}addPopupToMap(t,i,r=!1){return this.zone.runOutsideAngular(()=>{r&&t._listeners&&delete t._listeners.open,t.setLngLat(i),t.addTo(this.mapInstance)})}addPopupToMarker(t,i){return this.zone.runOutsideAngular(()=>{t.setPopup(i)})}removePopupFromMap(t,i=!1){i&&t._listeners&&delete t._listeners.close,this.popupsToRemove.push(t)}removePopupFromMarker(t){return this.zone.runOutsideAngular(()=>{t.setPopup(void 0)})}addControl(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(t,i)})}removeControl(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(t)})}loadAndAddImage(t,i,r){var s=this;return g3(function*(){return s.zone.runOutsideAngular(()=>new Promise((d,p)=>{s.mapInstance.loadImage(i,(v,x)=>{v?p(v):(s.addImage(t,x,r),d())})}))})()}addImage(t,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(t,i,r)})}removeImage(t){this.imageIdsToRemove.push(t)}addSource(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>void 0===i[r]&&delete i[r]),this.mapInstance.addSource(t,i)})}getSource(t){return this.mapInstance.getSource(t)}removeSource(t){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(t).forEach(i=>this.mapInstance.removeLayer(i.id)),this.mapInstance.removeSource(t)})}setAllLayerPaintProperty(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>{this.mapInstance.setPaintProperty(t,r,i[r])})})}setAllLayerLayoutProperty(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>{this.mapInstance.setLayoutProperty(t,r,i[r])})})}setLayerFilter(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(t,i)})}setLayerBefore(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(t,i)})}setLayerZoomRange(t,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(t,i||0,r||20)})}fitBounds(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(t,i)})}fitScreenCoordinates(t,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(t[0],t[1],i,r)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(t){_.assertNotInAngularZone(),Object.keys(t).forEach(r=>{void 0===t[r]&&delete t[r]}),this.mapInstance=new YE.Map(t),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(t.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const t of this.markersToRemove)t.remove();this.markersToRemove=[]}removePopups(){for(const t of this.popupsToRemove)t.remove();this.popupsToRemove=[]}removeImages(){for(const t of this.imageIdsToRemove)this.mapInstance.removeImage(t);this.imageIdsToRemove=[]}findLayersBySourceId(t){const i=this.mapInstance.getStyle().layers;return null==i?[]:i.filter(r=>"source"in r&&r.source===t)}hookEvents(t){this.mapInstance.on("load",i=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{t.mapLoad.emit(i),t.load.emit(i.target)})}),(t.mapResize.observed||t.resize.observed)&&this.mapInstance.on("resize",i=>this.zone.run(()=>{t.mapResize.emit(i),t.resize.emit(i)})),(t.mapRemove.observed||t.remove.observed)&&this.mapInstance.on("remove",i=>this.zone.run(()=>{t.mapRemove.emit(i),t.remove.emit(i)})),(t.mapMouseDown.observed||t.mouseDown.observed)&&this.mapInstance.on("mousedown",i=>this.zone.run(()=>{t.mapMouseDown.emit(i),t.mouseDown.emit(i)})),(t.mapMouseUp.observed||t.mouseUp.observed)&&this.mapInstance.on("mouseup",i=>this.zone.run(()=>{t.mapMouseUp.emit(i),t.mouseUp.emit(i)})),(t.mapMouseMove.observed||t.mouseMove.observed)&&this.mapInstance.on("mousemove",i=>this.zone.run(()=>{t.mapMouseMove.emit(i),t.mouseMove.emit(i)})),(t.mapClick.observed||t.click.observed)&&this.mapInstance.on("click",i=>this.zone.run(()=>{t.mapClick.emit(i),t.click.emit(i)})),(t.mapDblClick.observed||t.dblClick.observed)&&this.mapInstance.on("dblclick",i=>this.zone.run(()=>{t.mapDblClick.emit(i),t.dblClick.emit(i)})),(t.mapMouseOver.observed||t.mouseOver.observed)&&this.mapInstance.on("mouseover",i=>this.zone.run(()=>{t.mapMouseOver.emit(i),t.mouseOver.emit(i)})),(t.mapMouseOut.observed||t.mouseOut.observed)&&this.mapInstance.on("mouseout",i=>this.zone.run(()=>{t.mapMouseOut.emit(i),t.mouseOut.emit(i)})),(t.mapContextMenu.observed||t.contextMenu.observed)&&this.mapInstance.on("contextmenu",i=>this.zone.run(()=>{t.mapContextMenu.emit(i),t.contextMenu.emit(i)})),(t.mapTouchStart.observed||t.touchStart.observed)&&this.mapInstance.on("touchstart",i=>this.zone.run(()=>{t.mapTouchStart.emit(i),t.touchStart.emit(i)})),(t.mapTouchEnd.observed||t.touchEnd.observed)&&this.mapInstance.on("touchend",i=>this.zone.run(()=>{t.mapTouchEnd.emit(i),t.touchEnd.emit(i)})),(t.mapTouchMove.observed||t.touchMove.observed)&&this.mapInstance.on("touchmove",i=>this.zone.run(()=>{t.mapTouchMove.emit(i),t.touchMove.emit(i)})),(t.mapTouchCancel.observed||t.touchCancel.observed)&&this.mapInstance.on("touchcancel",i=>this.zone.run(()=>{t.mapTouchCancel.emit(i),t.touchCancel.emit(i)})),(t.mapWheel.observed||t.wheel.observed)&&this.mapInstance.on("wheel",i=>this.zone.run(()=>{t.mapWheel.emit(i),t.wheel.emit(i)})),t.moveStart.observed&&this.mapInstance.on("movestart",i=>this.zone.run(()=>t.moveStart.emit(i))),t.move.observed&&this.mapInstance.on("move",i=>this.zone.run(()=>t.move.emit(i))),t.moveEnd.observed&&this.mapInstance.on("moveend",i=>this.zone.run(()=>t.moveEnd.emit(i))),(t.mapDragStart.observed||t.dragStart.observed)&&this.mapInstance.on("dragstart",i=>this.zone.run(()=>{t.mapDragStart.emit(i),t.dragStart.emit(i)})),(t.mapDrag.observed||t.drag.observed)&&this.mapInstance.on("drag",i=>this.zone.run(()=>{t.mapDrag.emit(i),t.drag.emit(i)})),(t.mapDragEnd.observed||t.dragEnd.observed)&&this.mapInstance.on("dragend",i=>this.zone.run(()=>{t.mapDragEnd.emit(i),t.dragEnd.emit(i)})),t.zoomStart.observed&&this.mapInstance.on("zoomstart",i=>this.zone.run(()=>t.zoomStart.emit(i))),t.zoomEvt.observed&&this.mapInstance.on("zoom",i=>this.zone.run(()=>t.zoomEvt.emit(i))),t.zoomEnd.observed&&this.mapInstance.on("zoomend",i=>this.zone.run(()=>t.zoomEnd.emit(i))),t.rotateStart.observed&&this.mapInstance.on("rotatestart",i=>this.zone.run(()=>t.rotateStart.emit(i))),t.rotate.observed&&this.mapInstance.on("rotate",i=>this.zone.run(()=>t.rotate.emit(i))),t.rotateEnd.observed&&this.mapInstance.on("rotateend",i=>this.zone.run(()=>t.rotateEnd.emit(i))),t.pitchStart.observed&&this.mapInstance.on("pitchstart",i=>this.zone.run(()=>t.pitchStart.emit(i))),t.pitchEvt.observed&&this.mapInstance.on("pitch",i=>this.zone.run(()=>t.pitchEvt.emit(i))),t.pitchEnd.observed&&this.mapInstance.on("pitchend",i=>this.zone.run(()=>t.pitchEnd.emit(i))),t.boxZoomStart.observed&&this.mapInstance.on("boxzoomstart",i=>this.zone.run(()=>t.boxZoomStart.emit(i))),t.boxZoomEnd.observed&&this.mapInstance.on("boxzoomend",i=>this.zone.run(()=>t.boxZoomEnd.emit(i))),t.boxZoomCancel.observed&&this.mapInstance.on("boxzoomcancel",i=>this.zone.run(()=>t.boxZoomCancel.emit(i))),t.webGlContextLost.observed&&this.mapInstance.on("webglcontextlost",i=>this.zone.run(()=>t.webGlContextLost.emit(i))),t.webGlContextRestored.observed&&this.mapInstance.on("webglcontextrestored",i=>this.zone.run(()=>t.webGlContextRestored.emit(i))),t.render.observed&&this.mapInstance.on("render",i=>this.zone.run(()=>t.render.emit(i))),(t.mapError.observed||t.error.observed)&&this.mapInstance.on("error",i=>this.zone.run(()=>{t.mapError.emit(i),t.error.emit(i)})),t.data.observed&&this.mapInstance.on("data",i=>this.zone.run(()=>t.data.emit(i))),t.styleData.observed&&this.mapInstance.on("styledata",i=>this.zone.run(()=>t.styleData.emit(i))),t.sourceData.observed&&this.mapInstance.on("sourcedata",i=>this.zone.run(()=>t.sourceData.emit(i))),t.dataLoading.observed&&this.mapInstance.on("dataloading",i=>this.zone.run(()=>t.dataLoading.emit(i))),t.styleDataLoading.observed&&this.mapInstance.on("styledataloading",i=>this.zone.run(()=>t.styleDataLoading.emit(i))),t.sourceDataLoading.observed&&this.mapInstance.on("sourcedataloading",i=>this.zone.run(()=>t.sourceDataLoading.emit(i))),t.styleImageMissing.observed&&this.mapInstance.on("styleimagemissing",i=>this.zone.run(()=>t.styleImageMissing.emit(i))),t.idle.observed&&this.mapInstance.on("idle",i=>this.zone.run(()=>t.idle.emit(i)))}assign(t,i,r){if("string"==typeof i&&(i=i.split(".")),i.length>1){const s=i.shift();this.assign(t[s]="[object Object]"===Object.prototype.toString.call(t[s])?t[s]:{},i,r)}else t[i[0]]=r}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_),Dt(b3,8))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();const KE=(e,n,t)=>{console.warn(`[ngx-mapbox-gl]: ${e}: ${n} is deprecated, please use ${t} instead.`)};let qJ=(()=>{class e{constructor(t){this.mapService=t,this.layerClick=new a,this.layerDblClick=new a,this.layerMouseDown=new a,this.layerMouseUp=new a,this.layerMouseEnter=new a,this.layerMouseLeave=new a,this.layerMouseMove=new a,this.layerMouseOver=new a,this.layerMouseOut=new a,this.layerContextMenu=new a,this.layerTouchStart=new a,this.layerTouchEnd=new a,this.layerTouchCancel=new a,this.click=new a,this.dblClick=new a,this.mouseDown=new a,this.mouseUp=new a,this.mouseEnter=new a,this.mouseLeave=new a,this.mouseMove=new a,this.mouseOver=new a,this.mouseOut=new a,this.contextMenu=new a,this.touchStart=new a,this.touchEnd=new a,this.touchCancel=new a,this.layerAdded=!1}ngOnInit(){this.warnDeprecatedOutputs(),this.sub=this.mapService.mapLoaded$.pipe(gi(()=>Xw(this.mapService.mapInstance,"styledata").pipe(zk(!1),Rc(()=>!this.mapService.mapInstance.getLayer(this.id)),V0(!0)))).subscribe(t=>this.init(t))}ngOnChanges(t){this.layerAdded&&(t.paint&&!t.paint.isFirstChange()&&this.mapService.setAllLayerPaintProperty(this.id,t.paint.currentValue),t.layout&&!t.layout.isFirstChange()&&this.mapService.setAllLayerLayoutProperty(this.id,t.layout.currentValue),t.filter&&!t.filter.isFirstChange()&&this.mapService.setLayerFilter(this.id,t.filter.currentValue),t.before&&!t.before.isFirstChange()&&this.mapService.setLayerBefore(this.id,t.before.currentValue),(t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&this.mapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))}ngOnDestroy(){this.layerAdded&&this.mapService.removeLayer(this.id),this.sub&&this.sub.unsubscribe()}init(t){this.mapService.addLayer({layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel,click:this.click,dblClick:this.dblClick,mouseDown:this.mouseDown,mouseUp:this.mouseUp,mouseEnter:this.mouseEnter,mouseLeave:this.mouseLeave,mouseMove:this.mouseMove,mouseOver:this.mouseOver,mouseOut:this.mouseOut,contextMenu:this.contextMenu,touchStart:this.touchStart,touchEnd:this.touchEnd,touchCancel:this.touchCancel}},t,this.before),this.layerAdded=!0}warnDeprecatedOutputs(){const t=KE.bind(void 0,e.name);this.click.observed&&t("click","layerClick"),this.dblClick.observed&&t("dblClick","layerDblClick"),this.mouseDown.observed&&t("mouseDown","layerMouseDown"),this.mouseUp.observed&&t("mouseUp","layerMouseUp"),this.mouseEnter.observed&&t("mouseEnter","layerMouseEnter"),this.mouseLeave.observed&&t("mouseLeave","layerMouseLeave"),this.mouseMove.observed&&t("mouseMove","layerMouseMove"),this.mouseOver.observed&&t("mouseOver","layerMouseOver"),this.mouseOut.observed&&t("mouseOut","layerMouseOut"),this.contextMenu.observed&&t("contextMenu","layerContextMenu"),this.touchStart.observed&&t("touchStart","layerTouchStart"),this.touchEnd.observed&&t("touchEnd","layerTouchEnd"),this.touchCancel.observed&&t("touchCancel","layerTouchCancel")}static#e=this.\u0275fac=function(i){return new(i||e)(Et($x))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mgl-layer"]],inputs:{id:"id",source:"source",type:"type",metadata:"metadata",sourceLayer:"sourceLayer",filter:"filter",layout:"layout",paint:"paint",before:"before",minzoom:"minzoom",maxzoom:"maxzoom"},outputs:{layerClick:"layerClick",layerDblClick:"layerDblClick",layerMouseDown:"layerMouseDown",layerMouseUp:"layerMouseUp",layerMouseEnter:"layerMouseEnter",layerMouseLeave:"layerMouseLeave",layerMouseMove:"layerMouseMove",layerMouseOver:"layerMouseOver",layerMouseOut:"layerMouseOut",layerContextMenu:"layerContextMenu",layerTouchStart:"layerTouchStart",layerTouchEnd:"layerTouchEnd",layerTouchCancel:"layerTouchCancel",click:"click",dblClick:"dblClick",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseMove:"mouseMove",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchCancel:"touchCancel"},features:[ii],decls:0,vars:0,template:function(i,r){},encapsulation:2})}return e})(),WJ=(()=>{class e{get mapInstance(){return this.mapService.mapInstance}constructor(t){this.mapService=t,this.movingMethod="flyTo",this.mapResize=new a,this.mapRemove=new a,this.mapMouseDown=new a,this.mapMouseUp=new a,this.mapMouseMove=new a,this.mapClick=new a,this.mapDblClick=new a,this.mapMouseOver=new a,this.mapMouseOut=new a,this.mapContextMenu=new a,this.mapTouchStart=new a,this.mapTouchEnd=new a,this.mapTouchMove=new a,this.mapTouchCancel=new a,this.mapWheel=new a,this.moveStart=new a,this.move=new a,this.moveEnd=new a,this.mapDragStart=new a,this.mapDrag=new a,this.mapDragEnd=new a,this.zoomStart=new a,this.zoomEvt=new a,this.zoomEnd=new a,this.rotateStart=new a,this.rotate=new a,this.rotateEnd=new a,this.pitchStart=new a,this.pitchEvt=new a,this.pitchEnd=new a,this.boxZoomStart=new a,this.boxZoomEnd=new a,this.boxZoomCancel=new a,this.webGlContextLost=new a,this.webGlContextRestored=new a,this.mapLoad=new a,this.mapCreate=new a,this.idle=new a,this.render=new a,this.mapError=new a,this.data=new a,this.styleData=new a,this.sourceData=new a,this.dataLoading=new a,this.styleDataLoading=new a,this.sourceDataLoading=new a,this.styleImageMissing=new a,this.resize=new a,this.remove=new a,this.mouseDown=new a,this.mouseUp=new a,this.mouseMove=new a,this.click=new a,this.dblClick=new a,this.mouseOver=new a,this.mouseOut=new a,this.contextMenu=new a,this.touchStart=new a,this.touchEnd=new a,this.touchMove=new a,this.touchCancel=new a,this.wheel=new a,this.dragStart=new a,this.drag=new a,this.dragEnd=new a,this.load=new a,this.error=new a}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.mapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale,cooperativeGestures:this.cooperativeGestures,projection:this.projection},mapEvents:this}),this.cursorStyle&&this.mapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.mapService.destroyMap()}ngOnChanges(t){var i=this;return g3(function*(){yield function VJ(e,n){const t="object"==typeof n;return new Promise((i,r)=>{let d,s=!1;e.subscribe({next:p=>{d=p,s=!0},error:r,complete:()=>{s?i(d):t?i(n.defaultValue):r(new z0)}})})}(i.mapService.mapCreated$),t.cursorStyle&&!t.cursorStyle.isFirstChange()&&i.mapService.changeCanvasCursor(t.cursorStyle.currentValue),t.projection&&!t.projection.isFirstChange()&&i.mapService.updateProjection(t.projection.currentValue),t.minZoom&&!t.minZoom.isFirstChange()&&i.mapService.updateMinZoom(t.minZoom.currentValue),t.maxZoom&&!t.maxZoom.isFirstChange()&&i.mapService.updateMaxZoom(t.maxZoom.currentValue),t.minPitch&&!t.minPitch.isFirstChange()&&i.mapService.updateMinPitch(t.minPitch.currentValue),t.maxPitch&&!t.maxPitch.isFirstChange()&&i.mapService.updateMaxPitch(t.maxPitch.currentValue),t.renderWorldCopies&&!t.renderWorldCopies.isFirstChange()&&i.mapService.updateRenderWorldCopies(t.renderWorldCopies.currentValue),t.scrollZoom&&!t.scrollZoom.isFirstChange()&&i.mapService.updateScrollZoom(t.scrollZoom.currentValue),t.dragRotate&&!t.dragRotate.isFirstChange()&&i.mapService.updateDragRotate(t.dragRotate.currentValue),t.touchPitch&&!t.touchPitch.isFirstChange()&&i.mapService.updateTouchPitch(t.touchPitch.currentValue),t.touchZoomRotate&&!t.touchZoomRotate.isFirstChange()&&i.mapService.updateTouchZoomRotate(t.touchZoomRotate.currentValue),t.doubleClickZoom&&!t.doubleClickZoom.isFirstChange()&&i.mapService.updateDoubleClickZoom(t.doubleClickZoom.currentValue),t.keyboard&&!t.keyboard.isFirstChange()&&i.mapService.updateKeyboard(t.keyboard.currentValue),t.dragPan&&!t.dragPan.isFirstChange()&&i.mapService.updateDragPan(t.dragPan.currentValue),t.boxZoom&&!t.boxZoom.isFirstChange()&&i.mapService.updateBoxZoom(t.boxZoom.currentValue),t.style&&!t.style.isFirstChange()&&i.mapService.updateStyle(t.style.currentValue),t.maxBounds&&!t.maxBounds.isFirstChange()&&i.mapService.updateMaxBounds(t.maxBounds.currentValue),t.fitBounds&&t.fitBounds.currentValue&&!t.fitBounds.isFirstChange()&&i.mapService.fitBounds(t.fitBounds.currentValue,i.fitBoundsOptions),t.fitScreenCoordinates&&t.fitScreenCoordinates.currentValue&&((i.center||i.zoom||i.pitch||i.fitBounds)&&t.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),i.mapService.fitScreenCoordinates(t.fitScreenCoordinates.currentValue,i.bearing?i.bearing[0]:0,i.movingOptions)),!i.centerWithPanTo||!t.center||t.center.isFirstChange()||t.zoom||t.bearing||t.pitch?(t.center&&!t.center.isFirstChange()||t.zoom&&!t.zoom.isFirstChange()||t.bearing&&!t.bearing.isFirstChange()&&!t.fitScreenCoordinates||t.pitch&&!t.pitch.isFirstChange())&&i.mapService.move(i.movingMethod,i.movingOptions,t.zoom&&i.zoom?i.zoom[0]:void 0,t.center?i.center:void 0,t.bearing&&i.bearing?i.bearing[0]:void 0,t.pitch&&i.pitch?i.pitch[0]:void 0):i.mapService.panTo(i.center,i.panToOptions)})()}warnDeprecatedOutputs(){const t=KE.bind(void 0,e.name);this.resize.observed&&t("resize","mapResize"),this.remove.observed&&t("remove","mapRemove"),this.mouseDown.observed&&t("mouseDown","mapMouseDown"),this.mouseUp.observed&&t("mouseUp","mapMouseUp"),this.mouseMove.observed&&t("mouseMove","mapMouseMove"),this.click.observed&&t("click","mapClick"),this.dblClick.observed&&t("dblClick","mapDblClick"),this.mouseOver.observed&&t("mouseOver","mapMouseOver"),this.mouseOut.observed&&t("mouseOut","mapMouseOut"),this.contextMenu.observed&&t("contextMenu","mapContextMenu"),this.touchStart.observed&&t("touchStart","mapTouchStart"),this.touchEnd.observed&&t("touchEnd","mapTouchEnd"),this.touchMove.observed&&t("touchMove","mapTouchMove"),this.touchCancel.observed&&t("touchCancel","mapTouchCancel"),this.wheel.observed&&t("wheel","mapWheel"),this.dragStart.observed&&t("dragStart","mapDragStart"),this.drag.observed&&t("drag","mapDrag"),this.dragEnd.observed&&t("dragEnd","mapDragEnd"),this.load.observed&&t("load","mapLoad"),this.error.observed&&t("error","mapError")}static#e=this.\u0275fac=function(i){return new(i||e)(Et($x))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mgl-map"]],viewQuery:function(i,r){if(1&i&&$p(UJ,7),2&i){let s;Kh(s=Qh())&&(r.mapContainer=s.first)}},inputs:{accessToken:"accessToken",collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",cooperativeGestures:"cooperativeGestures",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",projection:"projection",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",mapCreate:"mapCreate",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[ya([$x]),ii],decls:2,vars:0,consts:[["container",""]],template:function(i,r){1&i&&Oi(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block}div[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}return e})(),ZJ=(()=>{class e{constructor(t){this.mapService=t,this.markerDragStart=new a,this.markerDragEnd=new a,this.markerDrag=new a,this.dragStart=new a,this.dragEnd=new a,this.drag=new a}ngOnInit(){if(this.warnDeprecatedOutputs(),this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")}ngOnChanges(t){t.lngLat&&!t.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),t.feature&&!t.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates),t.draggable&&!t.draggable.isFirstChange()&&this.markerInstance.setDraggable(!!this.draggable),t.popupShown&&!t.popupShown.isFirstChange()&&(t.popupShown.currentValue?this.markerInstance.getPopup().addTo(this.mapService.mapInstance):this.markerInstance.getPopup().remove()),t.pitchAlignment&&!t.pitchAlignment.isFirstChange()&&this.markerInstance.setPitchAlignment(t.pitchAlignment.currentValue),t.rotationAlignment&&!t.rotationAlignment.isFirstChange()&&this.markerInstance.setRotationAlignment(t.rotationAlignment.currentValue)}ngAfterViewInit(){this.mapService.mapCreated$.subscribe(()=>{this.markerInstance=this.mapService.addMarker({markersOptions:{offset:this.offset,anchor:this.anchor,pitchAlignment:this.pitchAlignment,rotationAlignment:this.rotationAlignment,draggable:!!this.draggable,element:this.content.nativeElement,feature:this.feature,lngLat:this.lngLat,clickTolerance:this.clickTolerance},markersEvents:{markerDragStart:this.markerDragStart,markerDrag:this.markerDrag,markerDragEnd:this.markerDragEnd,dragStart:this.markerDragStart,drag:this.markerDrag,dragEnd:this.markerDragEnd}})})}ngOnDestroy(){this.mapService.removeMarker(this.markerInstance),this.markerInstance=void 0}togglePopup(){this.markerInstance.togglePopup()}updateCoordinates(t){this.markerInstance.setLngLat(t)}warnDeprecatedOutputs(){const t=KE.bind(void 0,e.name);this.markerDragStart.observed&&t("dragStart","markerDragStart"),this.markerDragEnd.observed&&t("dragEnd","markerDragEnd"),this.markerDrag.observed&&t("drag","markerDrag")}static#e=this.\u0275fac=function(i){return new(i||e)(Et($x))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mgl-marker"]],viewQuery:function(i,r){if(1&i&&$p(y3,7),2&i){let s;Kh(s=Qh())&&(r.content=s.first)}},inputs:{offset:"offset",anchor:"anchor",clickTolerance:"clickTolerance",feature:"feature",lngLat:"lngLat",draggable:"draggable",popupShown:"popupShown",className:"className",pitchAlignment:"pitchAlignment",rotationAlignment:"rotationAlignment"},outputs:{markerDragStart:"markerDragStart",markerDragEnd:"markerDragEnd",markerDrag:"markerDrag",dragStart:"dragStart",dragEnd:"dragEnd",drag:"drag"},features:[ii],ngContentSelectors:v3,decls:3,vars:2,consts:[["content",""]],template:function(i,r){1&i&&(Xh(),jt(0,"div",null,0),Kc(2),Yt()),2&i&&F_(r.className)},encapsulation:2,changeDetection:0})}return e})(),XJ=(()=>{class e{constructor(t){this.mapService=t,this.popupClose=new a,this.popupOpen=new a,this.close=new a,this.open=new a}ngOnInit(){if(this.warnDeprecatedOutputs(),this.lngLat&&this.marker||this.feature&&this.lngLat||this.feature&&this.marker)throw new Error("marker, lngLat, feature input are mutually exclusive")}ngOnChanges(t){if(t.lngLat&&!t.lngLat.isFirstChange()||t.feature&&!t.feature.isFirstChange()){const i=t.lngLat?this.lngLat:this.feature.geometry.coordinates;this.mapService.removePopupFromMap(this.popupInstance,!0);const r=this.createPopup();this.mapService.addPopupToMap(r,i,this.popupInstance.isOpen()),this.popupInstance=r}if(t.marker&&!t.marker.isFirstChange()){const i=t.marker.previousValue;i.markerInstance&&this.mapService.removePopupFromMarker(i.markerInstance),this.marker&&this.marker.markerInstance&&this.popupInstance&&this.mapService.addPopupToMarker(this.marker.markerInstance,this.popupInstance)}t.offset&&!t.offset.isFirstChange()&&this.popupInstance&&this.popupInstance.setOffset(this.offset)}ngAfterViewInit(){this.popupInstance=this.createPopup(),this.addPopup(this.popupInstance)}ngOnDestroy(){this.popupInstance&&(this.lngLat||this.feature?this.mapService.removePopupFromMap(this.popupInstance):this.marker&&this.marker.markerInstance&&this.mapService.removePopupFromMarker(this.marker.markerInstance)),this.popupInstance=void 0}createPopup(){return this.mapService.createPopup({popupOptions:{closeButton:this.closeButton,closeOnClick:this.closeOnClick,closeOnMove:this.closeOnMove,focusAfterOpen:this.focusAfterOpen,anchor:this.anchor,offset:this.offset,className:this.className,maxWidth:this.maxWidth},popupEvents:{open:this.open,close:this.close,popupOpen:this.popupOpen,popupClose:this.popupClose}},this.content.nativeElement)}addPopup(t){this.mapService.mapCreated$.subscribe(()=>{if(this.lngLat||this.feature)this.mapService.addPopupToMap(t,this.lngLat?this.lngLat:this.feature.geometry.coordinates);else{if(!this.marker||!this.marker.markerInstance)throw new Error("mgl-popup need either lngLat/marker/feature to be set");this.mapService.addPopupToMarker(this.marker.markerInstance,t)}})}warnDeprecatedOutputs(){const t=KE.bind(void 0,e.name);this.close.observed&&t("close","popupClose"),this.open.observed&&t("open","popupOpen")}static#e=this.\u0275fac=function(i){return new(i||e)(Et($x))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mgl-popup"]],viewQuery:function(i,r){if(1&i&&$p(y3,7),2&i){let s;Kh(s=Qh())&&(r.content=s.first)}},inputs:{closeButton:"closeButton",closeOnClick:"closeOnClick",closeOnMove:"closeOnMove",focusAfterOpen:"focusAfterOpen",anchor:"anchor",className:"className",maxWidth:"maxWidth",feature:"feature",lngLat:"lngLat",marker:"marker",offset:"offset"},outputs:{popupClose:"popupClose",popupOpen:"popupOpen",close:"close",open:"open"},features:[ii],ngContentSelectors:v3,decls:3,vars:0,consts:[["content",""]],template:function(i,r){1&i&&(Xh(),jt(0,"div",null,0),Kc(2),Yt())},encapsulation:2,changeDetection:0})}return e})(),YJ=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:b3,useValue:t.accessToken}]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[D0]})}return e})();const KJ=function(e){return{type:"geojson",data:e}},QJ=function(){return{"fill-color":"#627BC1","fill-opacity":.3}},w3=function(e,n){return[e,n]};function JJ(e,n){if(1&e&&(jt(0,"span"),Oi(1,"mgl-layer",3)(2,"mgl-marker",4,5),jt(4,"mgl-popup",6),An(5),Yt()()),2&e){const t=n.$implicit,i=n.index,r=MS(3),s=xs();Gn(1),R1("id","circle",i,""),Di("source",Wf(7,KJ,s.createCircle(t.coordinates.x,t.coordinates.y)))("paint",function CP(e,n,t){const i=pc()+e,r=Mn();return r[i]===ai?Zh(r,i,t?n.call(t):n()):function a0(e,n){return e[n]}(r,i)}(9,QJ)),Gn(1),Di("lngLat",og(10,w3,t.coordinates.x,t.coordinates.y)),Gn(2),Di("closeButton",!1)("marker",r),Gn(1),Gp(null==t?null:t.name)}}const eee=function(e){return[e]};let tee=(()=>{class e{constructor(){this.markers=[{name:"Marker 1",coordinates:{x:21,y:52.229}},{name:"Marker 2",coordinates:{x:22,y:53.228}}],this.zoom=5.5,this.center={x:19.7,y:52.1}}createCircle(t,i){return function jX(e,n,t){void 0===t&&(t={});for(var i=t.steps||64,r=t.properties?t.properties:!Array.isArray(e)&&"Feature"===e.type&&e.properties?e.properties:{},s=[],d=0;d<i;d++)s.push(UX(e,n,-360*d/i,t).geometry.coordinates);return s.push(s[0]),wx([s],r)}([t,i],5,{steps:50,units:"kilometers",properties:{foo:"bar"}})}ngOnInit(){}mapCreated(t){this.map=t}mapLoaded(t){this.map.resize()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-map-localisation"]],inputs:{markers:"markers"},decls:3,vars:10,consts:[[1,"map-container"],[3,"zoom","center","mapCreate","mapLoad"],[4,"ngFor","ngForOf"],["type","fill",3,"id","source","paint"],["anchor","center",3,"lngLat"],["marker",""],[3,"closeButton","marker"]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"mgl-map",1),vo("mapCreate",function(d){return r.mapCreated(d)})("mapLoad",function(d){return r.mapLoaded(d)}),Oo(2,JJ,6,13,"span",2),Yt()()),2&i&&(Gn(1),gu("mapbox://styles/mapbox/streets-v9"),Di("zoom",Wf(5,eee,r.zoom))("center",og(7,w3,r.center.x,r.center.y)),Gn(1),Di("ngForOf",r.markers))},dependencies:[iO,WJ,qJ,ZJ,XJ],styles:[".map-container[_ngcontent-%COMP%]{height:100%;width:100%;position:relative}mgl-map[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;inset:0;aspect-ratio:1 / 1}"]})}return e})();function nee(e,n){if(1&e&&(jt(0,"div",2),Oi(1,"app-map-localisation"),Yt()),2&e){const t=xs();Di("hidden","map"!==t.navigationMode&&t.isSmallScreen)}}let iee=(()=>{class e{constructor(t,i,r){this.auth=t,this.deviceSizeService=i,this.dialog=r,this.navigationMode="list",this.isMapVisited=!1,this.isSmallScreen=!1,this.destroy=new Ct}ngOnInit(){this.deviceSizeService.getIsSmallScreen().pipe(Jp(this.destroy)).subscribe(t=>{this.navigationMode="list",this.isSmallScreen=t})}changeNavigationMode(t){const i=t.value;this.navigationMode=i,"map"===i&&(this.isMapVisited=!0)}ngOnDestroy(){this.destroy.next(!0),this.destroy.unsubscribe()}openFilters(){this.dialog.open(HZ,{width:"500px",height:"500px"})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(uy),Et(_D),Et(oF))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-home"]],decls:61,vars:4,consts:[[1,"container"],[1,"content-container"],[1,"content",3,"hidden"],[2,"display","flex"],[1,"search-container"],[1,"search-icon"],["type","text","placeholder","Szukaj",1,"search-input"],[1,"filters-button-container"],["mat-stroked-button","",1,"filters-button",3,"click"],[1,"list-container"],[1,"list-item"],[1,"list-item-image"],["src","./assets/images/avatars/avatar1.png","alt","avatar"],[1,"list-item-content"],[1,"list-item-header"],[1,"list-item-name"],[1,"list-item-tags"],[1,"list-item-tag"],[1,"list-item-info"],[1,"list-item-city"],[1,"list-item-distance"],[1,"list-item-price"],["class","content",3,"hidden",4,"ngIf"],[1,"filters-container"],[1,"nav-buttons-container"],["name","navigationMode",1,"toggle-group-button",3,"ngModel","change"],["value","list",1,"toggle-button"],["value","map",1,"toggle-button"],["value","filters",1,"toggle-button"]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-icon",5),An(6,"search"),Yt(),Oi(7,"input",6),Yt(),jt(8,"div",7)(9,"button",8),vo("click",function(){return r.openFilters()}),An(10," Filtry "),jt(11,"mat-icon"),An(12,"filter_list"),Yt()()()(),jt(13,"div",9)(14,"div",10)(15,"div",11),Oi(16,"img",12),Yt(),jt(17,"div",13)(18,"div",14)(19,"div",15),An(20,"Mariusz Tracz"),Yt(),jt(21,"div",16)(22,"div",17),An(23,"Murarz"),Yt(),jt(24,"div",17),An(25,"Tynkarz"),Yt(),jt(26,"div",17),An(27,"Akrobata"),Yt()()(),jt(28,"div",18)(29,"div",19)(30,"mat-icon"),An(31,"location_on"),Yt(),An(32," Warszawa"),Yt(),jt(33,"div",20)(34,"mat-icon"),An(35,"outlined_flag"),Yt(),An(36,"~5km"),Yt(),jt(37,"div",21),An(38,"$ 5000-150000 PLN"),Yt()()()(),Oi(39,"div",10)(40,"div",10)(41,"div",10)(42,"div",10)(43,"div",10)(44,"div",10)(45,"div",10)(46,"div",10)(47,"div",10)(48,"div",10)(49,"div",10),Yt()(),Oo(50,nee,2,1,"div",22),jt(51,"div",2),Oi(52,"div",23),Yt()()(),jt(53,"div",24)(54,"mat-button-toggle-group",25),vo("change",function(d){return r.changeNavigationMode(d)}),jt(55,"mat-button-toggle",26),An(56,"Lista"),Yt(),jt(57,"mat-button-toggle",27),An(58,"Mapa"),Yt(),jt(59,"mat-button-toggle",28),An(60,"Filtry"),Yt()()()),2&i&&(Gn(2),Di("hidden","list"!==r.navigationMode&&r.isSmallScreen),Gn(48),Di("ngIf",r.isMapVisited||"map"===r.navigationMode||!r.isSmallScreen),Gn(1),Di("hidden","filters"!==r.navigationMode),Gn(3),Di("ngModel",r.navigationMode))},dependencies:[$_,R0,dI,JI,gD,OF,kF,tee],styles:[".container[_ngcontent-%COMP%]{width:100%;height:calc(100% - 20px);display:flex;flex-direction:column;align-items:center;padding:12px 16px}.nav-buttons-container[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100%;padding:12px 16px}.toggle-group-button[_ngcontent-%COMP%]{width:100%;height:40px;border-radius:10px}.toggle-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;background-color:var(--white);border:1px solid var(--gray-400);color:var(--gray-400);font-weight:600}.toggle-button[_ngcontent-%COMP%]:first-of-type{border-top-left-radius:10px;border-bottom-left-radius:10px}.toggle-button[_ngcontent-%COMP%]:last-of-type{border-top-right-radius:10px;border-bottom-right-radius:10px}.toggle-button.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:var(--primary-600);border-color:var(--primary-600);color:var(--white)}.filters-button-container[_ngcontent-%COMP%]{display:none}.filters-button[_ngcontent-%COMP%]{color:var(--black);height:42px;margin-left:18px;width:160px;display:flex;justify-content:revert;padding:9px 16px}.filters-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;right:12px}.content-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex}.content[_ngcontent-%COMP%]{width:100%;height:100%}.search-container[_ngcontent-%COMP%]{position:relative;width:100%}.search-container[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;top:11px;left:10px}.search-input[_ngcontent-%COMP%]{width:100%;height:42px;padding-left:42px;padding-right:12px;border-radius:8px;overflow:hidden;border:1px #d0d5dd solid}.list-container[_ngcontent-%COMP%]{margin-top:12px;width:100%;height:calc(100% - 50px);display:flex;flex-direction:column;align-items:center;gap:10px;overflow:auto}.list-item[_ngcontent-%COMP%]{display:flex;width:100%;min-height:73px;padding:6px;border:1px solid var(--gray-300);border-radius:10px;gap:5px}.list-item[_ngcontent-%COMP%]   .list-item-image[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:10px;background-color:var(--gray-300)}.list-item[_ngcontent-%COMP%]   .list-item-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:10px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:3px;width:calc(100% - 60px)}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:5px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]   .list-item-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--black);height:20px;display:flex;align-items:center}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]   .list-item-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:5px;align-items:center}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]   .list-item-tags[_ngcontent-%COMP%]   .list-item-tag[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:var(--primary-600);padding:2px 5px;border-radius:10px;font-size:10px;font-weight:600;color:var(--white);height:13px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-info[_ngcontent-%COMP%]{display:flex;gap:15px;color:var(--gray-500);font-size:8px;font-weight:600;height:18px;align-items:center}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:8px;height:8px;font-size:8px}.filters-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;padding:12px 18px;background-color:var(--white);border-radius:10px;border:1px solid var(--gray-200)}@media (min-width: 768px){.nav-buttons-container[_ngcontent-%COMP%]{display:none}.content[_ngcontent-%COMP%]{padding:0 12px}.filters-button-container[_ngcontent-%COMP%]{display:block}.list-item[_ngcontent-%COMP%]{height:81px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]   .list-item-name[_ngcontent-%COMP%]{font-size:16px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-header[_ngcontent-%COMP%]   .list-item-tags[_ngcontent-%COMP%]   .list-item-tag[_ngcontent-%COMP%]{height:24px;font-size:12px;padding:3px 10px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-info[_ngcontent-%COMP%]{display:flex;align-items:flex-end;font-size:10px}.list-item[_ngcontent-%COMP%]   .list-item-content[_ngcontent-%COMP%]   .list-item-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:12px;height:12px;font-size:12px}}"]})}return e})(),ree=(()=>{class e{constructor(t,i,r){this._router=t,this.auth=i,this.snackBar=r,this.loginForm=new ef({email:new js("",{nonNullable:!0,validators:[Jl.required,Jl.email]}),pwd:new js("",{nonNullable:!0,validators:[Jl.required]})}),this.auth.isLogged()&&this.navigateToHomePage()}navigateToRegister(){this._router.navigateByUrl("/register")}navigateToHomePage(){this._router.navigateByUrl("/home")}loginSubmit(){if(this.loginForm.valid){const t=this.loginForm.getRawValue();this.auth.login(t.email,t.pwd).then(()=>{this.navigateToHomePage()}).catch(i=>{this.snackBar.open("Niepoprawny login lub has\u0142o","Close",{duration:3e3})})}else this.loginForm.get("email")?.invalid?this.snackBar.open("Wprowad\u017a poprawny adres email","Close",{duration:3e3}):this.loginForm.get("pwd")?.invalid?this.snackBar.open("Wprowad\u017a poprawne has\u0142o","Close",{duration:3e3}):this.snackBar.open("Wype\u0142nij pola z loginem i has\u0142em","Close",{duration:3e3})}static#e=this.\u0275fac=function(i){return new(i||e)(Et(bu),Et(uy),Et(XN))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-login"]],decls:38,vars:3,consts:[[2,"width","100%","height","100%","background","white","flex-direction","column","justify-content","flex-start","align-items","center","display","inline-flex",3,"formGroup","ngSubmit"],[2,"align-self","stretch","height","100%","background","white","justify-content","flex-start","align-items","center","display","inline-flex"],[2,"flex","1 1 0","align-self","stretch","flex-direction","column","justify-content","space-between","align-items","center","display","inline-flex"],[2,"align-self","stretch","height","70px","padding","32px","justify-content","flex-start","align-items","center","display","inline-flex"],[2,"width","400px","height","44px","color","#7f56d9","font-size","36px","font-family","Inter","font-weight","700","line-height","44px","word-wrap","break-word","background-color","white","border","none","text-align","left",3,"click"],[2,"align-self","stretch","height","360px","padding-left","32px","padding-right","32px","flex-direction","column","justify-content","flex-start","align-items","center","display","flex"],[2,"height","360px","flex-direction","column","justify-content","flex-start","align-items","center","gap","16px","display","flex"],[2,"align-self","stretch","height","74px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","12px","display","flex"],[2,"align-self","stretch","color","#121212","font-size","30px","font-family","Inter","font-weight","700","line-height","38px","word-wrap","break-word"],[2,"align-self","stretch","color","#667085","font-size","16px","font-family","Inter","font-weight","400","line-height","24px","word-wrap","break-word"],[2,"align-self","stretch","height","174px","border-radius","12px","flex-direction","column","justify-content","flex-start","align-items","center","gap","24px","display","flex"],[2,"align-self","stretch","height","174px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","10px","display","flex"],[2,"align-self","stretch","height","70px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","6px","display","flex"],[2,"color","#121212","font-size","14px","font-family","Inter","font-weight","400","line-height","20px","word-wrap","break-word"],["id","email","formControlName","email","placeholder","Wpisz sw\xf3j email",1,"input"],[2,"align-self","stretch","height","94px","flex-direction","column","justify-content","flex-start","align-items","flex-start","gap","6px","display","flex"],["type","password","id","pwd","formControlName","pwd","placeholder","Wpisz sw\xf3je has\u0142o",1,"input"],[2,"width","360px","color","#667085","font-size","12px","font-family","Inter","font-weight","400","line-height","18px","word-wrap","break-word"],[2,"width","100%",3,"text","submit"],[2,"align-self","stretch","justify-content","flex-end","align-items","flex-start","gap","4px","display","inline-flex"],[2,"color","#667085","font-size","14px","font-family","Inter","font-weight","400","line-height","20px","word-wrap","break-word"],[2,"justify-content","flex-start","align-items","flex-start","display","flex"],[2,"justify-content","center","align-items","center","gap","8px","display","flex"],[1,"button_register",3,"click"],[1,"image_content"],["src","assets/images/image.png",1,"backgroundImage"]],template:function(i,r){1&i&&(jt(0,"form",0),vo("ngSubmit",function(){return r.loginSubmit()}),jt(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),vo("click",function(){return r.navigateToHomePage()}),An(5," HelpHunter "),Yt()(),jt(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),An(10," Logowanie "),Yt(),jt(11,"div",9),An(12," Witamy ponownie! Prosz\u0119 wpisa\u0107 swoje dane "),Yt()(),jt(13,"div",10)(14,"div",11)(15,"div",12)(16,"div",13),An(17," Email* "),Yt(),Oi(18,"input",14),Yt(),jt(19,"div",15)(20,"div",13),An(21," Has\u0142o* "),Yt(),Oi(22,"input",16),jt(23,"div",17),An(24," Musi mie\u0107 co najmniej 8 znak\xf3w "),Yt()()()(),Oi(25,"app-button",18),jt(26,"div",19)(27,"div",20),An(28," Nie posiadasz konta? "),Yt(),jt(29,"div",21)(30,"div",22)(31,"button",23),vo("click",function(){return r.navigateToRegister()}),An(32,"Zarejestruj si\u0119"),Yt()()()()()(),jt(33,"div",3)(34,"div",20),An(35," \xa9 HelpHunter 2023 "),Yt()()(),jt(36,"div",24),Oi(37,"img",25),Yt()()()),2&i&&(Di("formGroup",r.loginForm),Gn(25),Di("text","Zaloguj si\u0119")("submit",!0))},dependencies:[hI,P0,R0,dw,q_,B0,tE],styles:[".input[_ngcontent-%COMP%]{color:#121212;font-size:16px;font-family:Inter;font-weight:400;line-height:24px;word-wrap:break-word;align-self:stretch;height:42px;padding-left:12px;padding-right:12px;border-radius:8px;overflow:hidden;border:1px #d0d5dd solid;justify-content:flex-start;align-items:center;gap:10px;display:inline-flex}.backgroundImage[_ngcontent-%COMP%]{width:600px;height:436.507px}.button_register[_ngcontent-%COMP%]{color:#6941c6;font-size:14px;font-family:Inter;font-weight:600;line-height:20px;word-wrap:break-word;background-color:transparent;border:none}.button_register[_ngcontent-%COMP%]:hover{color:#946fe2}.image_content[_ngcontent-%COMP%]{width:720px;height:100%;padding-left:60px;padding-right:60px;background:#7f56d9;flex-direction:column;justify-content:center;align-items:center;display:inline-flex}@media (max-width: 1185px){.image_content[_ngcontent-%COMP%]{display:none}}"]})}return e})(),see=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-page-not-found"]],decls:7,vars:0,consts:[[2,"display","flex","flex-direction","column"],["routerLink","/home"]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"h1"),An(2,"Strony nie znaleziono"),Yt(),jt(3,"p"),An(4,"Przepraszamy, ale strona o podanym adresie nie istnieje."),Yt(),jt(5,"a",1),An(6,"Strona g\u0142\xf3wna"),Yt()())},dependencies:[nx]})}return e})();function aee(e,n){if(1&e){const t=$f();d0(0),jt(1,"div",5)(2,"a",6),An(3,"Strona g\u0142\xf3wna"),Yt(),jt(4,"a",7),An(5,"Wiadomo\u015bci"),Yt(),jt(6,"a",8),An(7,"Profil"),Yt()(),jt(8,"app-button",9),vo("click",function(){return Fc(t),Wl(xs().logout())}),Yt(),h0()}}function lee(e,n){if(1&e){const t=$f();jt(0,"button",11),vo("click",function(){return Fc(t),Wl(xs(2).isMobileMenuOpen=!0)}),jt(1,"mat-icon"),An(2,"menu"),Yt()()}}function cee(e,n){if(1&e){const t=$f();jt(0,"button",11),vo("click",function(){return Fc(t),Wl(xs(2).isMobileMenuOpen=!1)}),jt(1,"mat-icon"),An(2,"close"),Yt()()}}function uee(e,n){if(1&e&&(d0(0),Oo(1,lee,3,0,"button",10),Oo(2,cee,3,0,"button",10),h0()),2&e){const t=xs();Gn(1),Di("ngIf",!t.isMobileMenuOpen),Gn(1),Di("ngIf",t.isMobileMenuOpen)}}const dee=function(e){return{open:e}};function hee(e,n){if(1&e){const t=$f();jt(0,"div",12)(1,"div",13)(2,"div",14)(3,"a",15),An(4,"Strona g\u0142\xf3wna"),Yt(),Oi(5,"hr",16),jt(6,"a",17),An(7,"Wiadomo\u015bci"),Yt(),Oi(8,"hr",16),jt(9,"a",18),An(10,"Profil"),Yt()(),jt(11,"app-button",19),vo("click",function(){return Fc(t),Wl(xs().logout())}),Yt()()()}if(2&e){const t=xs();Di("ngClass",Wf(1,dee,t.isMobileMenuOpen))}}let fee=(()=>{class e{constructor(t,i){this.auth=t,this.deviceSizeService=i,this.isSmallScreen=!1,this.isMobileMenuOpen=!1,this.destroy=new Ct}ngOnInit(){this.deviceSizeService.getIsSmallScreen().pipe(Jp(this.destroy)).subscribe(t=>{this.isMobileMenuOpen=!1,this.isSmallScreen=t})}logout(){this.auth.logout()}ngOnDestroy(){this.destroy.next(!0),this.destroy.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)(Et(uy),Et(_D))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-navbar"]],decls:7,vars:3,consts:[[1,"nav-bar"],[1,"logo"],[1,"nav-buttons"],[4,"ngIf"],["class","menu-container",3,"ngClass",4,"ngIf"],[1,"nav-links"],["routerLinkActive","active","routerLink","/home",1,"link"],["routerLinkActive","active","routerLink","/chat",1,"link"],["routerLinkActive","active","routerLink","/profile",1,"link"],["text","Wyloguj si\u0119",3,"click"],["mat-icon-button","","class","menu-button",3,"click",4,"ngIf"],["mat-icon-button","",1,"menu-button",3,"click"],[1,"menu-container",3,"ngClass"],[1,"menu-content"],[2,"display","flex","flex-direction","column","justify-content","center","width","80%"],["routerLinkActive","active","routerLink","/home",1,"link","menu-link"],[1,"divider"],["routerLinkActive","active","routerLink","/chat",1,"link","menu-link"],["routerLinkActive","active","routerLink","/profile",1,"link","menu-link"],["text","Wyloguj si\u0119",2,"width","100%",3,"click"]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"h1",1),An(2,"HelpHunter"),Yt(),jt(3,"div",2),Oo(4,aee,9,0,"ng-container",3),Oo(5,uee,3,2,"ng-container",3),Yt(),Oo(6,hee,12,3,"div",4),Yt()),2&i&&(Gn(4),Di("ngIf",!r.isSmallScreen),Gn(1),Di("ngIf",r.isSmallScreen),Gn(1),Di("ngIf",r.isSmallScreen))},dependencies:[OM,$_,nx,OL,O7,gD,tE],styles:["@media (max-width: 768px){[_nghost-%COMP%]   .nav-bar[_ngcontent-%COMP%]{height:50px!important;padding:15px!important}[_nghost-%COMP%]   .nav-bar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{font-size:24px}}.nav-bar[_ngcontent-%COMP%]{height:70px;width:100%;padding:13px 39px;display:flex;justify-content:space-between}.logo[_ngcontent-%COMP%]{color:var(--primary-600);word-wrap:break-word;font-size:36px;margin:0;-webkit-user-select:none;user-select:none}.nav-buttons[_ngcontent-%COMP%]{display:flex;gap:27px}.nav-links[_ngcontent-%COMP%]{display:flex;align-items:center;gap:32px;-webkit-user-select:none;user-select:none}.link[_ngcontent-%COMP%]{color:var(--gray-500);font-weight:600;cursor:pointer;text-decoration:none}.link[_ngcontent-%COMP%]:hover{color:var(--primary-600)}.link.active[_ngcontent-%COMP%]{color:var(--primary-600);text-decoration:underline}.link.menu-link[_ngcontent-%COMP%]{width:100%;height:24px;padding:16px 0;text-align:center;text-decoration:none}.menu-button[_ngcontent-%COMP%]{width:24px;height:24px;padding:0;display:inline-flex;align-items:center;justify-content:center}.menu-button[_ngcontent-%COMP%]   .mat-mdc-button-touch-target[_ngcontent-%COMP%]{width:24px;height:24px}.menu-container[_ngcontent-%COMP%]{position:absolute;top:50px;right:0;width:100vw;height:0;background-color:var(--white);transition:height .5s;z-index:1000;overflow:hidden}.menu-container.open[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.menu-content[_ngcontent-%COMP%]{width:100%;height:100%;padding:48px 16px 24px;display:flex;flex-direction:column;align-items:center;justify-content:space-between;gap:20px}.menu-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;border-color:var(--gray-200)}"]})}return e})(),pee=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-footbar"]],decls:3,vars:0,consts:[[1,"footbar"],[1,"footbar-text"]],template:function(i,r){1&i&&(jt(0,"div",0)(1,"p",1),An(2,"\xa9 HelpHunter 2023"),Yt()())},styles:[".footbar[_ngcontent-%COMP%]{width:100%;height:70px;padding:32px}.footbar-text[_ngcontent-%COMP%]{margin:0;font-size:14px;color:var(--gray-500);line-height:20px}@media (max-width: 768px){.footbar[_ngcontent-%COMP%]{height:50px;padding:15px}.footbar-text[_ngcontent-%COMP%]{font-size:12px}}"]})}return e})();const mee=function(e){return{height:e}};let gee=(()=>{class e{constructor(t,i){this.auth=t,this.deviceSizeService=i,this.isSmallScreen=!1,this.destroy=new Ct}ngOnInit(){this.deviceSizeService.getIsSmallScreen().pipe(Jp(this.destroy)).subscribe(t=>{this.isSmallScreen=t})}ngOnDestroy(){this.destroy.next(!0),this.destroy.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)(Et(uy),Et(_D))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-main"]],decls:5,vars:3,consts:[[1,"main-container"],[1,"content",3,"ngStyle"]],template:function(i,r){1&i&&(jt(0,"div",0),Oi(1,"app-navbar"),jt(2,"div",1),Oi(3,"router-outlet"),Yt(),Oi(4,"app-footbar"),Yt()),2&i&&(Gn(2),Di("ngStyle",Wf(1,mee,r.isSmallScreen?"calc(100% - 100px)":"calc(100% - 140px)")))},dependencies:[NM,Rw,fee,pee],styles:[".main-container[_ngcontent-%COMP%]{width:100vw;height:100vh;max-width:100%;max-height:100%;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{width:100%}"]})}return e})(),_ee=(()=>{class e{constructor(t){this.http=t,this.apiUrl="http://localhost:3000/api/user"}getUserData(){return this.http.get(this.apiUrl)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_g))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const yee=["*"],bee=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],wee=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],Eee=new Pn("MAT_CARD_CONFIG");let E3=(()=>{class e{constructor(t){this.appearance=t?.appearance||"raised"}static#e=this.\u0275fac=function(i){return new(i||e)(Et(Eee,8))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,r){2&i&&Uu("mat-mdc-card-outlined","outlined"===r.appearance)("mdc-card--outlined","outlined"===r.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:yee,decls:1,vars:0,template:function(i,r){1&i&&(Xh(),Kc(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation);--mdc-elevated-card-container-shape:4px;--mdc-outlined-card-container-shape:4px;--mdc-outlined-card-outline-width:1px}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return e})(),C3=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=vn({type:e,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return e})(),S3=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Gi({type:e,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:wee,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(i,r){1&i&&(Xh(bee),Kc(0),jt(1,"div",0),Kc(2,1),Yt(),Kc(3,2))},encapsulation:2,changeDetection:0})}return e})(),Dee=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,D0,yc]})}return e})();function Tee(e,n){if(1&e){const t=$f();jt(0,"app-button",19),vo("click",function(){return Fc(t),Wl(xs().editData())}),Yt()}}function Aee(e,n){if(1&e){const t=$f();jt(0,"app-button",20),vo("click",function(){return Fc(t),Wl(xs().cancel())}),Yt()}}function Pee(e,n){if(1&e){const t=$f();jt(0,"app-button",21),vo("click",function(){return Fc(t),Wl(xs().save())}),Yt()}}function Ree(e,n){if(1&e&&(jt(0,"p"),An(1),Yt()),2&e){const t=xs();Gn(1),OS("",null==t.user?null:t.user.FIRST_NAME," ",null==t.user?null:t.user.LAST_NAME,"")}}function Oee(e,n){if(1&e&&Oi(0,"input",22),2&e){const t=xs();Hf("value",null==t.user?null:t.user.FIRST_NAME)}}function kee(e,n){if(1&e&&Oi(0,"input",22),2&e){const t=xs();Hf("value",null==t.user?null:t.user.LAST_NAME)}}function Lee(e,n){if(1&e&&(jt(0,"p"),An(1),Yt()),2&e){const t=xs();Gn(1),Gp(null==t.user?null:t.user.PHONE_NUMBER)}}function Nee(e,n){if(1&e&&Oi(0,"input",22),2&e){const t=xs();Hf("value",null==t.user?null:t.user.PHONE_NUMBER)}}function Fee(e,n){if(1&e&&(jt(0,"p"),An(1),Yt()),2&e){const t=xs();Gn(1),Gp(null==t.user?null:t.user.EMAIL)}}function Bee(e,n){if(1&e&&Oi(0,"input",22),2&e){const t=xs();Hf("value",null==t.user?null:t.user.EMAIL)}}function zee(e,n){if(1&e&&(jt(0,"p"),An(1),Yt()),2&e){const t=xs();Gn(1),Gp(null==t.user?null:t.user.ADDRESS)}}function Vee(e,n){if(1&e&&Oi(0,"input",22),2&e){const t=xs();Hf("value",null==t.user?null:t.user.ADDRESS)}}function Uee(e,n){1&e&&(jt(0,"div",23),An(1,"W\u0142\u0105czony"),Yt())}function jee(e,n){1&e&&(jt(0,"div",24),An(1,"W\u0142\u0105czony"),Yt())}function Gee(e,n){1&e&&(jt(0,"div",25),An(1,"Wy\u0142\u0105czony"),Yt())}function $ee(e,n){1&e&&(jt(0,"div",26),An(1,"Wy\u0142\u0105czony"),Yt())}function Hee(e,n){if(1&e&&(jt(0,"p"),An(1),Yt()),2&e){const t=xs(2);Gn(1),Gp(null==t.user?null:t.user.ADDITIONAL_INFO)}}function qee(e,n){if(1&e&&Oi(0,"input",22),2&e){const t=xs(2);Hf("value",null==t.user?null:t.user.ADDITIONAL_INFO)}}function Wee(e,n){if(1&e&&(jt(0,"mat-card-content",2)(1,"div",3)(2,"p"),An(3,"O firmie"),Yt()(),jt(4,"div",9),Oo(5,Hee,2,1,"p",10),Oo(6,qee,1,1,"input",11),Yt()()),2&e){const t=xs();Gn(5),Di("ngIf",!t.isEdit),Gn(1),Di("ngIf",t.isEdit)}}function Zee(e,n){if(1&e&&(jt(0,"mat-card-content",2)(1,"div",3)(2,"p"),An(3,"List us\u0142ug"),Yt()(),jt(4,"div",9)(5,"p"),An(6),Yt()()()),2&e){const t=xs();Gn(6),Gp(null==t.user?null:t.user.SERVICES)}}const Xee=[{path:"",component:gee,canActivate:[(e,n)=>Rn(uy).canActivate()],children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:iee},{path:"profile",component:(()=>{class e{constructor(t){this.userService=t,this.isEdit=!1,this.isOn=!1}ngOnInit(){this.getUserData()}getUserData(){this.userService.getUserData().subscribe(t=>{this.user=t},t=>{console.error(t)})}editData(){this.isEdit=!0}cancel(){this.isEdit=!1}save(){this.isEdit=!1}swipeOnOff(){this.isOn=!this.isOn}static#e=this.\u0275fac=function(i){return new(i||e)(Et(_ee))};static#t=this.\u0275cmp=Gi({type:e,selectors:[["app-profile"]],decls:65,vars:19,consts:[[1,"header"],["fxLayoutAlign","space-between center","fxLayoutGap","20px",1,"py-4"],[1,"list-item",2,"display","flex","margin","auto"],[1,"start-list"],[2,"color","gray"],[1,"end-list",2,"text-align","right"],["text","Edytuj",3,"click",4,"ngIf"],["type","stroked","text","Anuluj","style","margin-right: 5px; border: 2px black",3,"click",4,"ngIf"],["text","Zapisz",3,"click",4,"ngIf"],[1,"end-list"],[4,"ngIf"],["class","input",3,"value",4,"ngIf"],[1,"image",3,"src"],[1,"end-list","expert"],["class","expert-true","style","border-bottom-right-radius: 0; border-top-right-radius: 0",4,"ngIf"],["class","expert-false","style","border-bottom-right-radius: 0; border-top-right-radius: 0",4,"ngIf"],["class","expert-true","style","border-bottom-left-radius: 0; border-top-left-radius: 0",4,"ngIf"],["class","expert-false","style","border-bottom-left-radius: 0; border-top-left-radius: 0",4,"ngIf"],["class","list-item","style","display: flex; margin: auto",4,"ngIf"],["text","Edytuj",3,"click"],["type","stroked","text","Anuluj",2,"margin-right","5px","border","2px black",3,"click"],["text","Zapisz",3,"click"],[1,"input",3,"value"],[1,"expert-true",2,"border-bottom-right-radius","0","border-top-right-radius","0"],[1,"expert-false",2,"border-bottom-right-radius","0","border-top-right-radius","0"],[1,"expert-true",2,"border-bottom-left-radius","0","border-top-left-radius","0"],[1,"expert-false",2,"border-bottom-left-radius","0","border-top-left-radius","0"]],template:function(i,r){1&i&&(jt(0,"mat-card")(1,"mat-card-header")(2,"div",0),An(3,"M\xf3j profil"),Yt()(),jt(4,"mat-card-content",1)(5,"mat-card-content",2)(6,"div",3)(7,"p"),An(8,"Dane kontaktowe "),Oi(9,"br"),jt(10,"small",4),An(11,"Zaktualizuj swoje zdj\u0119cie i data osobwe."),Yt()()(),jt(12,"div",5),Oo(13,Tee,1,0,"app-button",6),Oo(14,Aee,1,0,"app-button",7),Oo(15,Pee,1,0,"app-button",8),Yt()(),jt(16,"mat-card-content",2)(17,"div",3)(18,"p"),An(19,"Imi\u0119 i nazwisko"),Yt()(),jt(20,"div",9),Oo(21,Ree,2,2,"p",10),Oo(22,Oee,1,1,"input",11),Oo(23,kee,1,1,"input",11),Yt()(),jt(24,"mat-card-content",2)(25,"div",3)(26,"p"),An(27,"Telefon"),Yt()(),jt(28,"div",9),Oo(29,Lee,2,1,"p",10),Oo(30,Nee,1,1,"input",11),Yt()(),jt(31,"mat-card-content",2)(32,"div",3)(33,"p"),An(34,"Email"),Yt()(),jt(35,"div",9),Oo(36,Fee,2,1,"p",10),Oo(37,Bee,1,1,"input",11),Yt()(),jt(38,"mat-card-content",2)(39,"div",3)(40,"p"),An(41,"Tw\xf3j avatar "),Oi(42,"br"),jt(43,"small",4),An(44,"B\u0119dzie to widoczne na Twoim profilu."),Yt()()(),jt(45,"div",9),Oi(46,"img",12),Yt()(),jt(47,"mat-card-content",2)(48,"div",3)(49,"p"),An(50,"Adres"),Yt()(),jt(51,"div",9),Oo(52,zee,2,1,"p",10),Oo(53,Vee,1,1,"input",11),Yt()(),jt(54,"mat-card-content",2)(55,"div",3)(56,"p"),An(57,"Tryb specjalisty"),Yt()(),jt(58,"div",13),Oo(59,Uee,2,0,"div",14),Oo(60,jee,2,0,"div",15),Oo(61,Gee,2,0,"div",16),Oo(62,$ee,2,0,"div",17),Yt()(),Oo(63,Wee,7,2,"mat-card-content",18),Oo(64,Zee,7,1,"mat-card-content",18),Yt()()),2&i&&(Gn(13),Di("ngIf",!r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(6),Di("ngIf",!r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(6),Di("ngIf",!r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(6),Di("ngIf",!r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(9),Hf("src",null==r.user?null:r.user.AVATAR,Vu),Gn(6),Di("ngIf",!r.isEdit),Gn(1),Di("ngIf",r.isEdit),Gn(6),Di("ngIf",null==r.user?null:r.user.EXPERT),Gn(1),Di("ngIf",!(null!=r.user&&r.user.EXPERT)),Gn(1),Di("ngIf",!(null!=r.user&&r.user.EXPERT)),Gn(1),Di("ngIf",null==r.user?null:r.user.EXPERT),Gn(1),Di("ngIf",null==r.user?null:r.user.EXPERT),Gn(1),Di("ngIf",null==r.user?null:r.user.EXPERT))},dependencies:[$_,E3,C3,S3,tE],styles:[".header[_ngcontent-%COMP%]{font-size:30px;font-weight:700;align-items:center;padding:10px;margin-left:14px}.expert[_ngcontent-%COMP%]{display:inline-grid;grid-template-columns:10% 10% 80%;justify-content:left}.expert-true[_ngcontent-%COMP%]{text-align:center;border:1px solid #7f56d9;border-radius:10px;background-color:#7f56d9;color:#fff;padding:7px}.expert-false[_ngcontent-%COMP%]{text-align:center;border:1px solid #7f56d9;border-radius:10px;background-color:#fff;color:#7f56d9;padding:7px}.start-list[_ngcontent-%COMP%]{width:15%;font-size:18px}.end-list[_ngcontent-%COMP%]{width:85%;text-align:left;align-content:center;justify-content:center;align-items:center;font-size:18px}.list-item[_ngcontent-%COMP%]{align-items:center;border-bottom:lightgray 1px solid;padding:10px}.list-item-end[_ngcontent-%COMP%]{align-items:center;padding:10px}.image[_ngcontent-%COMP%]{border-radius:10%;width:75px;height:75px;margin-top:10px}.input[_ngcontent-%COMP%]{color:#121212;font-size:16px;font-family:Inter;font-weight:400;line-height:24px;word-wrap:break-word;align-self:stretch;height:42px;padding-left:12px;padding-right:12px;border-radius:8px;overflow:hidden;border:1px #d0d5dd solid;justify-content:flex-start;align-items:center;gap:10px;display:inline-flex;margin-right:10px}"]})}return e})()}]},{path:"register",component:BW},{path:"login",component:ree},{path:"**",component:see}];let Yee=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[UL.forRoot(Xee,{preloadingStrategy:l9}),UL]})}return e})();function M3(e){return new Ot(3e3,!1)}function lm(e){switch(e.length){case 0:return new hx;case 1:return e[0];default:return new PN(e)}}function I3(e,n,t=new Map,i=new Map){const r=[],s=[];let d=-1,p=null;if(n.forEach(v=>{const x=v.get("offset"),M=x==d,R=M&&p||new Map;v.forEach((L,F)=>{let Y=F,X=L;if("offset"!==F)switch(Y=e.normalizePropertyName(Y,r),X){case"!":X=t.get(F);break;case ep:X=i.get(F);break;default:X=e.normalizeStyleValue(F,Y,X,r)}R.set(Y,X)}),M||s.push(R),p=R,d=x}),r.length)throw function vte(e){return new Ot(3502,!1)}();return s}function OT(e,n,t,i){switch(n){case"start":e.onStart(()=>i(t&&kT(t,"start",e)));break;case"done":e.onDone(()=>i(t&&kT(t,"done",e)));break;case"destroy":e.onDestroy(()=>i(t&&kT(t,"destroy",e)))}}function kT(e,n,t){const s=LT(e.element,e.triggerName,e.fromState,e.toState,n||e.phaseName,t.totalTime??e.totalTime,!!t.disabled),d=e._data;return null!=d&&(s._data=d),s}function LT(e,n,t,i,r="",s=0,d){return{element:e,triggerName:n,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!d}}function hd(e,n,t){let i=e.get(n);return i||e.set(n,i=t),i}function D3(e){const n=e.indexOf(":");return[e.substring(1,n),e.slice(n+1)]}const Pte=(()=>typeof document>"u"?null:document.documentElement)();function NT(e){const n=e.parentNode||e.host||null;return n===Pte?null:n}let Cg=null,T3=!1;function A3(e,n){for(;n;){if(n===e)return!0;n=NT(n)}return!1}function P3(e,n,t){if(t)return Array.from(e.querySelectorAll(n));const i=e.querySelector(n);return i?[i]:[]}let R3=(()=>{class e{validateStyleProperty(t){return function Ote(e){Cg||(Cg=function kte(){return typeof document<"u"?document.body:null}()||{},T3=!!Cg.style&&"WebkitAppearance"in Cg.style);let n=!0;return Cg.style&&!function Rte(e){return"ebkit"==e.substring(1,6)}(e)&&(n=e in Cg.style,!n&&T3&&(n="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in Cg.style)),n}(t)}matchesElement(t,i){return!1}containsElement(t,i){return A3(t,i)}getParentElement(t){return NT(t)}query(t,i,r){return P3(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,d,p=[],v){return new hx(r,s)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),FT=(()=>{class e{static#e=this.NOOP=new R3}return e})();const Lte=1e3,BT="ng-enter",QE="ng-leave",JE="ng-trigger",eC=".ng-trigger",k3="ng-animating",zT=".ng-animating";function op(e){if("number"==typeof e)return e;const n=e.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:VT(parseFloat(n[1]),n[2])}function VT(e,n){return"s"===n?e*Lte:e}function tC(e,n,t){return e.hasOwnProperty("duration")?e:function Fte(e,n,t){let r,s=0,d="";if("string"==typeof e){const p=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===p)return n.push(M3()),{duration:0,delay:0,easing:""};r=VT(parseFloat(p[1]),p[2]);const v=p[3];null!=v&&(s=VT(parseFloat(v),p[4]));const x=p[5];x&&(d=x)}else r=e;if(!t){let p=!1,v=n.length;r<0&&(n.push(function Kee(){return new Ot(3100,!1)}()),p=!0),s<0&&(n.push(function Qee(){return new Ot(3101,!1)}()),p=!0),p&&n.splice(v,0,M3())}return{duration:r,delay:s,easing:d}}(e,n,t)}function Hx(e,n={}){return Object.keys(e).forEach(t=>{n[t]=e[t]}),n}function L3(e){const n=new Map;return Object.keys(e).forEach(t=>{n.set(t,e[t])}),n}function cm(e,n=new Map,t){if(t)for(let[i,r]of t)n.set(i,r);for(let[i,r]of e)n.set(i,r);return n}function df(e,n,t){n.forEach((i,r)=>{const s=jT(r);t&&!t.has(r)&&t.set(r,e.style[s]),e.style[s]=i})}function Sg(e,n){n.forEach((t,i)=>{const r=jT(i);e.style[r]=""})}function qx(e){return Array.isArray(e)?1==e.length?e[0]:DN(e):e}const UT=new RegExp("{{\\s*(.+?)\\s*}}","g");function F3(e){let n=[];if("string"==typeof e){let t;for(;t=UT.exec(e);)n.push(t[1]);UT.lastIndex=0}return n}function Wx(e,n,t){const i=e.toString(),r=i.replace(UT,(s,d)=>{let p=n[d];return null==p&&(t.push(function ete(e){return new Ot(3003,!1)}()),p=""),p.toString()});return r==i?e:r}function nC(e){const n=[];let t=e.next();for(;!t.done;)n.push(t.value),t=e.next();return n}const Vte=/-+([a-z0-9])/g;function jT(e){return e.replace(Vte,(...n)=>n[1].toUpperCase())}function fd(e,n,t){switch(n.type){case 7:return e.visitTrigger(n,t);case 0:return e.visitState(n,t);case 1:return e.visitTransition(n,t);case 2:return e.visitSequence(n,t);case 3:return e.visitGroup(n,t);case 4:return e.visitAnimate(n,t);case 5:return e.visitKeyframes(n,t);case 6:return e.visitStyle(n,t);case 8:return e.visitReference(n,t);case 9:return e.visitAnimateChild(n,t);case 10:return e.visitAnimateRef(n,t);case 11:return e.visitQuery(n,t);case 12:return e.visitStagger(n,t);default:throw function tte(e){return new Ot(3004,!1)}()}}function B3(e,n){return window.getComputedStyle(e)[n]}const iC="*";function Gte(e,n){const t=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function $te(e,n,t){if(":"==e[0]){const v=function Hte(e,n){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return n.push(function mte(e){return new Ot(3016,!1)}()),"* => *"}}(e,t);if("function"==typeof v)return void n.push(v);e=v}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function pte(e){return new Ot(3015,!1)}()),n;const r=i[1],s=i[2],d=i[3];n.push(z3(r,d));"<"==s[0]&&!(r==iC&&d==iC)&&n.push(z3(d,r))}(i,t,n)):t.push(e),t}const rC=new Set(["true","1"]),oC=new Set(["false","0"]);function z3(e,n){const t=rC.has(e)||oC.has(e),i=rC.has(n)||oC.has(n);return(r,s)=>{let d=e==iC||e==r,p=n==iC||n==s;return!d&&t&&"boolean"==typeof r&&(d=r?rC.has(e):oC.has(e)),!p&&i&&"boolean"==typeof s&&(p=s?rC.has(n):oC.has(n)),d&&p}}const qte=new RegExp("s*:selfs*,?","g");function GT(e,n,t,i){return new Wte(e).build(n,t,i)}class Wte{constructor(n){this._driver=n}build(n,t,i){const r=new Yte(t);return this._resetContextStyleTimingState(r),fd(this,qx(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],d=[];return"@"==n.name.charAt(0)&&t.errors.push(function ite(){return new Ot(3006,!1)}()),n.definitions.forEach(p=>{if(this._resetContextStyleTimingState(t),0==p.type){const v=p,x=v.name;x.toString().split(/\s*,\s*/).forEach(M=>{v.name=M,s.push(this.visitState(v,t))}),v.name=x}else if(1==p.type){const v=this.visitTransition(p,t);i+=v.queryCount,r+=v.depCount,d.push(v)}else t.errors.push(function rte(){return new Ot(3007,!1)}())}),{type:7,name:n.name,states:s,transitions:d,queryCount:i,depCount:r,options:null}}visitState(n,t){const i=this.visitStyle(n.styles,t),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const s=new Set,d=r||{};i.styles.forEach(p=>{p instanceof Map&&p.forEach(v=>{F3(v).forEach(x=>{d.hasOwnProperty(x)||s.add(x)})})}),s.size&&(nC(s.values()),t.errors.push(function ote(e,n){return new Ot(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,t){t.queryCount=0,t.depCount=0;const i=fd(this,qx(n.animation),t);return{type:1,matchers:Gte(n.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Mg(n.options)}}visitSequence(n,t){return{type:2,steps:n.steps.map(i=>fd(this,i,t)),options:Mg(n.options)}}visitGroup(n,t){const i=t.currentTime;let r=0;const s=n.steps.map(d=>{t.currentTime=i;const p=fd(this,d,t);return r=Math.max(r,t.currentTime),p});return t.currentTime=r,{type:3,steps:s,options:Mg(n.options)}}visitAnimate(n,t){const i=function Qte(e,n){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return $T(tC(e,n).duration,0,"");const t=e;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=$T(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=tC(t,n);return $T(r.duration,r.delay,r.easing)}(n.timings,t.errors);t.currentAnimateTimings=i;let r,s=n.styles?n.styles:ph({});if(5==s.type)r=this.visitKeyframes(s,t);else{let d=n.styles,p=!1;if(!d){p=!0;const x={};i.easing&&(x.easing=i.easing),d=ph(x)}t.currentTime+=i.duration+i.delay;const v=this.visitStyle(d,t);v.isEmptyStep=p,r=v}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,t){const i=this._makeStyleAst(n,t);return this._validateStyleAst(i,t),i}_makeStyleAst(n,t){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let p of r)"string"==typeof p?p===ep?i.push(p):t.errors.push(new Ot(3002,!1)):i.push(L3(p));let s=!1,d=null;return i.forEach(p=>{if(p instanceof Map&&(p.has("easing")&&(d=p.get("easing"),p.delete("easing")),!s))for(let v of p.values())if(v.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:d,offset:n.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(n,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),n.styles.forEach(d=>{"string"!=typeof d&&d.forEach((p,v)=>{const x=t.collectedStyles.get(t.currentQuerySelector),M=x.get(v);let R=!0;M&&(s!=r&&s>=M.startTime&&r<=M.endTime&&(t.errors.push(function ate(e,n,t,i,r){return new Ot(3010,!1)}()),R=!1),s=M.startTime),R&&x.set(v,{startTime:s,endTime:r}),t.options&&function zte(e,n,t){const i=n.params||{},r=F3(e);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Jee(e){return new Ot(3001,!1)}())})}(p,t.options,t.errors)})})}visitKeyframes(n,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function lte(){return new Ot(3011,!1)}()),i;let s=0;const d=[];let p=!1,v=!1,x=0;const M=n.steps.map(ae=>{const Q=this._makeStyleAst(ae,t);let me=null!=Q.offset?Q.offset:function Kte(e){if("string"==typeof e)return null;let n=null;if(Array.isArray(e))e.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const t=e;n=parseFloat(t.get("offset")),t.delete("offset")}return n}(Q.styles),Xe=0;return null!=me&&(s++,Xe=Q.offset=me),v=v||Xe<0||Xe>1,p=p||Xe<x,x=Xe,d.push(Xe),Q});v&&t.errors.push(function cte(){return new Ot(3012,!1)}()),p&&t.errors.push(function ute(){return new Ot(3200,!1)}());const R=n.steps.length;let L=0;s>0&&s<R?t.errors.push(function dte(){return new Ot(3202,!1)}()):0==s&&(L=1/(R-1));const F=R-1,Y=t.currentTime,X=t.currentAnimateTimings,ye=X.duration;return M.forEach((ae,Q)=>{const me=L>0?Q==F?1:L*Q:d[Q],Xe=me*ye;t.currentTime=Y+X.delay+Xe,X.duration=Xe,this._validateStyleAst(ae,t),ae.offset=me,i.styles.push(ae)}),i}visitReference(n,t){return{type:8,animation:fd(this,qx(n.animation),t),options:Mg(n.options)}}visitAnimateChild(n,t){return t.depCount++,{type:9,options:Mg(n.options)}}visitAnimateRef(n,t){return{type:10,animation:this.visitReference(n.animation,t),options:Mg(n.options)}}visitQuery(n,t){const i=t.currentQuerySelector,r=n.options||{};t.queryCount++,t.currentQuery=n;const[s,d]=function Zte(e){const n=!!e.split(/\s*,\s*/).find(t=>":self"==t);return n&&(e=e.replace(qte,"")),e=e.replace(/@\*/g,eC).replace(/@\w+/g,t=>eC+"-"+t.slice(1)).replace(/:animating/g,zT),[e,n]}(n.selector);t.currentQuerySelector=i.length?i+" "+s:s,hd(t.collectedStyles,t.currentQuerySelector,new Map);const p=fd(this,qx(n.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:d,animation:p,originalSelector:n.selector,options:Mg(n.options)}}visitStagger(n,t){t.currentQuery||t.errors.push(function hte(){return new Ot(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:tC(n.timings,t.errors,!0);return{type:12,animation:fd(this,qx(n.animation),t),timings:i,options:null}}}class Yte{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Mg(e){return e?(e=Hx(e)).params&&(e.params=function Xte(e){return e?Hx(e):null}(e.params)):e={},e}function $T(e,n,t){return{duration:e,delay:n,easing:t}}function HT(e,n,t,i,r,s,d=null,p=!1){return{type:1,element:e,keyframes:n,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:d,subTimeline:p}}class sC{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,t){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...t)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const tne=new RegExp(":enter","g"),ine=new RegExp(":leave","g");function qT(e,n,t,i,r,s=new Map,d=new Map,p,v,x=[]){return(new rne).buildKeyframes(e,n,t,i,r,s,d,p,v,x)}class rne{buildKeyframes(n,t,i,r,s,d,p,v,x,M=[]){x=x||new sC;const R=new WT(n,t,x,r,s,M,[]);R.options=v;const L=v.delay?op(v.delay):0;R.currentTimeline.delayNextStep(L),R.currentTimeline.setStyles([d],null,R.errors,v),fd(this,i,R);const F=R.timelines.filter(Y=>Y.containsAnimation());if(F.length&&p.size){let Y;for(let X=F.length-1;X>=0;X--){const ye=F[X];if(ye.element===t){Y=ye;break}}Y&&!Y.allowOnlyTimelineStyles()&&Y.setStyles([p],null,R.errors,v)}return F.length?F.map(Y=>Y.buildKeyframes()):[HT(t,[],[],[],0,L,"",!1)]}visitTrigger(n,t){}visitState(n,t){}visitTransition(n,t){}visitAnimateChild(n,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(n.options),s=t.currentTimeline.currentTime,d=this._visitSubInstructions(i,r,r.options);s!=d&&t.transformIntoNewTimeline(d)}t.previousNode=n}visitAnimateRef(n,t){const i=t.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],t,i),this.visitReference(n.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=n}_applyAnimationRefDelays(n,t,i){for(const r of n){const s=r?.delay;if(s){const d="number"==typeof s?s:op(Wx(s,r?.params??{},t.errors));i.delayNextStep(d)}}}_visitSubInstructions(n,t,i){let s=t.currentTimeline.currentTime;const d=null!=i.duration?op(i.duration):null,p=null!=i.delay?op(i.delay):null;return 0!==d&&n.forEach(v=>{const x=t.appendInstructionToTimeline(v,d,p);s=Math.max(s,x.duration+x.delay)}),s}visitReference(n,t){t.updateOptions(n.options,!0),fd(this,n.animation,t),t.previousNode=n}visitSequence(n,t){const i=t.subContextCount;let r=t;const s=n.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=aC);const d=op(s.delay);r.delayNextStep(d)}n.steps.length&&(n.steps.forEach(d=>fd(this,d,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=n}visitGroup(n,t){const i=[];let r=t.currentTimeline.currentTime;const s=n.options&&n.options.delay?op(n.options.delay):0;n.steps.forEach(d=>{const p=t.createSubContext(n.options);s&&p.delayNextStep(s),fd(this,d,p),r=Math.max(r,p.currentTimeline.currentTime),i.push(p.currentTimeline)}),i.forEach(d=>t.currentTimeline.mergeTimelineCollectedStyles(d)),t.transformIntoNewTimeline(r),t.previousNode=n}_visitTiming(n,t){if(n.dynamic){const i=n.strValue;return tC(t.params?Wx(i,t.params,t.errors):i,t.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,t){const i=t.currentAnimateTimings=this._visitTiming(n.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=n.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=n}visitStyle(n,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(s):i.setStyles(n.styles,s,t.errors,t.options),t.previousNode=n}visitKeyframes(n,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,p=t.createSubContext().currentTimeline;p.easing=i.easing,n.styles.forEach(v=>{p.forwardTime((v.offset||0)*s),p.setStyles(v.styles,v.easing,t.errors,t.options),p.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(p),t.transformIntoNewTimeline(r+s),t.previousNode=n}visitQuery(n,t){const i=t.currentTimeline.currentTime,r=n.options||{},s=r.delay?op(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=aC);let d=i;const p=t.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=p.length;let v=null;p.forEach((x,M)=>{t.currentQueryIndex=M;const R=t.createSubContext(n.options,x);s&&R.delayNextStep(s),x===t.element&&(v=R.currentTimeline),fd(this,n.animation,R),R.currentTimeline.applyStylesToKeyframe(),d=Math.max(d,R.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(d),v&&(t.currentTimeline.mergeTimelineCollectedStyles(v),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=n}visitStagger(n,t){const i=t.parentContext,r=t.currentTimeline,s=n.timings,d=Math.abs(s.duration),p=d*(t.currentQueryTotal-1);let v=d*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":v=p-v;break;case"full":v=i.currentStaggerTime}const M=t.currentTimeline;v&&M.delayNextStep(v);const R=M.currentTime;fd(this,n.animation,t),t.previousNode=n,i.currentStaggerTime=r.currentTime-R+(r.startTime-i.currentTimeline.startTime)}}const aC={};class WT{constructor(n,t,i,r,s,d,p,v){this._driver=n,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=d,this.timelines=p,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=aC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=v||new lC(this._driver,t,0),p.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,t){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=op(i.duration)),null!=i.delay&&(r.delay=op(i.delay));const s=i.params;if(s){let d=r.params;d||(d=this.options.params={}),Object.keys(s).forEach(p=>{(!t||!d.hasOwnProperty(p))&&(d[p]=Wx(s[p],d,this.errors))})}}_copyOptions(){const n={};if(this.options){const t=this.options.params;if(t){const i=n.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return n}createSubContext(n=null,t,i){const r=t||this.element,s=new WT(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=aC,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,t,i){const r={duration:t??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},s=new one(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,t,i,r,s,d){let p=[];if(r&&p.push(this.element),n.length>0){n=(n=n.replace(tne,"."+this._enterClassName)).replace(ine,"."+this._leaveClassName);let x=this._driver.query(this.element,n,1!=i);0!==i&&(x=i<0?x.slice(x.length+i,x.length):x.slice(0,i)),p.push(...x)}return!s&&0==p.length&&d.push(function fte(e){return new Ot(3014,!1)}()),p}}class lC{constructor(n,t,i,r){this._driver=n,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+n),t&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,t){return this.applyStylesToKeyframe(),new lC(this._driver,n,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,t){this._localTimelineStyles.set(n,t),this._globalTimelineStyles.set(n,t),this._styleSummary.set(n,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||ep),this._currentKeyframe.set(t,ep);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},d=function sne(e,n){const t=new Map;let i;return e.forEach(r=>{if("*"===r){i=i||n.keys();for(let s of i)t.set(s,ep)}else cm(r,t)}),t}(n,this._globalTimelineStyles);for(let[p,v]of d){const x=Wx(v,s,i);this._pendingStyles.set(p,x),this._localTimelineStyles.has(p)||this._backFill.set(p,this._globalTimelineStyles.get(p)??ep),this._updateStyle(p,x)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,t)=>{this._currentKeyframe.set(t,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,n)}))}snapshotCurrentStyles(){for(let[n,t]of this._localTimelineStyles)this._pendingStyles.set(n,t),this._updateStyle(n,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let t in this._currentKeyframe)n.push(t);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((p,v)=>{const x=cm(p,new Map,this._backFill);x.forEach((M,R)=>{"!"===M?n.add(R):M===ep&&t.add(R)}),i||x.set("offset",v/this.duration),r.push(x)});const s=n.size?nC(n.values()):[],d=t.size?nC(t.values()):[];if(i){const p=r[0],v=new Map(p);p.set("offset",0),v.set("offset",1),r=[p,v]}return HT(this.element,r,s,d,this.duration,this.startTime,this.easing,!1)}}class one extends lC{constructor(n,t,i,r,s,d,p=!1){super(n,t,d.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=p,this.timings={duration:d.duration,delay:d.delay,easing:d.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],d=i+t,p=t/d,v=cm(n[0]);v.set("offset",0),s.push(v);const x=cm(n[0]);x.set("offset",j3(p)),s.push(x);const M=n.length-1;for(let R=1;R<=M;R++){let L=cm(n[R]);const F=L.get("offset");L.set("offset",j3((t+F*i)/d)),s.push(L)}i=d,t=0,r="",n=s}return HT(this.element,n,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function j3(e,n=3){const t=Math.pow(10,n-1);return Math.round(e*t)/t}class ZT{}const ane=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class lne extends ZT{normalizePropertyName(n,t){return jT(n)}normalizeStyleValue(n,t,i,r){let s="";const d=i.toString().trim();if(ane.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const p=i.match(/^[+-]?[\d\.]+([a-z]*)$/);p&&0==p[1].length&&r.push(function nte(e,n){return new Ot(3005,!1)}())}return d+s}}function G3(e,n,t,i,r,s,d,p,v,x,M,R,L){return{type:0,element:e,triggerName:n,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:d,timelines:p,queriedElements:v,preStyleProps:x,postStyleProps:M,totalTime:R,errors:L}}const XT={};class $3{constructor(n,t,i){this._triggerName=n,this.ast=t,this._stateStyles=i}match(n,t,i,r){return function cne(e,n,t,i,r){return e.some(s=>s(n,t,i,r))}(this.ast.matchers,n,t,i,r)}buildStyles(n,t,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(t,i):new Map}build(n,t,i,r,s,d,p,v,x,M){const R=[],L=this.ast.options&&this.ast.options.params||XT,Y=this.buildStyles(i,p&&p.params||XT,R),X=v&&v.params||XT,ye=this.buildStyles(r,X,R),ae=new Set,Q=new Map,me=new Map,Xe="void"===r,nt={params:une(X,L),delay:this.ast.options?.delay},wt=M?[]:qT(n,t,this.ast.animation,s,d,Y,ye,nt,x,R);let xt=0;if(wt.forEach(Qe=>{xt=Math.max(Qe.duration+Qe.delay,xt)}),R.length)return G3(t,this._triggerName,i,r,Xe,Y,ye,[],[],Q,me,xt,R);wt.forEach(Qe=>{const vi=Qe.element,ri=hd(Q,vi,new Set);Qe.preStyleProps.forEach(Xi=>ri.add(Xi));const Ui=hd(me,vi,new Set);Qe.postStyleProps.forEach(Xi=>Ui.add(Xi)),vi!==t&&ae.add(vi)});const Ft=nC(ae.values());return G3(t,this._triggerName,i,r,Xe,Y,ye,wt,Ft,Q,me,xt)}}function une(e,n){const t=Hx(n);for(const i in e)e.hasOwnProperty(i)&&null!=e[i]&&(t[i]=e[i]);return t}class dne{constructor(n,t,i){this.styles=n,this.defaultParams=t,this.normalizer=i}buildStyles(n,t){const i=new Map,r=Hx(this.defaultParams);return Object.keys(n).forEach(s=>{const d=n[s];null!==d&&(r[s]=d)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((d,p)=>{d&&(d=Wx(d,r,t));const v=this.normalizer.normalizePropertyName(p,t);d=this.normalizer.normalizeStyleValue(p,v,d,t),i.set(p,d)})}),i}}class fne{constructor(n,t,i){this.name=n,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new dne(r.style,r.options&&r.options.params||{},i))}),H3(this.states,"true","1"),H3(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new $3(n,r,this.states))}),this.fallbackTransition=function pne(e,n,t){return new $3(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(d,p)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,t,i,r){return this.transitionFactories.find(d=>d.match(n,t,i,r))||null}matchStyles(n,t,i){return this.fallbackTransition.buildStyles(n,t,i)}}function H3(e,n,t){e.has(n)?e.has(t)||e.set(t,e.get(n)):e.has(t)&&e.set(n,e.get(t))}const mne=new sC;class gne{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,t){const i=[],s=GT(this._driver,t,i,[]);if(i.length)throw function xte(e){return new Ot(3503,!1)}();this._animations.set(n,s)}_buildPlayer(n,t,i){const r=n.element,s=I3(this._normalizer,n.keyframes,t,i);return this._driver.animate(r,s,n.duration,n.delay,n.easing,[],!0)}create(n,t,i={}){const r=[],s=this._animations.get(n);let d;const p=new Map;if(s?(d=qT(this._driver,t,s,BT,QE,new Map,new Map,i,mne,r),d.forEach(M=>{const R=hd(p,M.element,new Map);M.postStyleProps.forEach(L=>R.set(L,null))})):(r.push(function bte(){return new Ot(3300,!1)}()),d=[]),r.length)throw function wte(e){return new Ot(3504,!1)}();p.forEach((M,R)=>{M.forEach((L,F)=>{M.set(F,this._driver.computeStyle(R,F,ep))})});const x=lm(d.map(M=>{const R=p.get(M.element);return this._buildPlayer(M,new Map,R)}));return this._playersById.set(n,x),x.onDestroy(()=>this.destroy(n)),this.players.push(x),x}destroy(n){const t=this._getPlayer(n);t.destroy(),this._playersById.delete(n);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(n){const t=this._playersById.get(n);if(!t)throw function Ete(e){return new Ot(3301,!1)}();return t}listen(n,t,i,r){const s=LT(t,"","","");return OT(this._getPlayer(n),i,s,r),()=>{}}command(n,t,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,t,r[0]||{});const s=this._getPlayer(n);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const q3="ng-animate-queued",YT="ng-animate-disabled",bne=[],W3={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},wne={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},gh="__ng_removed";class KT{get params(){return this.options.params}constructor(n,t=""){this.namespaceId=t;const i=n&&n.hasOwnProperty("value");if(this.value=function Mne(e){return e??null}(i?n.value:n),i){const s=Hx(n);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const t=n.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Zx="void",QT=new KT(Zx);class Ene{constructor(n,t,i){this.id=n,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Bd(t,this._hostClassName)}listen(n,t,i,r){if(!this._triggers.has(t))throw function Cte(e,n){return new Ot(3302,!1)}();if(null==i||0==i.length)throw function Ste(e){return new Ot(3303,!1)}();if(!function Ine(e){return"start"==e||"done"==e}(i))throw function Mte(e,n){return new Ot(3400,!1)}();const s=hd(this._elementListeners,n,[]),d={name:t,phase:i,callback:r};s.push(d);const p=hd(this._engine.statesByElement,n,new Map);return p.has(t)||(Bd(n,JE),Bd(n,JE+"-"+t),p.set(t,QT)),()=>{this._engine.afterFlush(()=>{const v=s.indexOf(d);v>=0&&s.splice(v,1),this._triggers.has(t)||p.delete(t)})}}register(n,t){return!this._triggers.has(n)&&(this._triggers.set(n,t),!0)}_getTrigger(n){const t=this._triggers.get(n);if(!t)throw function Ite(e){return new Ot(3401,!1)}();return t}trigger(n,t,i,r=!0){const s=this._getTrigger(t),d=new JT(this.id,t,n);let p=this._engine.statesByElement.get(n);p||(Bd(n,JE),Bd(n,JE+"-"+t),this._engine.statesByElement.set(n,p=new Map));let v=p.get(t);const x=new KT(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&v&&x.absorbOptions(v.options),p.set(t,x),v||(v=QT),x.value!==Zx&&v.value===x.value){if(!function Ane(e,n){const t=Object.keys(e),i=Object.keys(n);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!n.hasOwnProperty(s)||e[s]!==n[s])return!1}return!0}(v.params,x.params)){const X=[],ye=s.matchStyles(v.value,v.params,X),ae=s.matchStyles(x.value,x.params,X);X.length?this._engine.reportError(X):this._engine.afterFlush(()=>{Sg(n,ye),df(n,ae)})}return}const L=hd(this._engine.playersByElement,n,[]);L.forEach(X=>{X.namespaceId==this.id&&X.triggerName==t&&X.queued&&X.destroy()});let F=s.matchTransition(v.value,x.value,n,x.params),Y=!1;if(!F){if(!r)return;F=s.fallbackTransition,Y=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:t,transition:F,fromState:v,toState:x,player:d,isFallbackTransition:Y}),Y||(Bd(n,q3),d.onStart(()=>{Ey(n,q3)})),d.onDone(()=>{let X=this.players.indexOf(d);X>=0&&this.players.splice(X,1);const ye=this._engine.playersByElement.get(n);if(ye){let ae=ye.indexOf(d);ae>=0&&ye.splice(ae,1)}}),this.players.push(d),L.push(d),d}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(t=>t.delete(n)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const t=this._engine.playersByElement.get(n);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,t){const i=this._engine.driver.query(n,eC,!0);i.forEach(r=>{if(r[gh])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(d=>d.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,t,i,r){const s=this._engine.statesByElement.get(n),d=new Map;if(s){const p=[];if(s.forEach((v,x)=>{if(d.set(x,v.value),this._triggers.has(x)){const M=this.trigger(n,x,Zx,r);M&&p.push(M)}}),p.length)return this._engine.markElementAsRemoved(this.id,n,!0,t,d),i&&lm(p).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const t=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(t&&i){const r=new Set;t.forEach(s=>{const d=s.name;if(r.has(d))return;r.add(d);const v=this._triggers.get(d).fallbackTransition,x=i.get(d)||QT,M=new KT(Zx),R=new JT(this.id,d,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:d,transition:v,fromState:x,toState:M,player:R,isFallbackTransition:!0})})}}removeNode(n,t){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,t),this.triggerLeaveAnimation(n,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(n):[];if(s&&s.length)r=!0;else{let d=n;for(;d=d.parentNode;)if(i.statesByElement.get(d)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,t);else{const s=n[gh];(!s||s===W3)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,t))}}insertNode(n,t){Bd(n,this._hostClassName)}drainQueuedTransitions(n){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,d=this._elementListeners.get(s);d&&d.forEach(p=>{if(p.name==i.triggerName){const v=LT(s,i.triggerName,i.fromState.value,i.toState.value);v._data=n,OT(i.player,p.phase,v,p.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,d=r.transition.ast.depCount;return 0==s||0==d?s-d:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class Cne{_onRemovalComplete(n,t){this.onRemovalComplete(n,t)}constructor(n,t,i){this.bodyNode=n,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,t){const i=new Ene(n,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let d=!1,p=this.driver.getParentElement(t);for(;p;){const v=r.get(p);if(v){const x=i.indexOf(v);i.splice(x+1,0,n),d=!0;break}p=this.driver.getParentElement(p)}d||i.unshift(n)}else i.push(n);return r.set(t,n),n}register(n,t){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,t)),i}registerTrigger(n,t,i){let r=this._namespaceLookup[n];r&&r.register(t,i)&&this.totalAnimations++}destroy(n,t){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const t=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(n,t,i,r){if(cC(t)){const s=this._fetchNamespace(n);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(n,t,i,r){if(!cC(t))return;const s=t[gh];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const d=this.collectedLeaveElements.indexOf(t);d>=0&&this.collectedLeaveElements.splice(d,1)}if(n){const d=this._fetchNamespace(n);d&&d.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,t){t?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Bd(n,YT)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Ey(n,YT))}removeNode(n,t,i){if(cC(t)){const r=n?this._fetchNamespace(n):null;r?r.removeNode(t,i):this.markElementAsRemoved(n,t,!1,i);const s=this.namespacesByHostElement.get(t);s&&s.id!==n&&s.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(n,t,i,r,s){this.collectedLeaveElements.push(t),t[gh]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,t,i,r,s){return cC(t)?this._fetchNamespace(n).listen(t,i,r,s):()=>{}}_buildInstruction(n,t,i,r,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,t,s)}destroyInnerAnimations(n){let t=this.driver.query(n,eC,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(n,zT,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const t=this.playersByElement.get(n);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const t=this.playersByQueriedElement.get(n);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return lm(this.players).onDone(()=>n());n()})}processLeaveNode(n){const t=n[gh];if(t&&t.setForRemoval){if(n[gh]=W3,t.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,t.setForRemoval)}n.classList?.contains(YT)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Bd(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?lm(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function Dte(e){return new Ot(3402,!1)}()}_flushAnimations(n,t){const i=new sC,r=[],s=new Map,d=[],p=new Map,v=new Map,x=new Map,M=new Set;this.disabledNodes.forEach(dn=>{M.add(dn);const Yn=this.driver.query(dn,".ng-animate-queued",!0);for(let Kn=0;Kn<Yn.length;Kn++)M.add(Yn[Kn])});const R=this.bodyNode,L=Array.from(this.statesByElement.keys()),F=Y3(L,this.collectedEnterElements),Y=new Map;let X=0;F.forEach((dn,Yn)=>{const Kn=BT+X++;Y.set(Yn,Kn),dn.forEach(li=>Bd(li,Kn))});const ye=[],ae=new Set,Q=new Set;for(let dn=0;dn<this.collectedLeaveElements.length;dn++){const Yn=this.collectedLeaveElements[dn],Kn=Yn[gh];Kn&&Kn.setForRemoval&&(ye.push(Yn),ae.add(Yn),Kn.hasAnimation?this.driver.query(Yn,".ng-star-inserted",!0).forEach(li=>ae.add(li)):Q.add(Yn))}const me=new Map,Xe=Y3(L,Array.from(ae));Xe.forEach((dn,Yn)=>{const Kn=QE+X++;me.set(Yn,Kn),dn.forEach(li=>Bd(li,Kn))}),n.push(()=>{F.forEach((dn,Yn)=>{const Kn=Y.get(Yn);dn.forEach(li=>Ey(li,Kn))}),Xe.forEach((dn,Yn)=>{const Kn=me.get(Yn);dn.forEach(li=>Ey(li,Kn))}),ye.forEach(dn=>{this.processLeaveNode(dn)})});const nt=[],wt=[];for(let dn=this._namespaceList.length-1;dn>=0;dn--)this._namespaceList[dn].drainQueuedTransitions(t).forEach(Kn=>{const li=Kn.player,Bo=Kn.element;if(nt.push(li),this.collectedEnterElements.length){const ua=Bo[gh];if(ua&&ua.setForMove){if(ua.previousTriggersValues&&ua.previousTriggersValues.has(Kn.triggerName)){const _h=ua.previousTriggersValues.get(Kn.triggerName),xc=this.statesByElement.get(Kn.element);if(xc&&xc.has(Kn.triggerName)){const sp=xc.get(Kn.triggerName);sp.value=_h,xc.set(Kn.triggerName,sp)}}return void li.destroy()}}const Es=!R||!this.driver.containsElement(R,Bo),hs=me.get(Bo),Vr=Y.get(Bo),ar=this._buildInstruction(Kn,i,Vr,hs,Es);if(ar.errors&&ar.errors.length)return void wt.push(ar);if(Es)return li.onStart(()=>Sg(Bo,ar.fromStyles)),li.onDestroy(()=>df(Bo,ar.toStyles)),void r.push(li);if(Kn.isFallbackTransition)return li.onStart(()=>Sg(Bo,ar.fromStyles)),li.onDestroy(()=>df(Bo,ar.toStyles)),void r.push(li);const ca=[];ar.timelines.forEach(ua=>{ua.stretchStartingKeyframe=!0,this.disabledNodes.has(ua.element)||ca.push(ua)}),ar.timelines=ca,i.append(Bo,ar.timelines),d.push({instruction:ar,player:li,element:Bo}),ar.queriedElements.forEach(ua=>hd(p,ua,[]).push(li)),ar.preStyleProps.forEach((ua,_h)=>{if(ua.size){let xc=v.get(_h);xc||v.set(_h,xc=new Set),ua.forEach((sp,um)=>xc.add(um))}}),ar.postStyleProps.forEach((ua,_h)=>{let xc=x.get(_h);xc||x.set(_h,xc=new Set),ua.forEach((sp,um)=>xc.add(um))})});if(wt.length){const dn=[];wt.forEach(Yn=>{dn.push(function Tte(e,n){return new Ot(3505,!1)}())}),nt.forEach(Yn=>Yn.destroy()),this.reportError(dn)}const xt=new Map,Ft=new Map;d.forEach(dn=>{const Yn=dn.element;i.has(Yn)&&(Ft.set(Yn,Yn),this._beforeAnimationBuild(dn.player.namespaceId,dn.instruction,xt))}),r.forEach(dn=>{const Yn=dn.element;this._getPreviousPlayers(Yn,!1,dn.namespaceId,dn.triggerName,null).forEach(li=>{hd(xt,Yn,[]).push(li),li.destroy()})});const Qe=ye.filter(dn=>Q3(dn,v,x)),vi=new Map;X3(vi,this.driver,Q,x,ep).forEach(dn=>{Q3(dn,v,x)&&Qe.push(dn)});const Ui=new Map;F.forEach((dn,Yn)=>{X3(Ui,this.driver,new Set(dn),v,"!")}),Qe.forEach(dn=>{const Yn=vi.get(dn),Kn=Ui.get(dn);vi.set(dn,new Map([...Yn?.entries()??[],...Kn?.entries()??[]]))});const Xi=[],$n=[],Li={};d.forEach(dn=>{const{element:Yn,player:Kn,instruction:li}=dn;if(i.has(Yn)){if(M.has(Yn))return Kn.onDestroy(()=>df(Yn,li.toStyles)),Kn.disabled=!0,Kn.overrideTotalTime(li.totalTime),void r.push(Kn);let Bo=Li;if(Ft.size>1){let hs=Yn;const Vr=[];for(;hs=hs.parentNode;){const ar=Ft.get(hs);if(ar){Bo=ar;break}Vr.push(hs)}Vr.forEach(ar=>Ft.set(ar,Bo))}const Es=this._buildAnimation(Kn.namespaceId,li,xt,s,Ui,vi);if(Kn.setRealPlayer(Es),Bo===Li)Xi.push(Kn);else{const hs=this.playersByElement.get(Bo);hs&&hs.length&&(Kn.parentPlayer=lm(hs)),r.push(Kn)}}else Sg(Yn,li.fromStyles),Kn.onDestroy(()=>df(Yn,li.toStyles)),$n.push(Kn),M.has(Yn)&&r.push(Kn)}),$n.forEach(dn=>{const Yn=s.get(dn.element);if(Yn&&Yn.length){const Kn=lm(Yn);dn.setRealPlayer(Kn)}}),r.forEach(dn=>{dn.parentPlayer?dn.syncPlayerEvents(dn.parentPlayer):dn.destroy()});for(let dn=0;dn<ye.length;dn++){const Yn=ye[dn],Kn=Yn[gh];if(Ey(Yn,QE),Kn&&Kn.hasAnimation)continue;let li=[];if(p.size){let Es=p.get(Yn);Es&&Es.length&&li.push(...Es);let hs=this.driver.query(Yn,zT,!0);for(let Vr=0;Vr<hs.length;Vr++){let ar=p.get(hs[Vr]);ar&&ar.length&&li.push(...ar)}}const Bo=li.filter(Es=>!Es.destroyed);Bo.length?Dne(this,Yn,Bo):this.processLeaveNode(Yn)}return ye.length=0,Xi.forEach(dn=>{this.players.push(dn),dn.onDone(()=>{dn.destroy();const Yn=this.players.indexOf(dn);this.players.splice(Yn,1)}),dn.play()}),Xi}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,t,i,r,s){let d=[];if(t){const p=this.playersByQueriedElement.get(n);p&&(d=p)}else{const p=this.playersByElement.get(n);if(p){const v=!s||s==Zx;p.forEach(x=>{x.queued||!v&&x.triggerName!=r||d.push(x)})}}return(i||r)&&(d=d.filter(p=>!(i&&i!=p.namespaceId||r&&r!=p.triggerName))),d}_beforeAnimationBuild(n,t,i){const s=t.element,d=t.isRemovalTransition?void 0:n,p=t.isRemovalTransition?void 0:t.triggerName;for(const v of t.timelines){const x=v.element,M=x!==s,R=hd(i,x,[]);this._getPreviousPlayers(x,M,d,p,t.toState).forEach(F=>{const Y=F.getRealPlayer();Y.beforeDestroy&&Y.beforeDestroy(),F.destroy(),R.push(F)})}Sg(s,t.fromStyles)}_buildAnimation(n,t,i,r,s,d){const p=t.triggerName,v=t.element,x=[],M=new Set,R=new Set,L=t.timelines.map(Y=>{const X=Y.element;M.add(X);const ye=X[gh];if(ye&&ye.removedBeforeQueried)return new hx(Y.duration,Y.delay);const ae=X!==v,Q=function Tne(e){const n=[];return K3(e,n),n}((i.get(X)||bne).map(xt=>xt.getRealPlayer())).filter(xt=>!!xt.element&&xt.element===X),me=s.get(X),Xe=d.get(X),nt=I3(this._normalizer,Y.keyframes,me,Xe),wt=this._buildPlayer(Y,nt,Q);if(Y.subTimeline&&r&&R.add(X),ae){const xt=new JT(n,p,X);xt.setRealPlayer(wt),x.push(xt)}return wt});x.forEach(Y=>{hd(this.playersByQueriedElement,Y.element,[]).push(Y),Y.onDone(()=>function Sne(e,n,t){let i=e.get(n);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&e.delete(n)}return i}(this.playersByQueriedElement,Y.element,Y))}),M.forEach(Y=>Bd(Y,k3));const F=lm(L);return F.onDestroy(()=>{M.forEach(Y=>Ey(Y,k3)),df(v,t.toStyles)}),R.forEach(Y=>{hd(r,Y,[]).push(F)}),F}_buildPlayer(n,t,i){return t.length>0?this.driver.animate(n.element,t,n.duration,n.delay,n.easing,i):new hx(n.duration,n.delay)}}class JT{constructor(n,t,i){this.namespaceId=n,this.triggerName=t,this.element=i,this._player=new hx,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>OT(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const t=this._player;t.triggerCallback&&n.onStart(()=>t.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,t){hd(this._queuedCallbacks,n,[]).push(t)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const t=this._player;t.triggerCallback&&t.triggerCallback(n)}}function cC(e){return e&&1===e.nodeType}function Z3(e,n){const t=e.style.display;return e.style.display=n??"none",t}function X3(e,n,t,i,r){const s=[];t.forEach(v=>s.push(Z3(v)));const d=[];i.forEach((v,x)=>{const M=new Map;v.forEach(R=>{const L=n.computeStyle(x,R,r);M.set(R,L),(!L||0==L.length)&&(x[gh]=wne,d.push(x))}),e.set(x,M)});let p=0;return t.forEach(v=>Z3(v,s[p++])),d}function Y3(e,n){const t=new Map;if(e.forEach(p=>t.set(p,[])),0==n.length)return t;const r=new Set(n),s=new Map;function d(p){if(!p)return 1;let v=s.get(p);if(v)return v;const x=p.parentNode;return v=t.has(x)?x:r.has(x)?1:d(x),s.set(p,v),v}return n.forEach(p=>{const v=d(p);1!==v&&t.get(v).push(p)}),t}function Bd(e,n){e.classList?.add(n)}function Ey(e,n){e.classList?.remove(n)}function Dne(e,n,t){lm(t).onDone(()=>e.processLeaveNode(n))}function K3(e,n){for(let t=0;t<e.length;t++){const i=e[t];i instanceof PN?K3(i.players,n):n.push(i)}}function Q3(e,n,t){const i=t.get(e);if(!i)return!1;let r=n.get(e);return r?i.forEach(s=>r.add(s)):n.set(e,i),t.delete(e),!0}class uC{constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Cne(n,t,i),this._timelineEngine=new gne(n,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(n,t,i,r,s){const d=n+"-"+r;let p=this._triggerCache[d];if(!p){const v=[],M=GT(this._driver,s,v,[]);if(v.length)throw function yte(e,n){return new Ot(3404,!1)}();p=function hne(e,n,t){return new fne(e,n,t)}(r,M,this._normalizer),this._triggerCache[d]=p}this._transitionEngine.registerTrigger(t,r,p)}register(n,t){this._transitionEngine.register(n,t)}destroy(n,t){this._transitionEngine.destroy(n,t)}onInsert(n,t,i,r){this._transitionEngine.insertNode(n,t,i,r)}onRemove(n,t,i){this._transitionEngine.removeNode(n,t,i)}disableAnimations(n,t){this._transitionEngine.markElementAsDisabled(n,t)}process(n,t,i,r){if("@"==i.charAt(0)){const[s,d]=D3(i);this._timelineEngine.command(s,t,d,r)}else this._transitionEngine.trigger(n,t,i,r)}listen(n,t,i,r,s){if("@"==i.charAt(0)){const[d,p]=D3(i);return this._timelineEngine.listen(d,t,p,s)}return this._transitionEngine.listen(n,t,i,r,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let Rne=(()=>{class e{static#e=this.initialStylesByElement=new WeakMap;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=e.initialStylesByElement.get(t);s||e.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&df(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(df(this._element,this._initialStyles),this._endStyles&&(df(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Sg(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Sg(this._element,this._endStyles),this._endStyles=null),df(this._element,this._initialStyles),this._state=3)}}return e})();function eA(e){let n=null;return e.forEach((t,i)=>{(function One(e){return"display"===e||"position"===e})(i)&&(n=n||new Map,n.set(i,t))}),n}class J3{constructor(n,t,i,r){this.element=n,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const t=[];return n.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(n,t,i){return n.animate(this._convertKeyframesToObject(t),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:B3(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const t="start"===n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class kne{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,t){return!1}containsElement(n,t){return A3(n,t)}getParentElement(n){return NT(n)}query(n,t,i){return P3(n,t,i)}computeStyle(n,t,i){return window.getComputedStyle(n)[t]}animate(n,t,i,r,s,d=[]){const v={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(v.easing=s);const x=new Map,M=d.filter(F=>F instanceof J3);(function Ute(e,n){return 0===e||0===n})(i,r)&&M.forEach(F=>{F.currentSnapshot.forEach((Y,X)=>x.set(X,Y))});let R=function Bte(e){return e.length?e[0]instanceof Map?e:e.map(n=>L3(n)):[]}(t).map(F=>cm(F));R=function jte(e,n,t){if(t.size&&n.length){let i=n[0],r=[];if(t.forEach((s,d)=>{i.has(d)||r.push(d),i.set(d,s)}),r.length)for(let s=1;s<n.length;s++){let d=n[s];r.forEach(p=>d.set(p,B3(e,p)))}}return n}(n,R,x);const L=function Pne(e,n){let t=null,i=null;return Array.isArray(n)&&n.length?(t=eA(n[0]),n.length>1&&(i=eA(n[n.length-1]))):n instanceof Map&&(t=eA(n)),t||i?new Rne(e,t,i):null}(n,R);return new J3(n,R,v,L)}}let Lne=(()=>{class e extends MN{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Lo.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?DN(t):t;return e4(this._renderer,null,i,"register",[r]),new Nne(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Xm),Dt(Ar))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();class Nne extends k7{constructor(n,t){super(),this._id=n,this._renderer=t}create(n,t){return new Fne(this._id,n,t||{},this._renderer)}}class Fne{constructor(n,t,i,r){this.id=n,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,t){return this._renderer.listen(this.element,`@@${this.id}:${n}`,t)}_command(n,...t){return e4(this._renderer,this.element,this.id,n,t)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function e4(e,n,t,i,r){return e.setProperty(n,`@@${t}:${i}`,r)}const t4="@.disabled";let Bne=(()=>{class e{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,d)=>{const p=d?.parentNode(s);p&&d.removeChild(p,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let M=this._rendererCache.get(s);return M||(M=new n4("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,M)),M}const d=i.id,p=i.id+"-"+this._currentId;this._currentId++,this.engine.register(p,t);const v=M=>{Array.isArray(M)?M.forEach(v):this.engine.registerTrigger(d,p,t,M.name,M)};return i.data.animation.forEach(v),new zne(this,p,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[d,p]=s;d(p)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Xm),Dt(uC),Dt(_))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})();class n4{constructor(n,t,i,r){this.namespaceId=n,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,t){return this.delegate.createElement(n,t)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,t){this.delegate.appendChild(n,t),this.engine.onInsert(this.namespaceId,t,n,!1)}insertBefore(n,t,i,r=!0){this.delegate.insertBefore(n,t,i),this.engine.onInsert(this.namespaceId,t,n,r)}removeChild(n,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(n,t){return this.delegate.selectRootElement(n,t)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,t,i,r){this.delegate.setAttribute(n,t,i,r)}removeAttribute(n,t,i){this.delegate.removeAttribute(n,t,i)}addClass(n,t){this.delegate.addClass(n,t)}removeClass(n,t){this.delegate.removeClass(n,t)}setStyle(n,t,i,r){this.delegate.setStyle(n,t,i,r)}removeStyle(n,t,i){this.delegate.removeStyle(n,t,i)}setProperty(n,t,i){"@"==t.charAt(0)&&t==t4?this.disableAnimations(n,!!i):this.delegate.setProperty(n,t,i)}setValue(n,t){this.delegate.setValue(n,t)}listen(n,t,i){return this.delegate.listen(n,t,i)}disableAnimations(n,t){this.engine.disableAnimations(n,t)}}class zne extends n4{constructor(n,t,i,r,s){super(t,i,r,s),this.factory=n,this.namespaceId=t}setProperty(n,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==t4?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,t.slice(1),i):this.delegate.setProperty(n,t,i)}listen(n,t,i){if("@"==t.charAt(0)){const r=function Vne(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(n);let s=t.slice(1),d="";return"@"!=s.charAt(0)&&([s,d]=function Une(e){const n=e.indexOf(".");return[e.substring(0,n),e.slice(n+1)]}(s)),this.engine.listen(this.namespaceId,r,s,d,p=>{this.factory.scheduleListenerCallback(p._data||-1,i,p)})}return this.delegate.listen(n,t,i)}}const r4=[{provide:MN,useClass:Lne},{provide:ZT,useFactory:function Gne(){return new lne}},{provide:uC,useClass:(()=>{class e extends uC{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(Ar),Dt(FT),Dt(ZT),Dt(qp))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})()},{provide:Xm,useFactory:function $ne(e,n,t){return new Bne(e,n,t)},deps:[qM,uC,_]}],tA=[{provide:FT,useFactory:()=>new kne},{provide:rh,useValue:"BrowserAnimations"},...r4],o4=[{provide:FT,useClass:R3},{provide:rh,useValue:"NoopAnimations"},...r4];let Hne=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?o4:tA}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({providers:tA,imports:[IO]})}return e})();let qne=(()=>{class e{constructor(t){this.client=t,this.url="https://api.mapbox.com/geocoding/v5/mapbox.places/",this.token=""}getGeocoding(t,i,r,s){return this.client.get(this.url+encodeURIComponent(t+" "+i+" "+r+" "+s)+".json?access_token="+this.token)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(_g))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),Wne=(()=>{class e{constructor(t){this.auth=t,this.apiServer="//95.217.193.230:9999",this.allowedUrls=["/api/login","/api/register","api.mapbox.com"]}intercept(t,i){return t.url.startsWith("/")&&(t=t.clone({url:this.apiServer+t.url})),this.allowedUrls.includes(t.url)||(this.auth.getToken()?t=t.clone({setHeaders:{Authorization:`Bearer ${this.auth.getToken()}`}}):this.auth.logout()),i.handle(t)}static#e=this.\u0275fac=function(i){return new(i||e)(Dt(uy))};static#t=this.\u0275prov=kn({token:e,factory:e.\u0275fac})}return e})(),Zne=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({})}return e})(),a4=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,D0,ZL,yc]})}return e})(),tie=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e});static#n=this.\u0275inj=wr({imports:[yc,a4,a4,Zne,yc]})}return e})(),nie=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=xr({type:e,bootstrap:[E9]});static#n=this.\u0275inj=wr({providers:[qne,_g,{provide:mF,useClass:Wne,multi:!0}],imports:[IO,Yee,eH,Hne,IZ,J$,WN,SN,YJ.withConfig({accessToken:""}),$Z,KZ,tie,rZ,Dee]})}return e})();$G().bootstrapModule(nie).catch(e=>console.error(e))},1568:(un,vt,Ve)=>{"use strict";var Fe=Ve(8570);function at(m){var xe=[1/0,1/0,-1/0,-1/0];return Fe.coordEach(m,function(He){xe[0]>He[0]&&(xe[0]=He[0]),xe[1]>He[1]&&(xe[1]=He[1]),xe[2]<He[0]&&(xe[2]=He[0]),xe[3]<He[1]&&(xe[3]=He[1])}),xe}at.default=at,vt.Z=at},621:(un,vt)=>{"use strict";function Ve(Ue,Ke,Me){void 0===Me&&(Me={});var on={type:"Feature"};return(0===Me.id||Me.id)&&(on.id=Me.id),Me.bbox&&(on.bbox=Me.bbox),on.properties=Ke||{},on.geometry=Ue,on}function Fe(Ue,Ke,Me){if(void 0===Me&&(Me={}),!Ue)throw new Error("coordinates is required");if(!Array.isArray(Ue))throw new Error("coordinates must be an Array");if(Ue.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!re(Ue[0])||!re(Ue[1]))throw new Error("coordinates must contain numbers");return Ve({type:"Point",coordinates:Ue},Ke,Me)}function m(Ue,Ke,Me){void 0===Me&&(Me={});for(var on=0,Lt=Ue;on<Lt.length;on++){var Ee=Lt[on];if(Ee.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var dt=0;dt<Ee[Ee.length-1].length;dt++)if(Ee[Ee.length-1][dt]!==Ee[0][dt])throw new Error("First and last Position are not equivalent.")}return Ve({type:"Polygon",coordinates:Ue},Ke,Me)}function He(Ue,Ke,Me){if(void 0===Me&&(Me={}),Ue.length<2)throw new Error("coordinates must be an array of two or more positions");return Ve({type:"LineString",coordinates:Ue},Ke,Me)}function tt(Ue,Ke){void 0===Ke&&(Ke={});var Me={type:"FeatureCollection"};return Ke.id&&(Me.id=Ke.id),Ke.bbox&&(Me.bbox=Ke.bbox),Me.features=Ue,Me}function mt(Ue,Ke,Me){return void 0===Me&&(Me={}),Ve({type:"MultiLineString",coordinates:Ue},Ke,Me)}function Xt(Ue,Ke,Me){return void 0===Me&&(Me={}),Ve({type:"MultiPoint",coordinates:Ue},Ke,Me)}function Mt(Ue,Ke,Me){return void 0===Me&&(Me={}),Ve({type:"MultiPolygon",coordinates:Ue},Ke,Me)}function pn(Ue,Ke){void 0===Ke&&(Ke="kilometers");var Me=vt.factors[Ke];if(!Me)throw new Error(Ke+" units is invalid");return Ue*Me}function he(Ue,Ke){void 0===Ke&&(Ke="kilometers");var Me=vt.factors[Ke];if(!Me)throw new Error(Ke+" units is invalid");return Ue/Me}function ge(Ue){return Ue%(2*Math.PI)*180/Math.PI}function re(Ue){return!isNaN(Ue)&&null!==Ue&&!Array.isArray(Ue)}Object.defineProperty(vt,"__esModule",{value:!0}),vt.earthRadius=6371008.8,vt.factors={centimeters:100*vt.earthRadius,centimetres:100*vt.earthRadius,degrees:vt.earthRadius/111325,feet:3.28084*vt.earthRadius,inches:39.37*vt.earthRadius,kilometers:vt.earthRadius/1e3,kilometres:vt.earthRadius/1e3,meters:vt.earthRadius,metres:vt.earthRadius,miles:vt.earthRadius/1609.344,millimeters:1e3*vt.earthRadius,millimetres:1e3*vt.earthRadius,nauticalmiles:vt.earthRadius/1852,radians:1,yards:1.0936*vt.earthRadius},vt.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/vt.earthRadius,yards:1.0936133},vt.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},vt.feature=Ve,vt.geometry=function be(Ue,Ke,Me){switch(void 0===Me&&(Me={}),Ue){case"Point":return Fe(Ke).geometry;case"LineString":return He(Ke).geometry;case"Polygon":return m(Ke).geometry;case"MultiPoint":return Xt(Ke).geometry;case"MultiLineString":return mt(Ke).geometry;case"MultiPolygon":return Mt(Ke).geometry;default:throw new Error(Ue+" is invalid")}},vt.point=Fe,vt.points=function at(Ue,Ke,Me){return void 0===Me&&(Me={}),tt(Ue.map(function(on){return Fe(on,Ke)}),Me)},vt.polygon=m,vt.polygons=function xe(Ue,Ke,Me){return void 0===Me&&(Me={}),tt(Ue.map(function(on){return m(on,Ke)}),Me)},vt.lineString=He,vt.lineStrings=function ct(Ue,Ke,Me){return void 0===Me&&(Me={}),tt(Ue.map(function(on){return He(on,Ke)}),Me)},vt.featureCollection=tt,vt.multiLineString=mt,vt.multiPoint=Xt,vt.multiPolygon=Mt,vt.geometryCollection=function yt(Ue,Ke,Me){return void 0===Me&&(Me={}),Ve({type:"GeometryCollection",geometries:Ue},Ke,Me)},vt.round=function Rt(Ue,Ke){if(void 0===Ke&&(Ke=0),Ke&&!(Ke>=0))throw new Error("precision must be a positive number");var Me=Math.pow(10,Ke||0);return Math.round(Ue*Me)/Me},vt.radiansToLength=pn,vt.lengthToRadians=he,vt.lengthToDegrees=function De(Ue,Ke){return ge(he(Ue,Ke))},vt.bearingToAzimuth=function ce(Ue){var Ke=Ue%360;return Ke<0&&(Ke+=360),Ke},vt.radiansToDegrees=ge,vt.degreesToRadians=function ue(Ue){return Ue%360*Math.PI/180},vt.convertLength=function ze(Ue,Ke,Me){if(void 0===Ke&&(Ke="kilometers"),void 0===Me&&(Me="kilometers"),!(Ue>=0))throw new Error("length must be a positive number");return pn(he(Ue,Ke),Me)},vt.convertArea=function de(Ue,Ke,Me){if(void 0===Ke&&(Ke="meters"),void 0===Me&&(Me="kilometers"),!(Ue>=0))throw new Error("area must be a positive number");var on=vt.areaFactors[Ke];if(!on)throw new Error("invalid original units");var Lt=vt.areaFactors[Me];if(!Lt)throw new Error("invalid final units");return Ue/on*Lt},vt.isNumber=re,vt.isObject=function Ae(Ue){return!!Ue&&Ue.constructor===Object},vt.validateBBox=function ne(Ue){if(!Ue)throw new Error("bbox is required");if(!Array.isArray(Ue))throw new Error("bbox must be an Array");if(4!==Ue.length&&6!==Ue.length)throw new Error("bbox must be an Array of 4 or 6 numbers");Ue.forEach(function(Ke){if(!re(Ke))throw new Error("bbox must only contain numbers")})},vt.validateId=function ot(Ue){if(!Ue)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof Ue))throw new Error("id must be a number or a string")}},8570:(un,vt,Ve)=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});var be=Ve(621);function Fe(ue,ze,de){if(null!==ue)for(var re,Ae,ne,ot,Ue,Ke,Me,Ee,on=0,Lt=0,dt=ue.type,Re="FeatureCollection"===dt,it="Feature"===dt,gt=Re?ue.features.length:1,Ie=0;Ie<gt;Ie++){Ue=(Ee=!!(Me=Re?ue.features[Ie].geometry:it?ue.geometry:ue)&&"GeometryCollection"===Me.type)?Me.geometries.length:1;for(var qt=0;qt<Ue;qt++){var Ct=0,Cn=0;if(null!==(ot=Ee?Me.geometries[qt]:Me)){Ke=ot.coordinates;var Ut=ot.type;switch(on=!de||"Polygon"!==Ut&&"MultiPolygon"!==Ut?0:1,Ut){case null:break;case"Point":if(!1===ze(Ke,Lt,Ie,Ct,Cn))return!1;Lt++,Ct++;break;case"LineString":case"MultiPoint":for(re=0;re<Ke.length;re++){if(!1===ze(Ke[re],Lt,Ie,Ct,Cn))return!1;Lt++,"MultiPoint"===Ut&&Ct++}"LineString"===Ut&&Ct++;break;case"Polygon":case"MultiLineString":for(re=0;re<Ke.length;re++){for(Ae=0;Ae<Ke[re].length-on;Ae++){if(!1===ze(Ke[re][Ae],Lt,Ie,Ct,Cn))return!1;Lt++}"MultiLineString"===Ut&&Ct++,"Polygon"===Ut&&Cn++}"Polygon"===Ut&&Ct++;break;case"MultiPolygon":for(re=0;re<Ke.length;re++){for(Cn=0,Ae=0;Ae<Ke[re].length;Ae++){for(ne=0;ne<Ke[re][Ae].length-on;ne++){if(!1===ze(Ke[re][Ae][ne],Lt,Ie,Ct,Cn))return!1;Lt++}Cn++}Ct++}break;case"GeometryCollection":for(re=0;re<ot.geometries.length;re++)if(!1===Fe(ot.geometries[re],ze,de))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(ue,ze){var de;switch(ue.type){case"FeatureCollection":for(de=0;de<ue.features.length&&!1!==ze(ue.features[de].properties,de);de++);break;case"Feature":ze(ue.properties,0)}}function He(ue,ze){if("Feature"===ue.type)ze(ue,0);else if("FeatureCollection"===ue.type)for(var de=0;de<ue.features.length&&!1!==ze(ue.features[de],de);de++);}function mt(ue,ze){var de,re,Ae,ne,ot,Ue,Ke,Me,on,Lt,Ee=0,dt="FeatureCollection"===ue.type,Re="Feature"===ue.type,it=dt?ue.features.length:1;for(de=0;de<it;de++){for(Me=dt?ue.features[de].properties:Re?ue.properties:{},on=dt?ue.features[de].bbox:Re?ue.bbox:void 0,Lt=dt?ue.features[de].id:Re?ue.id:void 0,ot=(Ke=!!(Ue=dt?ue.features[de].geometry:Re?ue.geometry:ue)&&"GeometryCollection"===Ue.type)?Ue.geometries.length:1,Ae=0;Ae<ot;Ae++)if(null!==(ne=Ke?Ue.geometries[Ae]:Ue))switch(ne.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===ze(ne,Ee,Me,on,Lt))return!1;break;case"GeometryCollection":for(re=0;re<ne.geometries.length;re++)if(!1===ze(ne.geometries[re],Ee,Me,on,Lt))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===ze(null,Ee,Me,on,Lt))return!1;Ee++}}function Mt(ue,ze){mt(ue,function(de,re,Ae,ne,ot){var Ke,Ue=null===de?null:de.type;switch(Ue){case null:case"Point":case"LineString":case"Polygon":return!1!==ze(be.feature(de,Ae,{bbox:ne,id:ot}),re,0)&&void 0}switch(Ue){case"MultiPoint":Ke="Point";break;case"MultiLineString":Ke="LineString";break;case"MultiPolygon":Ke="Polygon"}for(var Me=0;Me<de.coordinates.length;Me++)if(!1===ze(be.feature({type:Ke,coordinates:de.coordinates[Me]},Ae),re,Me))return!1})}function Rt(ue,ze){Mt(ue,function(de,re,Ae){var ne=0;if(de.geometry){var ot=de.geometry.type;if("Point"!==ot&&"MultiPoint"!==ot){var Ue,Ke=0,Me=0,on=0;if(!1===Fe(de,function(Lt,Ee,dt,Re,it){if(void 0===Ue||re>Ke||Re>Me||it>on)return Ue=Lt,Ke=re,Me=Re,on=it,void(ne=0);var gt=be.lineString([Ue,Lt],de.properties);if(!1===ze(gt,re,Ae,it,ne))return!1;ne++,Ue=Lt}))return!1}}})}function he(ue,ze){if(!ue)throw new Error("geojson is required");Mt(ue,function(de,re,Ae){if(null!==de.geometry){var ot=de.geometry.coordinates;switch(de.geometry.type){case"LineString":if(!1===ze(de,re,Ae,0,0))return!1;break;case"Polygon":for(var Ue=0;Ue<ot.length;Ue++)if(!1===ze(be.lineString(ot[Ue],de.properties),re,Ae,Ue))return!1}}})}vt.coordAll=function tt(ue){var ze=[];return Fe(ue,function(de){ze.push(de)}),ze},vt.coordEach=Fe,vt.coordReduce=function at(ue,ze,de,re){var Ae=de;return Fe(ue,function(ne,ot,Ue,Ke,Me){Ae=0===ot&&void 0===de?ne:ze(Ae,ne,ot,Ue,Ke,Me)},re),Ae},vt.featureEach=He,vt.featureReduce=function ct(ue,ze,de){var re=de;return He(ue,function(Ae,ne){re=0===ne&&void 0===de?Ae:ze(re,Ae,ne)}),re},vt.findPoint=function ge(ue,ze){if(!be.isObject(ze=ze||{}))throw new Error("options is invalid");var Ue,de=ze.featureIndex||0,re=ze.multiFeatureIndex||0,Ae=ze.geometryIndex||0,ne=ze.coordIndex||0,ot=ze.properties;switch(ue.type){case"FeatureCollection":de<0&&(de=ue.features.length+de),ot=ot||ue.features[de].properties,Ue=ue.features[de].geometry;break;case"Feature":ot=ot||ue.properties,Ue=ue.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=ue;break;default:throw new Error("geojson is invalid")}if(null===Ue)return null;var Ke=Ue.coordinates;switch(Ue.type){case"Point":return be.point(Ke,ot,ze);case"MultiPoint":return re<0&&(re=Ke.length+re),be.point(Ke[re],ot,ze);case"LineString":return ne<0&&(ne=Ke.length+ne),be.point(Ke[ne],ot,ze);case"Polygon":return Ae<0&&(Ae=Ke.length+Ae),ne<0&&(ne=Ke[Ae].length+ne),be.point(Ke[Ae][ne],ot,ze);case"MultiLineString":return re<0&&(re=Ke.length+re),ne<0&&(ne=Ke[re].length+ne),be.point(Ke[re][ne],ot,ze);case"MultiPolygon":return re<0&&(re=Ke.length+re),Ae<0&&(Ae=Ke[re].length+Ae),ne<0&&(ne=Ke[re][Ae].length-ne),be.point(Ke[re][Ae][ne],ot,ze)}throw new Error("geojson is invalid")},vt.findSegment=function ce(ue,ze){if(!be.isObject(ze=ze||{}))throw new Error("options is invalid");var Ue,de=ze.featureIndex||0,re=ze.multiFeatureIndex||0,Ae=ze.geometryIndex||0,ne=ze.segmentIndex||0,ot=ze.properties;switch(ue.type){case"FeatureCollection":de<0&&(de=ue.features.length+de),ot=ot||ue.features[de].properties,Ue=ue.features[de].geometry;break;case"Feature":ot=ot||ue.properties,Ue=ue.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=ue;break;default:throw new Error("geojson is invalid")}if(null===Ue)return null;var Ke=Ue.coordinates;switch(Ue.type){case"Point":case"MultiPoint":return null;case"LineString":return ne<0&&(ne=Ke.length+ne-1),be.lineString([Ke[ne],Ke[ne+1]],ot,ze);case"Polygon":return Ae<0&&(Ae=Ke.length+Ae),ne<0&&(ne=Ke[Ae].length+ne-1),be.lineString([Ke[Ae][ne],Ke[Ae][ne+1]],ot,ze);case"MultiLineString":return re<0&&(re=Ke.length+re),ne<0&&(ne=Ke[re].length+ne-1),be.lineString([Ke[re][ne],Ke[re][ne+1]],ot,ze);case"MultiPolygon":return re<0&&(re=Ke.length+re),Ae<0&&(Ae=Ke[re].length+Ae),ne<0&&(ne=Ke[re][Ae].length-ne-1),be.lineString([Ke[re][Ae][ne],Ke[re][Ae][ne+1]],ot,ze)}throw new Error("geojson is invalid")},vt.flattenEach=Mt,vt.flattenReduce=function yt(ue,ze,de){var re=de;return Mt(ue,function(Ae,ne,ot){re=0===ne&&0===ot&&void 0===de?Ae:ze(re,Ae,ne,ot)}),re},vt.geomEach=mt,vt.geomReduce=function Xt(ue,ze,de){var re=de;return mt(ue,function(Ae,ne,ot,Ue,Ke){re=0===ne&&void 0===de?Ae:ze(re,Ae,ne,ot,Ue,Ke)}),re},vt.lineEach=he,vt.lineReduce=function De(ue,ze,de){var re=de;return he(ue,function(Ae,ne,ot,Ue){re=0===ne&&void 0===de?Ae:ze(re,Ae,ne,ot,Ue)}),re},vt.propEach=m,vt.propReduce=function xe(ue,ze,de){var re=de;return m(ue,function(Ae,ne){re=0===ne&&void 0===de?Ae:ze(re,Ae,ne)}),re},vt.segmentEach=Rt,vt.segmentReduce=function pn(ue,ze,de){var re=de,Ae=!1;return Rt(ue,function(ne,ot,Ue,Ke,Me){re=!1===Ae&&void 0===de?ne:ze(re,ne,ot,Ue,Ke,Me),Ae=!0}),re}},1098:(un,vt,Ve)=>{"use strict";var be=Ve(491),Fe=Ve(5436),at=Fe(be("String.prototype.indexOf"));un.exports=function(xe,He){var ct=be(xe,!!He);return"function"==typeof ct&&at(xe,".prototype.")>-1?Fe(ct):ct}},5436:(un,vt,Ve)=>{"use strict";var be=Ve(5333),Fe=Ve(491),at=Ve(2245),m=Fe("%TypeError%"),xe=Fe("%Function.prototype.apply%"),He=Fe("%Function.prototype.call%"),ct=Fe("%Reflect.apply%",!0)||be.call(He,xe),tt=Fe("%Object.defineProperty%",!0),mt=Fe("%Math.max%");if(tt)try{tt({},"a",{value:1})}catch{tt=null}un.exports=function(yt){if("function"!=typeof yt)throw new m("a function is required");var Rt=ct(be,He,arguments);return at(Rt,1+mt(0,yt.length-(arguments.length-1)),!0)};var Xt=function(){return ct(be,xe,arguments)};tt?tt(un.exports,"apply",{value:Xt}):un.exports.apply=Xt},3664:(un,vt,Ve)=>{"use strict";var be=Ve(938),Fe=Ve(7935),at=Ve(4179),m=Ve(6138).orient2d;function xe(de,re,Ae){re=Math.max(0,void 0===re?2:re),Ae=Ae||0;var ne=function pn(de){for(var re=de[0],Ae=de[0],ne=de[0],ot=de[0],Ue=0;Ue<de.length;Ue++){var Ke=de[Ue];Ke[0]<re[0]&&(re=Ke),Ke[0]>ne[0]&&(ne=Ke),Ke[1]<Ae[1]&&(Ae=Ke),Ke[1]>ot[1]&&(ot=Ke)}var Me=[re,Ae,ne,ot],on=Me.slice();for(Ue=0;Ue<de.length;Ue++)at(de[Ue],Me)||on.push(de[Ue]);return function ze(de){de.sort(ue);for(var re=[],Ae=0;Ae<de.length;Ae++){for(;re.length>=2&&Mt(re[re.length-2],re[re.length-1],de[Ae])<=0;)re.pop();re.push(de[Ae])}for(var ne=[],ot=de.length-1;ot>=0;ot--){for(;ne.length>=2&&Mt(ne[ne.length-2],ne[ne.length-1],de[ot])<=0;)ne.pop();ne.push(de[ot])}return ne.pop(),re.pop(),re.concat(ne)}(on)}(de),ot=new be(16);ot.toBBox=function(Cn){return{minX:Cn[0],minY:Cn[1],maxX:Cn[0],maxY:Cn[1]}},ot.compareMinX=function(Cn,Ut){return Cn[0]-Ut[0]},ot.compareMinY=function(Cn,Ut){return Cn[1]-Ut[1]},ot.load(de);for(var Me,Ue=[],Ke=0;Ke<ne.length;Ke++){var on=ne[Ke];ot.remove(on),Me=he(on,Me),Ue.push(Me)}var Lt=new be(16);for(Ke=0;Ke<Ue.length;Ke++)Lt.insert(Rt(Ue[Ke]));for(var Ee=re*re,dt=Ae*Ae;Ue.length;){var Re=Ue.shift(),it=Re.p,gt=Re.next.p,Ie=De(it,gt);if(!(Ie<dt)){var qt=Ie/Ee;(on=He(ot,Re.prev.p,it,gt,Re.next.next.p,qt,Lt))&&Math.min(De(on,it),De(on,gt))<=qt&&(Ue.push(Re),Ue.push(he(on,Re)),ot.remove(on),Lt.remove(Re),Lt.insert(Rt(Re)),Lt.insert(Rt(Re.next)))}}Re=Me;var Ct=[];do{Ct.push(Re.p),Re=Re.next}while(Re!==Me);return Ct.push(Re.p),Ct}function He(de,re,Ae,ne,ot,Ue,Ke){for(var Me=new Fe([],ct),on=de.data;on;){for(var Lt=0;Lt<on.children.length;Lt++){var Ee=on.children[Lt],dt=on.leaf?ce(Ee,Ae,ne):tt(Ae,ne,Ee);dt>Ue||Me.push({node:Ee,dist:dt})}for(;Me.length&&!Me.peek().node.children;){var Re=Me.pop(),it=Re.node,gt=ce(it,re,Ae),Ie=ce(it,ne,ot);if(Re.dist<gt&&Re.dist<Ie&&Xt(Ae,it,Ke)&&Xt(ne,it,Ke))return it}(on=Me.pop())&&(on=on.node)}return null}function ct(de,re){return de.dist-re.dist}function tt(de,re,Ae){if(mt(de,Ae)||mt(re,Ae))return 0;var ne=ge(de[0],de[1],re[0],re[1],Ae.minX,Ae.minY,Ae.maxX,Ae.minY);if(0===ne)return 0;var ot=ge(de[0],de[1],re[0],re[1],Ae.minX,Ae.minY,Ae.minX,Ae.maxY);if(0===ot)return 0;var Ue=ge(de[0],de[1],re[0],re[1],Ae.maxX,Ae.minY,Ae.maxX,Ae.maxY);if(0===Ue)return 0;var Ke=ge(de[0],de[1],re[0],re[1],Ae.minX,Ae.maxY,Ae.maxX,Ae.maxY);return 0===Ke?0:Math.min(ne,ot,Ue,Ke)}function mt(de,re){return de[0]>=re.minX&&de[0]<=re.maxX&&de[1]>=re.minY&&de[1]<=re.maxY}function Xt(de,re,Ae){for(var ne=Math.min(de[0],re[0]),ot=Math.min(de[1],re[1]),Ue=Math.max(de[0],re[0]),Ke=Math.max(de[1],re[1]),Me=Ae.search({minX:ne,minY:ot,maxX:Ue,maxY:Ke}),on=0;on<Me.length;on++)if(yt(Me[on].p,Me[on].next.p,de,re))return!1;return!0}function Mt(de,re,Ae){return m(de[0],de[1],re[0],re[1],Ae[0],Ae[1])}function yt(de,re,Ae,ne){return de!==ne&&re!==Ae&&Mt(de,re,Ae)>0!=Mt(de,re,ne)>0&&Mt(Ae,ne,de)>0!=Mt(Ae,ne,re)>0}function Rt(de){var re=de.p,Ae=de.next.p;return de.minX=Math.min(re[0],Ae[0]),de.minY=Math.min(re[1],Ae[1]),de.maxX=Math.max(re[0],Ae[0]),de.maxY=Math.max(re[1],Ae[1]),de}function he(de,re){var Ae={p:de,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return re?(Ae.next=re.next,Ae.prev=re,re.next.prev=Ae,re.next=Ae):(Ae.prev=Ae,Ae.next=Ae),Ae}function De(de,re){var Ae=de[0]-re[0],ne=de[1]-re[1];return Ae*Ae+ne*ne}function ce(de,re,Ae){var ne=re[0],ot=re[1],Ue=Ae[0]-ne,Ke=Ae[1]-ot;if(0!==Ue||0!==Ke){var Me=((de[0]-ne)*Ue+(de[1]-ot)*Ke)/(Ue*Ue+Ke*Ke);Me>1?(ne=Ae[0],ot=Ae[1]):Me>0&&(ne+=Ue*Me,ot+=Ke*Me)}return(Ue=de[0]-ne)*Ue+(Ke=de[1]-ot)*Ke}function ge(de,re,Ae,ne,ot,Ue,Ke,Me){var Bn,zn,Jn,Kt,on=Ae-de,Lt=ne-re,Ee=Ke-ot,dt=Me-Ue,Re=de-ot,it=re-Ue,gt=on*on+Lt*Lt,Ie=on*Ee+Lt*dt,qt=Ee*Ee+dt*dt,Ct=on*Re+Lt*it,Cn=Ee*Re+dt*it,Ut=gt*qt-Ie*Ie,Qn=Ut,mn=Ut;0===Ut?(zn=0,Qn=1,Kt=Cn,mn=qt):(Kt=gt*Cn-Ie*Ct,(zn=Ie*Cn-qt*Ct)<0?(zn=0,Kt=Cn,mn=qt):zn>Qn&&(zn=Qn,Kt=Cn+Ie,mn=qt)),Kt<0?(Kt=0,-Ct<0?zn=0:-Ct>gt?zn=Qn:(zn=-Ct,Qn=gt)):Kt>mn&&(Kt=mn,-Ct+Ie<0?zn=0:-Ct+Ie>gt?zn=Qn:(zn=-Ct+Ie,Qn=gt));var wi=(1-(Jn=0===Kt?0:Kt/mn))*ot+Jn*Ke-((1-(Bn=0===zn?0:zn/Qn))*de+Bn*Ae),_t=(1-Jn)*Ue+Jn*Me-((1-Bn)*re+Bn*ne);return wi*wi+_t*_t}function ue(de,re){return de[0]===re[0]?de[1]-re[1]:de[0]-re[0]}Fe.default&&(Fe=Fe.default),un.exports=xe,un.exports.default=xe},938:function(un){un.exports=function(){"use strict";function vt(he,De,ce,ge,ue){!function ze(de,re,Ae,ne,ot){for(;ne>Ae;){if(ne-Ae>600){var Ue=ne-Ae+1,Ke=re-Ae+1,Me=Math.log(Ue),on=.5*Math.exp(2*Me/3),Lt=.5*Math.sqrt(Me*on*(Ue-on)/Ue)*(Ke-Ue/2<0?-1:1);ze(de,re,Math.max(Ae,Math.floor(re-Ke*on/Ue+Lt)),Math.min(ne,Math.floor(re+(Ue-Ke)*on/Ue+Lt)),ot)}var Re=de[re],it=Ae,gt=ne;for(Ve(de,Ae,re),ot(de[ne],Re)>0&&Ve(de,Ae,ne);it<gt;){for(Ve(de,it,gt),it++,gt--;ot(de[it],Re)<0;)it++;for(;ot(de[gt],Re)>0;)gt--}0===ot(de[Ae],Re)?Ve(de,Ae,gt):Ve(de,++gt,ne),gt<=re&&(Ae=gt+1),re<=gt&&(ne=gt-1)}}(he,De,ce||0,ge||he.length-1,ue||be)}function Ve(he,De,ce){var ge=he[De];he[De]=he[ce],he[ce]=ge}function be(he,De){return he<De?-1:he>De?1:0}var Fe=function(he){void 0===he&&(he=9),this._maxEntries=Math.max(4,he),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function at(he,De,ce){if(!ce)return De.indexOf(he);for(var ge=0;ge<De.length;ge++)if(ce(he,De[ge]))return ge;return-1}function m(he,De){xe(he,0,he.children.length,De,he)}function xe(he,De,ce,ge,ue){ue||(ue=Rt(null)),ue.minX=1/0,ue.minY=1/0,ue.maxX=-1/0,ue.maxY=-1/0;for(var ze=De;ze<ce;ze++){var de=he.children[ze];He(ue,he.leaf?ge(de):de)}return ue}function He(he,De){return he.minX=Math.min(he.minX,De.minX),he.minY=Math.min(he.minY,De.minY),he.maxX=Math.max(he.maxX,De.maxX),he.maxY=Math.max(he.maxY,De.maxY),he}function ct(he,De){return he.minX-De.minX}function tt(he,De){return he.minY-De.minY}function mt(he){return(he.maxX-he.minX)*(he.maxY-he.minY)}function Xt(he){return he.maxX-he.minX+(he.maxY-he.minY)}function Mt(he,De){return he.minX<=De.minX&&he.minY<=De.minY&&De.maxX<=he.maxX&&De.maxY<=he.maxY}function yt(he,De){return De.minX<=he.maxX&&De.minY<=he.maxY&&De.maxX>=he.minX&&De.maxY>=he.minY}function Rt(he){return{children:he,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function pn(he,De,ce,ge,ue){for(var ze=[De,ce];ze.length;)if(!((ce=ze.pop())-(De=ze.pop())<=ge)){var de=De+Math.ceil((ce-De)/ge/2)*ge;vt(he,de,De,ce,ue),ze.push(De,de,de,ce)}}return Fe.prototype.all=function(){return this._all(this.data,[])},Fe.prototype.search=function(he){var De=this.data,ce=[];if(!yt(he,De))return ce;for(var ge=this.toBBox,ue=[];De;){for(var ze=0;ze<De.children.length;ze++){var de=De.children[ze],re=De.leaf?ge(de):de;yt(he,re)&&(De.leaf?ce.push(de):Mt(he,re)?this._all(de,ce):ue.push(de))}De=ue.pop()}return ce},Fe.prototype.collides=function(he){var De=this.data;if(!yt(he,De))return!1;for(var ce=[];De;){for(var ge=0;ge<De.children.length;ge++){var ue=De.children[ge],ze=De.leaf?this.toBBox(ue):ue;if(yt(he,ze)){if(De.leaf||Mt(he,ze))return!0;ce.push(ue)}}De=ce.pop()}return!1},Fe.prototype.load=function(he){if(!he||!he.length)return this;if(he.length<this._minEntries){for(var De=0;De<he.length;De++)this.insert(he[De]);return this}var ce=this._build(he.slice(),0,he.length-1,0);if(this.data.children.length)if(this.data.height===ce.height)this._splitRoot(this.data,ce);else{if(this.data.height<ce.height){var ge=this.data;this.data=ce,ce=ge}this._insert(ce,this.data.height-ce.height-1,!0)}else this.data=ce;return this},Fe.prototype.insert=function(he){return he&&this._insert(he,this.data.height-1),this},Fe.prototype.clear=function(){return this.data=Rt([]),this},Fe.prototype.remove=function(he,De){if(!he)return this;for(var ce,ge,ue,ze=this.data,de=this.toBBox(he),re=[],Ae=[];ze||re.length;){if(ze||(ze=re.pop(),ge=re[re.length-1],ce=Ae.pop(),ue=!0),ze.leaf){var ne=at(he,ze.children,De);if(-1!==ne)return ze.children.splice(ne,1),re.push(ze),this._condense(re),this}ue||ze.leaf||!Mt(ze,de)?ge?(ce++,ze=ge.children[ce],ue=!1):ze=null:(re.push(ze),Ae.push(ce),ce=0,ge=ze,ze=ze.children[0])}return this},Fe.prototype.toBBox=function(he){return he},Fe.prototype.compareMinX=function(he,De){return he.minX-De.minX},Fe.prototype.compareMinY=function(he,De){return he.minY-De.minY},Fe.prototype.toJSON=function(){return this.data},Fe.prototype.fromJSON=function(he){return this.data=he,this},Fe.prototype._all=function(he,De){for(var ce=[];he;)he.leaf?De.push.apply(De,he.children):ce.push.apply(ce,he.children),he=ce.pop();return De},Fe.prototype._build=function(he,De,ce,ge){var ue,ze=ce-De+1,de=this._maxEntries;if(ze<=de)return m(ue=Rt(he.slice(De,ce+1)),this.toBBox),ue;ge||(ge=Math.ceil(Math.log(ze)/Math.log(de)),de=Math.ceil(ze/Math.pow(de,ge-1))),(ue=Rt([])).leaf=!1,ue.height=ge;var re=Math.ceil(ze/de),Ae=re*Math.ceil(Math.sqrt(de));pn(he,De,ce,Ae,this.compareMinX);for(var ne=De;ne<=ce;ne+=Ae){var ot=Math.min(ne+Ae-1,ce);pn(he,ne,ot,re,this.compareMinY);for(var Ue=ne;Ue<=ot;Ue+=re){var Ke=Math.min(Ue+re-1,ot);ue.children.push(this._build(he,Ue,Ke,ge-1))}}return m(ue,this.toBBox),ue},Fe.prototype._chooseSubtree=function(he,De,ce,ge){for(;ge.push(De),!De.leaf&&ge.length-1!==ce;){for(var ue=1/0,ze=1/0,de=void 0,re=0;re<De.children.length;re++){var Ae=De.children[re],ne=mt(Ae),ot=(Ue=he,Ke=Ae,(Math.max(Ke.maxX,Ue.maxX)-Math.min(Ke.minX,Ue.minX))*(Math.max(Ke.maxY,Ue.maxY)-Math.min(Ke.minY,Ue.minY))-ne);ot<ze?(ze=ot,ue=ne<ue?ne:ue,de=Ae):ot===ze&&ne<ue&&(ue=ne,de=Ae)}De=de||De.children[0]}var Ue,Ke;return De},Fe.prototype._insert=function(he,De,ce){var ge=ce?he:this.toBBox(he),ue=[],ze=this._chooseSubtree(ge,this.data,De,ue);for(ze.children.push(he),He(ze,ge);De>=0&&ue[De].children.length>this._maxEntries;)this._split(ue,De),De--;this._adjustParentBBoxes(ge,ue,De)},Fe.prototype._split=function(he,De){var ce=he[De],ge=ce.children.length,ue=this._minEntries;this._chooseSplitAxis(ce,ue,ge);var ze=this._chooseSplitIndex(ce,ue,ge),de=Rt(ce.children.splice(ze,ce.children.length-ze));de.height=ce.height,de.leaf=ce.leaf,m(ce,this.toBBox),m(de,this.toBBox),De?he[De-1].children.push(de):this._splitRoot(ce,de)},Fe.prototype._splitRoot=function(he,De){this.data=Rt([he,De]),this.data.height=he.height+1,this.data.leaf=!1,m(this.data,this.toBBox)},Fe.prototype._chooseSplitIndex=function(he,De,ce){for(var ge,ue,ze,de,re,Ae,ne,ot=1/0,Ue=1/0,Ke=De;Ke<=ce-De;Ke++){var Me=xe(he,0,Ke,this.toBBox),on=xe(he,Ke,ce,this.toBBox),Lt=(ue=Me,ze=on,void 0,void 0,void 0,void 0,de=Math.max(ue.minX,ze.minX),re=Math.max(ue.minY,ze.minY),Ae=Math.min(ue.maxX,ze.maxX),ne=Math.min(ue.maxY,ze.maxY),Math.max(0,Ae-de)*Math.max(0,ne-re)),Ee=mt(Me)+mt(on);Lt<ot?(ot=Lt,ge=Ke,Ue=Ee<Ue?Ee:Ue):Lt===ot&&Ee<Ue&&(Ue=Ee,ge=Ke)}return ge||ce-De},Fe.prototype._chooseSplitAxis=function(he,De,ce){var ge=he.leaf?this.compareMinX:ct,ue=he.leaf?this.compareMinY:tt;this._allDistMargin(he,De,ce,ge)<this._allDistMargin(he,De,ce,ue)&&he.children.sort(ge)},Fe.prototype._allDistMargin=function(he,De,ce,ge){he.children.sort(ge);for(var ue=this.toBBox,ze=xe(he,0,De,ue),de=xe(he,ce-De,ce,ue),re=Xt(ze)+Xt(de),Ae=De;Ae<ce-De;Ae++){var ne=he.children[Ae];He(ze,he.leaf?ue(ne):ne),re+=Xt(ze)}for(var ot=ce-De-1;ot>=De;ot--){var Ue=he.children[ot];He(de,he.leaf?ue(Ue):Ue),re+=Xt(de)}return re},Fe.prototype._adjustParentBBoxes=function(he,De,ce){for(var ge=ce;ge>=0;ge--)He(De[ge],he)},Fe.prototype._condense=function(he){for(var De=he.length-1,ce=void 0;De>=0;De--)0===he[De].children.length?De>0?(ce=he[De-1].children).splice(ce.indexOf(he[De]),1):this.clear():m(he[De],this.toBBox)},Fe}()},3970:(un,vt,Ve)=>{var be=Ve(7809),Fe=Ve(8147),at=Ve(314),m=Ve(4720),xe=Ve(1139),He=Ve(2365),ct=Date.prototype.getTime;function mt(yt){return null==yt}function Xt(yt){return!(!yt||"object"!=typeof yt||"number"!=typeof yt.length||"function"!=typeof yt.copy||"function"!=typeof yt.slice||yt.length>0&&"number"!=typeof yt[0])}un.exports=function tt(yt,Rt,pn){var he=pn||{};return!!(he.strict?at(yt,Rt):yt===Rt)||(!yt||!Rt||"object"!=typeof yt&&"object"!=typeof Rt?he.strict?at(yt,Rt):yt==Rt:function Mt(yt,Rt,pn){var he,De;if(typeof yt!=typeof Rt||mt(yt)||mt(Rt)||yt.prototype!==Rt.prototype||Fe(yt)!==Fe(Rt))return!1;var ce=m(yt),ge=m(Rt);if(ce!==ge)return!1;if(ce||ge)return yt.source===Rt.source&&xe(yt)===xe(Rt);if(He(yt)&&He(Rt))return ct.call(yt)===ct.call(Rt);var ue=Xt(yt),ze=Xt(Rt);if(ue!==ze)return!1;if(ue||ze){if(yt.length!==Rt.length)return!1;for(he=0;he<yt.length;he++)if(yt[he]!==Rt[he])return!1;return!0}if(typeof yt!=typeof Rt)return!1;try{var de=be(yt),re=be(Rt)}catch{return!1}if(de.length!==re.length)return!1;for(de.sort(),re.sort(),he=de.length-1;he>=0;he--)if(de[he]!=re[he])return!1;for(he=de.length-1;he>=0;he--)if(!tt(yt[De=de[he]],Rt[De],pn))return!1;return!0}(yt,Rt,he))}},9224:(un,vt,Ve)=>{"use strict";var be=Ve(2486)(),Fe=Ve(491),at=be&&Fe("%Object.defineProperty%",!0);if(at)try{at({},"a",{value:1})}catch{at=!1}var m=Fe("%SyntaxError%"),xe=Fe("%TypeError%"),He=Ve(9262);un.exports=function(tt,mt,Xt){if(!tt||"object"!=typeof tt&&"function"!=typeof tt)throw new xe("`obj` must be an object or a function`");if("string"!=typeof mt&&"symbol"!=typeof mt)throw new xe("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new xe("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new xe("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new xe("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new xe("`loose`, if provided, must be a boolean");var Mt=arguments.length>3?arguments[3]:null,yt=arguments.length>4?arguments[4]:null,Rt=arguments.length>5?arguments[5]:null,pn=arguments.length>6&&arguments[6],he=!!He&&He(tt,mt);if(at)at(tt,mt,{configurable:null===Rt&&he?he.configurable:!Rt,enumerable:null===Mt&&he?he.enumerable:!Mt,value:Xt,writable:null===yt&&he?he.writable:!yt});else{if(!pn&&(Mt||yt||Rt))throw new m("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");tt[mt]=Xt}}},1648:(un,vt,Ve)=>{"use strict";var be=Ve(7809),Fe="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),at=Object.prototype.toString,m=Array.prototype.concat,xe=Ve(9224),ct=Ve(2486)(),tt=function(Xt,Mt,yt,Rt){if(Mt in Xt)if(!0===Rt){if(Xt[Mt]===yt)return}else if(!function(Xt){return"function"==typeof Xt&&"[object Function]"===at.call(Xt)}(Rt)||!Rt())return;ct?xe(Xt,Mt,yt,!0):xe(Xt,Mt,yt)},mt=function(Xt,Mt){var yt=arguments.length>2?arguments[2]:{},Rt=be(Mt);Fe&&(Rt=m.call(Rt,Object.getOwnPropertySymbols(Mt)));for(var pn=0;pn<Rt.length;pn+=1)tt(Xt,Rt[pn],Mt[Rt[pn]],yt[Rt[pn]])};mt.supportsDescriptors=!!ct,un.exports=mt},7649:un=>{function vt(Ve,be,Fe,at){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(Ve,be,Fe,at)}vt.prototype.run=function(Ve,be,Fe,at){this._init(Ve,be,Fe,at);for(var m=0;m<this._datasetLength;m++)if(1!==this._visited[m]){this._visited[m]=1;var xe=this._regionQuery(m);if(xe.length<this.minPts)this.noise.push(m);else{var He=this.clusters.length;this.clusters.push([]),this._addToCluster(m,He),this._expandCluster(He,xe)}}return this.clusters},vt.prototype._init=function(Ve,be,Fe,at){if(Ve){if(!(Ve instanceof Array))throw Error("Dataset must be of type array, "+typeof Ve+" given");this.dataset=Ve,this.clusters=[],this.noise=[],this._datasetLength=Ve.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}be&&(this.epsilon=be),Fe&&(this.minPts=Fe),at&&(this.distance=at)},vt.prototype._expandCluster=function(Ve,be){for(var Fe=0;Fe<be.length;Fe++){var at=be[Fe];if(1!==this._visited[at]){this._visited[at]=1;var m=this._regionQuery(at);m.length>=this.minPts&&(be=this._mergeArrays(be,m))}1!==this._assigned[at]&&this._addToCluster(at,Ve)}},vt.prototype._addToCluster=function(Ve,be){this.clusters[be].push(Ve),this._assigned[Ve]=1},vt.prototype._regionQuery=function(Ve){for(var be=[],Fe=0;Fe<this._datasetLength;Fe++)this.distance(this.dataset[Ve],this.dataset[Fe])<this.epsilon&&be.push(Fe);return be},vt.prototype._mergeArrays=function(Ve,be){for(var Fe=be.length,at=0;at<Fe;at++){var m=be[at];Ve.indexOf(m)<0&&Ve.push(m)}return Ve},vt.prototype._euclideanDistance=function(Ve,be){for(var Fe=0,at=Math.min(Ve.length,be.length);at--;)Fe+=(Ve[at]-be[at])*(Ve[at]-be[at]);return Math.sqrt(Fe)},un.exports&&(un.exports=vt)},442:un=>{function vt(Ve,be,Fe){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(Ve,be,Fe)}vt.prototype.init=function(Ve,be,Fe){this.assignments=[],this.centroids=[],typeof Ve<"u"&&(this.dataset=Ve),typeof be<"u"&&(this.k=be),typeof Fe<"u"&&(this.distance=Fe)},vt.prototype.run=function(Ve,be){this.init(Ve,be);for(var Fe=this.dataset.length,at=0;at<this.k;at++)this.centroids[at]=this.randomCentroid();for(var m=!0;m;){m=this.assign();for(var xe=0;xe<this.k;xe++){for(var He=new Array(Xt),ct=0,tt=0;tt<Xt;tt++)He[tt]=0;for(var mt=0;mt<Fe;mt++){var Xt=this.dataset[mt].length;if(xe===this.assignments[mt]){for(tt=0;tt<Xt;tt++)He[tt]+=this.dataset[mt][tt];ct++}}if(ct>0){for(tt=0;tt<Xt;tt++)He[tt]/=ct;this.centroids[xe]=He}else this.centroids[xe]=this.randomCentroid(),m=!0}}return this.getClusters()},vt.prototype.randomCentroid=function(){var be,Fe,Ve=this.dataset.length-1;do{Fe=Math.round(Math.random()*Ve),be=this.dataset[Fe]}while(this.centroids.indexOf(be)>=0);return be},vt.prototype.assign=function(){for(var Fe,Ve=!1,be=this.dataset.length,at=0;at<be;at++)(Fe=this.argmin(this.dataset[at],this.centroids,this.distance))!=this.assignments[at]&&(this.assignments[at]=Fe,Ve=!0);return Ve},vt.prototype.getClusters=function(){for(var be,Ve=new Array(this.k),Fe=0;Fe<this.assignments.length;Fe++)typeof Ve[be=this.assignments[Fe]]>"u"&&(Ve[be]=[]),Ve[be].push(Fe);return Ve},vt.prototype.argmin=function(Ve,be,Fe){for(var He,at=Number.MAX_VALUE,m=0,xe=be.length,ct=0;ct<xe;ct++)(He=Fe(Ve,be[ct]))<at&&(at=He,m=ct);return m},vt.prototype.distance=function(Ve,be){for(var Fe=0,at=Math.min(Ve.length,be.length);at--;){var m=Ve[at]-be[at];Fe+=m*m}return Math.sqrt(Fe)},un.exports&&(un.exports=vt)},2195:(un,vt,Ve)=>{if(un.exports)var be=Ve(6216);function Fe(at,m,xe,He){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(at,m,xe,He)}Fe.prototype.run=function(at,m,xe,He){this._init(at,m,xe,He);for(var ct=0,tt=this.dataset.length;ct<tt;ct++)if(1!==this._processed[ct]){this._processed[ct]=1,this.clusters.push([ct]);var mt=this.clusters.length-1;this._orderedList.push(ct);var Xt=new be(null,null,"asc"),Mt=this._regionQuery(ct);void 0!==this._distanceToCore(ct)&&(this._updateQueue(ct,Mt,Xt),this._expandCluster(mt,Xt))}return this.clusters},Fe.prototype.getReachabilityPlot=function(){for(var at=[],m=0,xe=this._orderedList.length;m<xe;m++){var He=this._orderedList[m];at.push([He,this._reachability[He]])}return at},Fe.prototype._init=function(at,m,xe,He){if(at){if(!(at instanceof Array))throw Error("Dataset must be of type array, "+typeof at+" given");this.dataset=at,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}m&&(this.epsilon=m),xe&&(this.minPts=xe),He&&(this.distance=He)},Fe.prototype._updateQueue=function(at,m,xe){var He=this;this._coreDistance=this._distanceToCore(at),m.forEach(function(ct){if(void 0===He._processed[ct]){var tt=He.distance(He.dataset[at],He.dataset[ct]),mt=Math.max(He._coreDistance,tt);void 0===He._reachability[ct]?(He._reachability[ct]=mt,xe.insert(ct,mt)):mt<He._reachability[ct]&&(He._reachability[ct]=mt,xe.remove(ct),xe.insert(ct,mt))}})},Fe.prototype._expandCluster=function(at,m){for(var xe=m.getElements(),He=0,ct=xe.length;He<ct;He++){var tt=xe[He];if(void 0===this._processed[tt]){var mt=this._regionQuery(tt);this._processed[tt]=1,this.clusters[at].push(tt),this._orderedList.push(tt),void 0!==this._distanceToCore(tt)&&(this._updateQueue(tt,mt,m),this._expandCluster(at,m))}}},Fe.prototype._distanceToCore=function(at){for(var m=this.epsilon,xe=0;xe<m;xe++)if(this._regionQuery(at,xe).length>=this.minPts)return xe},Fe.prototype._regionQuery=function(at,m){m=m||this.epsilon;for(var xe=[],He=0,ct=this.dataset.length;He<ct;He++)this.distance(this.dataset[at],this.dataset[He])<m&&xe.push(He);return xe},Fe.prototype._euclideanDistance=function(at,m){for(var xe=0,He=Math.min(at.length,m.length);He--;)xe+=(at[He]-m[He])*(at[He]-m[He]);return Math.sqrt(xe)},un.exports&&(un.exports=Fe)},6216:un=>{function vt(Ve,be,Fe){this._queue=[],this._priorities=[],this._sorting="desc",this._init(Ve,be,Fe)}vt.prototype.insert=function(Ve,be){for(var Fe=this._queue.length,at=Fe;at--;){var m=this._priorities[at];"desc"===this._sorting?be>m&&(Fe=at):be<m&&(Fe=at)}this._insertAt(Ve,be,Fe)},vt.prototype.remove=function(Ve){for(var be=this._queue.length;be--;)if(Ve===this._queue[be]){this._queue.splice(be,1),this._priorities.splice(be,1);break}},vt.prototype.forEach=function(Ve){this._queue.forEach(Ve)},vt.prototype.getElements=function(){return this._queue},vt.prototype.getElementPriority=function(Ve){return this._priorities[Ve]},vt.prototype.getPriorities=function(){return this._priorities},vt.prototype.getElementsWithPriorities=function(){for(var Ve=[],be=0,Fe=this._queue.length;be<Fe;be++)Ve.push([this._queue[be],this._priorities[be]]);return Ve},vt.prototype._init=function(Ve,be,Fe){if(Ve&&be){if(this._queue=[],this._priorities=[],Ve.length!==be.length)throw new Error("Arrays must have the same length");for(var at=0;at<Ve.length;at++)this.insert(Ve[at],be[at])}Fe&&(this._sorting=Fe)},vt.prototype._insertAt=function(Ve,be,Fe){this._queue.length===Fe?(this._queue.push(Ve),this._priorities.push(be)):(this._queue.splice(Fe,0,Ve),this._priorities.splice(Fe,0,be))},un.exports&&(un.exports=vt)},3367:(un,vt,Ve)=>{un.exports&&(un.exports={DBSCAN:Ve(7649),KMEANS:Ve(442),OPTICS:Ve(2195),PriorityQueue:Ve(6216)})},9145:un=>{"use strict";function vt(Ee,dt,Re){Re=Re||2;var Ct,Cn,Ut,Bn,zn,Jn,Kt,it=dt&&dt.length,gt=it?dt[0]*Re:Ee.length,Ie=Ve(Ee,0,gt,Re,!0),qt=[];if(!Ie||Ie.next===Ie.prev)return qt;if(it&&(Ie=function ct(Ee,dt,Re,it){var Ie,qt,Ut,gt=[];for(Ie=0,qt=dt.length;Ie<qt;Ie++)(Ut=Ve(Ee,dt[Ie]*it,Ie<qt-1?dt[Ie+1]*it:Ee.length,it,!1))===Ut.next&&(Ut.steiner=!0),gt.push(he(Ut));for(gt.sort(tt),Ie=0;Ie<gt.length;Ie++)Re=mt(gt[Ie],Re);return Re}(Ee,dt,Ie,Re)),Ee.length>80*Re){Ct=Ut=Ee[0],Cn=Bn=Ee[1];for(var Qn=Re;Qn<gt;Qn+=Re)(zn=Ee[Qn])<Ct&&(Ct=zn),(Jn=Ee[Qn+1])<Cn&&(Cn=Jn),zn>Ut&&(Ut=zn),Jn>Bn&&(Bn=Jn);Kt=0!==(Kt=Math.max(Ut-Ct,Bn-Cn))?32767/Kt:0}return Fe(Ie,qt,Re,Ct,Cn,Kt,0),qt}function Ve(Ee,dt,Re,it,gt){var Ie,qt;if(gt===Lt(Ee,dt,Re,it)>0)for(Ie=dt;Ie<Re;Ie+=it)qt=Ke(Ie,Ee[Ie],Ee[Ie+1],qt);else for(Ie=Re-it;Ie>=dt;Ie-=it)qt=Ke(Ie,Ee[Ie],Ee[Ie+1],qt);return qt&&ue(qt,qt.next)&&(Me(qt),qt=qt.next),qt}function be(Ee,dt){if(!Ee)return Ee;dt||(dt=Ee);var it,Re=Ee;do{if(it=!1,Re.steiner||!ue(Re,Re.next)&&0!==ge(Re.prev,Re,Re.next))Re=Re.next;else{if(Me(Re),(Re=dt=Re.prev)===Re.next)break;it=!0}}while(it||Re!==dt);return dt}function Fe(Ee,dt,Re,it,gt,Ie,qt){if(Ee){!qt&&Ie&&function yt(Ee,dt,Re,it){var gt=Ee;do{0===gt.z&&(gt.z=pn(gt.x,gt.y,dt,Re,it)),gt.prevZ=gt.prev,gt.nextZ=gt.next,gt=gt.next}while(gt!==Ee);gt.prevZ.nextZ=null,gt.prevZ=null,function Rt(Ee){var dt,Re,it,gt,Ie,qt,Ct,Cn,Ut=1;do{for(Re=Ee,Ee=null,Ie=null,qt=0;Re;){for(qt++,it=Re,Ct=0,dt=0;dt<Ut&&(Ct++,it=it.nextZ);dt++);for(Cn=Ut;Ct>0||Cn>0&&it;)0!==Ct&&(0===Cn||!it||Re.z<=it.z)?(gt=Re,Re=Re.nextZ,Ct--):(gt=it,it=it.nextZ,Cn--),Ie?Ie.nextZ=gt:Ee=gt,gt.prevZ=Ie,Ie=gt;Re=it}Ie.nextZ=null,Ut*=2}while(qt>1)}(gt)}(Ee,it,gt,Ie);for(var Cn,Ut,Ct=Ee;Ee.prev!==Ee.next;)if(Cn=Ee.prev,Ut=Ee.next,Ie?m(Ee,it,gt,Ie):at(Ee))dt.push(Cn.i/Re|0),dt.push(Ee.i/Re|0),dt.push(Ut.i/Re|0),Me(Ee),Ee=Ut.next,Ct=Ut.next;else if((Ee=Ut)===Ct){qt?1===qt?Fe(Ee=xe(be(Ee),dt,Re),dt,Re,it,gt,Ie,2):2===qt&&He(Ee,dt,Re,it,gt,Ie):Fe(be(Ee),dt,Re,it,gt,Ie,1);break}}}function at(Ee){var dt=Ee.prev,Re=Ee,it=Ee.next;if(ge(dt,Re,it)>=0)return!1;for(var gt=dt.x,Ie=Re.x,qt=it.x,Ct=dt.y,Cn=Re.y,Ut=it.y,Bn=gt<Ie?gt<qt?gt:qt:Ie<qt?Ie:qt,zn=Ct<Cn?Ct<Ut?Ct:Ut:Cn<Ut?Cn:Ut,Jn=gt>Ie?gt>qt?gt:qt:Ie>qt?Ie:qt,Kt=Ct>Cn?Ct>Ut?Ct:Ut:Cn>Ut?Cn:Ut,Qn=it.next;Qn!==dt;){if(Qn.x>=Bn&&Qn.x<=Jn&&Qn.y>=zn&&Qn.y<=Kt&&De(gt,Ct,Ie,Cn,qt,Ut,Qn.x,Qn.y)&&ge(Qn.prev,Qn,Qn.next)>=0)return!1;Qn=Qn.next}return!0}function m(Ee,dt,Re,it){var gt=Ee.prev,Ie=Ee,qt=Ee.next;if(ge(gt,Ie,qt)>=0)return!1;for(var Ct=gt.x,Cn=Ie.x,Ut=qt.x,Bn=gt.y,zn=Ie.y,Jn=qt.y,Kt=Ct<Cn?Ct<Ut?Ct:Ut:Cn<Ut?Cn:Ut,Qn=Bn<zn?Bn<Jn?Bn:Jn:zn<Jn?zn:Jn,mn=Ct>Cn?Ct>Ut?Ct:Ut:Cn>Ut?Cn:Ut,Mr=Bn>zn?Bn>Jn?Bn:Jn:zn>Jn?zn:Jn,Ii=pn(Kt,Qn,dt,Re,it),vr=pn(mn,Mr,dt,Re,it),mi=Ee.prevZ,wi=Ee.nextZ;mi&&mi.z>=Ii&&wi&&wi.z<=vr;){if(mi.x>=Kt&&mi.x<=mn&&mi.y>=Qn&&mi.y<=Mr&&mi!==gt&&mi!==qt&&De(Ct,Bn,Cn,zn,Ut,Jn,mi.x,mi.y)&&ge(mi.prev,mi,mi.next)>=0||(mi=mi.prevZ,wi.x>=Kt&&wi.x<=mn&&wi.y>=Qn&&wi.y<=Mr&&wi!==gt&&wi!==qt&&De(Ct,Bn,Cn,zn,Ut,Jn,wi.x,wi.y)&&ge(wi.prev,wi,wi.next)>=0))return!1;wi=wi.nextZ}for(;mi&&mi.z>=Ii;){if(mi.x>=Kt&&mi.x<=mn&&mi.y>=Qn&&mi.y<=Mr&&mi!==gt&&mi!==qt&&De(Ct,Bn,Cn,zn,Ut,Jn,mi.x,mi.y)&&ge(mi.prev,mi,mi.next)>=0)return!1;mi=mi.prevZ}for(;wi&&wi.z<=vr;){if(wi.x>=Kt&&wi.x<=mn&&wi.y>=Qn&&wi.y<=Mr&&wi!==gt&&wi!==qt&&De(Ct,Bn,Cn,zn,Ut,Jn,wi.x,wi.y)&&ge(wi.prev,wi,wi.next)>=0)return!1;wi=wi.nextZ}return!0}function xe(Ee,dt,Re){var it=Ee;do{var gt=it.prev,Ie=it.next.next;!ue(gt,Ie)&&ze(gt,it,it.next,Ie)&&ne(gt,Ie)&&ne(Ie,gt)&&(dt.push(gt.i/Re|0),dt.push(it.i/Re|0),dt.push(Ie.i/Re|0),Me(it),Me(it.next),it=Ee=Ie),it=it.next}while(it!==Ee);return be(it)}function He(Ee,dt,Re,it,gt,Ie){var qt=Ee;do{for(var Ct=qt.next.next;Ct!==qt.prev;){if(qt.i!==Ct.i&&ce(qt,Ct)){var Cn=Ue(qt,Ct);return qt=be(qt,qt.next),Cn=be(Cn,Cn.next),Fe(qt,dt,Re,it,gt,Ie,0),void Fe(Cn,dt,Re,it,gt,Ie,0)}Ct=Ct.next}qt=qt.next}while(qt!==Ee)}function tt(Ee,dt){return Ee.x-dt.x}function mt(Ee,dt){var Re=function Xt(Ee,dt){var qt,Re=dt,it=Ee.x,gt=Ee.y,Ie=-1/0;do{if(gt<=Re.y&&gt>=Re.next.y&&Re.next.y!==Re.y){var Ct=Re.x+(gt-Re.y)*(Re.next.x-Re.x)/(Re.next.y-Re.y);if(Ct<=it&&Ct>Ie&&(Ie=Ct,qt=Re.x<Re.next.x?Re:Re.next,Ct===it))return qt}Re=Re.next}while(Re!==dt);if(!qt)return null;var Jn,Cn=qt,Ut=qt.x,Bn=qt.y,zn=1/0;Re=qt;do{it>=Re.x&&Re.x>=Ut&&it!==Re.x&&De(gt<Bn?it:Ie,gt,Ut,Bn,gt<Bn?Ie:it,gt,Re.x,Re.y)&&(Jn=Math.abs(gt-Re.y)/(it-Re.x),ne(Re,Ee)&&(Jn<zn||Jn===zn&&(Re.x>qt.x||Re.x===qt.x&&Mt(qt,Re)))&&(qt=Re,zn=Jn)),Re=Re.next}while(Re!==Cn);return qt}(Ee,dt);if(!Re)return dt;var it=Ue(Re,Ee);return be(it,it.next),be(Re,Re.next)}function Mt(Ee,dt){return ge(Ee.prev,Ee,dt.prev)<0&&ge(dt.next,Ee,Ee.next)<0}function pn(Ee,dt,Re,it,gt){return(Ee=1431655765&((Ee=858993459&((Ee=252645135&((Ee=16711935&((Ee=(Ee-Re)*gt|0)|Ee<<8))|Ee<<4))|Ee<<2))|Ee<<1))|(dt=1431655765&((dt=858993459&((dt=252645135&((dt=16711935&((dt=(dt-it)*gt|0)|dt<<8))|dt<<4))|dt<<2))|dt<<1))<<1}function he(Ee){var dt=Ee,Re=Ee;do{(dt.x<Re.x||dt.x===Re.x&&dt.y<Re.y)&&(Re=dt),dt=dt.next}while(dt!==Ee);return Re}function De(Ee,dt,Re,it,gt,Ie,qt,Ct){return(gt-qt)*(dt-Ct)>=(Ee-qt)*(Ie-Ct)&&(Ee-qt)*(it-Ct)>=(Re-qt)*(dt-Ct)&&(Re-qt)*(Ie-Ct)>=(gt-qt)*(it-Ct)}function ce(Ee,dt){return Ee.next.i!==dt.i&&Ee.prev.i!==dt.i&&!function Ae(Ee,dt){var Re=Ee;do{if(Re.i!==Ee.i&&Re.next.i!==Ee.i&&Re.i!==dt.i&&Re.next.i!==dt.i&&ze(Re,Re.next,Ee,dt))return!0;Re=Re.next}while(Re!==Ee);return!1}(Ee,dt)&&(ne(Ee,dt)&&ne(dt,Ee)&&function ot(Ee,dt){var Re=Ee,it=!1,gt=(Ee.x+dt.x)/2,Ie=(Ee.y+dt.y)/2;do{Re.y>Ie!=Re.next.y>Ie&&Re.next.y!==Re.y&&gt<(Re.next.x-Re.x)*(Ie-Re.y)/(Re.next.y-Re.y)+Re.x&&(it=!it),Re=Re.next}while(Re!==Ee);return it}(Ee,dt)&&(ge(Ee.prev,Ee,dt.prev)||ge(Ee,dt.prev,dt))||ue(Ee,dt)&&ge(Ee.prev,Ee,Ee.next)>0&&ge(dt.prev,dt,dt.next)>0)}function ge(Ee,dt,Re){return(dt.y-Ee.y)*(Re.x-dt.x)-(dt.x-Ee.x)*(Re.y-dt.y)}function ue(Ee,dt){return Ee.x===dt.x&&Ee.y===dt.y}function ze(Ee,dt,Re,it){var gt=re(ge(Ee,dt,Re)),Ie=re(ge(Ee,dt,it)),qt=re(ge(Re,it,Ee)),Ct=re(ge(Re,it,dt));return!!(gt!==Ie&&qt!==Ct||0===gt&&de(Ee,Re,dt)||0===Ie&&de(Ee,it,dt)||0===qt&&de(Re,Ee,it)||0===Ct&&de(Re,dt,it))}function de(Ee,dt,Re){return dt.x<=Math.max(Ee.x,Re.x)&&dt.x>=Math.min(Ee.x,Re.x)&&dt.y<=Math.max(Ee.y,Re.y)&&dt.y>=Math.min(Ee.y,Re.y)}function re(Ee){return Ee>0?1:Ee<0?-1:0}function ne(Ee,dt){return ge(Ee.prev,Ee,Ee.next)<0?ge(Ee,dt,Ee.next)>=0&&ge(Ee,Ee.prev,dt)>=0:ge(Ee,dt,Ee.prev)<0||ge(Ee,Ee.next,dt)<0}function Ue(Ee,dt){var Re=new on(Ee.i,Ee.x,Ee.y),it=new on(dt.i,dt.x,dt.y),gt=Ee.next,Ie=dt.prev;return Ee.next=dt,dt.prev=Ee,Re.next=gt,gt.prev=Re,it.next=Re,Re.prev=it,Ie.next=it,it.prev=Ie,it}function Ke(Ee,dt,Re,it){var gt=new on(Ee,dt,Re);return it?(gt.next=it.next,gt.prev=it,it.next.prev=gt,it.next=gt):(gt.prev=gt,gt.next=gt),gt}function Me(Ee){Ee.next.prev=Ee.prev,Ee.prev.next=Ee.next,Ee.prevZ&&(Ee.prevZ.nextZ=Ee.nextZ),Ee.nextZ&&(Ee.nextZ.prevZ=Ee.prevZ)}function on(Ee,dt,Re){this.i=Ee,this.x=dt,this.y=Re,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lt(Ee,dt,Re,it){for(var gt=0,Ie=dt,qt=Re-it;Ie<Re;Ie+=it)gt+=(Ee[qt]-Ee[Ie])*(Ee[Ie+1]+Ee[qt+1]),qt=Ie;return gt}un.exports=vt,un.exports.default=vt,vt.deviation=function(Ee,dt,Re,it){var gt=dt&&dt.length,qt=Math.abs(Lt(Ee,0,gt?dt[0]*Re:Ee.length,Re));if(gt)for(var Ct=0,Cn=dt.length;Ct<Cn;Ct++)qt-=Math.abs(Lt(Ee,dt[Ct]*Re,Ct<Cn-1?dt[Ct+1]*Re:Ee.length,Re));var zn=0;for(Ct=0;Ct<it.length;Ct+=3){var Jn=it[Ct]*Re,Kt=it[Ct+1]*Re,Qn=it[Ct+2]*Re;zn+=Math.abs((Ee[Jn]-Ee[Qn])*(Ee[Kt+1]-Ee[Jn+1])-(Ee[Jn]-Ee[Kt])*(Ee[Qn+1]-Ee[Jn+1]))}return 0===qt&&0===zn?0:Math.abs((zn-qt)/qt)},vt.flatten=function(Ee){for(var dt=Ee[0][0].length,Re={vertices:[],holes:[],dimensions:dt},it=0,gt=0;gt<Ee.length;gt++){for(var Ie=0;Ie<Ee[gt].length;Ie++)for(var qt=0;qt<dt;qt++)Re.vertices.push(Ee[gt][Ie][qt]);gt>0&&Re.holes.push(it+=Ee[gt-1].length)}return Re}},238:un=>{"use strict";var Ve=Object.prototype.toString,be=Math.max,at=function(ct,tt){for(var mt=[],Xt=0;Xt<ct.length;Xt+=1)mt[Xt]=ct[Xt];for(var Mt=0;Mt<tt.length;Mt+=1)mt[Mt+ct.length]=tt[Mt];return mt};un.exports=function(ct){var tt=this;if("function"!=typeof tt||"[object Function]"!==Ve.apply(tt))throw new TypeError("Function.prototype.bind called on incompatible "+tt);for(var Xt,mt=function(ct,tt){for(var mt=[],Xt=1,Mt=0;Xt<ct.length;Xt+=1,Mt+=1)mt[Mt]=ct[Xt];return mt}(arguments),yt=be(0,tt.length-mt.length),Rt=[],pn=0;pn<yt;pn++)Rt[pn]="$"+pn;if(Xt=Function("binder","return function ("+function(He,ct){for(var tt="",mt=0;mt<He.length;mt+=1)tt+=He[mt],mt+1<He.length&&(tt+=",");return tt}(Rt)+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof Xt){var De=tt.apply(this,at(mt,arguments));return Object(De)===De?De:this}return tt.apply(ct,at(mt,arguments))}),tt.prototype){var he=function(){};he.prototype=tt.prototype,Xt.prototype=new he,he.prototype=null}return Xt}},5333:(un,vt,Ve)=>{"use strict";var be=Ve(238);un.exports=Function.prototype.bind||be},1552:un=>{"use strict";var vt=function(){return"string"==typeof function(){}.name},Ve=Object.getOwnPropertyDescriptor;if(Ve)try{Ve([],"length")}catch{Ve=null}vt.functionsHaveConfigurableNames=function(){if(!vt()||!Ve)return!1;var at=Ve(function(){},"name");return!!at&&!!at.configurable};var be=Function.prototype.bind;vt.boundFunctionsHaveNames=function(){return vt()&&"function"==typeof be&&""!==function(){}.bind().name},un.exports=vt},3198:(un,vt,Ve)=>{var be=Ve(3970),Fe=function(He){this.precision=He&&He.precision?He.precision:17,this.direction=!(!He||!He.direction)&&He.direction,this.pseudoNode=!(!He||!He.pseudoNode)&&He.pseudoNode,this.objectComparator=He&&He.objectComparator?He.objectComparator:xe};function at(He){return He.coordinates.map(function(ct){return{type:He.type.replace("Multi",""),coordinates:ct}})}function m(He,ct){return He.hasOwnProperty("coordinates")?He.coordinates.length===ct.coordinates.length:He.length===ct.length}function xe(He,ct){return be(He,ct,{strict:!0})}Fe.prototype.compare=function(He,ct){if(He.type!==ct.type||!m(He,ct))return!1;switch(He.type){case"Point":return this.compareCoord(He.coordinates,ct.coordinates);case"LineString":return this.compareLine(He.coordinates,ct.coordinates,0,!1);case"Polygon":return this.comparePolygon(He,ct);case"Feature":return this.compareFeature(He,ct);default:if(0===He.type.indexOf("Multi")){var tt=this,mt=at(He),Xt=at(ct);return mt.every(function(Mt){return this.some(function(yt){return tt.compare(Mt,yt)})},Xt)}}return!1},Fe.prototype.compareCoord=function(He,ct){if(He.length!==ct.length)return!1;for(var tt=0;tt<He.length;tt++)if(He[tt].toFixed(this.precision)!==ct[tt].toFixed(this.precision))return!1;return!0},Fe.prototype.compareLine=function(He,ct,tt,mt){if(!m(He,ct))return!1;var Xt=this.pseudoNode?He:this.removePseudo(He),Mt=this.pseudoNode?ct:this.removePseudo(ct);if(!mt||this.compareCoord(Xt[0],Mt[0])||(Mt=this.fixStartIndex(Mt,Xt))){var yt=this.compareCoord(Xt[tt],Mt[tt]);return this.direction||yt?this.comparePath(Xt,Mt):!!this.compareCoord(Xt[tt],Mt[Mt.length-(1+tt)])&&this.comparePath(Xt.slice().reverse(),Mt)}},Fe.prototype.fixStartIndex=function(He,ct){for(var tt,mt=-1,Xt=0;Xt<He.length;Xt++)if(this.compareCoord(He[Xt],ct[0])){mt=Xt;break}return mt>=0&&(tt=[].concat(He.slice(mt,He.length),He.slice(1,mt+1))),tt},Fe.prototype.comparePath=function(He,ct){var tt=this;return He.every(function(mt,Xt){return tt.compareCoord(mt,this[Xt])},ct)},Fe.prototype.comparePolygon=function(He,ct){if(this.compareLine(He.coordinates[0],ct.coordinates[0],1,!0)){var tt=He.coordinates.slice(1,He.coordinates.length),mt=ct.coordinates.slice(1,ct.coordinates.length),Xt=this;return tt.every(function(Mt){return this.some(function(yt){return Xt.compareLine(Mt,yt,1,!0)})},mt)}return!1},Fe.prototype.compareFeature=function(He,ct){return!(He.id!==ct.id||!this.objectComparator(He.properties,ct.properties)||!this.compareBBox(He,ct))&&this.compare(He.geometry,ct.geometry)},Fe.prototype.compareBBox=function(He,ct){return!!(!He.bbox&&!ct.bbox||He.bbox&&ct.bbox&&this.compareCoord(He.bbox,ct.bbox))},Fe.prototype.removePseudo=function(He){return He},un.exports=Fe},5665:(un,vt,Ve)=>{var be=Ve(7571),Fe=Ve(621),at=Ve(8570),m=Ve(1568).Z,xe=at.featureEach,tt=Fe.featureCollection;function mt(Xt){var Mt=new be(Xt);return Mt.insert=function(yt){if("Feature"!==yt.type)throw new Error("invalid feature");return yt.bbox=yt.bbox?yt.bbox:m(yt),be.prototype.insert.call(this,yt)},Mt.load=function(yt){var Rt=[];return Array.isArray(yt)?yt.forEach(function(pn){if("Feature"!==pn.type)throw new Error("invalid features");pn.bbox=pn.bbox?pn.bbox:m(pn),Rt.push(pn)}):xe(yt,function(pn){if("Feature"!==pn.type)throw new Error("invalid features");pn.bbox=pn.bbox?pn.bbox:m(pn),Rt.push(pn)}),be.prototype.load.call(this,Rt)},Mt.remove=function(yt,Rt){if("Feature"!==yt.type)throw new Error("invalid feature");return yt.bbox=yt.bbox?yt.bbox:m(yt),be.prototype.remove.call(this,yt,Rt)},Mt.clear=function(){return be.prototype.clear.call(this)},Mt.search=function(yt){var Rt=be.prototype.search.call(this,this.toBBox(yt));return tt(Rt)},Mt.collides=function(yt){return be.prototype.collides.call(this,this.toBBox(yt))},Mt.all=function(){var yt=be.prototype.all.call(this);return tt(yt)},Mt.toJSON=function(){return be.prototype.toJSON.call(this)},Mt.fromJSON=function(yt){return be.prototype.fromJSON.call(this,yt)},Mt.toBBox=function(yt){var Rt;if(yt.bbox)Rt=yt.bbox;else if(Array.isArray(yt)&&4===yt.length)Rt=yt;else if(Array.isArray(yt)&&6===yt.length)Rt=[yt[0],yt[1],yt[3],yt[4]];else if("Feature"===yt.type)Rt=m(yt);else{if("FeatureCollection"!==yt.type)throw new Error("invalid geojson");Rt=m(yt)}return{minX:Rt[0],minY:Rt[1],maxX:Rt[2],maxY:Rt[3]}},Mt}un.exports=mt,un.exports.default=mt},7571:function(un){un.exports=function(){"use strict";function vt(he,De,ce,ge,ue){!function ze(de,re,Ae,ne,ot){for(;ne>Ae;){if(ne-Ae>600){var Ue=ne-Ae+1,Ke=re-Ae+1,Me=Math.log(Ue),on=.5*Math.exp(2*Me/3),Lt=.5*Math.sqrt(Me*on*(Ue-on)/Ue)*(Ke-Ue/2<0?-1:1);ze(de,re,Math.max(Ae,Math.floor(re-Ke*on/Ue+Lt)),Math.min(ne,Math.floor(re+(Ue-Ke)*on/Ue+Lt)),ot)}var Re=de[re],it=Ae,gt=ne;for(Ve(de,Ae,re),ot(de[ne],Re)>0&&Ve(de,Ae,ne);it<gt;){for(Ve(de,it,gt),it++,gt--;ot(de[it],Re)<0;)it++;for(;ot(de[gt],Re)>0;)gt--}0===ot(de[Ae],Re)?Ve(de,Ae,gt):Ve(de,++gt,ne),gt<=re&&(Ae=gt+1),re<=gt&&(ne=gt-1)}}(he,De,ce||0,ge||he.length-1,ue||be)}function Ve(he,De,ce){var ge=he[De];he[De]=he[ce],he[ce]=ge}function be(he,De){return he<De?-1:he>De?1:0}var Fe=function(he){void 0===he&&(he=9),this._maxEntries=Math.max(4,he),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function at(he,De,ce){if(!ce)return De.indexOf(he);for(var ge=0;ge<De.length;ge++)if(ce(he,De[ge]))return ge;return-1}function m(he,De){xe(he,0,he.children.length,De,he)}function xe(he,De,ce,ge,ue){ue||(ue=Rt(null)),ue.minX=1/0,ue.minY=1/0,ue.maxX=-1/0,ue.maxY=-1/0;for(var ze=De;ze<ce;ze++){var de=he.children[ze];He(ue,he.leaf?ge(de):de)}return ue}function He(he,De){return he.minX=Math.min(he.minX,De.minX),he.minY=Math.min(he.minY,De.minY),he.maxX=Math.max(he.maxX,De.maxX),he.maxY=Math.max(he.maxY,De.maxY),he}function ct(he,De){return he.minX-De.minX}function tt(he,De){return he.minY-De.minY}function mt(he){return(he.maxX-he.minX)*(he.maxY-he.minY)}function Xt(he){return he.maxX-he.minX+(he.maxY-he.minY)}function Mt(he,De){return he.minX<=De.minX&&he.minY<=De.minY&&De.maxX<=he.maxX&&De.maxY<=he.maxY}function yt(he,De){return De.minX<=he.maxX&&De.minY<=he.maxY&&De.maxX>=he.minX&&De.maxY>=he.minY}function Rt(he){return{children:he,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function pn(he,De,ce,ge,ue){for(var ze=[De,ce];ze.length;)if(!((ce=ze.pop())-(De=ze.pop())<=ge)){var de=De+Math.ceil((ce-De)/ge/2)*ge;vt(he,de,De,ce,ue),ze.push(De,de,de,ce)}}return Fe.prototype.all=function(){return this._all(this.data,[])},Fe.prototype.search=function(he){var De=this.data,ce=[];if(!yt(he,De))return ce;for(var ge=this.toBBox,ue=[];De;){for(var ze=0;ze<De.children.length;ze++){var de=De.children[ze],re=De.leaf?ge(de):de;yt(he,re)&&(De.leaf?ce.push(de):Mt(he,re)?this._all(de,ce):ue.push(de))}De=ue.pop()}return ce},Fe.prototype.collides=function(he){var De=this.data;if(!yt(he,De))return!1;for(var ce=[];De;){for(var ge=0;ge<De.children.length;ge++){var ue=De.children[ge],ze=De.leaf?this.toBBox(ue):ue;if(yt(he,ze)){if(De.leaf||Mt(he,ze))return!0;ce.push(ue)}}De=ce.pop()}return!1},Fe.prototype.load=function(he){if(!he||!he.length)return this;if(he.length<this._minEntries){for(var De=0;De<he.length;De++)this.insert(he[De]);return this}var ce=this._build(he.slice(),0,he.length-1,0);if(this.data.children.length)if(this.data.height===ce.height)this._splitRoot(this.data,ce);else{if(this.data.height<ce.height){var ge=this.data;this.data=ce,ce=ge}this._insert(ce,this.data.height-ce.height-1,!0)}else this.data=ce;return this},Fe.prototype.insert=function(he){return he&&this._insert(he,this.data.height-1),this},Fe.prototype.clear=function(){return this.data=Rt([]),this},Fe.prototype.remove=function(he,De){if(!he)return this;for(var ce,ge,ue,ze=this.data,de=this.toBBox(he),re=[],Ae=[];ze||re.length;){if(ze||(ze=re.pop(),ge=re[re.length-1],ce=Ae.pop(),ue=!0),ze.leaf){var ne=at(he,ze.children,De);if(-1!==ne)return ze.children.splice(ne,1),re.push(ze),this._condense(re),this}ue||ze.leaf||!Mt(ze,de)?ge?(ce++,ze=ge.children[ce],ue=!1):ze=null:(re.push(ze),Ae.push(ce),ce=0,ge=ze,ze=ze.children[0])}return this},Fe.prototype.toBBox=function(he){return he},Fe.prototype.compareMinX=function(he,De){return he.minX-De.minX},Fe.prototype.compareMinY=function(he,De){return he.minY-De.minY},Fe.prototype.toJSON=function(){return this.data},Fe.prototype.fromJSON=function(he){return this.data=he,this},Fe.prototype._all=function(he,De){for(var ce=[];he;)he.leaf?De.push.apply(De,he.children):ce.push.apply(ce,he.children),he=ce.pop();return De},Fe.prototype._build=function(he,De,ce,ge){var ue,ze=ce-De+1,de=this._maxEntries;if(ze<=de)return m(ue=Rt(he.slice(De,ce+1)),this.toBBox),ue;ge||(ge=Math.ceil(Math.log(ze)/Math.log(de)),de=Math.ceil(ze/Math.pow(de,ge-1))),(ue=Rt([])).leaf=!1,ue.height=ge;var re=Math.ceil(ze/de),Ae=re*Math.ceil(Math.sqrt(de));pn(he,De,ce,Ae,this.compareMinX);for(var ne=De;ne<=ce;ne+=Ae){var ot=Math.min(ne+Ae-1,ce);pn(he,ne,ot,re,this.compareMinY);for(var Ue=ne;Ue<=ot;Ue+=re){var Ke=Math.min(Ue+re-1,ot);ue.children.push(this._build(he,Ue,Ke,ge-1))}}return m(ue,this.toBBox),ue},Fe.prototype._chooseSubtree=function(he,De,ce,ge){for(;ge.push(De),!De.leaf&&ge.length-1!==ce;){for(var ue=1/0,ze=1/0,de=void 0,re=0;re<De.children.length;re++){var Ae=De.children[re],ne=mt(Ae),ot=(Ue=he,Ke=Ae,(Math.max(Ke.maxX,Ue.maxX)-Math.min(Ke.minX,Ue.minX))*(Math.max(Ke.maxY,Ue.maxY)-Math.min(Ke.minY,Ue.minY))-ne);ot<ze?(ze=ot,ue=ne<ue?ne:ue,de=Ae):ot===ze&&ne<ue&&(ue=ne,de=Ae)}De=de||De.children[0]}var Ue,Ke;return De},Fe.prototype._insert=function(he,De,ce){var ge=ce?he:this.toBBox(he),ue=[],ze=this._chooseSubtree(ge,this.data,De,ue);for(ze.children.push(he),He(ze,ge);De>=0&&ue[De].children.length>this._maxEntries;)this._split(ue,De),De--;this._adjustParentBBoxes(ge,ue,De)},Fe.prototype._split=function(he,De){var ce=he[De],ge=ce.children.length,ue=this._minEntries;this._chooseSplitAxis(ce,ue,ge);var ze=this._chooseSplitIndex(ce,ue,ge),de=Rt(ce.children.splice(ze,ce.children.length-ze));de.height=ce.height,de.leaf=ce.leaf,m(ce,this.toBBox),m(de,this.toBBox),De?he[De-1].children.push(de):this._splitRoot(ce,de)},Fe.prototype._splitRoot=function(he,De){this.data=Rt([he,De]),this.data.height=he.height+1,this.data.leaf=!1,m(this.data,this.toBBox)},Fe.prototype._chooseSplitIndex=function(he,De,ce){for(var ge,ue,ze,de,re,Ae,ne,ot=1/0,Ue=1/0,Ke=De;Ke<=ce-De;Ke++){var Me=xe(he,0,Ke,this.toBBox),on=xe(he,Ke,ce,this.toBBox),Lt=(ue=Me,ze=on,void 0,void 0,void 0,void 0,de=Math.max(ue.minX,ze.minX),re=Math.max(ue.minY,ze.minY),Ae=Math.min(ue.maxX,ze.maxX),ne=Math.min(ue.maxY,ze.maxY),Math.max(0,Ae-de)*Math.max(0,ne-re)),Ee=mt(Me)+mt(on);Lt<ot?(ot=Lt,ge=Ke,Ue=Ee<Ue?Ee:Ue):Lt===ot&&Ee<Ue&&(Ue=Ee,ge=Ke)}return ge||ce-De},Fe.prototype._chooseSplitAxis=function(he,De,ce){var ge=he.leaf?this.compareMinX:ct,ue=he.leaf?this.compareMinY:tt;this._allDistMargin(he,De,ce,ge)<this._allDistMargin(he,De,ce,ue)&&he.children.sort(ge)},Fe.prototype._allDistMargin=function(he,De,ce,ge){he.children.sort(ge);for(var ue=this.toBBox,ze=xe(he,0,De,ue),de=xe(he,ce-De,ce,ue),re=Xt(ze)+Xt(de),Ae=De;Ae<ce-De;Ae++){var ne=he.children[Ae];He(ze,he.leaf?ue(ne):ne),re+=Xt(ze)}for(var ot=ce-De-1;ot>=De;ot--){var Ue=he.children[ot];He(de,he.leaf?ue(Ue):Ue),re+=Xt(de)}return re},Fe.prototype._adjustParentBBoxes=function(he,De,ce){for(var ge=ce;ge>=0;ge--)He(De[ge],he)},Fe.prototype._condense=function(he){for(var De=he.length-1,ce=void 0;De>=0;De--)0===he[De].children.length?De>0?(ce=he[De-1].children).splice(ce.indexOf(he[De]),1):this.clear():m(he[De],this.toBBox)},Fe}()},491:(un,vt,Ve)=>{"use strict";var be,Fe=SyntaxError,at=Function,m=TypeError,xe=function(on){try{return at('"use strict"; return ('+on+").constructor;")()}catch{}},He=Object.getOwnPropertyDescriptor;if(He)try{He({},"")}catch{He=null}var ct=function(){throw new m},tt=He?function(){try{return ct}catch{try{return He(arguments,"callee").get}catch{return ct}}}():ct,mt=Ve(6152)(),Xt=Ve(9028)(),Mt=Object.getPrototypeOf||(Xt?function(on){return on.__proto__}:null),yt={},Rt=typeof Uint8Array>"u"||!Mt?be:Mt(Uint8Array),pn={"%AggregateError%":typeof AggregateError>"u"?be:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?be:ArrayBuffer,"%ArrayIteratorPrototype%":mt&&Mt?Mt([][Symbol.iterator]()):be,"%AsyncFromSyncIteratorPrototype%":be,"%AsyncFunction%":yt,"%AsyncGenerator%":yt,"%AsyncGeneratorFunction%":yt,"%AsyncIteratorPrototype%":yt,"%Atomics%":typeof Atomics>"u"?be:Atomics,"%BigInt%":typeof BigInt>"u"?be:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?be:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?be:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?be:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?be:Float32Array,"%Float64Array%":typeof Float64Array>"u"?be:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?be:FinalizationRegistry,"%Function%":at,"%GeneratorFunction%":yt,"%Int8Array%":typeof Int8Array>"u"?be:Int8Array,"%Int16Array%":typeof Int16Array>"u"?be:Int16Array,"%Int32Array%":typeof Int32Array>"u"?be:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":mt&&Mt?Mt(Mt([][Symbol.iterator]())):be,"%JSON%":"object"==typeof JSON?JSON:be,"%Map%":typeof Map>"u"?be:Map,"%MapIteratorPrototype%":typeof Map>"u"||!mt||!Mt?be:Mt((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?be:Promise,"%Proxy%":typeof Proxy>"u"?be:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?be:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?be:Set,"%SetIteratorPrototype%":typeof Set>"u"||!mt||!Mt?be:Mt((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?be:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":mt&&Mt?Mt(""[Symbol.iterator]()):be,"%Symbol%":mt?Symbol:be,"%SyntaxError%":Fe,"%ThrowTypeError%":tt,"%TypedArray%":Rt,"%TypeError%":m,"%Uint8Array%":typeof Uint8Array>"u"?be:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?be:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?be:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?be:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?be:WeakMap,"%WeakRef%":typeof WeakRef>"u"?be:WeakRef,"%WeakSet%":typeof WeakSet>"u"?be:WeakSet};if(Mt)try{null.error}catch(on){var he=Mt(Mt(on));pn["%Error.prototype%"]=he}var De=function on(Lt){var Ee;if("%AsyncFunction%"===Lt)Ee=xe("async function () {}");else if("%GeneratorFunction%"===Lt)Ee=xe("function* () {}");else if("%AsyncGeneratorFunction%"===Lt)Ee=xe("async function* () {}");else if("%AsyncGenerator%"===Lt){var dt=on("%AsyncGeneratorFunction%");dt&&(Ee=dt.prototype)}else if("%AsyncIteratorPrototype%"===Lt){var Re=on("%AsyncGenerator%");Re&&Mt&&(Ee=Mt(Re.prototype))}return pn[Lt]=Ee,Ee},ce={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ge=Ve(5333),ue=Ve(836),ze=ge.call(Function.call,Array.prototype.concat),de=ge.call(Function.apply,Array.prototype.splice),re=ge.call(Function.call,String.prototype.replace),Ae=ge.call(Function.call,String.prototype.slice),ne=ge.call(Function.call,RegExp.prototype.exec),ot=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ue=/\\(\\)?/g,Me=function(Lt,Ee){var Re,dt=Lt;if(ue(ce,dt)&&(dt="%"+(Re=ce[dt])[0]+"%"),ue(pn,dt)){var it=pn[dt];if(it===yt&&(it=De(dt)),typeof it>"u"&&!Ee)throw new m("intrinsic "+Lt+" exists, but is not available. Please file an issue!");return{alias:Re,name:dt,value:it}}throw new Fe("intrinsic "+Lt+" does not exist!")};un.exports=function(Lt,Ee){if("string"!=typeof Lt||0===Lt.length)throw new m("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof Ee)throw new m('"allowMissing" argument must be a boolean');if(null===ne(/^%?[^%]*%?$/,Lt))throw new Fe("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var dt=function(Lt){var Ee=Ae(Lt,0,1),dt=Ae(Lt,-1);if("%"===Ee&&"%"!==dt)throw new Fe("invalid intrinsic syntax, expected closing `%`");if("%"===dt&&"%"!==Ee)throw new Fe("invalid intrinsic syntax, expected opening `%`");var Re=[];return re(Lt,ot,function(it,gt,Ie,qt){Re[Re.length]=Ie?re(qt,Ue,"$1"):gt||it}),Re}(Lt),Re=dt.length>0?dt[0]:"",it=Me("%"+Re+"%",Ee),gt=it.name,Ie=it.value,qt=!1,Ct=it.alias;Ct&&(Re=Ct[0],de(dt,ze([0,1],Ct)));for(var Cn=1,Ut=!0;Cn<dt.length;Cn+=1){var Bn=dt[Cn],zn=Ae(Bn,0,1),Jn=Ae(Bn,-1);if(('"'===zn||"'"===zn||"`"===zn||'"'===Jn||"'"===Jn||"`"===Jn)&&zn!==Jn)throw new Fe("property names with quotes must have matching quotes");if(("constructor"===Bn||!Ut)&&(qt=!0),ue(pn,gt="%"+(Re+="."+Bn)+"%"))Ie=pn[gt];else if(null!=Ie){if(!(Bn in Ie)){if(!Ee)throw new m("base intrinsic for "+Lt+" exists, but the property is not available.");return}if(He&&Cn+1>=dt.length){var Kt=He(Ie,Bn);Ie=(Ut=!!Kt)&&"get"in Kt&&!("originalValue"in Kt.get)?Kt.get:Ie[Bn]}else Ut=ue(Ie,Bn),Ie=Ie[Bn];Ut&&!qt&&(pn[gt]=Ie)}}return Ie}},9262:(un,vt,Ve)=>{"use strict";var Fe=Ve(491)("%Object.getOwnPropertyDescriptor%",!0);if(Fe)try{Fe([],"length")}catch{Fe=null}un.exports=Fe},2486:(un,vt,Ve)=>{"use strict";var Fe=Ve(491)("%Object.defineProperty%",!0),at=function(){if(Fe)try{return Fe({},"a",{value:1}),!0}catch{return!1}return!1};at.hasArrayLengthDefineBug=function(){if(!at())return null;try{return 1!==Fe([],"length",{value:1}).length}catch{return!0}},un.exports=at},9028:un=>{"use strict";var vt={foo:{}},Ve=Object;un.exports=function(){return{__proto__:vt}.foo===vt.foo&&!({__proto__:null}instanceof Ve)}},6152:(un,vt,Ve)=>{"use strict";var be=typeof Symbol<"u"&&Symbol,Fe=Ve(5441);un.exports=function(){return"function"==typeof be&&"function"==typeof Symbol&&"symbol"==typeof be("foo")&&"symbol"==typeof Symbol("bar")&&Fe()}},5441:un=>{"use strict";un.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var Ve={},be=Symbol("test"),Fe=Object(be);if("string"==typeof be||"[object Symbol]"!==Object.prototype.toString.call(be)||"[object Symbol]"!==Object.prototype.toString.call(Fe))return!1;for(be in Ve[be]=42,Ve)return!1;if("function"==typeof Object.keys&&0!==Object.keys(Ve).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(Ve).length)return!1;var m=Object.getOwnPropertySymbols(Ve);if(1!==m.length||m[0]!==be||!Object.prototype.propertyIsEnumerable.call(Ve,be))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var xe=Object.getOwnPropertyDescriptor(Ve,be);if(42!==xe.value||!0!==xe.enumerable)return!1}return!0}},8041:(un,vt,Ve)=>{"use strict";var be=Ve(5441);un.exports=function(){return be()&&!!Symbol.toStringTag}},836:(un,vt,Ve)=>{"use strict";var be=Function.prototype.call,Fe=Object.prototype.hasOwnProperty,at=Ve(5333);un.exports=at.call(be,Fe)},8147:(un,vt,Ve)=>{"use strict";var be=Ve(8041)(),at=Ve(1098)("Object.prototype.toString"),m=function(tt){return!(be&&tt&&"object"==typeof tt&&Symbol.toStringTag in tt)&&"[object Arguments]"===at(tt)},xe=function(tt){return!!m(tt)||null!==tt&&"object"==typeof tt&&"number"==typeof tt.length&&tt.length>=0&&"[object Array]"!==at(tt)&&"[object Function]"===at(tt.callee)},He=function(){return m(arguments)}();m.isLegacyArguments=xe,un.exports=He?m:xe},2365:(un,vt,Ve)=>{"use strict";var be=Date.prototype.getDay,at=Object.prototype.toString,xe=Ve(8041)();un.exports=function(ct){return"object"==typeof ct&&null!==ct&&(xe?function(ct){try{return be.call(ct),!0}catch{return!1}}(ct):"[object Date]"===at.call(ct))}},4720:(un,vt,Ve)=>{"use strict";var at,m,xe,He,be=Ve(1098),Fe=Ve(8041)();if(Fe){at=be("Object.prototype.hasOwnProperty"),m=be("RegExp.prototype.exec"),xe={};var ct=function(){throw xe};He={toString:ct,valueOf:ct},"symbol"==typeof Symbol.toPrimitive&&(He[Symbol.toPrimitive]=ct)}var tt=be("Object.prototype.toString"),mt=Object.getOwnPropertyDescriptor;un.exports=Fe?function(yt){if(!yt||"object"!=typeof yt)return!1;var Rt=mt(yt,"lastIndex");if(!Rt||!at(Rt,"value"))return!1;try{m(yt,He)}catch(he){return he===xe}}:function(yt){return!(!yt||"object"!=typeof yt&&"function"!=typeof yt)&&"[object RegExp]"===tt(yt)}},2574:function(un){un.exports=function(){"use strict";var vt,Ve,be;function Fe(m,xe){if(vt)if(Ve){var He="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+vt+")(sharedChunk); ("+Ve+")(sharedChunk); self.onerror = null;",ct={};vt(ct),be=xe(ct),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(be.workerUrl=window.URL.createObjectURL(new Blob([He],{type:"text/javascript"})))}else Ve=xe;else vt=xe}return Fe(0,function(m){var xe=typeof self<"u"?self:{},He="2.15.0";let ct;const tt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==ct){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ct=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{ct=a}}return ct},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!tt.API_URL)return null;try{const a=new URL(tt.API_URL);return"api.mapbox.cn"===a.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===a.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},mt={supported:!1,testSupport:function(a){!yt&&Mt&&(Rt?pn(a):Xt=a)}};let Xt,Mt,yt=!1,Rt=!1;function pn(a){const o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Mt),a.isContextLost())return;mt.supported=!0}catch{}a.deleteTexture(o),yt=!0}xe.document&&(Mt=xe.document.createElement("img"),Mt.onload=function(){Xt&&pn(Xt),Xt=null,Rt=!0},Mt.onerror=function(){yt=!0,Xt=null},Mt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const he="01";function De(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ce=ge;function ge(a,o,c,f){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=c,this.p2y=f}ge.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,o){if(void 0===o&&(o=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,f=0;f<8;f++){var _=this.sampleCurveX(c)-a;if(Math.abs(_)<o)return c;var E=this.sampleCurveDerivativeX(c);if(Math.abs(E)<1e-6)break;c-=_/E}var S=0,T=1;for(c=a,f=0;f<20&&(_=this.sampleCurveX(c),!(Math.abs(_-a)<o));f++)a>_?S=c:T=c,c=.5*(T-S)+S;return c},solve:function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))}};var ue=De(ce),ze=de;function de(a,o){this.x=a,this.y=o}de.prototype={clone:function(){return new de(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,o){return this.clone()._rotateAround(a,o)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var o=a.x-this.x,c=a.y-this.y;return o*o+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,o){return Math.atan2(this.x*o-this.y*a,this.x*a+this.y*o)},_matMult:function(a){var o=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=o,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var o=Math.cos(a),c=Math.sin(a),f=c*this.x+o*this.y;return this.x=o*this.x-c*this.y,this.y=f,this},_rotateAround:function(a,o){var c=Math.cos(a),f=Math.sin(a),_=o.y+f*(this.x-o.x)+c*(this.y-o.y);return this.x=o.x+c*(this.x-o.x)-f*(this.y-o.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},de.convert=function(a){return a instanceof de?a:Array.isArray(a)?new de(a[0],a[1]):a};var re=De(ze);const Ae=Math.PI/180,ne=180/Math.PI;function ot(a){return a*Ae}function Ue(a){return a*ne}const Ke=[[0,0],[1,0],[1,1],[0,1]];function Me(a){if(a<=0)return 0;if(a>=1)return 1;const o=a*a,c=o*a;return 4*(a<.5?c:3*(a-o)+c-.75)}function on(a,o,c,f){const _=new ue(a,o,c,f);return function(E){return _.solve(E)}}const Lt=on(.25,.1,.25,1);function Ee(a,o,c){return Math.min(c,Math.max(o,a))}function dt(a,o,c){return(c=Ee((c-a)/(o-a),0,1))*c*(3-2*c)}function Re(a,o,c){const f=c-o,_=((a-o)%f+f)%f+o;return _===o?c:_}function it(a,o,c){if(!a.length)return c(null,[]);let f=a.length;const _=new Array(a.length);let E=null;a.forEach((S,T)=>{o(S,(O,k)=>{O&&(E=O),_[T]=k,0==--f&&c(E,_)})})}function gt(a){const o=[];for(const c in a)o.push(a[c]);return o}function Ie(a,...o){for(const c of o)for(const f in c)a[f]=c[f];return a}let qt=1;function Ct(){return qt++}function Cn(){return function a(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function Ut(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Bn(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function zn(a,o){a.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function Jn(a,o){return-1!==a.indexOf(o,a.length-o.length)}function Kt(a,o,c){const f={};for(const _ in a)f[_]=o.call(c||this,a[_],_,a);return f}function Qn(a,o,c){const f={};for(const _ in a)o.call(c||this,a[_],_,a)&&(f[_]=a[_]);return f}function mn(a){return Array.isArray(a)?a.map(mn):"object"==typeof a&&a?Kt(a,mn):a}const Mr={};function Ii(a){Mr[a]||(typeof console<"u"&&console.warn(a),Mr[a]=!0)}function vr(a,o,c){return(c.y-a.y)*(o.x-a.x)>(o.y-a.y)*(c.x-a.x)}function mi(a){let o=0;for(let c,f,_=0,E=a.length,S=E-1;_<E;S=_++)c=a[_],f=a[S],o+=(f.x-c.x)*(c.y+f.y);return o}function wi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function _t(a){const o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,f,_,E)=>{const S=_||E;return o[f]=!S||S.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o}let we=null;function fe(a){if(null==we){const o=a.navigator?a.navigator.userAgent:null;we=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return we}function le(a){try{const o=xe[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function $e(a,o){return[a[4*o],a[4*o+1],a[4*o+2],a[4*o+3]]}const pt="mapbox-tiles";let cn,Wt,Gt=500,fn=50;function Mi(){try{return xe.caches}catch{}}function Ni(){Mi()&&!cn&&(cn=xe.caches.open(pt))}function Nn(a){const o=a.indexOf("?");if(o<0)return a;const f=function(_){const E=_.indexOf("?");return E>0?_.slice(E+1).split("&"):[]}(a).filter(_=>{const E=_.split("=");return"language"===E[0]||"worldview"===E[0]});return f.length?`${a.slice(0,o)}?${f.join("&")}`:a.slice(0,o)}let Ci=1/0;const Nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Nr);class nr extends Error{constructor(o,c,f){401===c&&Tt(f)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=c,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const cr=wi()?()=>self.worker&&self.worker.referrer:()=>("blob:"===xe.location.protocol?xe.parent:xe).location.href,po=function(a,o){if(!(/^file:/.test(c=a.url)||/^file:/.test(cr())&&!/^\w+:/.test(c))){if(xe.fetch&&xe.Request&&xe.AbortController&&xe.Request.prototype.hasOwnProperty("signal"))return function(f,_){const E=new xe.AbortController,S=new xe.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:cr(),referrerPolicy:f.referrerPolicy,signal:E.signal});let T=!1,O=!1;const k=(V=S.url).indexOf("sku=")>0&&Tt(V);var V;"json"===f.type&&S.headers.set("Accept","application/json");const j=(W,K,te)=>{if(O)return;if(W&&"SecurityError"!==W.message&&Ii(W.toString()),K&&te)return $(K);const ve=Date.now();xe.fetch(S).then(Be=>{if(Be.ok){const Je=k?Be.clone():null;return $(Be,Je,ve)}return _(new nr(Be.statusText,Be.status,f.url))}).catch(Be=>{"AbortError"!==Be.name&&_(new Error(`${Be.message} ${f.url}`))})},$=(W,K,te)=>{("arrayBuffer"===f.type?W.arrayBuffer():"json"===f.type?W.json():W.text()).then(ve=>{O||(K&&te&&function(Be,Je,Ne){if(Ni(),!cn)return;const Ze={status:Je.status,statusText:Je.statusText,headers:new xe.Headers};Je.headers.forEach((Vt,At)=>Ze.headers.set(At,Vt));const rt=_t(Je.headers.get("Cache-Control")||"");if(rt["no-store"])return;rt["max-age"]&&Ze.headers.set("Expires",new Date(Ne+1e3*rt["max-age"]).toUTCString());const st=Ze.headers.get("Expires");st&&(new Date(st).getTime()-Ne<42e4||function(Vt,At){if(void 0===Wt)try{new Response(new ReadableStream),Wt=!0}catch{Wt=!1}Wt?At(Vt.body):Vt.blob().then(At)}(Je,Vt=>{const At=new xe.Response(Vt,Ze);Ni(),cn&&cn.then(en=>en.put(Nn(Be.url),At)).catch(en=>Ii(en.message))}))}(S,K,te),T=!0,_(null,ve,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(ve=>{O||_(new Error(ve.message))})};return k?function(W,K){if(Ni(),!cn)return K(null);const te=Nn(W.url);cn.then(ve=>{ve.match(te).then(Be=>{const Je=function(Ne){if(!Ne)return!1;const Ze=new Date(Ne.headers.get("Expires")||0),rt=_t(Ne.headers.get("Cache-Control")||"");return Ze>Date.now()&&!rt["no-cache"]}(Be);ve.delete(te),Je&&ve.put(te,Be.clone()),K(null,Be,Je)}).catch(K)}).catch(K)}(S,j):j(null,null),{cancel:()=>{O=!0,T||E.abort()}}}(a,o);if(wi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o,void 0,!0)}var c;return function(f,_){const E=new xe.XMLHttpRequest;E.open(f.method||"GET",f.url,!0),"arrayBuffer"===f.type&&(E.responseType="arraybuffer");for(const S in f.headers)E.setRequestHeader(S,f.headers[S]);return"json"===f.type&&(E.responseType="text",E.setRequestHeader("Accept","application/json")),E.withCredentials="include"===f.credentials,E.onerror=()=>{_(new Error(E.statusText))},E.onload=()=>{if((E.status>=200&&E.status<300||0===E.status)&&null!==E.response){let S=E.response;if("json"===f.type)try{S=JSON.parse(E.response)}catch(T){return _(T)}_(null,S,E.getResponseHeader("Cache-Control"),E.getResponseHeader("Expires"))}else _(new nr(E.statusText,E.status,f.url))},E.send(f.body),{cancel:()=>E.abort()}}(a,o)},Xo=function(a,o){return po(Ie(a,{type:"arrayBuffer"}),o)};function $s(a){const o=xe.document.createElement("a");return o.href=a,o.protocol===xe.document.location.protocol&&o.host===xe.document.location.host}const qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let oe,se;oe=[],se=0;const je=function(a,o){if(mt.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),se>=tt.MAX_PARALLEL_IMAGE_REQUESTS){const E={requestParameters:a,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return oe.push(E),E}se++;let c=!1;const f=()=>{if(!c)for(c=!0,se--;oe.length&&se<tt.MAX_PARALLEL_IMAGE_REQUESTS;){const E=oe.shift(),{requestParameters:S,callback:T,cancelled:O}=E;O||(E.cancel=je(S,T).cancel)}},_=Xo(a,(E,S,T,O)=>{f(),E?o(E):S&&(xe.createImageBitmap?function(k,V){const j=new xe.Blob([new Uint8Array(k)],{type:"image/png"});xe.createImageBitmap(j).then($=>{V(null,$)}).catch($=>{V(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(S,(k,V)=>o(k,V,T,O)):function(k,V){const j=new xe.Image,$=xe.URL;j.onload=()=>{V(null,j),$.revokeObjectURL(j.src),j.onload=null,xe.requestAnimationFrame(()=>{j.src=qe})},j.onerror=()=>V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const W=new xe.Blob([new Uint8Array(k)],{type:"image/png"});j.src=k.byteLength?$.createObjectURL(W):qe}(S,(k,V)=>o(k,V,T,O)))});return{cancel:()=>{_.cancel(),f()}}},et="NO_ACCESS_TOKEN";function ke(a){return 0===a.indexOf("mapbox:")}function Tt(a){return tt.API_URL_REGEX.test(a)}function It(a){return tt.API_CDN_URL_REGEX.test(a)}function Ye(a){return tt.API_STYLE_REGEX.test(a)&&!Nt(a)}function Nt(a){return tt.API_SPRITE_REGEX.test(a)}const _n=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Dn(a){const o=a.match(_n);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function yn(a){const o=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${o}`}const qi="mapbox.eventData";function Yi(a){if(!a)return null;const o=a.split(".");if(!o||3!==o.length)return null;try{return JSON.parse(decodeURIComponent(xe.atob(o[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ji{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const c=Yi(tt.ACCESS_TOKEN);let f="";return f=c&&c.u?xe.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(_,E)=>String.fromCharCode(+("0x"+E)))):tt.ACCESS_TOKEN||"",o?`${qi}.${o}:${f}`:`${qi}:${f}`}fetchEventData(){const o=le("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(o)try{const _=xe.localStorage.getItem(c);_&&(this.eventData=JSON.parse(_));const E=xe.localStorage.getItem(f);E&&(this.anonId=E)}catch{Ii("Unable to read from LocalStorage")}}saveEventData(){const o=le("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(o)try{xe.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&xe.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{Ii("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,c,f,_){if(!tt.EVENTS_URL)return;const E=Dn(tt.EVENTS_URL);E.params.push(`access_token=${_||tt.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(o).toISOString()},T=c?Ie(S,c):S,O={url:yn(E),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};var V;this.pendingRequest=(V=k=>{this.pendingRequest=null,f(k),this.saveEventData(),this.processRequests(_)},po(Ie(O,{method:"POST"}),V))}queueRequest(o,c){this.queue.push(o),this.processRequests(c)}}const Fi=new class extends ji{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,o){tt.EVENTS_URL&&tt.ACCESS_TOKEN&&Array.isArray(a)&&a.some(c=>ke(c)||Tt(c))&&this.queueRequest(Date.now(),o)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Yi(tt.ACCESS_TOKEN),c=o?o.u:tt.ACCESS_TOKEN;let f=c!==this.eventData.tokenU;Bn(this.anonId)||(this.anonId=Cn(),f=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const E=new Date(this.eventData.lastSuccess),S=new Date(_),T=(_-this.eventData.lastSuccess)/864e5;f=f||T>=1||T<-1||E.getDate()!==S.getDate()}else f=!0;f?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:He,skuId:he,"enabled.telemetry":!1,userId:this.anonId},E=>{E||(this.eventData.lastSuccess=_,this.eventData.tokenU=c)},a):this.processRequests()}},or=Fi.postTurnstileEvent.bind(Fi),dr=new class extends ji{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,o,c,f){this.skuToken=o,this.errorCb=f,tt.EVENTS_URL&&(c||tt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},c):this.errorCb(new Error(et)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:c}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),Bn(this.anonId)||(this.anonId=Cn()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:He,skuId:he,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):o&&(this.success[o]=!0)},a))}},zo=dr.postMapLoadEvent.bind(dr),Vi=new class extends ji{constructor(){super("gljs.performance")}postPerformanceEvent(a,o){tt.EVENTS_URL&&(a||tt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:c}=this.queue.shift(),f=function(_){const E=xe.performance.getEntriesByType("resource"),S=xe.performance.getEntriesByType("mark"),T=function($){const W={};if($)for(const K in $)if("other"!==K)for(const te of $[K]){const ve=`${K}ResolveRangeMin`,Be=`${K}ResolveRangeMax`,Je=`${K}RequestCount`,Ne=`${K}RequestCachedCount`;W[ve]=Math.min(W[ve]||1/0,te.startTime),W[Be]=Math.max(W[Be]||-1/0,te.responseEnd);const Ze=rt=>{void 0===W[rt]&&(W[rt]=0),++W[rt]};void 0!==te.transferSize&&0===te.transferSize&&Ze(Ne),Ze(Je)}return W}(function($,W){const K={};if($)for(const te of $){const ve=W(te);void 0===K[ve]&&(K[ve]=[]),K[ve].push(te)}return K}(E,Vd)),O=xe.devicePixelRatio,k=xe.navigator.connection||xe.navigator.mozConnection||xe.navigator.webkitConnection,V={counters:[],metadata:[],attributes:[]},j=($,W,K)=>{null!=K&&$.push({name:W,value:K.toString()})};for(const $ in T)j(V.counters,$,T[$]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(j(V.counters,"interactionRangeMin",_.interactionRange[0]),j(V.counters,"interactionRangeMax",_.interactionRange[1])),S)for(const $ of Object.keys(Ll)){const W=Ll[$],K=S.find(te=>te.name===W);K&&j(V.counters,W,K.startTime)}return j(V.counters,"visibilityHidden",_.visibilityHidden),j(V.attributes,"style",function($){if($)for(const W of $){const K=W.name.split("?")[0];if(Ye(K)){const te=K.split("/").slice(-2);if(2===te.length)return`mapbox://styles/${te[0]}/${te[1]}`}}}(E)),j(V.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),j(V.attributes,"fogEnabled",_.fogEnabled?"true":"false"),j(V.attributes,"projection",_.projection),j(V.attributes,"zoom",_.zoom),j(V.metadata,"devicePixelRatio",O),j(V.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),j(V.metadata,"navigatorUserAgent",xe.navigator.userAgent),j(V.metadata,"screenWidth",xe.screen.width),j(V.metadata,"screenHeight",xe.screen.height),j(V.metadata,"windowWidth",xe.innerWidth),j(V.metadata,"windowHeight",xe.innerHeight),j(V.metadata,"mapWidth",_.width/O),j(V.metadata,"mapHeight",_.height/O),j(V.metadata,"webglRenderer",_.renderer),j(V.metadata,"webglVendor",_.vendor),j(V.metadata,"sdkVersion",He),j(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(c);for(const _ of f.metadata);for(const _ of f.counters);for(const _ of f.attributes);this.postEvent(o,f,()=>{},a)}},mo=Vi.postPerformanceEvent.bind(Vi),ta=new class extends ji{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,o,c,f){if(!tt.API_URL||!tt.SESSION_PATH)return;const _=Dn(tt.API_URL+tt.SESSION_PATH);_.params.push(`sku=${o||""}`),_.params.push(`access_token=${f||tt.ACCESS_TOKEN||""}`);const E={url:yn(_),headers:{"Content-Type":"text/plain"}};var T;this.pendingRequest=(T=S=>{this.pendingRequest=null,c(S),this.saveEventData(),this.processRequests(f)},po(Ie(E,{method:"GET"}),T))}getSessionAPI(a,o,c,f){this.skuToken=o,this.errorCb=f,tt.SESSION_PATH&&tt.API_URL&&(c||tt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},c):this.errorCb(new Error(et)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:c}=this.queue.shift();o&&this.success[o]||this.getSession(c,this.skuToken,f=>{f?this.errorCb(f):o&&(this.success[o]=!0)},a)}},wo=ta.getSessionAPI.bind(ta),go=new Set,Ll={create:"create",load:"load",fullLoad:"fullLoad"},Hs={mark(a){xe.performance.mark(a)},measure(a,o,c){xe.performance.measure(a,o,c)}};function Vd(a){const o=a.name.split("?")[0];return It(o)&&o.includes("mapbox-gl.js")?"javascript":It(o)&&o.includes("mapbox-gl.css")?"css":tt.API_FONTS_REGEX.test(o)?"fontRange":Nt(o)?"sprite":Ye(o)?"style":tt.API_TILEJSON_REGEX.test(o)?"tilejson":"other"}const _i=xe.performance;function kc(a){const o=a?a.url.toString():void 0;return _i.getEntriesByName(o)}let Cr,Yo,Iu,is;const xa={now:()=>void 0!==Iu?Iu:xe.performance.now(),setNow(a){Iu=a},restoreNow(){Iu=void 0},frame(a){const o=xe.requestAnimationFrame(a);return{cancel:()=>xe.cancelAnimationFrame(o)}},getImageData(a,o=0){const{width:c,height:f}=a;is||(is=xe.document.createElement("canvas"));const _=is.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(c>is.width||f>is.height)&&(is.width=c,is.height=f),_.clearRect(-o,-o,c+2*o,f+2*o),_.drawImage(a,0,0,c,f),_.getImageData(-o,-o,c+2*o,f+2*o)},resolveURL:a=>(Cr||(Cr=xe.document.createElement("a")),Cr.href=a,Cr.href),get devicePixelRatio(){return xe.devicePixelRatio},get prefersReducedMotion(){return!!xe.matchMedia&&(null==Yo&&(Yo=xe.matchMedia("(prefers-reduced-motion: reduce)")),Yo.matches)}};function rs(a,o,c){c[a]&&-1!==c[a].indexOf(o)||(c[a]=c[a]||[],c[a].push(o))}function ic(a,o,c){if(c&&c[a]){const f=c[a].indexOf(o);-1!==f&&c[a].splice(f,1)}}class ka{constructor(o,c={}){Ie(this,c),this.type=o}}class da extends ka{constructor(o,c={}){super("error",Ie({error:o},c))}}class ba{on(o,c){return this._listeners=this._listeners||{},rs(o,c,this._listeners),this}off(o,c){return ic(o,c,this._listeners),ic(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},rs(o,c,this._oneTimeListeners),this):new Promise(f=>this.once(o,f))}fire(o,c){"string"==typeof o&&(o=new ka(o,c||{}));const f=o.type;if(this.listens(f)){o.target=this;const _=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of _)T.call(this,o);const E=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of E)ic(f,T,this._oneTimeListeners),T.call(this,o);const S=this._eventedParent;S&&(Ie(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),S.fire(o))}else o instanceof da&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}var Qt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Nl(a,...o){for(const c of o)for(const f in c)a[f]=c[f];return a}function fs(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function qs(a){if(Array.isArray(a))return a.map(qs);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const o={};for(const c in a)o[c]=qs(a[c]);return o}return fs(a)}class Ko extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}var bc=Ko;class Fl{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[f,_]of c)this.bindings[f]=_}concat(o){return new Fl(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var Ws=Fl;const eu={kind:"null"},tn={kind:"number"},Ln={kind:"string"},Ai={kind:"boolean"},La={kind:"color"},gi={kind:"object"},sr={kind:"value"},Bl={kind:"collator"},Ir={kind:"formatted"},na={kind:"resolvedImage"};function br(a,o){return{kind:"array",itemType:a,N:o}}function Io(a){if("array"===a.kind){const o=Io(a.itemType);return"number"==typeof a.N?`array<${o}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${o}>`}return a.kind}const hf=[eu,tn,Ln,Ai,La,Ir,gi,br(sr),na];function nn(a,o){if("error"===o.kind)return null;if("array"===a.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!nn(a.itemType,o.itemType))&&("number"!=typeof a.N||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if("value"===a.kind)for(const c of hf)if(!nn(c,o))return null}return`Expected ${Io(a)} but found ${Io(o)} instead.`}function Bi(a,o){return o.some(c=>c.kind===a.kind)}function Ia(a,o){return o.some(c=>"null"===c?null===a:"array"===c?Array.isArray(a):"object"===c?a&&!Array.isArray(a)&&"object"==typeof a:c===typeof a)}var vl,yh={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ts(a){return(a=Math.round(a))<0?0:a>255?255:a}function Ot(a){return Ts("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function mr(a){return(o="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:o>1?1:o;var o}function oi(a,o,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(o-a)*c*6:2*c<1?o:3*c<2?a+(o-a)*(2/3-c)*6:a}try{vl={}.parseCSSColor=function(a){var o,c=a.replace(/ /g,"").toLowerCase();if(c in yh)return yh[c].slice();if("#"===c[0])return 4===c.length?(o=parseInt(c.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:7===c.length&&(o=parseInt(c.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var f=c.indexOf("("),_=c.indexOf(")");if(-1!==f&&_+1===c.length){var E=c.substr(0,f),S=c.substr(f+1,_-(f+1)).split(","),T=1;switch(E){case"rgba":if(4!==S.length)return null;T=mr(S.pop());case"rgb":return 3!==S.length?null:[Ot(S[0]),Ot(S[1]),Ot(S[2]),T];case"hsla":if(4!==S.length)return null;T=mr(S.pop());case"hsl":if(3!==S.length)return null;var O=(parseFloat(S[0])%360+360)%360/360,k=mr(S[1]),V=mr(S[2]),j=V<=.5?V*(k+1):V+k-V*k,$=2*V-j;return[Ts(255*oi($,j,O+1/3)),Ts(255*oi($,j,O)),Ts(255*oi($,j,O-1/3)),T];default:return null}}return null}}catch{}class ur{constructor(o,c,f,_=1){this.r=o,this.g=c,this.b=f,this.a=_}static parse(o){if(!o)return;if(o instanceof ur)return o;if("string"!=typeof o)return;const c=vl(o);return c?new ur(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[o,c,f,_]=this.toArray();return`rgba(${Math.round(o)},${Math.round(c)},${Math.round(f)},${_})`}toArray(){const{r:o,g:c,b:f,a:_}=this;return 0===_?[0,0,0,0]:[255*o/_,255*c/_,255*f/_,_]}toArray01(){const{r:o,g:c,b:f,a:_}=this;return 0===_?[0,0,0,0]:[o/_,c/_,f/_,_]}toArray01PremultipliedAlpha(){const{r:o,g:c,b:f,a:_}=this;return[o,c,f,_]}}ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1),ur.blue=new ur(0,0,1,1);var Zs=ur;class Wa{constructor(o,c,f){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class pd{constructor(o,c,f,_,E){this.text=o.normalize?o.normalize():o,this.image=c,this.scale=f,this.fontStack=_,this.textColor=E}}class Qo{constructor(o){this.sections=o}static fromString(o){return new Qo([new pd(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof Qo?o:Qo.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const c of this.sections){if(c.image){o.push(["image",c.image.name]);continue}o.push(c.text);const f={};c.fontStack&&(f["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(f["font-scale"]=c.scale),c.textColor&&(f["text-color"]=["rgba"].concat(c.textColor.toArray())),o.push(f)}return o}}class Pi{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Pi({name:o,available:!1}):null}serialize(){return["image",this.name]}}function Ud(a,o,c,f){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===f||"number"==typeof f&&f>=0&&f<=1?null:`Invalid rgba value [${[a,o,c,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof f?[a,o,c,f]:[a,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function As(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof Zs||a instanceof Wa||a instanceof Qo||a instanceof Pi)return!0;if(Array.isArray(a)){for(const o of a)if(!As(o))return!1;return!0}if("object"==typeof a){for(const o in a)if(!As(a[o]))return!1;return!0}return!1}function Cs(a){if(null===a)return eu;if("string"==typeof a)return Ln;if("boolean"==typeof a)return Ai;if("number"==typeof a)return tn;if(a instanceof Zs)return La;if(a instanceof Wa)return Bl;if(a instanceof Qo)return Ir;if(a instanceof Pi)return na;if(Array.isArray(a)){const o=a.length;let c;for(const f of a){const _=Cs(f);if(c){if(c===_)continue;c=sr;break}c=_}return br(c||sr,o)}return gi}function Za(a){const o=typeof a;return null===a?"":"string"===o||"number"===o||"boolean"===o?String(a):a instanceof Zs||a instanceof Qo||a instanceof Pi?a.toString():JSON.stringify(a)}class Vo{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(2!==o.length)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!As(o[1]))return c.error("invalid value");const f=o[1];let _=Cs(f);const E=c.expectedType;return"array"!==_.kind||0!==_.N||!E||"array"!==E.kind||"number"==typeof E.N&&0!==E.N||(_=E),new Vo(_,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Zs?["rgba"].concat(this.value.toArray()):this.value instanceof Qo?this.value.serialize():this.value}}var ia=Vo,ra=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const xl={string:Ln,number:tn,boolean:Ai,object:gi};class rc{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let f,_=1;const E=o[0];if("array"===E){let T,O;if(o.length>2){const k=o[1];if("string"!=typeof k||!(k in xl)||"object"===k)return c.error('The item type argument of "array" must be one of string, number, boolean',1);T=xl[k],_++}else T=sr;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);O=o[2],_++}f=br(T,O)}else f=xl[E];const S=[];for(;_<o.length;_++){const T=c.parse(o[_],_,sr);if(!T)return null;S.push(T)}return new rc(f,S)}evaluate(o){for(let c=0;c<this.args.length;c++){const f=this.args[c].evaluate(o);if(!nn(this.type,Cs(f)))return f;if(c===this.args.length-1)throw new ra(`Expected value to be of type ${Io(this.type)}, but found ${Io(Cs(f))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,c=[o.kind];if("array"===o.kind){const f=o.itemType;if("string"===f.kind||"number"===f.kind||"boolean"===f.kind){c.push(f.kind);const _=o.N;("number"==typeof _||this.args.length>1)&&c.push(_)}}return c.concat(this.args.map(f=>f.serialize()))}}var Xa=rc;class bl{constructor(o){this.type=Ir,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&"object"==typeof f)return c.error("First argument must be an image or text section.");const _=[];let E=!1;for(let S=1;S<=o.length-1;++S){const T=o[S];if(E&&"object"==typeof T&&!Array.isArray(T)){E=!1;let O=null;if(T["font-scale"]&&(O=c.parse(T["font-scale"],1,tn),!O))return null;let k=null;if(T["text-font"]&&(k=c.parse(T["text-font"],1,br(Ln)),!k))return null;let V=null;if(T["text-color"]&&(V=c.parse(T["text-color"],1,La),!V))return null;const j=_[_.length-1];j.scale=O,j.font=k,j.textColor=V}else{const O=c.parse(o[S],1,sr);if(!O)return null;const k=O.type.kind;if("string"!==k&&"value"!==k&&"null"!==k&&"resolvedImage"!==k)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");E=!0,_.push({content:O,scale:null,font:null,textColor:null})}}return new bl(_)}evaluate(o){return new Qo(this.sections.map(c=>{const f=c.content.evaluate(o);return Cs(f)===na?new pd("",f,null,null,null):new pd(Za(f),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const c of this.sections){o.push(c.content.serialize());const f={};c.scale&&(f["font-scale"]=c.scale.serialize()),c.font&&(f["text-font"]=c.font.serialize()),c.textColor&&(f["text-color"]=c.textColor.serialize()),o.push(f)}return o}}class ps{constructor(o){this.type=na,this.input=o}static parse(o,c){if(2!==o.length)return c.error("Expected two arguments.");const f=c.parse(o[1],1,Ln);return f?new ps(f):c.error("No image name provided.")}evaluate(o){const c=this.input.evaluate(o),f=Pi.fromString(c);return f&&o.availableImages&&(f.available=o.availableImages.indexOf(c)>-1),f}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const zl={"to-boolean":Ai,"to-color":La,"to-number":tn,"to-string":Ln};class xi{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const f=o[0];if(("to-boolean"===f||"to-string"===f)&&2!==o.length)return c.error("Expected one argument.");const _=zl[f],E=[];for(let S=1;S<o.length;S++){const T=c.parse(o[S],S,sr);if(!T)return null;E.push(T)}return new xi(_,E)}evaluate(o){if("boolean"===this.type.kind)return!!this.args[0].evaluate(o);if("color"===this.type.kind){let c,f;for(const _ of this.args){if(c=_.evaluate(o),f=null,c instanceof Zs)return c;if("string"==typeof c){const E=o.parseColor(c);if(E)return E}else if(Array.isArray(c)&&(f=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Ud(c[0],c[1],c[2],c[3]),!f))return new Zs(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new ra(f||`Could not parse color from value '${"string"==typeof c?c:String(JSON.stringify(c))}'`)}if("number"===this.type.kind){let c=null;for(const f of this.args){if(c=f.evaluate(o),null===c)return 0;const _=Number(c);if(!isNaN(_))return _}throw new ra(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?Qo.fromString(Za(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Pi.fromString(Za(this.args[0].evaluate(o))):Za(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if("formatted"===this.type.kind)return new bl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ps(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(c=>{o.push(c.serialize())}),o}}var Uo=xi;const ko=["Unknown","Point","LineString","Polygon"];var jd=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ko[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*o-a[0])+this.featureDistanceData.bearing[1]*(f*o-a[1])}return 0}parseColor(a){let o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=Zs.parse(a)),o}};class kn{constructor(o,c,f,_){this.name=o,this.type=c,this._evaluate=f,this.args=_}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,c){const f=o[0],_=kn.definitions[f];if(!_)return c.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const E=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,T=S.filter(([k])=>!Array.isArray(k)||k.length===o.length-1);let O=null;for(const[k,V]of T){O=new Du(c.registry,c.path,null,c.scope);const j=[];let $=!1;for(let W=1;W<o.length;W++){const K=o[W],te=Array.isArray(k)?k[W-1]:k.type,ve=O.parse(K,1+j.length,te);if(!ve){$=!0;break}j.push(ve)}if(!$)if(Array.isArray(k)&&k.length!==j.length)O.error(`Expected ${k.length} arguments, but found ${j.length} instead.`);else{for(let W=0;W<j.length;W++){const K=Array.isArray(k)?k[W]:k.type,te=j[W];O.concat(W+1).checkSubtype(K,te.type)}if(0===O.errors.length)return new kn(f,E,V,j)}}if(1===T.length)c.errors.push(...O.errors);else{const k=(T.length?T:S).map(([j])=>{return $=j,Array.isArray($)?`(${$.map(Io).join(", ")})`:`(${Io($.type)}...)`;var $}).join(" | "),V=[];for(let j=1;j<o.length;j++){const $=c.parse(o[j],1+V.length);if(!$)return null;V.push(Io($.type))}c.error(`Expected arguments of type ${k}, but found (${V.join(", ")}) instead.`)}return null}static register(o,c){kn.definitions=c;for(const f in c)o[f]=kn}}var Vl=kn;class wr{constructor(o,c,f){this.type=Bl,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(2!==o.length)return c.error("Expected one argument.");const f=o[1];if("object"!=typeof f||Array.isArray(f))return c.error("Collator options argument must be an object.");const _=c.parse(void 0!==f["case-sensitive"]&&f["case-sensitive"],1,Ai);if(!_)return null;const E=c.parse(void 0!==f["diacritic-sensitive"]&&f["diacritic-sensitive"],1,Ai);if(!E)return null;let S=null;return f.locale&&(S=c.parse(f.locale,1,Ln),!S)?null:new wr(_,E,S)}evaluate(o){return new Wa(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const Ul=8192;function ha(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function sl(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function Xs(a,o){const c=(180+a[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,_=Math.pow(2,o.z);return[Math.round(c*_*Ul),Math.round(f*_*Ul)]}function wc(a,o,c){const f=a[0]-o[0],_=a[1]-o[1],E=a[0]-c[0],S=a[1]-c[1];return f*S-E*_==0&&f*E<=0&&_*S<=0}function Na(a,o){let c=!1;for(let S=0,T=o.length;S<T;S++){const O=o[S];for(let k=0,V=O.length;k<V-1;k++){if(wc(a,O[k],O[k+1]))return!1;(_=O[k])[1]>(f=a)[1]!=(E=O[k+1])[1]>f[1]&&f[0]<(E[0]-_[0])*(f[1]-_[1])/(E[1]-_[1])+_[0]&&(c=!c)}}var f,_,E;return c}function tu(a,o){for(let c=0;c<o.length;c++)if(Na(a,o[c]))return!0;return!1}function jo(a,o,c,f){const _=f[0]-c[0],E=f[1]-c[1],S=(a[0]-c[0])*E-_*(a[1]-c[1]),T=(o[0]-c[0])*E-_*(o[1]-c[1]);return S>0&&T<0||S<0&&T>0}function ci(a,o,c){for(const k of c)for(let V=0;V<k.length-1;++V)if((T=[(S=k[V+1])[0]-(E=k[V])[0],S[1]-E[1]])[0]*(O=[(_=o)[0]-(f=a)[0],_[1]-f[1]])[1]-T[1]*O[0]!=0&&jo(f,_,E,S)&&jo(E,S,f,_))return!0;var f,_,E,S,T,O;return!1}function si(a,o){for(let c=0;c<a.length;++c)if(!Na(a[c],o))return!1;for(let c=0;c<a.length-1;++c)if(ci(a[c],a[c+1],o))return!1;return!0}function Wu(a,o){for(let c=0;c<o.length;c++)if(si(a,o[c]))return!0;return!1}function wa(a,o,c){const f=[];for(let _=0;_<a.length;_++){const E=[];for(let S=0;S<a[_].length;S++){const T=Xs(a[_][S],c);ha(o,T),E.push(T)}f.push(E)}return f}function os(a,o,c){const f=[];for(let _=0;_<a.length;_++){const E=wa(a[_],o,c);f.push(E)}return f}function Ec(a,o,c,f){if(a[0]<c[0]||a[0]>c[2]){const _=.5*f;let E=a[0]-c[0]>_?-f:c[0]-a[0]>_?f:0;0===E&&(E=a[0]-c[2]>_?-f:c[2]-a[0]>_?f:0),a[0]+=E}ha(o,a)}function Gd(a,o,c,f){const _=Math.pow(2,f.z)*Ul,E=[f.x*Ul,f.y*Ul],S=[];if(!a)return S;for(const T of a)for(const O of T){const k=[O.x+E[0],O.y+E[1]];Ec(k,o,c,_),S.push(k)}return S}function Do(a,o,c,f){const _=Math.pow(2,f.z)*Ul,E=[f.x*Ul,f.y*Ul],S=[];if(!a)return S;for(const O of a){const k=[];for(const V of O){const j=[V.x+E[0],V.y+E[1]];ha(o,j),k.push(j)}S.push(k)}if(o[2]-o[0]<=_/2){(T=o)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const O of S)for(const k of O)Ec(k,o,c,_)}var T;return S}class md{constructor(o,c){this.type=Ai,this.geojson=o,this.geometries=c}static parse(o,c){if(2!==o.length)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(As(o[1])){const f=o[1];if("FeatureCollection"===f.type)for(let _=0;_<f.features.length;++_){const E=f.features[_].geometry.type;if("Polygon"===E||"MultiPolygon"===E)return new md(f,f.features[_].geometry)}else if("Feature"===f.type){const _=f.geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new md(f,f.geometry)}else if("Polygon"===f.type||"MultiPolygon"===f.type)return new md(f,f)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(c,f){const _=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],S=c.canonicalID();if(!S)return!1;if("Polygon"===f.type){const T=wa(f.coordinates,E,S),O=Gd(c.geometry(),_,E,S);if(!sl(_,E))return!1;for(const k of O)if(!Na(k,T))return!1}if("MultiPolygon"===f.type){const T=os(f.coordinates,E,S),O=Gd(c.geometry(),_,E,S);if(!sl(_,E))return!1;for(const k of O)if(!tu(k,T))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(c,f){const _=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],S=c.canonicalID();if(!S)return!1;if("Polygon"===f.type){const T=wa(f.coordinates,E,S),O=Do(c.geometry(),_,E,S);if(!sl(_,E))return!1;for(const k of O)if(!si(k,T))return!1}if("MultiPolygon"===f.type){const T=os(f.coordinates,E,S),O=Do(c.geometry(),_,E,S);if(!sl(_,E))return!1;for(const k of O)if(!Wu(k,T))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Er=md;function Fa(a){if(a instanceof Vl&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Er)return!1;let o=!0;return a.eachChild(c=>{o&&!Fa(c)&&(o=!1)}),o}function Dr(a){if(a instanceof Vl&&"feature-state"===a.name)return!1;let o=!0;return a.eachChild(c=>{o&&!Dr(c)&&(o=!1)}),o}function oc(a,o){if(a instanceof Vl&&o.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild(f=>{c&&!oc(f,o)&&(c=!1)}),c}class fa{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(2!==o.length||"string"!=typeof o[1])return c.error("'var' expression requires exactly one string literal argument.");const f=o[1];return c.scope.has(f)?new fa(f,c.scope.get(f)):c.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var ff=fa;class Ki{constructor(o,c=[],f,_=new Ws,E=[]){this.registry=o,this.path=c,this.key=c.map(S=>`[${S}]`).join(""),this.scope=_,this.errors=E,this.expectedType=f}parse(o,c,f,_,E={}){return c?this.concat(c,f,_)._parse(o,E):this._parse(o,E)}_parse(o,c){function f(_,E,S){return"assert"===S?new Xa(E,[_]):"coerce"===S?new Uo(E,[_]):_}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=o[0];if("string"!=typeof _)return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const E=this.registry[_];if(E){let S=E.parse(o,this);if(!S)return null;if(this.expectedType){const T=this.expectedType,O=S.type;if("string"!==T.kind&&"number"!==T.kind&&"boolean"!==T.kind&&"object"!==T.kind&&"array"!==T.kind||"value"!==O.kind)if("color"!==T.kind&&"formatted"!==T.kind&&"resolvedImage"!==T.kind||"value"!==O.kind&&"string"!==O.kind){if(this.checkSubtype(T,O))return null}else S=f(S,T,c.typeAnnotation||"coerce");else S=f(S,T,c.typeAnnotation||"assert")}if(!(S instanceof ia)&&"resolvedImage"!==S.type.kind&&To(S)){const T=new jd;try{S=new ia(S.type,S.evaluate(T))}catch(O){return this.error(O.message),null}}return S}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,f){const _="number"==typeof o?this.path.concat(o):this.path,E=f?this.scope.concat(f):this.scope;return new Ki(this.registry,_,c||null,E,this.errors)}error(o,...c){const f=`${this.key}${c.map(_=>`[${_}]`).join("")}`;this.errors.push(new bc(f,o))}checkSubtype(o,c){const f=nn(o,c);return f&&this.error(f),f}}var Du=Ki;function To(a){if(a instanceof ff)return To(a.boundExpression);if(a instanceof Vl&&"error"===a.name||a instanceof wr||a instanceof Er)return!1;const o=a instanceof Uo||a instanceof Xa;let c=!0;return a.eachChild(f=>{c=o?c&&To(f):c&&f instanceof ia}),!!c&&Fa(a)&&oc(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Zu(a,o){const c=a.length-1;let f,_,E=0,S=c,T=0;for(;E<=S;)if(T=Math.floor((E+S)/2),f=a[T],_=a[T+1],f<=o){if(T===c||o<_)return T;E=T+1}else{if(!(f>o))throw new ra("Input is not a number.");S=T-1}return 0}class Ea{constructor(o,c,f){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[_,E]of f)this.labels.push(_),this.outputs.push(E)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const f=c.parse(o[1],1,tn);if(!f)return null;const _=[];let E=null;c.expectedType&&"value"!==c.expectedType.kind&&(E=c.expectedType);for(let S=1;S<o.length;S+=2){const T=1===S?-1/0:o[S],O=o[S+1],k=S,V=S+1;if("number"!=typeof T)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(_.length&&_[_.length-1][0]>=T)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const j=c.parse(O,V,E);if(!j)return null;E=E||j.type,_.push([T,j])}return new Ea(E,f,_)}evaluate(o){const c=this.labels,f=this.outputs;if(1===c.length)return f[0].evaluate(o);const _=this.input.evaluate(o);if(_<=c[0])return f[0].evaluate(o);const E=c.length;return _>=c[E-1]?f[E-1].evaluate(o):f[Zu(c,_)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&o.push(this.labels[c]),o.push(this.outputs[c].serialize());return o}}var Tu=Ea;function hr(a,o,c){return a*(1-c)+o*c}var wl=Object.freeze({__proto__:null,array:function(a,o,c){return a.map((f,_)=>hr(f,o[_],c))},color:function(a,o,c){return new Zs(hr(a.r,o.r,c),hr(a.g,o.g,c),hr(a.b,o.b,c),hr(a.a,o.a,c))},number:hr});const Xu=4/29,Ba=6/29,Da=3*Ba*Ba,Ss=Ba*Ba*Ba,dm=Math.PI/180,nu=180/Math.PI;function Cc(a){return a>Ss?Math.pow(a,1/3):a/Da+Xu}function Dt(a){return a>Ba?a*a*a:Da*(a-Xu)}function Sc(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Rn(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ka(a){const o=Rn(a.r),c=Rn(a.g),f=Rn(a.b),_=Cc((.4124564*o+.3575761*c+.1804375*f)/.95047),E=Cc((.2126729*o+.7151522*c+.072175*f)/1);return{l:116*E-16,a:500*(_-E),b:200*(E-Cc((.0193339*o+.119192*c+.9503041*f)/1.08883)),alpha:a.a}}function El(a){let o=(a.l+16)/116,c=isNaN(a.a)?o:o+a.a/500,f=isNaN(a.b)?o:o-a.b/200;return o=1*Dt(o),c=.95047*Dt(c),f=1.08883*Dt(f),new Zs(Sc(3.2404542*c-1.5371385*o-.4985314*f),Sc(-.969266*c+1.8760108*o+.041556*f),Sc(.0556434*c-.2040259*o+1.0572252*f),a.alpha)}function sc(a,o,c){const f=o-a;return a+c*(f>180||f<-180?f-360*Math.round(f/360):f)}const Cl={forward:Ka,reverse:El,interpolate:function(a,o,c){return{l:hr(a.l,o.l,c),a:hr(a.a,o.a,c),b:hr(a.b,o.b,c),alpha:hr(a.alpha,o.alpha,c)}}},ms={forward:function(a){const{l:o,a:c,b:f}=Ka(a),_=Math.atan2(f,c)*nu;return{h:_<0?_+360:_,c:Math.sqrt(c*c+f*f),l:o,alpha:a.a}},reverse:function(a){const o=a.h*dm,c=a.c;return El({l:a.l,a:Math.cos(o)*c,b:Math.sin(o)*c,alpha:a.alpha})},interpolate:function(a,o,c){return{h:sc(a.h,o.h,c),c:hr(a.c,o.c,c),l:hr(a.l,o.l,c),alpha:hr(a.alpha,o.alpha,c)}}};var vh=Object.freeze({__proto__:null,hcl:ms,lab:Cl});class Qa{constructor(o,c,f,_,E){this.type=o,this.operator=c,this.interpolation=f,this.input=_,this.labels=[],this.outputs=[];for(const[S,T]of E)this.labels.push(S),this.outputs.push(T)}static interpolationFactor(o,c,f,_){let E=0;if("exponential"===o.name)E=Ps(c,o.base,f,_);else if("linear"===o.name)E=Ps(c,1,f,_);else if("cubic-bezier"===o.name){const S=o.controlPoints;E=new ue(S[0],S[1],S[2],S[3]).solve(Ps(c,1,f,_))}return E}static parse(o,c){let[f,_,E,...S]=o;if(!Array.isArray(_)||0===_.length)return c.error("Expected an interpolation type expression.",1);if("linear"===_[0])_={name:"linear"};else if("exponential"===_[0]){const k=_[1];if("number"!=typeof k)return c.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:k}}else{if("cubic-bezier"!==_[0])return c.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const k=_.slice(1);if(4!==k.length||k.some(V=>"number"!=typeof V||V<0||V>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:k}}}if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(E=c.parse(E,2,tn),!E)return null;const T=[];let O=null;"interpolate-hcl"===f||"interpolate-lab"===f?O=La:c.expectedType&&"value"!==c.expectedType.kind&&(O=c.expectedType);for(let k=0;k<S.length;k+=2){const V=S[k],j=S[k+1],$=k+3,W=k+4;if("number"!=typeof V)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(T.length&&T[T.length-1][0]>=V)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const K=c.parse(j,W,O);if(!K)return null;O=O||K.type,T.push([V,K])}return"number"===O.kind||"color"===O.kind||"array"===O.kind&&"number"===O.itemType.kind&&"number"==typeof O.N?new Qa(O,f,_,E,T):c.error(`Type ${Io(O)} is not interpolatable.`)}evaluate(o){const c=this.labels,f=this.outputs;if(1===c.length)return f[0].evaluate(o);const _=this.input.evaluate(o);if(_<=c[0])return f[0].evaluate(o);const E=c.length;if(_>=c[E-1])return f[E-1].evaluate(o);const S=Zu(c,_),T=Qa.interpolationFactor(this.interpolation,_,c[S],c[S+1]),O=f[S].evaluate(o),k=f[S+1].evaluate(o);return"interpolate"===this.operator?wl[this.type.kind.toLowerCase()](O,k,T):"interpolate-hcl"===this.operator?ms.reverse(ms.interpolate(ms.forward(O),ms.forward(k),T)):Cl.reverse(Cl.interpolate(Cl.forward(O),Cl.forward(k),T))}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,o,this.input.serialize()];for(let f=0;f<this.labels.length;f++)c.push(this.labels[f],this.outputs[f].serialize());return c}}function Ps(a,o,c,f){const _=f-c,E=a-c;return 0===_?0:1===o?E/_:(Math.pow(o,E)-1)/(Math.pow(o,_)-1)}var Lo=Qa;class Ms{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let f=null;const _=c.expectedType;_&&"value"!==_.kind&&(f=_);const E=[];for(const T of o.slice(1)){const O=c.parse(T,1+E.length,f,void 0,{typeAnnotation:"omit"});if(!O)return null;f=f||O.type,E.push(O)}const S=_&&E.some(T=>nn(_,T.type));return new Ms(S?sr:f,E)}evaluate(o){let c,f=null,_=0;for(const E of this.args){if(_++,f=E.evaluate(o),f&&f instanceof Pi&&!f.available&&(c||(c=f),f=null,_===this.args.length))return c;if(null!==f)break}return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(c=>{o.push(c.serialize())}),o}}var Rr=Ms;class Rs{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let E=1;E<o.length-1;E+=2){const S=o[E];if("string"!=typeof S)return c.error(`Expected string, but found ${typeof S} instead.`,E);if(/[^a-zA-Z0-9_]/.test(S))return c.error("Variable names must contain only alphanumeric characters or '_'.",E);const T=c.parse(o[E+1],E+1);if(!T)return null;f.push([S,T])}const _=c.parse(o[o.length-1],o.length-1,c.expectedType,f);return _?new Rs(f,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[c,f]of this.bindings)o.push(c,f.serialize());return o.push(this.result.serialize()),o}}var $d=Rs;class iu{constructor(o,c,f){this.type=o,this.index=c,this.input=f}static parse(o,c){if(3!==o.length)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,tn),_=c.parse(o[2],2,br(c.expectedType||sr));return f&&_?new iu(_.type.itemType,f,_):null}evaluate(o){const c=this.index.evaluate(o),f=this.input.evaluate(o);if(c<0)throw new ra(`Array index out of bounds: ${c} < 0.`);if(c>=f.length)throw new ra(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c!==Math.floor(c))throw new ra(`Array index must be an integer, but found ${c} instead.`);return f[c]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Yu=iu;class ac{constructor(o,c){this.type=Ai,this.needle=o,this.haystack=c}static parse(o,c){if(3!==o.length)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,sr),_=c.parse(o[2],2,sr);return f&&_?Bi(f.type,[Ai,Ln,tn,eu,sr])?new ac(f,_):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Io(f.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(null==f)return!1;if(!Ia(c,["boolean","string","number","null"]))throw new ra(`Expected first argument to be of type boolean, string, number or null, but found ${Io(Cs(c))} instead.`);if(!Ia(f,["string","array"]))throw new ra(`Expected second argument to be of type array or string, but found ${Io(Cs(f))} instead.`);return f.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var ru=ac;class lc{constructor(o,c,f){this.type=tn,this.needle=o,this.haystack=c,this.fromIndex=f}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,sr),_=c.parse(o[2],2,sr);if(!f||!_)return null;if(!Bi(f.type,[Ai,Ln,tn,eu,sr]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Io(f.type)} instead`);if(4===o.length){const E=c.parse(o[3],3,tn);return E?new lc(f,_,E):null}return new lc(f,_)}evaluate(o){const c=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!Ia(c,["boolean","string","number","null"]))throw new ra(`Expected first argument to be of type boolean, string, number or null, but found ${Io(Cs(c))} instead.`);if(!Ia(f,["string","array"]))throw new ra(`Expected second argument to be of type array or string, but found ${Io(Cs(f))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(o);return f.indexOf(c,_)}return f.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var jl=lc;class Is{constructor(o,c,f,_,E,S){this.inputType=o,this.type=c,this.input=f,this.cases=_,this.outputs=E,this.otherwise=S}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let f,_;c.expectedType&&"value"!==c.expectedType.kind&&(_=c.expectedType);const E={},S=[];for(let k=2;k<o.length-1;k+=2){let V=o[k];const j=o[k+1];Array.isArray(V)||(V=[V]);const $=c.concat(k);if(0===V.length)return $.error("Expected at least one branch label.");for(const K of V){if("number"!=typeof K&&"string"!=typeof K)return $.error("Branch labels must be numbers or strings.");if("number"==typeof K&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof K&&Math.floor(K)!==K)return $.error("Numeric branch labels must be integer values.");if(f){if($.checkSubtype(f,Cs(K)))return null}else f=Cs(K);if(void 0!==E[String(K)])return $.error("Branch labels must be unique.");E[String(K)]=S.length}const W=c.parse(j,k,_);if(!W)return null;_=_||W.type,S.push(W)}const T=c.parse(o[1],1,sr);if(!T)return null;const O=c.parse(o[o.length-1],o.length-1,_);return O?"value"!==T.type.kind&&c.concat(1).checkSubtype(f,T.type)?null:new Is(f,_,T,E,S,O):null}evaluate(o){const c=this.input.evaluate(o);return(Cs(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),f=[],_={};for(const S of c){const T=_[this.cases[S]];void 0===T?(_[this.cases[S]]=f.length,f.push([this.cases[S],[S]])):f[T][1].push(S)}const E=S=>"number"===this.inputType.kind?Number(S):S;for(const[S,T]of f)o.push(1===T.length?E(T[0]):T.map(E)),o.push(this.outputs[S].serialize());return o.push(this.otherwise.serialize()),o}}var Ku=Is;class oa{constructor(o,c,f){this.type=o,this.branches=c,this.otherwise=f}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let f;c.expectedType&&"value"!==c.expectedType.kind&&(f=c.expectedType);const _=[];for(let S=1;S<o.length-1;S+=2){const T=c.parse(o[S],S,Ai);if(!T)return null;const O=c.parse(o[S+1],S+1,f);if(!O)return null;_.push([T,O]),f=f||O.type}const E=c.parse(o[o.length-1],o.length-1,f);return E?new oa(f,_,E):null}evaluate(o){for(const[c,f]of this.branches)if(c.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,f]of this.branches)o(c),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(c=>{o.push(c.serialize())}),o}}var Ja=oa;class Gl{constructor(o,c,f,_){this.type=o,this.input=c,this.beginIndex=f,this.endIndex=_}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,sr),_=c.parse(o[2],2,tn);if(!f||!_)return null;if(!Bi(f.type,[br(sr),Ln,sr]))return c.error(`Expected first argument to be of type array or string, but found ${Io(f.type)} instead`);if(4===o.length){const E=c.parse(o[3],3,tn);return E?new Gl(f.type,f,_,E):null}return new Gl(f.type,f,_)}evaluate(o){const c=this.input.evaluate(o),f=this.beginIndex.evaluate(o);if(!Ia(c,["string","array"]))throw new ra(`Expected first argument to be of type array or string, but found ${Io(Cs(c))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(o);return c.slice(f,_)}return c.slice(f)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Hd=Gl;function Lc(a,o){return"=="===a||"!="===a?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function Mc(a,o,c,f){return 0===f.compare(o,c)}function al(a,o,c){const f="=="!==a&&"!="!==a;return class l4{constructor(E,S,T){this.type=Ai,this.lhs=E,this.rhs=S,this.collator=T,this.hasUntypedArgument="value"===E.type.kind||"value"===S.type.kind}static parse(E,S){if(3!==E.length&&4!==E.length)return S.error("Expected two or three arguments.");const T=E[0];let O=S.parse(E[1],1,sr);if(!O)return null;if(!Lc(T,O.type))return S.concat(1).error(`"${T}" comparisons are not supported for type '${Io(O.type)}'.`);let k=S.parse(E[2],2,sr);if(!k)return null;if(!Lc(T,k.type))return S.concat(2).error(`"${T}" comparisons are not supported for type '${Io(k.type)}'.`);if(O.type.kind!==k.type.kind&&"value"!==O.type.kind&&"value"!==k.type.kind)return S.error(`Cannot compare types '${Io(O.type)}' and '${Io(k.type)}'.`);f&&("value"===O.type.kind&&"value"!==k.type.kind?O=new Xa(k.type,[O]):"value"!==O.type.kind&&"value"===k.type.kind&&(k=new Xa(O.type,[k])));let V=null;if(4===E.length){if("string"!==O.type.kind&&"string"!==k.type.kind&&"value"!==O.type.kind&&"value"!==k.type.kind)return S.error("Cannot use collator to compare non-string types.");if(V=S.parse(E[3],3,Bl),!V)return null}return new l4(O,k,V)}evaluate(E){const S=this.lhs.evaluate(E),T=this.rhs.evaluate(E);if(f&&this.hasUntypedArgument){const O=Cs(S),k=Cs(T);if(O.kind!==k.kind||"string"!==O.kind&&"number"!==O.kind)throw new ra(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${O.kind}, ${k.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const O=Cs(S),k=Cs(T);if("string"!==O.kind||"string"!==k.kind)return o(E,S,T)}return this.collator?c(E,S,T,this.collator.evaluate(E)):o(E,S,T)}eachChild(E){E(this.lhs),E(this.rhs),this.collator&&E(this.collator)}outputDefined(){return!0}serialize(){const E=[a];return this.eachChild(S=>{E.push(S.serialize())}),E}}}const pa=al("==",function(a,o,c){return o===c},Mc),Os=al("!=",function(a,o,c){return o!==c},function(a,o,c,f){return!Mc(0,o,c,f)}),Ta=al("<",function(a,o,c){return o<c},function(a,o,c,f){return f.compare(o,c)<0}),pf=al(">",function(a,o,c){return o>c},function(a,o,c,f){return f.compare(o,c)>0}),ou=al("<=",function(a,o,c){return o<=c},function(a,o,c,f){return f.compare(o,c)<=0}),Au=al(">=",function(a,o,c){return o>=c},function(a,o,c,f){return f.compare(o,c)>=0});class ks{constructor(o,c,f,_,E,S){this.type=Ln,this.number=o,this.locale=c,this.currency=f,this.unit=_,this.minFractionDigits=E,this.maxFractionDigits=S}static parse(o,c){if(3!==o.length)return c.error("Expected two arguments.");const f=c.parse(o[1],1,tn);if(!f)return null;const _=o[2];if("object"!=typeof _||Array.isArray(_))return c.error("NumberFormat options argument must be an object.");let E=null;if(_.locale&&(E=c.parse(_.locale,1,Ln),!E))return null;let S=null;if(_.currency&&(S=c.parse(_.currency,1,Ln),!S))return null;let T=null;if(_.unit&&(T=c.parse(_.unit,1,Ln),!T))return null;let O=null;if(_["min-fraction-digits"]&&(O=c.parse(_["min-fraction-digits"],1,tn),!O))return null;let k=null;return _["max-fraction-digits"]&&(k=c.parse(_["max-fraction-digits"],1,tn),!k)?null:new ks(f,E,S,T,O,k)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Ds{constructor(o){this.type=tn,this.input=o}static parse(o,c){if(2!==o.length)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=c.parse(o[1],1);return f?"array"!==f.type.kind&&"string"!==f.type.kind&&"value"!==f.type.kind?c.error(`Expected argument of type string or array, but found ${Io(f.type)} instead.`):new Ds(f):null}evaluate(o){const c=this.input.evaluate(o);if("string"==typeof c||Array.isArray(c))return c.length;throw new ra(`Expected value to be of type string or array, but found ${Io(Cs(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(c=>{o.push(c.serialize())}),o}}const Sl={"==":pa,"!=":Os,">":pf,"<":Ta,">=":Au,"<=":ou,array:Xa,at:Yu,boolean:Xa,case:Ja,coalesce:Rr,collator:wr,format:bl,image:ps,in:ru,"index-of":jl,interpolate:Lo,"interpolate-hcl":Lo,"interpolate-lab":Lo,length:Ds,let:$d,literal:ia,match:Ku,number:Xa,"number-format":ks,object:Xa,slice:Hd,step:Tu,string:Xa,"to-boolean":Uo,"to-color":Uo,"to-number":Uo,"to-string":Uo,var:ff,within:Er};function ll(a,[o,c,f,_]){o=o.evaluate(a),c=c.evaluate(a),f=f.evaluate(a);const E=_?_.evaluate(a):1,S=Ud(o,c,f,E);if(S)throw new ra(S);return new Zs(o/255*E,c/255*E,f/255*E,E)}function Ic(a,o){return a in o}function Nc(a,o){const c=o[a];return void 0===c?null:c}function Gi(a){return{type:a}}Vl.register(Sl,{error:[{kind:"error"},[Ln],(a,[o])=>{throw new ra(o.evaluate(a))}],typeof:[Ln,[sr],(a,[o])=>Io(Cs(o.evaluate(a)))],"to-rgba":[br(tn,4),[La],(a,[o])=>o.evaluate(a).toArray()],rgb:[La,[tn,tn,tn],ll],rgba:[La,[tn,tn,tn,tn],ll],has:{type:Ai,overloads:[[[Ln],(a,[o])=>Ic(o.evaluate(a),a.properties())],[[Ln,gi],(a,[o,c])=>Ic(o.evaluate(a),c.evaluate(a))]]},get:{type:sr,overloads:[[[Ln],(a,[o])=>Nc(o.evaluate(a),a.properties())],[[Ln,gi],(a,[o,c])=>Nc(o.evaluate(a),c.evaluate(a))]]},"feature-state":[sr,[Ln],(a,[o])=>Nc(o.evaluate(a),a.featureState||{})],properties:[gi,[],a=>a.properties()],"geometry-type":[Ln,[],a=>a.geometryType()],id:[sr,[],a=>a.id()],zoom:[tn,[],a=>a.globals.zoom],pitch:[tn,[],a=>a.globals.pitch||0],"distance-from-center":[tn,[],a=>a.distanceFromCenter()],"heatmap-density":[tn,[],a=>a.globals.heatmapDensity||0],"line-progress":[tn,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[tn,[],a=>a.globals.skyRadialProgress||0],accumulated:[sr,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[tn,Gi(tn),(a,o)=>{let c=0;for(const f of o)c+=f.evaluate(a);return c}],"*":[tn,Gi(tn),(a,o)=>{let c=1;for(const f of o)c*=f.evaluate(a);return c}],"-":{type:tn,overloads:[[[tn,tn],(a,[o,c])=>o.evaluate(a)-c.evaluate(a)],[[tn],(a,[o])=>-o.evaluate(a)]]},"/":[tn,[tn,tn],(a,[o,c])=>o.evaluate(a)/c.evaluate(a)],"%":[tn,[tn,tn],(a,[o,c])=>o.evaluate(a)%c.evaluate(a)],ln2:[tn,[],()=>Math.LN2],pi:[tn,[],()=>Math.PI],e:[tn,[],()=>Math.E],"^":[tn,[tn,tn],(a,[o,c])=>Math.pow(o.evaluate(a),c.evaluate(a))],sqrt:[tn,[tn],(a,[o])=>Math.sqrt(o.evaluate(a))],log10:[tn,[tn],(a,[o])=>Math.log(o.evaluate(a))/Math.LN10],ln:[tn,[tn],(a,[o])=>Math.log(o.evaluate(a))],log2:[tn,[tn],(a,[o])=>Math.log(o.evaluate(a))/Math.LN2],sin:[tn,[tn],(a,[o])=>Math.sin(o.evaluate(a))],cos:[tn,[tn],(a,[o])=>Math.cos(o.evaluate(a))],tan:[tn,[tn],(a,[o])=>Math.tan(o.evaluate(a))],asin:[tn,[tn],(a,[o])=>Math.asin(o.evaluate(a))],acos:[tn,[tn],(a,[o])=>Math.acos(o.evaluate(a))],atan:[tn,[tn],(a,[o])=>Math.atan(o.evaluate(a))],min:[tn,Gi(tn),(a,o)=>Math.min(...o.map(c=>c.evaluate(a)))],max:[tn,Gi(tn),(a,o)=>Math.max(...o.map(c=>c.evaluate(a)))],abs:[tn,[tn],(a,[o])=>Math.abs(o.evaluate(a))],round:[tn,[tn],(a,[o])=>{const c=o.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[tn,[tn],(a,[o])=>Math.floor(o.evaluate(a))],ceil:[tn,[tn],(a,[o])=>Math.ceil(o.evaluate(a))],"filter-==":[Ai,[Ln,sr],(a,[o,c])=>a.properties()[o.value]===c.value],"filter-id-==":[Ai,[sr],(a,[o])=>a.id()===o.value],"filter-type-==":[Ai,[Ln],(a,[o])=>a.geometryType()===o.value],"filter-<":[Ai,[Ln,sr],(a,[o,c])=>{const f=a.properties()[o.value],_=c.value;return typeof f==typeof _&&f<_}],"filter-id-<":[Ai,[sr],(a,[o])=>{const c=a.id(),f=o.value;return typeof c==typeof f&&c<f}],"filter->":[Ai,[Ln,sr],(a,[o,c])=>{const f=a.properties()[o.value],_=c.value;return typeof f==typeof _&&f>_}],"filter-id->":[Ai,[sr],(a,[o])=>{const c=a.id(),f=o.value;return typeof c==typeof f&&c>f}],"filter-<=":[Ai,[Ln,sr],(a,[o,c])=>{const f=a.properties()[o.value],_=c.value;return typeof f==typeof _&&f<=_}],"filter-id-<=":[Ai,[sr],(a,[o])=>{const c=a.id(),f=o.value;return typeof c==typeof f&&c<=f}],"filter->=":[Ai,[Ln,sr],(a,[o,c])=>{const f=a.properties()[o.value],_=c.value;return typeof f==typeof _&&f>=_}],"filter-id->=":[Ai,[sr],(a,[o])=>{const c=a.id(),f=o.value;return typeof c==typeof f&&c>=f}],"filter-has":[Ai,[sr],(a,[o])=>o.value in a.properties()],"filter-has-id":[Ai,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[Ai,[br(Ln)],(a,[o])=>o.value.indexOf(a.geometryType())>=0],"filter-id-in":[Ai,[br(sr)],(a,[o])=>o.value.indexOf(a.id())>=0],"filter-in-small":[Ai,[Ln,br(sr)],(a,[o,c])=>c.value.indexOf(a.properties()[o.value])>=0],"filter-in-large":[Ai,[Ln,br(sr)],(a,[o,c])=>function(f,_,E,S){for(;E<=S;){const T=E+S>>1;if(_[T]===f)return!0;_[T]>f?S=T-1:E=T+1}return!1}(a.properties()[o.value],c.value,0,c.value.length-1)],all:{type:Ai,overloads:[[[Ai,Ai],(a,[o,c])=>o.evaluate(a)&&c.evaluate(a)],[Gi(Ai),(a,o)=>{for(const c of o)if(!c.evaluate(a))return!1;return!0}]]},any:{type:Ai,overloads:[[[Ai,Ai],(a,[o,c])=>o.evaluate(a)||c.evaluate(a)],[Gi(Ai),(a,o)=>{for(const c of o)if(c.evaluate(a))return!0;return!1}]]},"!":[Ai,[Ai],(a,[o])=>!o.evaluate(a)],"is-supported-script":[Ai,[Ln],(a,[o])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(o.evaluate(a))}],upcase:[Ln,[Ln],(a,[o])=>o.evaluate(a).toUpperCase()],downcase:[Ln,[Ln],(a,[o])=>o.evaluate(a).toLowerCase()],concat:[Ln,Gi(sr),(a,o)=>o.map(c=>Za(c.evaluate(a))).join("")],"resolved-locale":[Ln,[Bl],(a,[o])=>o.evaluate(a).resolvedLocale()]});var ma=Sl;function xh(a){return{result:"success",value:a}}function ss(a){return{result:"error",value:a}}function xr(a){return"data-driven"===a["property-type"]}function cl(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function gs(a){return!!a.expression&&a.expression.interpolated}function vn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function _s(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function _r(a){return a}function Eo(a,o){const c="color"===o.type,f=a.stops&&"object"==typeof a.stops[0][0],_=f||!(f||void 0!==a.property),E=a.type||(gs(o)?"exponential":"interval");if(c&&((a=Nl({},a)).stops&&(a.stops=a.stops.map(k=>[k[0],Zs.parse(k[1])])),a.default=Zs.parse(a.default?a.default:o.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!vh[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let S,T,O;if("exponential"===E)S=Fr;else if("interval"===E)S=ls;else if("categorical"===E){S=Ls,T=Object.create(null);for(const k of a.stops)T[k[0]]=k[1];O=typeof a.stops[0][0]}else{if("identity"!==E)throw new Error(`Unknown function type "${E}"`);S=bh}if(f){const k={},V=[];for(let W=0;W<a.stops.length;W++){const K=a.stops[W],te=K[0].zoom;void 0===k[te]&&(k[te]={zoom:te,type:a.type,property:a.property,default:a.default,stops:[]},V.push(te)),k[te].stops.push([K[0].value,K[1]])}const j=[];for(const W of V)j.push([k[W].zoom,Eo(k[W],o)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Lo.interpolationFactor.bind(void 0,$),zoomStops:j.map(W=>W[0]),evaluate:({zoom:W},K)=>Fr({stops:j,base:a.base},o,W).evaluate(W,K)}}if(_){const k="exponential"===E?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Lo.interpolationFactor.bind(void 0,k),zoomStops:a.stops.map(V=>V[0]),evaluate:({zoom:V})=>S(a,o,V,T,O)}}return{kind:"source",evaluate(k,V){const j=V&&V.properties?V.properties[a.property]:void 0;return void 0===j?as(a.default,o.default):S(a,o,j,T,O)}}}function as(a,o,c){return void 0!==a?a:void 0!==o?o:void 0!==c?c:void 0}function Ls(a,o,c,f,_){return as(typeof c===_?f[c]:void 0,a.default,o.default)}function ls(a,o,c){if("number"!==vn(c))return as(a.default,o.default);const f=a.stops.length;if(1===f||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[f-1][0])return a.stops[f-1][1];const _=Zu(a.stops.map(E=>E[0]),c);return a.stops[_][1]}function Fr(a,o,c){const f=void 0!==a.base?a.base:1;if("number"!==vn(c))return as(a.default,o.default);const _=a.stops.length;if(1===_||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[_-1][0])return a.stops[_-1][1];const E=Zu(a.stops.map(V=>V[0]),c),S=function(V,j,$,W){const K=W-$,te=V-$;return 0===K?0:1===j?te/K:(Math.pow(j,te)-1)/(Math.pow(j,K)-1)}(c,f,a.stops[E][0],a.stops[E+1][0]),T=a.stops[E][1],O=a.stops[E+1][1];let k=wl[o.type]||_r;if(a.colorSpace&&"rgb"!==a.colorSpace){const V=vh[a.colorSpace];k=(j,$)=>V.reverse(V.interpolate(V.forward(j),V.forward($),S))}return"function"==typeof T.evaluate?{evaluate(...V){const j=T.evaluate.apply(void 0,V),$=O.evaluate.apply(void 0,V);if(void 0!==j&&void 0!==$)return k(j,$,S)}}:k(T,O,S)}function bh(a,o,c){return"color"===o.type?c=Zs.parse(c):"formatted"===o.type?c=Qo.fromString(c.toString()):"resolvedImage"===o.type?c=Pi.fromString(c.toString()):vn(c)===o.type||"enum"===o.type&&o.values[c]||(c=void 0),as(c,a.default,o.default)}class Pu{constructor(o,c){var f;this.expression=o,this._warningHistory={},this._evaluator=new jd,this._defaultValue=c?"color"===(f=c).type&&(_s(f.default)||Array.isArray(f.default))?new Zs(0,0,0,0):"color"===f.type?Zs.parse(f.default)||null:void 0===f.default?null:f.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(o,c,f,_,E,S,T,O){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=f,this._evaluator.canonical=_||null,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=S,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(o,c,f,_,E,S,T,O){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=f||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=S||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=O||null;try{const k=this.expression.evaluate(this._evaluator);if(null==k||"number"==typeof k&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new ra(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Ns(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in ma}function Ml(a,o){const c=new Du(ma,[],o?function(_){const E={color:La,string:Ln,number:tn,enum:Ln,boolean:Ai,formatted:Ir,resolvedImage:na};return"array"===_.type?br(E[_.value]||sr,_.length):E[_.type]}(o):void 0),f=c.parse(a,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return f?xh(new Pu(f,o)):ss(c.errors)}class cs{constructor(o,c){this.kind=o,this._styleExpression=c,this.isStateDependent="constant"!==o&&!Dr(c.expression)}evaluateWithoutErrorHandling(o,c,f,_,E,S){return this._styleExpression.evaluateWithoutErrorHandling(o,c,f,_,E,S)}evaluate(o,c,f,_,E,S){return this._styleExpression.evaluate(o,c,f,_,E,S)}}class Zn{constructor(o,c,f,_){this.kind=o,this.zoomStops=f,this._styleExpression=c,this.isStateDependent="camera"!==o&&!Dr(c.expression),this.interpolationType=_}evaluateWithoutErrorHandling(o,c,f,_,E,S){return this._styleExpression.evaluateWithoutErrorHandling(o,c,f,_,E,S)}evaluate(o,c,f,_,E,S){return this._styleExpression.evaluate(o,c,f,_,E,S)}interpolationFactor(o,c,f){return this.interpolationType?Lo.interpolationFactor(this.interpolationType,o,c,f):0}}function ki(a,o){if("error"===(a=Ml(a,o)).result)return a;const c=a.value.expression,f=Fa(c);if(!f&&!xr(o))return ss([new bc("","data expressions not supported")]);const _=oc(c,["zoom","pitch","distance-from-center"]);if(!_&&!cl(o))return ss([new bc("","zoom expressions not supported")]);const E=Co(c);return E||_?E instanceof bc?ss([E]):E instanceof Lo&&!gs(o)?ss([new bc("",'"interpolate" expressions cannot be used with this property')]):xh(E?new Zn(f?"camera":"composite",a.value,E.labels,E instanceof Lo?E.interpolation:void 0):new cs(f?"constant":"source",a.value)):ss([new bc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qi{constructor(o,c){this._parameters=o,this._specification=c,Nl(this,Eo(this._parameters,this._specification))}static deserialize(o){return new Qi(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Co(a){let o=null;if(a instanceof $d)o=Co(a.result);else if(a instanceof Rr){for(const c of a.args)if(o=Co(c),o)break}else(a instanceof Tu||a instanceof Lo)&&a.input instanceof Vl&&"zoom"===a.input.name&&(o=a);return o instanceof bc||a.eachChild(c=>{const f=Co(c);f instanceof bc?o=f:!o&&f?o=new bc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&f&&o!==f&&(o=new bc("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class Vn{constructor(o,c,f,_){this.message=(o?`${o}: `:"")+f,_&&(this.identifier=_),null!=c&&c.__line__&&(this.line=c.__line__)}}function yr(a){const o=a.key,c=a.value,f=a.valueSpec||{},_=a.objectElementValidators||{},E=a.style,S=a.styleSpec;let T=[];const O=vn(c);if("object"!==O)return[new Vn(o,c,`object expected, ${O} found`)];for(const k in c){const V=k.split(".")[0];let j;_[V]?j=_[V]:f[V]?j=z:_["*"]?j=_["*"]:f["*"]&&(j=z),j?T=T.concat(j({key:(o&&`${o}.`)+k,value:c[k],valueSpec:f[V]||f["*"],style:E,styleSpec:S,object:c,objectKey:k},c)):T.push(new Vn(o,c[k],`unknown property "${k}"`))}for(const k in f)_[k]||f[k].required&&void 0===f[k].default&&void 0===c[k]&&T.push(new Vn(o,c,`missing required property "${k}"`));return T}function su(a){const o=a.value,c=a.valueSpec,f=a.style,_=a.styleSpec,E=a.key,S=a.arrayElementValidator||z;if("array"!==vn(o))return[new Vn(E,o,`array expected, ${vn(o)} found`)];if(c.length&&o.length!==c.length)return[new Vn(E,o,`array length ${c.length} expected, length ${o.length} found`)];if(c["min-length"]&&o.length<c["min-length"])return[new Vn(E,o,`array length at least ${c["min-length"]} expected, length ${o.length} found`)];let T={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};_.$version<7&&(T.function=c.function),"object"===vn(c.value)&&(T=c.value);let O=[];for(let k=0;k<o.length;k++)O=O.concat(S({array:o,arrayIndex:k,value:o[k],valueSpec:T,style:f,styleSpec:_,key:`${E}[${k}]`}));return O}function Go(a){const o=a.key,c=a.value,f=a.valueSpec;let _=vn(c);if("number"===_&&c!=c&&(_="NaN"),"number"!==_)return[new Vn(o,c,`number expected, ${_} found`)];if("minimum"in f){let E=f.minimum;if("array"===vn(f.minimum)&&(E=f.minimum[a.arrayIndex]),c<E)return[new Vn(o,c,`${c} is less than the minimum value ${E}`)]}if("maximum"in f){let E=f.maximum;if("array"===vn(f.maximum)&&(E=f.maximum[a.arrayIndex]),c>E)return[new Vn(o,c,`${c} is greater than the maximum value ${E}`)]}return[]}function So(a){const o=a.valueSpec,c=fs(a.value.type);let f,_,E,S={};const T="categorical"!==c&&void 0===a.value.property,O=!T,k="array"===vn(a.value.stops)&&"array"===vn(a.value.stops[0])&&"object"===vn(a.value.stops[0][0]),V=yr({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(W){if("identity"===c)return[new Vn(W.key,W.value,'identity function may not have a "stops" property')];let K=[];const te=W.value;return K=K.concat(su({key:W.key,value:te,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:j})),"array"===vn(te)&&0===te.length&&K.push(new Vn(W.key,te,"array must have at least one stop")),K},default:function(W){return z({key:W.key,value:W.value,valueSpec:o,style:W.style,styleSpec:W.styleSpec})}}});return"identity"===c&&T&&V.push(new Vn(a.key,a.value,'missing required property "property"')),"identity"===c||a.value.stops||V.push(new Vn(a.key,a.value,'missing required property "stops"')),"exponential"===c&&a.valueSpec.expression&&!gs(a.valueSpec)&&V.push(new Vn(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(O&&!xr(a.valueSpec)?V.push(new Vn(a.key,a.value,"property functions not supported")):T&&!cl(a.valueSpec)&&V.push(new Vn(a.key,a.value,"zoom functions not supported"))),"categorical"!==c&&!k||void 0!==a.value.property||V.push(new Vn(a.key,a.value,'"property" property is required')),V;function j(W){let K=[];const te=W.value,ve=W.key;if("array"!==vn(te))return[new Vn(ve,te,`array expected, ${vn(te)} found`)];if(2!==te.length)return[new Vn(ve,te,`array length 2 expected, length ${te.length} found`)];if(k){if("object"!==vn(te[0]))return[new Vn(ve,te,`object expected, ${vn(te[0])} found`)];if(void 0===te[0].zoom)return[new Vn(ve,te,"object stop key must have zoom")];if(void 0===te[0].value)return[new Vn(ve,te,"object stop key must have value")];const Be=fs(te[0].zoom);if("number"!=typeof Be)return[new Vn(ve,te[0].zoom,"stop zoom values must be numbers")];if(E&&E>Be)return[new Vn(ve,te[0].zoom,"stop zoom values must appear in ascending order")];Be!==E&&(E=Be,_=void 0,S={}),K=K.concat(yr({key:`${ve}[0]`,value:te[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Go,value:$}}))}else K=K.concat($({key:`${ve}[0]`,value:te[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},te));return Ns(qs(te[1]))?K.concat([new Vn(`${ve}[1]`,te[1],"expressions are not allowed in function stops.")]):K.concat(z({key:`${ve}[1]`,value:te[1],valueSpec:o,style:W.style,styleSpec:W.styleSpec}))}function $(W,K){const te=vn(W.value),ve=fs(W.value),Be=null!==W.value?W.value:K;if(f){if(te!==f)return[new Vn(W.key,Be,`${te} stop domain type must match previous stop domain type ${f}`)]}else f=te;if("number"!==te&&"string"!==te&&"boolean"!==te&&"number"!=typeof ve&&"string"!=typeof ve&&"boolean"!=typeof ve)return[new Vn(W.key,Be,"stop domain value must be a number, string, or boolean")];if("number"!==te&&"categorical"!==c){let Je=`number expected, ${te} found`;return xr(o)&&void 0===c&&(Je+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Vn(W.key,Be,Je)]}return"categorical"!==c||"number"!==te||"number"==typeof ve&&isFinite(ve)&&Math.floor(ve)===ve?"categorical"!==c&&"number"===te&&"number"==typeof ve&&"number"==typeof _&&void 0!==_&&ve<_?[new Vn(W.key,Be,"stop domain values must appear in ascending order")]:(_=ve,"categorical"===c&&ve in S?[new Vn(W.key,Be,"stop domain values must be unique")]:(S[ve]=!0,[])):[new Vn(W.key,Be,`integer expected, found ${String(ve)}`)]}}function Fs(a){const o=("property"===a.expressionContext?ki:Ml)(qs(a.value),a.valueSpec);if("error"===o.result)return o.value.map(f=>new Vn(`${a.key}${f.key}`,a.value,f.message));const c=o.value.expression||o.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!c.outputDefined())return[new Vn(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Dr(c))return[new Vn(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext)return Si(c,a);if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!oc(c,["zoom","feature-state"]))return[new Vn(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Fa(c))return[new Vn(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Si(a,o){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const _ of o.valueSpec.expression.parameters)c.delete(_);if(0===c.size)return[];const f=[];return a instanceof Vl&&c.has(a.name)?[new Vn(o.key,o.value,`["${a.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(a.eachChild(_=>{f.push(...Si(_,o))}),f)}function au(a){const o=a.key,c=a.value,f=a.valueSpec,_=[];return Array.isArray(f.values)?-1===f.values.indexOf(fs(c))&&_.push(new Vn(o,c,`expected one of [${f.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(f.values).indexOf(fs(c))&&_.push(new Vn(o,c,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(c)} found`)),_}function Ru(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const o of a.slice(1))if(!Ru(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}function lu(a,o="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ru(a)||(a=ga(a));const c=a;let f=!0;try{f=function(k){if(!el(k))return k;let V=qs(k);return Aa(V),V=Ys(V),V}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(c,null,2)}\n        `)}const _=Qt[`filter_${o}`],E=Ml(f,_);let S=null;if("error"===E.result)throw new Error(E.value.map(k=>`${k.key}: ${k.message}`).join(", "));S=(k,V,j)=>E.value.evaluate(k,V,{},j);let T=null,O=null;if(f!==c){const k=Ml(c,_);if("error"===k.result)throw new Error(k.value.map(V=>`${V.key}: ${V.message}`).join(", "));T=(V,j,$,W,K)=>k.value.evaluate(V,j,{},$,void 0,void 0,W,K),O=!Fa(k.value.expression)}return{filter:S,dynamicFilter:T||void 0,needGeometry:Ou(f),needFeature:!!O}}function Ys(a){if(!Array.isArray(a))return a;const o=function(c){if(za.has(c[0]))for(let f=1;f<c.length;f++)if(el(c[f]))return!0;return c}(a);return!0===o?o:o.map(c=>Ys(c))}function Aa(a){let o=!1;const c=[];if("case"===a[0]){for(let f=1;f<a.length-1;f+=2)o=o||el(a[f]),c.push(a[f+1]);c.push(a[a.length-1])}else if("match"===a[0]){o=o||el(a[1]);for(let f=2;f<a.length-1;f+=2)c.push(a[f+1]);c.push(a[a.length-1])}else if("step"===a[0]){o=o||el(a[1]);for(let f=1;f<a.length-1;f+=2)c.push(a[f+1])}o&&(a.length=0,a.push("any",...c));for(let f=1;f<a.length;f++)Aa(a[f])}function el(a){if(!Array.isArray(a))return!1;if("pitch"===(o=a[0])||"distance-from-center"===o)return!0;var o;for(let c=1;c<a.length;c++)if(el(a[c]))return!0;return!1}const za=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Qu(a,o){return a<o?-1:a>o?1:0}function Ou(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let o=1;o<a.length;o++)if(Ou(a[o]))return!0;return!1}function ga(a){if(!a)return!0;const o=a[0];return a.length<=1?"any"!==o:"=="===o?ul(a[1],a[2],"=="):"!="===o?jn(ul(a[1],a[2],"==")):"<"===o||">"===o||"<="===o||">="===o?ul(a[1],a[2],o):"any"===o?(c=a.slice(1),["any"].concat(c.map(ga))):"all"===o?["all"].concat(a.slice(1).map(ga)):"none"===o?["all"].concat(a.slice(1).map(ga).map(jn)):"in"===o?cc(a[1],a.slice(2)):"!in"===o?jn(cc(a[1],a.slice(2))):"has"===o?Il(a[1]):"!has"===o?jn(Il(a[1])):"within"!==o||a;var c}function ul(a,o,c){switch(a){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,a,o]}}function cc(a,o){if(0===o.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",a,["literal",o.sort(Qu)]]:["filter-in-small",a,["literal",o]]}}function Il(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function jn(a){return["!",a]}function uc(a){return Ru(qs(a.value))?Fs(Nl({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):dc(a)}function dc(a){const o=a.value,c=a.key;if("array"!==vn(o))return[new Vn(c,o,`array expected, ${vn(o)} found`)];const f=a.styleSpec;let _,E=[];if(o.length<1)return[new Vn(c,o,"filter array must have at least 1 element")];switch(E=E.concat(au({key:`${c}[0]`,value:o[0],valueSpec:f.filter_operator,style:a.style,styleSpec:a.styleSpec})),fs(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===fs(o[1])&&E.push(new Vn(c,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&E.push(new Vn(c,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(_=vn(o[1]),"string"!==_&&E.push(new Vn(`${c}[1]`,o[1],`string expected, ${_} found`)));for(let S=2;S<o.length;S++)_=vn(o[S]),"$type"===fs(o[1])?E=E.concat(au({key:`${c}[${S}]`,value:o[S],valueSpec:f.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==_&&"number"!==_&&"boolean"!==_&&E.push(new Vn(`${c}[${S}]`,o[S],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let S=1;S<o.length;S++)E=E.concat(dc({key:`${c}[${S}]`,value:o[S],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":_=vn(o[1]),2!==o.length?E.push(new Vn(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==_&&E.push(new Vn(`${c}[1]`,o[1],`string expected, ${_} found`));break;case"within":_=vn(o[1]),2!==o.length?E.push(new Vn(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==_&&E.push(new Vn(`${c}[1]`,o[1],`object expected, ${_} found`))}return E}function Dc(a,o){const c=a.key,f=a.style,_=a.styleSpec,E=a.value,S=a.objectKey,T=_[`${o}_${a.layerType}`];if(!T)return[];const O=S.match(/^(.*)-transition$/);if("paint"===o&&O&&T[O[1]]&&T[O[1]].transition)return z({key:c,value:E,valueSpec:_.transition,style:f,styleSpec:_});const k=a.valueSpec||T[S];if(!k)return[new Vn(c,E,`unknown property "${S}"`)];let V;if("string"===vn(E)&&xr(k)&&!k.tokens&&(V=/^{([^}]+)}$/.exec(E))){const $=`\`{ "type": "identity", "property": ${V?JSON.stringify(V[1]):'"_"'} }\``;return[new Vn(c,E,`"${S}" does not support interpolation syntax\nUse an identity property function instead: ${$}.`)]}const j=[];return"symbol"===a.layerType&&("text-field"===S&&f&&!f.glyphs&&j.push(new Vn(c,E,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&_s(qs(E))&&"identity"===fs(E.type)&&j.push(new Vn(c,E,'"text-font" does not support identity functions'))),j.concat(z({key:a.key,value:E,valueSpec:k,style:f,styleSpec:_,expressionContext:"property",propertyType:o,propertyKey:S}))}function ys(a){return Dc(a,"paint")}function Ju(a){return Dc(a,"layout")}function sa(a){let o=[];const c=a.value,f=a.key,_=a.style,E=a.styleSpec;c.type||c.ref||o.push(new Vn(f,c,'either "type" or "ref" is required'));let S=fs(c.type);const T=fs(c.ref);if(c.id){const O=fs(c.id);for(let k=0;k<a.arrayIndex;k++){const V=_.layers[k];fs(V.id)===O&&o.push(new Vn(f,c.id,`duplicate layer id "${c.id}", previously used at line ${V.id.__line__}`))}}if("ref"in c){let O;["type","source","source-layer","filter","layout"].forEach(k=>{k in c&&o.push(new Vn(f,c[k],`"${k}" is prohibited for ref layers`))}),_.layers.forEach(k=>{fs(k.id)===T&&(O=k)}),O?O.ref?o.push(new Vn(f,c.ref,"ref cannot reference another ref layer")):S=fs(O.type):"string"==typeof T&&o.push(new Vn(f,c.ref,`ref layer "${T}" not found`))}else if("background"!==S&&"sky"!==S)if(c.source){const O=_.sources&&_.sources[c.source],k=O&&fs(O.type);O?"vector"===k&&"raster"===S?o.push(new Vn(f,c.source,`layer "${c.id}" requires a raster source`)):"raster"===k&&"raster"!==S?o.push(new Vn(f,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==k||c["source-layer"]?"raster-dem"===k&&"hillshade"!==S?o.push(new Vn(f,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==S||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||"geojson"===k&&O.lineMetrics||o.push(new Vn(f,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new Vn(f,c,`layer "${c.id}" must specify a "source-layer"`)):o.push(new Vn(f,c.source,`source "${c.source}" not found`))}else o.push(new Vn(f,c,'missing required property "source"'));return o=o.concat(yr({key:f,value:c,valueSpec:E.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>z({key:`${f}.type`,value:c.type,valueSpec:E.layer.type,style:a.style,styleSpec:a.styleSpec,object:c,objectKey:"type"}),filter:O=>uc(Nl({layerType:S},O)),layout:O=>yr({layer:c,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":k=>Ju(Nl({layerType:S},k))}}),paint:O=>yr({layer:c,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":k=>ys(Nl({layerType:S},k))}})}})),o}function Or(a){const o=a.value,c=a.key,f=vn(o);return"string"!==f?[new Vn(c,o,`string expected, ${f} found`)]:[]}const Ca={promoteId:function({key:a,value:o}){if("string"===vn(o))return Or({key:a,value:o});{const c=[];for(const f in o)c.push(...Or({key:`${a}.${f}`,value:o[f]}));return c}}};function qd(a){const o=a.value,c=a.key,f=a.styleSpec,_=a.style;if(!o.type)return[new Vn(c,o,'"type" is required')];const E=fs(o.type);let S;switch(E){case"vector":case"raster":case"raster-dem":return S=yr({key:c,value:o,valueSpec:f[`source_${E.replace("-","_")}`],style:a.style,styleSpec:f,objectElementValidators:Ca}),S;case"geojson":if(S=yr({key:c,value:o,valueSpec:f.source_geojson,style:_,styleSpec:f,objectElementValidators:Ca}),o.cluster)for(const T in o.clusterProperties){const[O,k]=o.clusterProperties[T],V="string"==typeof O?[O,["accumulated"],["get",T]]:O;S.push(...Fs({key:`${c}.${T}.map`,value:k,expressionContext:"cluster-map"})),S.push(...Fs({key:`${c}.${T}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return S;case"video":return yr({key:c,value:o,valueSpec:f.source_video,style:_,styleSpec:f});case"image":return yr({key:c,value:o,valueSpec:f.source_image,style:_,styleSpec:f});case"canvas":return[new Vn(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return au({key:`${c}.type`,value:o.type,valueSpec:{values:l(f)},style:_,styleSpec:f})}}function l(a){return a.source.reduce((o,c)=>{const f=a[c];return"enum"===f.type.type&&(o=o.concat(Object.keys(f.type.values))),o},[])}function h(a){const o=a.value,c=a.styleSpec,f=c.light,_=a.style;let E=[];const S=vn(o);if(void 0===o)return E;if("object"!==S)return E=E.concat([new Vn("light",o,`object expected, ${S} found`)]),E;for(const T in o){const O=T.match(/^(.*)-transition$/);E=E.concat(O&&f[O[1]]&&f[O[1]].transition?z({key:T,value:o[T],valueSpec:c.transition,style:_,styleSpec:c}):f[T]?z({key:T,value:o[T],valueSpec:f[T],style:_,styleSpec:c}):[new Vn(T,o[T],`unknown property "${T}"`)])}return E}function y(a){const o=a.value,c=a.key,f=a.style,_=a.styleSpec,E=_.terrain;let S=[];const T=vn(o);if(void 0===o)return S;if("object"!==T)return S=S.concat([new Vn("terrain",o,`object expected, ${T} found`)]),S;for(const O in o){const k=O.match(/^(.*)-transition$/);S=S.concat(k&&E[k[1]]&&E[k[1]].transition?z({key:O,value:o[O],valueSpec:_.transition,style:f,styleSpec:_}):E[O]?z({key:O,value:o[O],valueSpec:E[O],style:f,styleSpec:_}):[new Vn(O,o[O],`unknown property "${O}"`)])}if(o.source){const O=f.sources&&f.sources[o.source],k=O&&fs(O.type);O?"raster-dem"!==k&&S.push(new Vn(c,o.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):S.push(new Vn(c,o.source,`source "${o.source}" not found`))}else S.push(new Vn(c,o,'terrain is missing required property "source"'));return S}function w(a){const o=a.value,c=a.style,f=a.styleSpec,_=f.fog;let E=[];const S=vn(o);if(void 0===o)return E;if("object"!==S)return E=E.concat([new Vn("fog",o,`object expected, ${S} found`)]),E;for(const T in o){const O=T.match(/^(.*)-transition$/);E=E.concat(O&&_[O[1]]&&_[O[1]].transition?z({key:T,value:o[T],valueSpec:f.transition,style:c,styleSpec:f}):_[T]?z({key:T,value:o[T],valueSpec:_[T],style:c,styleSpec:f}):[new Vn(T,o[T],`unknown property "${T}"`)])}return E}const D={"*":()=>[],array:su,boolean:function(a){const o=a.value,c=a.key,f=vn(o);return"boolean"!==f?[new Vn(c,o,`boolean expected, ${f} found`)]:[]},number:Go,color:function(a){const o=a.key,c=a.value,f=vn(c);return"string"!==f?[new Vn(o,c,`color expected, ${f} found`)]:null===vl(c)?[new Vn(o,c,`color expected, "${c}" found`)]:[]},enum:au,filter:uc,function:So,layer:sa,object:yr,source:qd,light:h,terrain:y,fog:w,string:Or,formatted:function(a){return 0===Or(a).length?[]:Fs(a)},resolvedImage:function(a){return 0===Or(a).length?[]:Fs(a)},projection:function(a){const o=a.value,c=a.styleSpec,f=c.projection,_=a.style;let E=[];const S=vn(o);if("object"===S)for(const T in o)E=E.concat(z({key:T,value:o[T],valueSpec:f[T],style:_,styleSpec:c}));else"string"!==S&&(E=E.concat([new Vn("projection",o,`object or string expected, ${S} found`)]));return E}};function z(a){const o=a.value,c=a.valueSpec,f=a.styleSpec;return c.expression&&_s(fs(o))?So(a):c.expression&&Ns(qs(o))?Fs(a):c.type&&D[c.type]?D[c.type](a):yr(Nl({},a,{valueSpec:c.type?f[c.type]:c}))}function G(a){const o=a.value,c=a.key,f=Or(a);return f.length||(-1===o.indexOf("{fontstack}")&&f.push(new Vn(c,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&f.push(new Vn(c,o,'"glyphs" url must include a "{range}" token'))),f}function ie(a,o=Qt){return kt(z({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:G,"*":()=>[]}}))}const Oe=a=>kt(ys(a)),lt=a=>kt(Ju(a));function kt(a){return a.slice().sort((o,c)=>o.line&&c.line?o.line-c.line:0)}function Zt(a,o){let c=!1;if(o&&o.length)for(const f of o)a.fire(new da(new Error(f.message))),c=!0;return c}var Un=Xn,Fn=3;function Xn(a,o,c){var f=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var _=new Int32Array(this.arrayBuffer);a=_[0],this.d=(o=_[1])+2*(c=_[2]);for(var E=0;E<this.d*this.d;E++){var S=_[Fn+E],T=_[Fn+E+1];f.push(S===T?null:_.subarray(S,T))}var O=_[Fn+f.length+1];this.keys=_.subarray(_[Fn+f.length],O),this.bboxes=_.subarray(O),this.insert=this._insertReadonly}else{this.d=o+2*c;for(var k=0;k<this.d*this.d;k++)f.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=c,this.scale=o/a,this.uid=0;var V=c/o*a;this.min=-V,this.max=a+V}Xn.prototype.insert=function(a,o,c,f,_){this._forEachCell(o,c,f,_,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_)},Xn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xn.prototype._insertCell=function(a,o,c,f,_,E){this.cells[_].push(E)},Xn.prototype.query=function(a,o,c,f,_){var E=this.min,S=this.max;if(a<=E&&o<=E&&S<=c&&S<=f&&!_)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(a,o,c,f,this._queryCell,T,{},_),T},Xn.prototype._queryCell=function(a,o,c,f,_,E,S,T){var O=this.cells[_];if(null!==O)for(var k=this.keys,V=this.bboxes,j=0;j<O.length;j++){var $=O[j];if(void 0===S[$]){var W=4*$;(T?T(V[W+0],V[W+1],V[W+2],V[W+3]):a<=V[W+2]&&o<=V[W+3]&&c>=V[W+0]&&f>=V[W+1])?(S[$]=!0,E.push(k[$])):S[$]=!1}}},Xn.prototype._forEachCell=function(a,o,c,f,_,E,S,T){for(var O=this._convertToCellCoord(a),k=this._convertToCellCoord(o),V=this._convertToCellCoord(c),j=this._convertToCellCoord(f),$=O;$<=V;$++)for(var W=k;W<=j;W++){var K=this.d*W+$;if((!T||T(this._convertFromCellCoord($),this._convertFromCellCoord(W),this._convertFromCellCoord($+1),this._convertFromCellCoord(W+1)))&&_.call(this,a,o,c,f,K,E,S,T))return}},Xn.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Xn.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Xn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=Fn+this.cells.length+1+1,c=0,f=0;f<this.cells.length;f++)c+=this.cells[f].length;var _=new Int32Array(o+c+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var E=o,S=0;S<a.length;S++){var T=a[S];_[Fn+S]=E,_.set(T,E),E+=T.length}return _[Fn+a.length]=E,_.set(this.keys,E),_[Fn+a.length+1]=E+=this.keys.length,_.set(this.bboxes,E),E+=this.bboxes.length,_.buffer};var hi=De(Un);const Sr={};function On(a,o,c={}){Object.defineProperty(a,"_classRegistryKey",{value:o,writeable:!1}),Sr[o]={klass:a,omit:c.omit||[]}}On(Object,"Object"),hi.serialize=function(a,o){const c=a.toArrayBuffer();return o&&o.push(c),{buffer:c}},hi.deserialize=function(a){return new hi(a.buffer)},Object.defineProperty(hi,"name",{value:"Grid"}),On(hi,"Grid"),On(Zs,"Color"),On(Error,"Error"),On(nr,"AJAXError"),On(Pi,"ResolvedImage"),On(Qi,"StylePropertyFunction"),On(Pu,"StyleExpression",{omit:["_evaluator"]}),On(Zn,"ZoomDependentExpression"),On(cs,"ZoomConstantExpression"),On(Vl,"CompoundExpression",{omit:["_evaluate"]});for(const a in ma)Sr[ma[a]._classRegistryKey]||On(ma[a],`Expression${a}`);function Sa(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function hc(a){return xe.ImageBitmap&&a instanceof xe.ImageBitmap}function $l(a,o){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Sa(a)||hc(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){const c=a;return o&&o.push(c.buffer),c}if(a instanceof xe.ImageData)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){const c=[];for(const f of a)c.push($l(f,o));return c}if("object"==typeof a){const c=a.constructor,f=c._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const _=c.serialize?c.serialize(a,o):{};if(!c.serialize){for(const E in a)a.hasOwnProperty(E)&&(Sr[f].omit.indexOf(E)>=0||(_[E]=$l(a[E],o)));a instanceof Error&&(_.message=a.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==f&&(_.$name=f),_}throw new Error("can't serialize object of type "+typeof a)}function ku(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Sa(a)||hc(a)||ArrayBuffer.isView(a)||a instanceof xe.ImageData)return a;if(Array.isArray(a))return a.map(ku);if("object"==typeof a){const o=a.$name||"Object",{klass:c}=Sr[o];if(!c)throw new Error(`can't deserialize unregistered class ${o}`);if(c.deserialize)return c.deserialize(a);const f=Object.create(c.prototype);for(const _ of Object.keys(a))"$name"!==_&&(f[_]=ku(a[_]));return f}throw new Error("can't deserialize object of type "+typeof a)}const Wn={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Ig(a){for(const o of a)if(Tg(o.charCodeAt(0)))return!0;return!1}function Dg(a){for(const o of a)if(!hm(o.charCodeAt(0)))return!1;return!0}function hm(a){return!(Wn.Arabic(a)||Wn["Arabic Supplement"](a)||Wn["Arabic Extended-A"](a)||Wn["Arabic Presentation Forms-A"](a)||Wn["Arabic Presentation Forms-B"](a))}function Tg(a){return!(746!==a&&747!==a&&(a<4352||!(Wn["Bopomofo Extended"](a)||Wn.Bopomofo(a)||Wn["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Wn["CJK Compatibility Ideographs"](a)||Wn["CJK Compatibility"](a)||Wn["CJK Radicals Supplement"](a)||Wn["CJK Strokes"](a)||!(!Wn["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Wn["CJK Unified Ideographs Extension A"](a)||Wn["CJK Unified Ideographs"](a)||Wn["Enclosed CJK Letters and Months"](a)||Wn["Hangul Compatibility Jamo"](a)||Wn["Hangul Jamo Extended-A"](a)||Wn["Hangul Jamo Extended-B"](a)||Wn["Hangul Jamo"](a)||Wn["Hangul Syllables"](a)||Wn.Hiragana(a)||Wn["Ideographic Description Characters"](a)||Wn.Kanbun(a)||Wn["Kangxi Radicals"](a)||Wn["Katakana Phonetic Extensions"](a)||Wn.Katakana(a)&&12540!==a||!(!Wn["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Wn["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Wn["Unified Canadian Aboriginal Syllabics"](a)||Wn["Unified Canadian Aboriginal Syllabics Extended"](a)||Wn["Vertical Forms"](a)||Wn["Yijing Hexagram Symbols"](a)||Wn["Yi Syllables"](a)||Wn["Yi Radicals"](a))))}function Cy(a){return!(Tg(a)||(o=a,Wn["Latin-1 Supplement"](o)&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||Wn["General Punctuation"](o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||Wn["Letterlike Symbols"](o)||Wn["Number Forms"](o)||Wn["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||Wn["Control Pictures"](o)&&9251!==o||Wn["Optical Character Recognition"](o)||Wn["Enclosed Alphanumerics"](o)||Wn["Geometric Shapes"](o)||Wn["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Wn["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Wn["CJK Symbols and Punctuation"](o)||Wn.Katakana(o)||Wn["Private Use Area"](o)||Wn["CJK Compatibility Forms"](o)||Wn["Small Form Variants"](o)||Wn["Halfwidth and Fullwidth Forms"](o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o}function Sy(a){return a>=1424&&a<=2303||Wn["Arabic Presentation Forms-A"](a)||Wn["Arabic Presentation Forms-B"](a)}function Wd(a,o){return!(!o&&Sy(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Wn.Khmer(a))}function gd(a){for(const o of a)if(Sy(o.charCodeAt(0)))return!0;return!1}const Ag="deferred",Pg="loading",Va="loaded";let ed=null,b="unavailable",u=null;const g=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(b="error"),ed&&ed(a)};function C(){I.fire(new ka("pluginStateChange",{pluginStatus:b,pluginURL:u}))}const I=new ba,P=function(){return b},N=function(){if(b!==Ag||!u)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");b=Pg,C(),u&&Xo({url:u},a=>{a?g(a):(b=Va,C())})},B={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>b===Va||null!=B.applyArabicShaping,isLoading:()=>b===Pg,setState(a){b=a.pluginStatus,u=a.pluginURL},isParsed:()=>null!=B.applyArabicShaping&&null!=B.processBidirectionalText&&null!=B.processStyledBidirectionalText,getPluginURL:()=>u};class U{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(c,f){for(const _ of c)if(!Wd(_.charCodeAt(0),f))return!1;return!0}(o,B.isLoaded())}}class q{constructor(o,c){this.property=o,this.value=c,this.expression=function(f,_){if(_s(f))return new Qi(f,_);if(Ns(f)){const E=ki(f,_);if("error"===E.result)throw new Error(E.value.map(S=>`${S.key}: ${S.message}`).join(", "));return E.value}{let E=f;return"string"==typeof f&&"color"===_.type&&(E=Zs.parse(f)),{kind:"constant",evaluate:()=>E}}}(void 0===c?o.specification.default:c,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,c,f){return this.property.possiblyEvaluate(this,o,c,f)}}class H{constructor(o){this.property=o,this.value=new q(o,void 0)}transitioned(o,c){return new _e(this.property,this.value,c,Ie({},o.transition,this.transition),o.now)}untransitioned(){return new _e(this.property,this.value,null,{},0)}}class J{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return mn(this._values[o].value.value)}setValue(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new H(this._values[o].property)),this._values[o].value=new q(this._values[o].property,null===c?void 0:mn(c))}getTransition(o){return mn(this._values[o].transition)}setTransition(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new H(this._values[o].property)),this._values[o].transition=mn(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const f=this.getValue(c);void 0!==f&&(o[c]=f);const _=this.getTransition(c);void 0!==_&&(o[`${c}-transition`]=_)}return o}transitioned(o,c){const f=new Ce(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].transitioned(o,c._values[_]);return f}untransitioned(){const o=new Ce(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class _e{constructor(o,c,f,_,E){const S=_.delay||0,T=_.duration||0;E=E||0,this.property=o,this.value=c,this.begin=E+S,this.end=this.begin+T,o.specification.transition&&(_.delay||_.duration)&&(this.prior=f)}possiblyEvaluate(o,c,f){const _=o.now||0,E=this.value.possiblyEvaluate(o,c,f),S=this.prior;if(S){if(_>this.end)return this.prior=null,E;if(this.value.isDataDriven())return this.prior=null,E;if(_<this.begin)return S.possiblyEvaluate(o,c,f);{const T=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(o,c,f),E,Me(T))}}return E}}class Ce{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,f){const _=new Le(this._properties);for(const E of Object.keys(this._values))_._values[E]=this._values[E].possiblyEvaluate(o,c,f);return _}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Te{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return mn(this._values[o].value)}setValue(o,c){this._values[o]=new q(this._values[o].property,null===c?void 0:mn(c))}serialize(){const o={};for(const c of Object.keys(this._values)){const f=this.getValue(c);void 0!==f&&(o[c]=f)}return o}possiblyEvaluate(o,c,f){const _=new Le(this._properties);for(const E of Object.keys(this._values))_._values[E]=this._values[E].possiblyEvaluate(o,c,f);return _}}class Pe{constructor(o,c,f){this.property=o,this.value=c,this.parameters=f}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,c,f,_){return this.property.evaluate(this.value,this.parameters,o,c,f,_)}}class Le{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class ee{constructor(o){this.specification=o}possiblyEvaluate(o,c){return o.expression.evaluate(c)}interpolate(o,c,f){const _=wl[this.specification.type];return _?_(o,c,f):o}}class Se{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,f,_){return new Pe(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(c,null,{},f,_)}:o.expression,c)}interpolate(o,c,f){if("constant"!==o.value.kind||"constant"!==c.value.kind)return o;if(void 0===o.value.value||void 0===c.value.value)return new Pe(this,{kind:"constant",value:void 0},o.parameters);const _=wl[this.specification.type];return _?new Pe(this,{kind:"constant",value:_(o.value.value,c.value.value,f)},o.parameters):o}evaluate(o,c,f,_,E,S){return"constant"===o.kind?o.value:o.evaluate(c,f,_,E,S)}}class Ge{constructor(o){this.specification=o}possiblyEvaluate(o,c,f,_){return!!o.expression.evaluate(c,null,{},f,_)}interpolate(){return!1}}class We{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new U(0,{});for(const f in o){const _=o[f];_.specification.overridable&&this.overridableProperties.push(f);const E=this.defaultPropertyValues[f]=new q(_,void 0),S=this.defaultTransitionablePropertyValues[f]=new H(_);this.defaultTransitioningPropertyValues[f]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=E.possiblyEvaluate(c)}}}function ht(a,o){return 256*(a=Ee(Math.floor(a),0,255))+Ee(Math.floor(o),0,255)}On(Se,"DataDrivenProperty"),On(ee,"DataConstantProperty"),On(Ge,"ColorRampProperty");const ft={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ut{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class St{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function bt(a,o=1){let c=0,f=0;return{members:a.map(_=>{const E=ft[_.type].BYTES_PER_ELEMENT,S=c=zt(c,Math.max(o,E)),T=_.components||1;return f=Math.max(f,E),c+=E*T,{name:_.name,type:_.type,components:T,offset:S}}),size:zt(c,Math.max(f,o)),alignment:o}}function zt(a,o){return Math.ceil(a/o)*o}class En extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const _=2*o;return this.int16[_+0]=c,this.int16[_+1]=f,o}}En.prototype.bytesPerElement=4,On(En,"StructArrayLayout2i4");class Pt extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,o,c,f)}emplace(o,c,f,_){const E=3*o;return this.int16[E+0]=c,this.int16[E+1]=f,this.int16[E+2]=_,o}}Pt.prototype.bytesPerElement=6,On(Pt,"StructArrayLayout3i6");class sn extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,_){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,_)}emplace(o,c,f,_,E){const S=4*o;return this.int16[S+0]=c,this.int16[S+1]=f,this.int16[S+2]=_,this.int16[S+3]=E,o}}sn.prototype.bytesPerElement=8,On(sn,"StructArrayLayout4i8");class Ht extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S,T){const O=this.length;return this.resize(O+1),this.emplace(O,o,c,f,_,E,S,T)}emplace(o,c,f,_,E,S,T,O){const k=6*o,V=12*o,j=3*o;return this.int16[k+0]=c,this.int16[k+1]=f,this.uint8[V+4]=_,this.uint8[V+5]=E,this.uint8[V+6]=S,this.uint8[V+7]=T,this.float32[j+2]=O,o}}Ht.prototype.bytesPerElement=12,On(Ht,"StructArrayLayout2i4ub1f12");class xn extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,_){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,_)}emplace(o,c,f,_,E){const S=4*o;return this.float32[S+0]=c,this.float32[S+1]=f,this.float32[S+2]=_,this.float32[S+3]=E,o}}xn.prototype.bytesPerElement=16,On(xn,"StructArrayLayout4f16");class Bt extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E){const S=this.length;return this.resize(S+1),this.emplace(S,o,c,f,_,E)}emplace(o,c,f,_,E,S){const T=6*o,O=3*o;return this.uint16[T+0]=c,this.uint16[T+1]=f,this.uint16[T+2]=_,this.uint16[T+3]=E,this.float32[O+2]=S,o}}Bt.prototype.bytesPerElement=12,On(Bt,"StructArrayLayout4ui1f12");class rn extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,_){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,_)}emplace(o,c,f,_,E){const S=4*o;return this.uint16[S+0]=c,this.uint16[S+1]=f,this.uint16[S+2]=_,this.uint16[S+3]=E,o}}rn.prototype.bytesPerElement=8,On(rn,"StructArrayLayout4ui8");class wn extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,f,_,E,S)}emplace(o,c,f,_,E,S,T){const O=6*o;return this.int16[O+0]=c,this.int16[O+1]=f,this.int16[O+2]=_,this.int16[O+3]=E,this.int16[O+4]=S,this.int16[O+5]=T,o}}wn.prototype.bytesPerElement=12,On(wn,"StructArrayLayout6i12");class hn extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S,T,O,k,V,j,$){const W=this.length;return this.resize(W+1),this.emplace(W,o,c,f,_,E,S,T,O,k,V,j,$)}emplace(o,c,f,_,E,S,T,O,k,V,j,$,W){const K=12*o;return this.int16[K+0]=c,this.int16[K+1]=f,this.int16[K+2]=_,this.int16[K+3]=E,this.uint16[K+4]=S,this.uint16[K+5]=T,this.uint16[K+6]=O,this.uint16[K+7]=k,this.int16[K+8]=V,this.int16[K+9]=j,this.int16[K+10]=$,this.int16[K+11]=W,o}}hn.prototype.bytesPerElement=24,On(hn,"StructArrayLayout4i4ui4i24");class Sn extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S){const T=this.length;return this.resize(T+1),this.emplace(T,o,c,f,_,E,S)}emplace(o,c,f,_,E,S,T){const O=10*o,k=5*o;return this.int16[O+0]=c,this.int16[O+1]=f,this.int16[O+2]=_,this.float32[k+2]=E,this.float32[k+3]=S,this.float32[k+4]=T,o}}Sn.prototype.bytesPerElement=20,On(Sn,"StructArrayLayout3i3f20");class yi extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}yi.prototype.bytesPerElement=4,On(yi,"StructArrayLayout1ul4");class $i extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S,T,O,k,V,j,$,W){const K=this.length;return this.resize(K+1),this.emplace(K,o,c,f,_,E,S,T,O,k,V,j,$,W)}emplace(o,c,f,_,E,S,T,O,k,V,j,$,W,K){const te=20*o,ve=10*o;return this.int16[te+0]=c,this.int16[te+1]=f,this.int16[te+2]=_,this.int16[te+3]=E,this.int16[te+4]=S,this.float32[ve+3]=T,this.float32[ve+4]=O,this.float32[ve+5]=k,this.float32[ve+6]=V,this.int16[te+14]=j,this.uint32[ve+8]=$,this.uint16[te+18]=W,this.uint16[te+19]=K,o}}$i.prototype.bytesPerElement=40,On($i,"StructArrayLayout5i4f1i1ul2ui40");class ei extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S,T){const O=this.length;return this.resize(O+1),this.emplace(O,o,c,f,_,E,S,T)}emplace(o,c,f,_,E,S,T,O){const k=8*o;return this.int16[k+0]=c,this.int16[k+1]=f,this.int16[k+2]=_,this.int16[k+4]=E,this.int16[k+5]=S,this.int16[k+6]=T,this.int16[k+7]=O,o}}ei.prototype.bytesPerElement=16,On(ei,"StructArrayLayout3i2i2i16");class ii extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E){const S=this.length;return this.resize(S+1),this.emplace(S,o,c,f,_,E)}emplace(o,c,f,_,E,S){const T=4*o,O=8*o;return this.float32[T+0]=c,this.float32[T+1]=f,this.float32[T+2]=_,this.int16[O+6]=E,this.int16[O+7]=S,o}}ii.prototype.bytesPerElement=16,On(ii,"StructArrayLayout2f1f2i16");class fr extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,_){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,_)}emplace(o,c,f,_,E){const S=12*o,T=3*o;return this.uint8[S+0]=c,this.uint8[S+1]=f,this.float32[T+1]=_,this.float32[T+2]=E,o}}fr.prototype.bytesPerElement=12,On(fr,"StructArrayLayout2ub2f12");class pr extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,o,c,f)}emplace(o,c,f,_){const E=3*o;return this.float32[E+0]=c,this.float32[E+1]=f,this.float32[E+2]=_,o}}pr.prototype.bytesPerElement=12,On(pr,"StructArrayLayout3f12");class di extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,o,c,f)}emplace(o,c,f,_){const E=3*o;return this.uint16[E+0]=c,this.uint16[E+1]=f,this.uint16[E+2]=_,o}}di.prototype.bytesPerElement=6,On(di,"StructArrayLayout3ui6");class _o extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve,Be,Je,Ne,Ze,rt){const st=this.length;return this.resize(st+1),this.emplace(st,o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve,Be,Je,Ne,Ze,rt)}emplace(o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve,Be,Je,Ne,Ze,rt,st){const Vt=30*o,At=15*o,en=60*o;return this.int16[Vt+0]=c,this.int16[Vt+1]=f,this.int16[Vt+2]=_,this.float32[At+2]=E,this.float32[At+3]=S,this.uint16[Vt+8]=T,this.uint16[Vt+9]=O,this.uint32[At+5]=k,this.uint32[At+6]=V,this.uint32[At+7]=j,this.uint16[Vt+16]=$,this.uint16[Vt+17]=W,this.uint16[Vt+18]=K,this.float32[At+10]=te,this.float32[At+11]=ve,this.uint8[en+48]=Be,this.uint8[en+49]=Je,this.uint8[en+50]=Ne,this.uint32[At+13]=Ze,this.int16[Vt+28]=rt,this.uint8[en+58]=st,o}}_o.prototype.bytesPerElement=60,On(_o,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class No extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve,Be,Je,Ne,Ze,rt,st,Vt,At,en,bn,$t,an,ln,gn){const In=this.length;return this.resize(In+1),this.emplace(In,o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve,Be,Je,Ne,Ze,rt,st,Vt,At,en,bn,$t,an,ln,gn)}emplace(o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve,Be,Je,Ne,Ze,rt,st,Vt,At,en,bn,$t,an,ln,gn,In){const Jt=38*o,Hn=19*o;return this.int16[Jt+0]=c,this.int16[Jt+1]=f,this.int16[Jt+2]=_,this.float32[Hn+2]=E,this.float32[Hn+3]=S,this.int16[Jt+8]=T,this.int16[Jt+9]=O,this.int16[Jt+10]=k,this.int16[Jt+11]=V,this.int16[Jt+12]=j,this.int16[Jt+13]=$,this.uint16[Jt+14]=W,this.uint16[Jt+15]=K,this.uint16[Jt+16]=te,this.uint16[Jt+17]=ve,this.uint16[Jt+18]=Be,this.uint16[Jt+19]=Je,this.uint16[Jt+20]=Ne,this.uint16[Jt+21]=Ze,this.uint16[Jt+22]=rt,this.uint16[Jt+23]=st,this.uint16[Jt+24]=Vt,this.uint16[Jt+25]=At,this.uint16[Jt+26]=en,this.uint16[Jt+27]=bn,this.uint16[Jt+28]=$t,this.uint32[Hn+15]=an,this.float32[Hn+16]=ln,this.float32[Hn+17]=gn,this.float32[Hn+18]=In,o}}No.prototype.bytesPerElement=76,On(No,"StructArrayLayout3i2f6i15ui1ul3f76");class $o extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}$o.prototype.bytesPerElement=4,On($o,"StructArrayLayout1f4");class Ao extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,_,E){const S=this.length;return this.resize(S+1),this.emplace(S,o,c,f,_,E)}emplace(o,c,f,_,E,S){const T=5*o;return this.float32[T+0]=c,this.float32[T+1]=f,this.float32[T+2]=_,this.float32[T+3]=E,this.float32[T+4]=S,o}}Ao.prototype.bytesPerElement=20,On(Ao,"StructArrayLayout5f20");class Dl extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,_){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,_)}emplace(o,c,f,_,E){const S=6*o;return this.uint32[3*o+0]=c,this.uint16[S+2]=f,this.uint16[S+3]=_,this.uint16[S+4]=E,o}}Dl.prototype.bytesPerElement=12,On(Dl,"StructArrayLayout1ul3ui12");class vs extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const _=2*o;return this.uint16[_+0]=c,this.uint16[_+1]=f,o}}vs.prototype.bytesPerElement=4,On(vs,"StructArrayLayout2ui4");class Tc extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}Tc.prototype.bytesPerElement=2,On(Tc,"StructArrayLayout1ui2");class cu extends St{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const _=2*o;return this.float32[_+0]=c,this.float32[_+1]=f,o}}cu.prototype.bytesPerElement=8,On(cu,"StructArrayLayout2f8");class Hi extends ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Hi.prototype.size=40;class Po extends $i{get(o){return new Hi(this,o)}}On(Po,"CollisionBoxArray");class Tr extends ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}Tr.prototype.size=60;class yo extends _o{get(o){return new Tr(this,o)}}On(yo,"PlacedSymbolArray");class Hl extends ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Hl.prototype.size=76;class us extends No{get(o){return new Hl(this,o)}}On(us,"SymbolInstanceArray");class Ua extends $o{getoffsetX(o){return this.float32[1*o+0]}}On(Ua,"GlyphOffsetArray");class Tl extends En{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}On(Tl,"SymbolLineVertexArray");class Zd extends ut{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Zd.prototype.size=12;class mf extends Dl{get(o){return new Zd(this,o)}}On(mf,"FeatureIndexArray");class td extends vs{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}On(td,"FillExtrusionCentroidArray");const ql=bt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),_d=bt([{name:"a_dash",components:4,type:"Uint16"}]);var ap={exports:{}},Xx=function(a,o){var c,f,_,E,S,T,O,k;for(f=a.length-(c=3&a.length),_=o,S=3432918353,T=461845907,k=0;k<f;)O=255&a.charCodeAt(k)|(255&a.charCodeAt(++k))<<8|(255&a.charCodeAt(++k))<<16|(255&a.charCodeAt(++k))<<24,++k,_=27492+(65535&(E=5*(65535&(_=(_^=O=(65535&(O=(O=(65535&O)*S+(((O>>>16)*S&65535)<<16)&4294967295)<<15|O>>>17))*T+(((O>>>16)*T&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(O=0,c){case 3:O^=(255&a.charCodeAt(k+2))<<16;case 2:O^=(255&a.charCodeAt(k+1))<<8;case 1:_^=O=(65535&(O=(O=(65535&(O^=255&a.charCodeAt(k)))*S+(((O>>>16)*S&65535)<<16)&4294967295)<<15|O>>>17))*T+(((O>>>16)*T&65535)<<16)&4294967295}return _^=a.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0},lr=function(a,o){for(var c,f=a.length,_=o^f,E=0;f>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(E)|(255&a.charCodeAt(++E))<<8|(255&a.charCodeAt(++E))<<16|(255&a.charCodeAt(++E))<<24))+((1540483477*(c>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),f-=4,++E;switch(f){case 3:_^=(255&a.charCodeAt(E+2))<<16;case 2:_^=(255&a.charCodeAt(E+1))<<8;case 1:_=1540483477*(65535&(_^=255&a.charCodeAt(E)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};ap.exports=Xx,ap.exports.murmur3=Xx,ap.exports.murmur2=lr;var Rg=De(ap.exports);class Iy{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,c,f,_){this.ids.push(Yx(o)),this.positions.push(c,f,_)}getPositions(o){const c=Yx(o);let f=0,_=this.ids.length-1;for(;f<_;){const S=f+_>>1;this.ids[S]>=c?_=S:f=S+1}const E=[];for(;this.ids[f]===c;)E.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return E}static serialize(o,c){const f=new Float64Array(o.ids),_=new Uint32Array(o.positions);return Dy(f,_,0,f.length-1),c&&c.push(f.buffer,_.buffer),{ids:f,positions:_}}static deserialize(o){const c=new Iy;return c.ids=o.ids,c.positions=o.positions,c.indexed=!0,c}}function Yx(a){const o=+a;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Rg(String(a))}function Dy(a,o,c,f){for(;c<f;){const _=a[c+f>>1];let E=c-1,S=f+1;for(;;){do{E++}while(a[E]<_);do{S--}while(a[S]>_);if(E>=S)break;Og(a,E,S),Og(o,3*E,3*S),Og(o,3*E+1,3*S+1),Og(o,3*E+2,3*S+2)}S-c<f-S?(Dy(a,o,c,S),c=S+1):(Dy(a,o,S+1,f),f=S)}}function Og(a,o,c){const f=a[o];a[o]=a[c],a[c]=f}On(Iy,"FeaturePositionMap");class yd{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,c),this.initialized=!0),!!this.location}}class Xd extends yd{constructor(o){super(o),this.current=0}set(o,c,f){this.fetchUniformLocation(o,c)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class Kx extends yd{constructor(o){super(o),this.current=[0,0,0,0]}set(o,c,f){this.fetchUniformLocation(o,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class Qx extends yd{constructor(o){super(o),this.current=Zs.transparent}set(o,c,f){this.fetchUniformLocation(o,c)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const hC=new Float32Array(16),fC=new Float32Array(9),pC=new Float32Array(4);function Mn(a){return[ht(255*a.r,255*a.g),ht(255*a.b,255*a.a)]}class Br{constructor(o,c,f){this.value=o,this.uniformNames=c.map(_=>`u_${_}`),this.type=f}setUniform(o,c,f,_,E){c.set(o,E,_.constantOr(this.value))}getBinding(o,c){return"color"===this.type?new Qx(o):new Xd(o)}}class Fc{constructor(o,c){this.uniformNames=c.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,c,f,_,E){const S="u_pattern"===E||"u_dash"===E?this.pattern:"u_pixel_ratio"===E?this.pixelRatio:null;S&&c.set(o,E,S)}getBinding(o,c){return"u_pattern"===c||"u_dash"===c?new Kx(o):new Xd(o)}}class Wl{constructor(o,c,f,_){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=c.map(E=>({name:`a_${E}`,type:"Float32",components:"color"===f?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(o,c,f,_,E,S){const T=this.paintVertexArray.length,O=this.expression.evaluate(new U(0),c,{},E,_,S);this.paintVertexArray.resize(o),this._setPaintValue(T,o,O)}updatePaintArray(o,c,f,_,E){const S=this.expression.evaluate({zoom:0},f,_,void 0,E);this._setPaintValue(o,c,S)}_setPaintValue(o,c,f){if("color"===this.type){const _=Mn(f);for(let E=o;E<c;E++)this.paintVertexArray.emplace(E,_[0],_[1])}else{for(let _=o;_<c;_++)this.paintVertexArray.emplace(_,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bs{constructor(o,c,f,_,E,S){this.expression=o,this.uniformNames=c.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=_,this.zoom=E,this.maxValue=0,this.paintVertexAttributes=c.map(T=>({name:`a_${T}`,type:"Float32",components:"color"===f?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(o,c,f,_,E,S){const T=this.expression.evaluate(new U(this.zoom),c,{},E,_,S),O=this.expression.evaluate(new U(this.zoom+1),c,{},E,_,S),k=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(k,o,T,O)}updatePaintArray(o,c,f,_,E){const S=this.expression.evaluate({zoom:this.zoom},f,_,void 0,E),T=this.expression.evaluate({zoom:this.zoom+1},f,_,void 0,E);this._setPaintValue(o,c,S,T)}_setPaintValue(o,c,f,_){if("color"===this.type){const E=Mn(f),S=Mn(_);for(let T=o;T<c;T++)this.paintVertexArray.emplace(T,E[0],E[1],S[0],S[1])}else{for(let E=o;E<c;E++)this.paintVertexArray.emplace(E,f,_);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(_))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c,f,_,E){const S=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,T=Ee(this.expression.interpolationFactor(S,this.zoom,this.zoom+1),0,1);c.set(o,E,T)}getBinding(o,c){return new Xd(o)}}class Yd{constructor(o,c,f,_,E){this.expression=o,this.layerId=E,this.paintVertexAttributes=("array"===f?_d:ql).members;for(let S=0;S<c.length;++S);this.paintVertexArray=new _}populatePaintArray(o,c,f){const _=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(_,o,c.patterns&&c.patterns[this.layerId],f)}updatePaintArray(o,c,f,_,E,S){this._setPaintValues(o,c,f.patterns&&f.patterns[this.layerId],S)}_setPaintValues(o,c,f,_){if(!_||!f)return;const E=_[f];if(!E)return;const{tl:S,br:T,pixelRatio:O}=E;for(let k=o;k<c;k++)this.paintVertexArray.emplace(k,S[0],S[1],T[0],T[1],O)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lu{constructor(o,c,f=(()=>!0)){this.binders={},this._buffers=[];const _=[];for(const E in o.paint._values){if(!f(E))continue;const S=o.paint.get(E);if(!(S instanceof Pe&&xr(S.property.specification)))continue;const T=Ay(E,o.type),O=S.value,k=S.property.specification.type,V=!!S.property.useIntegerZoom,j="line-dasharray"===E||E.endsWith("pattern"),$="line-dasharray"===E&&"constant"!==o.layout.get("line-cap").value.kind;if("constant"!==O.kind||$)if("source"===O.kind||$||j){const W=Py(E,k,"source");this.binders[E]=j?new Yd(O,T,k,W,o.id):new Wl(O,T,k,W),_.push(`/a_${E}`)}else{const W=Py(E,k,"composite");this.binders[E]=new Bs(O,T,k,V,c,W),_.push(`/z_${E}`)}else this.binders[E]=j?new Fc(O.value,T):new Br(O.value,T,k),_.push(`/u_${E}`)}this.cacheKey=_.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof Wl||c instanceof Bs?c.maxValue:0}populatePaintArrays(o,c,f,_,E,S){for(const T in this.binders){const O=this.binders[T];(O instanceof Wl||O instanceof Bs||O instanceof Yd)&&O.populatePaintArray(o,c,f,_,E,S)}}setConstantPatternPositions(o){for(const c in this.binders){const f=this.binders[c];f instanceof Fc&&f.setConstantPatternPositions(o)}}updatePaintArrays(o,c,f,_,E,S){let T=!1;for(const O in o){const k=c.getPositions(O);for(const V of k){const j=f.feature(V.index);for(const $ in this.binders){const W=this.binders[$];if((W instanceof Wl||W instanceof Bs||W instanceof Yd)&&!0===W.expression.isStateDependent){const K=_.paint.get($);W.expression=K.value,W.updatePaintArray(V.start,V.end,j,o[O],E,S),T=!0}}}}return T}defines(){const o=[];for(const c in this.binders){const f=this.binders[c];(f instanceof Br||f instanceof Fc)&&o.push(...f.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Wl||f instanceof Bs||f instanceof Yd)for(let _=0;_<f.paintVertexAttributes.length;_++)o.push(f.paintVertexAttributes[_].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Br||f instanceof Fc||f instanceof Bs)for(const _ of f.uniformNames)o.push(_)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const c=[];for(const f in this.binders){const _=this.binders[f];if(_ instanceof Br||_ instanceof Fc||_ instanceof Bs)for(const E of _.uniformNames)c.push({name:E,property:f,binding:_.getBinding(o,E)})}return c}setUniforms(o,c,f,_,E){for(const{name:S,property:T,binding:O}of f)this.binders[T].setUniform(o,O,E,_.get(T),S)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Wl||c instanceof Bs||c instanceof Yd)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(o){for(const c in this.binders){const f=this.binders[c];(f instanceof Wl||f instanceof Bs||f instanceof Yd)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof Wl||c instanceof Bs||c instanceof Yd)&&c.destroy()}}}class fc{constructor(o,c,f=(()=>!0)){this.programConfigurations={};for(const _ of o)this.programConfigurations[_.id]=new Lu(_,c,f);this.needsUpload=!1,this._featureMap=new Iy,this._bufferOffset=0}populatePaintArrays(o,c,f,_,E,S,T){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(o,c,_,E,S,T);void 0!==c.id&&this._featureMap.add(c.id,f,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,f,_,E){for(const S of f)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(o,this._featureMap,c,S,_,E)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Ty={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ay(a,o){return Ty[a]||[a.replace(`${o}-`,"").replace(/-/g,"_")]}const mC={"line-pattern":{source:Bt,composite:Bt},"fill-pattern":{source:Bt,composite:Bt},"fill-extrusion-pattern":{source:Bt,composite:Bt},"line-dasharray":{source:rn,composite:rn}},nA={color:{source:cu,composite:xn},number:{source:$o,composite:cu}};function Py(a,o,c){const f=mC[a];return f&&f[c]||nA[o][c]}On(Br,"ConstantBinder"),On(Fc,"PatternConstantBinder"),On(Wl,"SourceExpressionBinder"),On(Yd,"PatternCompositeBinder"),On(Bs,"CompositeExpressionBinder"),On(Lu,"ProgramConfiguration",{omit:["_buffers"]}),On(fc,"ProgramConfigurationSet");const pc="-transition";class dl extends ba{constructor(o,c){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&"sky"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),c.layout&&(this._unevaluatedLayout=new Te(c.layout)),c.paint)){this._transitionablePaint=new J(c.paint);for(const f in o.paint)this.setPaintProperty(f,o.paint[f],{validate:!1});for(const f in o.layout)this.setLayoutProperty(f,o.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Le(c.paint)}}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c,f={}){null!=c&&this._validate(lt,`layers.${this.id}.layout.${o}`,o,c,f)||("visibility"!==o?this._unevaluatedLayout.setValue(o,c):this.visibility=c)}getPaintProperty(o){return Jn(o,pc)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c,f={}){if(null!=c&&this._validate(Oe,`layers.${this.id}.paint.${o}`,o,c,f))return!1;if(Jn(o,pc))return this._transitionablePaint.setTransition(o.slice(0,-11),c||void 0),!1;{const _=this._transitionablePaint._values[o],E=_.value.isDataDriven(),S=_.value;this._transitionablePaint.setValue(o,c),this._handleSpecialPaintPropertyUpdate(o);const T=this._transitionablePaint._values[o].value,O=T.isDataDriven(),k=Jn(o,"pattern")||"line-dasharray"===o;return O||E||k||this._handleOverridablePaintPropertyUpdate(o,S,T)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,c,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),Qn(o,(c,f)=>!(void 0===c||"layout"===f&&!Object.keys(c).length||"paint"===f&&!Object.keys(c).length))}_validate(o,c,f,_,E={}){return(!E||!1!==E.validate)&&Zt(this,o.call(ie,{key:c,layerType:this.type,objectKey:f,value:_,styleSpec:Qt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof Pe&&xr(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=lu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Jx=bt([{name:"a_pos",components:2,type:"Int16"}],4),cp=bt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Jo{constructor(o=[]){this.segments=o}prepareSegment(o,c,f,_){let E=this.segments[this.segments.length-1];return o>Jo.MAX_VERTEX_ARRAY_LENGTH&&Ii(`Max vertices per segment is ${Jo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!E||E.vertexLength+o>Jo.MAX_VERTEX_ARRAY_LENGTH||E.sortKey!==_)&&(E={vertexOffset:c.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},void 0!==_&&(E.sortKey=_),this.segments.push(E)),E}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,f,_){return new Jo([{vertexOffset:o,primitiveOffset:c,vertexLength:f,primitiveLength:_,vaos:{},sortKey:0}])}}Jo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,On(Jo,"SegmentVector");var Ei=8192;class Kd{constructor(o,c){o&&(c?this.setSouthWest(o).setNorthEast(c):4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof Ur?new Ur(o.lng,o.lat):Ur.convert(o),this}setSouthWest(o){return this._sw=o instanceof Ur?new Ur(o.lng,o.lat):Ur.convert(o),this}extend(o){const c=this._sw,f=this._ne;let _,E;if(o instanceof Ur)_=o,E=o;else{if(!(o instanceof Kd))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(Kd.convert(o)):this.extend(Ur.convert(o)):"object"==typeof o&&null!==o&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(Ur.convert(o)):this;if(_=o._sw,E=o._ne,!_||!E)return this}return c||f?(c.lng=Math.min(_.lng,c.lng),c.lat=Math.min(_.lat,c.lat),f.lng=Math.max(E.lng,f.lng),f.lat=Math.max(E.lat,f.lat)):(this._sw=new Ur(_.lng,_.lat),this._ne=new Ur(E.lng,E.lat)),this}getCenter(){return new Ur((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ur(this.getWest(),this.getNorth())}getSouthEast(){return new Ur(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:c,lat:f}=Ur.convert(o);let _=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&_}static convert(o){return!o||o instanceof Kd?o:new Kd(o)}}var kg=1e-6,Bc=typeof Float32Array<"u"?Float32Array:Array;function Lg(){var a=new Bc(9);return Bc!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Ng(a,o,c){var f=o[0],_=o[1],E=o[2],S=o[3],T=o[4],O=o[5],k=o[6],V=o[7],j=o[8],$=c[0],W=c[1],K=c[2],te=c[3],ve=c[4],Be=c[5],Je=c[6],Ne=c[7],Ze=c[8];return a[0]=$*f+W*S+K*k,a[1]=$*_+W*T+K*V,a[2]=$*E+W*O+K*j,a[3]=te*f+ve*S+Be*k,a[4]=te*_+ve*T+Be*V,a[5]=te*E+ve*O+Be*j,a[6]=Je*f+Ne*S+Ze*k,a[7]=Je*_+Ne*T+Ze*V,a[8]=Je*E+Ne*O+Ze*j,a}function Nu(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function fm(a,o){var c=o[0],f=o[1],_=o[2],E=o[3],S=o[4],T=o[5],O=o[6],k=o[7],V=o[8],j=o[9],$=o[10],W=o[11],K=o[12],te=o[13],ve=o[14],Be=o[15],Je=c*T-f*S,Ne=c*O-_*S,Ze=c*k-E*S,rt=f*O-_*T,st=f*k-E*T,Vt=_*k-E*O,At=V*te-j*K,en=V*ve-$*K,bn=V*Be-W*K,$t=j*ve-$*te,an=j*Be-W*te,ln=$*Be-W*ve,gn=Je*ln-Ne*an+Ze*$t+rt*bn-st*en+Vt*At;return gn?(a[0]=(T*ln-O*an+k*$t)*(gn=1/gn),a[1]=(_*an-f*ln-E*$t)*gn,a[2]=(te*Vt-ve*st+Be*rt)*gn,a[3]=($*st-j*Vt-W*rt)*gn,a[4]=(O*bn-S*ln-k*en)*gn,a[5]=(c*ln-_*bn+E*en)*gn,a[6]=(ve*Ze-K*Vt-Be*Ne)*gn,a[7]=(V*Vt-$*Ze+W*Ne)*gn,a[8]=(S*an-T*bn+k*At)*gn,a[9]=(f*bn-c*an-E*At)*gn,a[10]=(K*st-te*Ze+Be*Je)*gn,a[11]=(j*Ze-V*st-W*Je)*gn,a[12]=(T*en-S*$t-O*At)*gn,a[13]=(c*$t-f*en+_*At)*gn,a[14]=(te*Ne-K*rt-ve*Je)*gn,a[15]=(V*rt-j*Ne+$*Je)*gn,a):null}function gf(a,o,c){var f=o[0],_=o[1],E=o[2],S=o[3],T=o[4],O=o[5],k=o[6],V=o[7],j=o[8],$=o[9],W=o[10],K=o[11],te=o[12],ve=o[13],Be=o[14],Je=o[15],Ne=c[0],Ze=c[1],rt=c[2],st=c[3];return a[0]=Ne*f+Ze*T+rt*j+st*te,a[1]=Ne*_+Ze*O+rt*$+st*ve,a[2]=Ne*E+Ze*k+rt*W+st*Be,a[3]=Ne*S+Ze*V+rt*K+st*Je,a[4]=(Ne=c[4])*f+(Ze=c[5])*T+(rt=c[6])*j+(st=c[7])*te,a[5]=Ne*_+Ze*O+rt*$+st*ve,a[6]=Ne*E+Ze*k+rt*W+st*Be,a[7]=Ne*S+Ze*V+rt*K+st*Je,a[8]=(Ne=c[8])*f+(Ze=c[9])*T+(rt=c[10])*j+(st=c[11])*te,a[9]=Ne*_+Ze*O+rt*$+st*ve,a[10]=Ne*E+Ze*k+rt*W+st*Be,a[11]=Ne*S+Ze*V+rt*K+st*Je,a[12]=(Ne=c[12])*f+(Ze=c[13])*T+(rt=c[14])*j+(st=c[15])*te,a[13]=Ne*_+Ze*O+rt*$+st*ve,a[14]=Ne*E+Ze*k+rt*W+st*Be,a[15]=Ne*S+Ze*V+rt*K+st*Je,a}function up(a,o,c){var f,_,E,S,T,O,k,V,j,$,W,K,te=c[0],ve=c[1],Be=c[2];return o===a?(a[12]=o[0]*te+o[4]*ve+o[8]*Be+o[12],a[13]=o[1]*te+o[5]*ve+o[9]*Be+o[13],a[14]=o[2]*te+o[6]*ve+o[10]*Be+o[14],a[15]=o[3]*te+o[7]*ve+o[11]*Be+o[15]):(_=o[1],E=o[2],S=o[3],T=o[4],O=o[5],k=o[6],V=o[7],j=o[8],$=o[9],W=o[10],K=o[11],a[0]=f=o[0],a[1]=_,a[2]=E,a[3]=S,a[4]=T,a[5]=O,a[6]=k,a[7]=V,a[8]=j,a[9]=$,a[10]=W,a[11]=K,a[12]=f*te+T*ve+j*Be+o[12],a[13]=_*te+O*ve+$*Be+o[13],a[14]=E*te+k*ve+W*Be+o[14],a[15]=S*te+V*ve+K*Be+o[15]),a}function Qd(a,o,c){var f=c[0],_=c[1],E=c[2];return a[0]=o[0]*f,a[1]=o[1]*f,a[2]=o[2]*f,a[3]=o[3]*f,a[4]=o[4]*_,a[5]=o[5]*_,a[6]=o[6]*_,a[7]=o[7]*_,a[8]=o[8]*E,a[9]=o[9]*E,a[10]=o[10]*E,a[11]=o[11]*E,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a}function Fg(a,o,c){var f=Math.sin(c),_=Math.cos(c),E=o[4],S=o[5],T=o[6],O=o[7],k=o[8],V=o[9],j=o[10],$=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=E*_+k*f,a[5]=S*_+V*f,a[6]=T*_+j*f,a[7]=O*_+$*f,a[8]=k*_-E*f,a[9]=V*_-S*f,a[10]=j*_-T*f,a[11]=$*_-O*f,a}function pm(a,o,c){var f=Math.sin(c),_=Math.cos(c),E=o[0],S=o[1],T=o[2],O=o[3],k=o[8],V=o[9],j=o[10],$=o[11];return o!==a&&(a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=E*_-k*f,a[1]=S*_-V*f,a[2]=T*_-j*f,a[3]=O*_-$*f,a[8]=E*f+k*_,a[9]=S*f+V*_,a[10]=T*f+j*_,a[11]=O*f+$*_,a}function Ry(a,o){return a[0]=o[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=o[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Oy(a,o,c){var f,_,E,S=c[0],T=c[1],O=c[2],k=Math.hypot(S,T,O);return k<kg?null:(S*=k=1/k,T*=k,O*=k,f=Math.sin(o),_=Math.cos(o),a[0]=S*S*(E=1-_)+_,a[1]=T*S*E+O*f,a[2]=O*S*E-T*f,a[3]=0,a[4]=S*T*E-O*f,a[5]=T*T*E+_,a[6]=O*T*E+S*f,a[7]=0,a[8]=S*O*E+T*f,a[9]=T*O*E-S*f,a[10]=O*O*E+_,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,o=arguments.length;o--;)a+=arguments[o]*arguments[o];return Math.sqrt(a)});var ky=gf;function Ly(){var a=new Bc(3);return Bc!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function eb(a){var o=new Bc(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o}function hl(a){return Math.hypot(a[0],a[1],a[2])}function Fu(a,o,c){var f=new Bc(3);return f[0]=a,f[1]=o,f[2]=c,f}function es(a,o,c){return a[0]=o[0]+c[0],a[1]=o[1]+c[1],a[2]=o[2]+c[2],a}function Ny(a,o,c){return a[0]=o[0]-c[0],a[1]=o[1]-c[1],a[2]=o[2]-c[2],a}function tb(a,o,c){return a[0]=o[0]*c[0],a[1]=o[1]*c[1],a[2]=o[2]*c[2],a}function mm(a,o,c){return a[0]=Math.min(o[0],c[0]),a[1]=Math.min(o[1],c[1]),a[2]=Math.min(o[2],c[2]),a}function gm(a,o,c){return a[0]=Math.max(o[0],c[0]),a[1]=Math.max(o[1],c[1]),a[2]=Math.max(o[2],c[2]),a}function zc(a,o,c){return a[0]=o[0]*c,a[1]=o[1]*c,a[2]=o[2]*c,a}function dp(a,o,c,f){return a[0]=o[0]+c[0]*f,a[1]=o[1]+c[1]*f,a[2]=o[2]+c[2]*f,a}function fl(a,o){var c=o[0],f=o[1],_=o[2],E=c*c+f*f+_*_;return E>0&&(E=1/Math.sqrt(E)),a[0]=o[0]*E,a[1]=o[1]*E,a[2]=o[2]*E,a}function pl(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]}function Fy(a,o,c){var f=o[0],_=o[1],E=o[2],S=c[0],T=c[1],O=c[2];return a[0]=_*O-E*T,a[1]=E*S-f*O,a[2]=f*T-_*S,a}function zs(a,o,c){var f=o[0],_=o[1],E=o[2],S=c[3]*f+c[7]*_+c[11]*E+c[15];return a[0]=(c[0]*f+c[4]*_+c[8]*E+c[12])/(S=S||1),a[1]=(c[1]*f+c[5]*_+c[9]*E+c[13])/S,a[2]=(c[2]*f+c[6]*_+c[10]*E+c[14])/S,a}function _m(a,o,c){var f=c[0],_=c[1],E=c[2],S=o[0],T=o[1],O=o[2],k=_*O-E*T,V=E*S-f*O,j=f*T-_*S,$=_*j-E*V,W=E*k-f*j,K=f*V-_*k,te=2*c[3];return V*=te,j*=te,W*=2,K*=2,a[0]=S+(k*=te)+($*=2),a[1]=T+V+W,a[2]=O+j+K,a}var Eh,uu=Ny,nb=tb,ib=hl;function rb(a,o,c){return a[0]=o[0]*c,a[1]=o[1]*c,a[2]=o[2]*c,a[3]=o[3]*c,a}function _f(a,o){var c=o[0],f=o[1],_=o[2],E=o[3],S=c*c+f*f+_*_+E*E;return S>0&&(S=1/Math.sqrt(S)),a[0]=c*S,a[1]=f*S,a[2]=_*S,a[3]=E*S,a}function nd(a,o,c){var f=o[0],_=o[1],E=o[2],S=o[3];return a[0]=c[0]*f+c[4]*_+c[8]*E+c[12]*S,a[1]=c[1]*f+c[5]*_+c[9]*E+c[13]*S,a[2]=c[2]*f+c[6]*_+c[10]*E+c[14]*S,a[3]=c[3]*f+c[7]*_+c[11]*E+c[15]*S,a}function ob(){var a=new Bc(4);return Bc!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function gC(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function Bg(a,o,c){c*=.5;var f=o[0],_=o[1],E=o[2],S=o[3],T=Math.sin(c),O=Math.cos(c);return a[0]=f*O+S*T,a[1]=_*O+E*T,a[2]=E*O-_*T,a[3]=S*O-f*T,a}function _C(a,o,c){c*=.5;var f=o[0],_=o[1],E=o[2],S=o[3],T=Math.sin(c),O=Math.cos(c);return a[0]=f*O-E*T,a[1]=_*O+S*T,a[2]=E*O+f*T,a[3]=S*O-_*T,a}Ly(),Eh=new Bc(4),Bc!=Float32Array&&(Eh[0]=0,Eh[1]=0,Eh[2]=0,Eh[3]=0);var yC=_f;Ly(),Fu(1,0,0),Fu(0,1,0),ob(),ob(),Lg();const vC=bt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:xC}=vC,bC=bt([{name:"a_pos_3",components:3,type:"Int16"}]);var yf=bt([{name:"a_pos",type:"Int16",components:2}]);class vf{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,f){const _=pl(c,this.dir);if(Math.abs(_)<1e-6)return!1;const E=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1]+(o[2]-this.pos[2])*c[2])/_;return f[0]=this.pos[0]+this.dir[0]*E,f[1]=this.pos[1]+this.dir[1]*E,f[2]=this.pos[2]+this.dir[2]*E,!0}closestPointOnSphere(o,c,f){if(te=(W=this.pos)[0],ve=W[1],Be=W[2],Je=(K=o)[0],Ne=K[1],Ze=K[2],Math.abs(te-Je)<=kg*Math.max(1,Math.abs(te),Math.abs(Je))&&Math.abs(ve-Ne)<=kg*Math.max(1,Math.abs(ve),Math.abs(Ne))&&Math.abs(Be-Ze)<=kg*Math.max(1,Math.abs(Be),Math.abs(Ze))||0===c)return f[0]=f[1]=f[2]=0,!1;var W,K,te,ve,Be,Je,Ne,Ze;const[_,E,S]=this.dir,T=this.pos[0]-o[0],O=this.pos[1]-o[1],k=this.pos[2]-o[2],V=_*_+E*E+S*S,j=2*(T*_+O*E+k*S),$=j*j-4*V*(T*T+O*O+k*k-c*c);if($<0){const W=Math.max(-j/2,0),K=T+_*W,te=O+E*W,ve=k+S*W,Be=Math.hypot(K,te,ve);return f[0]=K*c/Be,f[1]=te*c/Be,f[2]=ve*c/Be,!1}{const W=(-j-Math.sqrt($))/(2*V);if(W<0){const K=Math.hypot(T,O,k);return f[0]=T*c/K,f[1]=O*c/K,f[2]=k*c/K,!1}return f[0]=T+_*W,f[1]=O+E*W,f[2]=k+S*W,!0}}}class By{constructor(o,c,f,_,E){this.TL=o,this.TR=c,this.BR=f,this.BL=_,this.horizon=E}static fromInvProjectionMatrix(o,c,f){const _=[-1,1,1],E=[1,1,1],S=[1,-1,1],T=[-1,-1,1],O=zs(_,_,o),k=zs(E,E,o),V=zs(S,S,o),j=zs(T,T,o);return new By(O,k,V,j,c/f)}}class xf{constructor(o,c){this.points=o,this.planes=c}static fromInvProjectionMatrix(o,c,f,_){const E=Math.pow(2,f),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const k=nd([],O,o),V=1/k[3]/c*E;return(j=k)[0]=($=k)[0]*(W=[V,V,_?1/k[3]:V,V])[0],j[1]=$[1]*W[1],j[2]=$[2]*W[2],j[3]=$[3]*W[3],j;var j,$,W}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const k=fl([],Fy([],uu([],S[O[0]],S[O[1]]),uu([],S[O[2]],S[O[1]]))),V=-pl(k,S[O[1]]);return k.concat(V)});return new xf(S,T)}}class Al{static fromPoints(o){const c=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const _ of o)mm(c,c,_),gm(f,f,_);return new Al(c,f)}static applyTransform(o,c){const f=o.getCorners();for(let _=0;_<f.length;++_)zs(f[_],f[_],c);return Al.fromPoints(f)}constructor(o,c){this.min=o,this.max=c,this.center=zc([],es([],this.min,this.max),.5)}quadrant(o){const c=[o%2==0,o<2],f=eb(this.min),_=eb(this.max);for(let E=0;E<c.length;E++)f[E]=c[E]?this.min[E]:this.center[E],_[E]=c[E]?this.center[E]:this.max[E];return _[2]=this.max[2],new Al(f,_)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,c=this.max;return[[o[0],o[1],o[2]],[c[0],o[1],o[2]],[c[0],c[1],o[2]],[o[0],c[1],o[2]],[o[0],o[1],c[2]],[c[0],o[1],c[2]],[c[0],c[1],c[2]],[o[0],c[1],c[2]]]}intersects(o){const c=this.getCorners();let f=!0;for(let _=0;_<o.planes.length;_++){const E=o.planes[_];let S=0;for(let T=0;T<c.length;T++)S+=pl(E,c[T])+E[3]>=0;if(0===S)return 0;S!==c.length&&(f=!1)}if(f)return 2;for(let _=0;_<3;_++){let E=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let T=0;T<o.points.length;T++){const O=o.points[T][_]-this.min[_];E=Math.min(E,O),S=Math.max(S,O)}if(S<0||E>this.max[_]-this.min[_])return 0}return 1}}const hp=5,wC=6,id=Ei/Math.PI/2,sb=16383,Vc=[64,32,16],Bu=-id,Ac=id,zy=[new Al([Bu,Bu,Bu],[Ac,Ac,Ac]),new Al([Bu,Bu,Bu],[0,0,Ac]),new Al([0,Bu,Bu],[Ac,0,Ac]),new Al([Bu,0,Bu],[0,Ac,Ac]),new Al([0,0,Bu],[Ac,Ac,Ac])];function ym(a){return a*id/vd}function vm(a,o,c,f=!0){const _=zc([],a._camera.position,a.worldSize),E=[o,c,1,1];nd(E,E,a.pixelMatrixInverse),rb(E,E,1/E[3]);const S=fl([],uu([],E,_)),T=a.globeMatrix,O=[T[12],T[13],T[14]],k=uu([],O,_),V=hl(k),j=fl([],k),$=a.worldSize/(2*Math.PI),W=pl(j,S),K=Math.asin($/V);if(K<Math.acos(W)){if(!f)return null;const bn=[],$t=[];zc(bn,S,V/W),fl($t,uu($t,bn,k)),fl(S,es(S,k,zc(S,$t,Math.tan(K)*V)))}const te=[];new vf(_,S).closestPointOnSphere(O,$,te);const ve=fl([],$e(T,0)),Be=fl([],$e(T,1)),Je=fl([],$e(T,2)),Ne=pl(ve,te),Ze=pl(Be,te),rt=pl(Je,te),st=Ue(Math.asin(-Ze/$));let Vt=Ue(Math.atan2(Ne,rt));Vt=a.center.lng+function(bn,$t){const an=($t-bn+180)%360-180;return an<-180?an+360:an}(a.center.lng,Vt);const At=bd(Vt),en=Ee(eh(st),0,1);return new _p(At,en)}class Vy{constructor(o,c,f){this.a=uu([],o,f),this.b=uu([],c,f),this.center=f;const _=fl([],this.a),E=fl([],this.b);this.angle=Math.acos(pl(_,E))}}function Uy(a,o){if(0===a.angle)return null;let c;return c=0===a.a[o]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[o]/a.a[o]/Math.sin(a.angle)-1/Math.tan(a.angle)),c<0||c>1?null:function(f,_,E,S){const T=Math.sin(E);return f*(Math.sin((1-S)*E)/T)+_*(Math.sin(S*E)/T)}(a.a[o],a.b[o],a.angle,Ee(c,0,1))+a.center[o]}function rd(a){if(a.z<=1)return zy[a.z+2*a.y+a.x];const o=Jd(wf(a));return Al.fromPoints(o)}function Ch(a,o,c){return zc(a,a,1-c),dp(a,a,o,c)}function jy(a,o){const c=Mh(o.zoom);if(0===c)return rd(a);const f=wf(a),_=Jd(f),E=bd(f.getWest())*o.worldSize,S=bd(f.getEast())*o.worldSize,T=eh(f.getNorth())*o.worldSize,O=eh(f.getSouth())*o.worldSize,k=[E,T,0],V=[S,T,0],j=[E,O,0],$=[S,O,0],W=fm([],o.globeMatrix);return zs(k,k,W),zs(V,V,W),zs(j,j,W),zs($,$,W),_[0]=Ch(_[0],j,c),_[1]=Ch(_[1],$,c),_[2]=Ch(_[2],V,c),_[3]=Ch(_[3],k,c),Al.fromPoints(_)}function Gy(a,o,c){for(const f of a)zs(f,f,o),zc(f,f,c)}function wf({x:a,y:o,z:c}){const f=1/(1<<c),_=new Ur(zu(a*f),Zl((o+1)*f)),E=new Ur(zu((a+1)*f),Zl(o*f));return new Kd(_,E)}function Jd(a){const o=ot(a.getNorth()),c=ot(a.getSouth()),f=Math.cos(o),_=Math.cos(c),E=Math.sin(o),S=Math.sin(c),T=a.getWest(),O=a.getEast();return[fp(_,S,T),fp(_,S,O),fp(f,E,O),fp(f,E,T)]}function fp(a,o,c,f=id){return c=ot(c),[a*Math.sin(c)*f,-o*f,a*Math.cos(c)*f]}function Ef(a,o,c){return fp(Math.cos(ot(a)),Math.sin(ot(a)),o,c)}function pp(a,o,c,f){const _=1<<c.z,E=(a/Ei+c.x)/_;return Ef(Zl((o/Ei+c.y)/_),zu(E),f)}function Sh({min:a,max:o}){return sb/Math.max(o[0]-a[0],o[1]-a[1],o[2]-a[2])}const ab=new Float64Array(16);function ml(a){const o=Sh(a),c=Ry(ab,[o,o,o]);return up(c,c,((f=[])[0]=-(_=a.min)[0],f[1]=-_[1],f[2]=-_[2],f));var f,_}function $y(a){const o=(f=a.min,(c=ab)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c);var c,f;const _=1/Sh(a);return Qd(o,o,[_,_,_])}function gl(a,o,c,f,_){const E=function(O){const k=Ei/(2*Math.PI);return O/(2*Math.PI)/k}(c),S=[a,o,-c/(2*Math.PI)],T=Nu(new Float64Array(16));return up(T,T,S),Qd(T,T,[E,E,E]),Fg(T,T,ot(-_)),pm(T,T,ot(-f)),T}function Mh(a){return dt(hp,wC,a)}function lb(a,o){const c=Ef(o.lat,o.lng);return S=(_=Ny([],function(K){const te=Ef(K._center.lat,K._center.lng);let ve=Fy([],Fu(0,1,0),te);const Be=Oy([],-K.angle,te);ve=zs(ve,ve,Be),Oy(Be,-K._pitch,ve);const Je=fl([],te);return zc(Je,Je,ym(K.cameraToCenterDistance/K.pixelsPerMeter)),zs(Je,Je,Be),es([],te,Je)}(a),c))[0],T=_[1],O=_[2],k=(E=c)[0],V=E[1],j=E[2],W=($=Math.sqrt(S*S+T*T+O*O)*Math.sqrt(k*k+V*V+j*j))&&pl(_,E)/$,Math.acos(Math.min(Math.max(W,-1),1));var _,E,S,T,O,k,V,j,$,W}function zg(a,o){return lb(a,o)>Math.PI/2*1.01}const Cf=ot(85),mp=Math.cos(Cf),gp=Math.sin(Cf),vd=6371008.8,Hy=2*Math.PI*vd;class xd{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xd(Re(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,f=this.lat*c,_=o.lat*c,E=Math.sin(f)*Math.sin(_)+Math.cos(f)*Math.cos(_)*Math.cos((o.lng-this.lng)*c);return vd*Math.acos(Math.min(E,1))}toBounds(o=0){const c=360*o/40075017,f=c/Math.cos(Math.PI/180*this.lat);return new Kd(new xd(this.lng-f,this.lat-c),new xd(this.lng+f,this.lat+c))}toEcef(o){const c=ym(o);return Ef(this.lat,this.lng,id+c)}static convert(o){if(o instanceof xd)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new xd(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new xd(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Ur=xd;function cb(a){return Hy*Math.cos(a*Math.PI/180)}function bd(a){return(180+a)/360}function eh(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function wd(a,o){return a/cb(o)}function zu(a){return 360*a-180}function Zl(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function CC(a,o){return a*cb(Zl(o))}const Xl=85.051129;function Sf(a){return 1/Math.cos(a*Math.PI/180)}class _p{constructor(o,c,f=0){this.x=+o,this.y=+c,this.z=+f}static fromLngLat(o,c=0){const f=Ur.convert(o);return new _p(bd(f.lng),eh(f.lat),wd(c,f.lat))}toLngLat(){return new Ur(zu(this.x),Zl(this.y))}toAltitude(){return CC(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Hy*Sf(Zl(this.y))}}function qy(a,o,c,f,_,E,S,T,O){const k=(o+f)/2,V=(c+_)/2,j=new re(k,V);T(j),function($,W,K,te,ve,Be){const Je=K-ve,Ne=te-Be;return Math.abs((te-W)*Je-(K-$)*Ne)/Math.hypot(Je,Ne)}(j.x,j.y,E.x,E.y,S.x,S.y)>=O?(qy(a,o,c,k,V,E,j,T,O),qy(a,k,V,f,_,j,S,T,O)):a.push(S)}function tl(a,o,c){let f=a[0],_=f.x,E=f.y;o(f);const S=[f];for(let T=1;T<a.length;T++){const O=a[T],{x:k,y:V}=O;o(O),qy(S,_,E,k,V,f,O,o,c),_=k,E=V,f=O}return S}function Wy(a,o,c,f){if(f(o,c)){const _=o.add(c)._mult(.5);Wy(a,o,_,f),Wy(a,_,c,f)}else a.push(c)}function xm(a,o){let c=a[0];const f=[c];for(let _=1;_<a.length;_++){const E=a[_];Wy(f,c,E,o),c=E}return f}const Zy=Math.pow(2,14)-1,du=-Zy-1;function yp(a,o){const c=Math.round(a.x*o),f=Math.round(a.y*o);return a.x=Ee(c,du,Zy),a.y=Ee(f,du,Zy),(c<a.x||c>a.x+1||f<a.y||f>a.y+1)&&Ii("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Ed(a,o,c){const f=a.loadGeometry(),_=a.extent,E=Ei/_;if(o&&c&&c.projection.isReprojectedInTileSpace){const S=1<<o.z,{scale:T,x:O,y:k,projection:V}=c,j=$=>{const W=zu((o.x+$.x/_)/S),K=Zl((o.y+$.y/_)/S),te=V.project(W,K);$.x=(te.x*T-O)*_,$.y=(te.y*T-k)*_};for(let $=0;$<f.length;$++)if(1!==a.type)f[$]=tl(f[$],j,1);else{const W=[];for(const K of f[$])K.x<0||K.x>=_||K.y<0||K.y>=_||(j(K),W.push(K));f[$]=W}}for(const S of f)for(const T of S)yp(T,E);return f}function Cd(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?Ed(a):[]}}function Ih(a,o,c,f,_){a.emplaceBack(2*o+(f+1)/2,2*c+(_+1)/2)}function Vg(a,o,c){a.emplaceBack(o.x,o.y,o.z,16384*c[0],16384*c[1],16384*c[2])}class ub{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new En,this.indexArray=new di,this.segments=new Jo,this.programConfigurations=new fc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,f,_){const E=this.layers[0],S=[];let T=null;"circle"===E.type&&(T=E.layout.get("circle-sort-key"));for(const{feature:k,id:V,index:j,sourceLayerIndex:$}of o){const W=this.layers[0]._featureFilter.needGeometry,K=Cd(k,W);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),K,f))continue;const te=T?T.evaluate(K,{},f):void 0,ve={id:V,properties:k.properties,type:k.type,sourceLayerIndex:$,index:j,geometry:W?K.geometry:Ed(k,f,_),patterns:{},sortKey:te};S.push(ve)}T&&S.sort((k,V)=>k.sortKey-V.sortKey);let O=null;"globe"===_.projection.name&&(this.globeExtVertexArray=new wn,O=_.projection);for(const k of S){const{geometry:V,index:j,sourceLayerIndex:$}=k,W=o[j].feature;this.addFeature(k,V,j,c.availableImages,f,O),c.featureIndex.insert(W,V,j,$,this.index)}}update(o,c,f,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Jx.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,cp.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,c,f,_,E,S){for(const T of c)for(const O of T){const k=O.x,V=O.y;if(k<0||k>=Ei||V<0||V>=Ei)continue;if(S){const W=S.projectTilePoint(k,V,E),K=S.upVector(E,k,V),te=this.globeExtVertexArray;Vg(te,W,K),Vg(te,W,K),Vg(te,W,K),Vg(te,W,K)}const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),$=j.vertexLength;Ih(this.layoutVertexArray,k,V,-1,-1),Ih(this.layoutVertexArray,k,V,1,-1),Ih(this.layoutVertexArray,k,V,1,1),Ih(this.layoutVertexArray,k,V,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{},_,E)}}function db(a,o){for(let c=0;c<a.length;c++)if(Mf(o,a[c]))return!0;for(let c=0;c<o.length;c++)if(Mf(a,o[c]))return!0;return!!Dh(a,o)}function iA(a,o,c){return!!Mf(a,o)||!!Ug(o,a,c)}function Uc(a,o){if(1===a.length)return fb(o,a[0]);for(let c=0;c<o.length;c++){const f=o[c];for(let _=0;_<f.length;_++)if(Mf(a,f[_]))return!0}for(let c=0;c<a.length;c++)if(fb(o,a[c]))return!0;for(let c=0;c<o.length;c++)if(Dh(a,o[c]))return!0;return!1}function Xy(a,o,c){if(a.length>1){if(Dh(a,o))return!0;for(let f=0;f<o.length;f++)if(Ug(o[f],a,c))return!0}for(let f=0;f<a.length;f++)if(Ug(a[f],o,c))return!0;return!1}function Dh(a,o){if(0===a.length||0===o.length)return!1;for(let c=0;c<a.length-1;c++){const f=a[c],_=a[c+1];for(let E=0;E<o.length-1;E++)if(rA(f,_,o[E],o[E+1]))return!0}return!1}function rA(a,o,c,f){return vr(a,c,f)!==vr(o,c,f)&&vr(a,o,c)!==vr(a,o,f)}function Ug(a,o,c){const f=c*c;if(1===o.length)return a.distSqr(o[0])<f;for(let _=1;_<o.length;_++)if(hb(a,o[_-1],o[_])<f)return!0;return!1}function hb(a,o,c){const f=o.distSqr(c);if(0===f)return a.distSqr(o);const _=((a.x-o.x)*(c.x-o.x)+(a.y-o.y)*(c.y-o.y))/f;return a.distSqr(_<0?o:_>1?c:c.sub(o)._mult(_)._add(o))}function fb(a,o){let c,f,_,E=!1;for(let S=0;S<a.length;S++){c=a[S];for(let T=0,O=c.length-1;T<c.length;O=T++)f=c[T],_=c[O],f.y>o.y!=_.y>o.y&&o.x<(_.x-f.x)*(o.y-f.y)/(_.y-f.y)+f.x&&(E=!E)}return E}function Mf(a,o){let c=!1;for(let f=0,_=a.length-1;f<a.length;_=f++){const E=a[f],S=a[_];E.y>o.y!=S.y>o.y&&o.x<(S.x-E.x)*(o.y-E.y)/(S.y-E.y)+E.x&&(c=!c)}return c}function pb(a,o,c,f,_){for(const S of a)if(o<=S.x&&c<=S.y&&f>=S.x&&_>=S.y)return!0;const E=[new re(o,c),new re(o,_),new re(f,_),new re(f,c)];if(a.length>2)for(const S of E)if(Mf(a,S))return!0;for(let S=0;S<a.length-1;S++)if(SC(a[S],a[S+1],E))return!0;return!1}function SC(a,o,c){const f=c[0],_=c[2];if(a.x<f.x&&o.x<f.x||a.x>_.x&&o.x>_.x||a.y<f.y&&o.y<f.y||a.y>_.y&&o.y>_.y)return!1;const E=vr(a,o,c[0]);return E!==vr(a,o,c[1])||E!==vr(a,o,c[2])||E!==vr(a,o,c[3])}function vp(a,o,c){const f=o.paint.get(a).value;return"constant"===f.kind?f.value:c.programConfigurations.get(o.id).getMaxValue(a)}function xp(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function bm(a,o,c,f,_){if(!o[0]&&!o[1])return a;const E=re.convert(o)._mult(_);"viewport"===c&&E._rotate(-f);const S=[];for(let T=0;T<a.length;T++)S.push(a[T].sub(E));return S}function mb(a,o,c,f){const _=re.convert(a)._mult(f);return"viewport"===o&&_._rotate(-c),_}On(ub,"CircleBucket",{omit:["layers"]});const If=new We({"circle-sort-key":new Se(Qt.layout_circle["circle-sort-key"])});var MC={paint:new We({"circle-radius":new Se(Qt.paint_circle["circle-radius"]),"circle-color":new Se(Qt.paint_circle["circle-color"]),"circle-blur":new Se(Qt.paint_circle["circle-blur"]),"circle-opacity":new Se(Qt.paint_circle["circle-opacity"]),"circle-translate":new ee(Qt.paint_circle["circle-translate"]),"circle-translate-anchor":new ee(Qt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ee(Qt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ee(Qt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Se(Qt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Se(Qt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Se(Qt.paint_circle["circle-stroke-opacity"])}),layout:If};function bp(a,o,c,f,_,E,S,T,O){if(E&&a.queryGeometry.isAboveHorizon)return!1;E&&(O*=a.pixelToTileUnitsFactor);const k=a.tileID.canonical,V=c.projection.upVectorScale(k,c.center.lat,c.worldSize).metersToTile;for(const j of o)for(const $ of j){const W=$.add(T),K=_&&c.elevation?c.elevation.exaggeration()*_.getElevationAt(W.x,W.y,!0):0,te=c.projection.projectTilePoint(W.x,W.y,k);if(K>0){const Ne=c.projection.upVector(k,W.x,W.y);te.x+=Ne[0]*V*K,te.y+=Ne[1]*V*K,te.z+=Ne[2]*V*K}const ve=E?W:IC(te.x,te.y,te.z,f),Be=E?a.tilespaceRays.map(Ne=>jg(Ne,K)):a.queryGeometry.screenGeometry,Je=nd([],[te.x,te.y,te.z,1],f);if(!S&&E?O*=Je[3]/c.cameraToCenterDistance:S&&!E&&(O*=c.cameraToCenterDistance/Je[3]),E){const Ne=Zl(($.y/Ei+k.y)/(1<<k.z));O/=c.projection.pixelsPerMeter(Ne,1)/wd(1,Ne)}if(iA(Be,ve,O))return!0}return!1}function IC(a,o,c,f){const _=nd([],[a,o,c,1],f);return new re(_[0]/_[3],_[1]/_[3])}const Yy=Fu(0,0,0),Ky=Fu(0,0,1);function jg(a,o){const c=Ly();return Yy[2]=o,a.intersectsPlane(Yy,Ky,c),new re(c[0],c[1])}class Qy extends ub{}function gb(a,{width:o,height:c},f,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==o*c*f)throw new RangeError("mismatched image size")}else _=new Uint8Array(o*c*f);return a.width=o,a.height=c,a.data=_,a}function _b(a,o,c){const{width:f,height:_}=o;f===a.width&&_===a.height||(Th(a,o,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,f),height:Math.min(a.height,_)},c),a.width=f,a.height=_,a.data=o.data)}function Th(a,o,c,f,_,E){if(0===_.width||0===_.height)return o;if(_.width>a.width||_.height>a.height||c.x>a.width-_.width||c.y>a.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>o.width||_.height>o.height||f.x>o.width-_.width||f.y>o.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const S=a.data,T=o.data;for(let O=0;O<_.height;O++){const k=((c.y+O)*a.width+c.x)*E,V=((f.y+O)*o.width+f.x)*E;for(let j=0;j<_.width*E;j++)T[V+j]=S[k+j]}return o}On(Qy,"HeatmapBucket",{omit:["layers"]});class hu{constructor(o,c){gb(this,o,1,c)}resize(o){_b(this,new hu(o),1)}clone(){return new hu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,f,_,E){Th(o,c,f,_,E,1)}}class jc{constructor(o,c){gb(this,o,4,c)}resize(o){_b(this,new jc(o),4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new jc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,f,_,E){Th(o,c,f,_,E,4)}}On(hu,"AlphaImage"),On(jc,"RGBAImage");var oA={paint:new We({"heatmap-radius":new Se(Qt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Se(Qt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ee(Qt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ge(Qt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ee(Qt.paint_heatmap["heatmap-opacity"])})};function Gg(a){const o={},c=a.resolution||256,f=a.clips?a.clips.length:1,_=a.image||new jc({width:c,height:f}),E=(S,T,O)=>{o[a.evaluationKey]=O;const k=a.expression.evaluate(o);_.data[S+T+0]=Math.floor(255*k.r/k.a),_.data[S+T+1]=Math.floor(255*k.g/k.a),_.data[S+T+2]=Math.floor(255*k.b/k.a),_.data[S+T+3]=Math.floor(255*k.a)};if(a.clips)for(let S=0,T=0;S<f;++S,T+=4*c)for(let O=0,k=0;O<c;O++,k+=4){const V=O/(c-1),{start:j,end:$}=a.clips[S];E(T,k,j*(1-V)+$*V)}else for(let S=0,T=0;S<c;S++,T+=4)E(0,T,S/(c-1));return _}var DC={paint:new We({"hillshade-illumination-direction":new ee(Qt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ee(Qt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ee(Qt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ee(Qt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ee(Qt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ee(Qt.paint_hillshade["hillshade-accent-color"])})};const sA=bt([{name:"a_pos",components:2,type:"Int16"}],4),{members:TC}=sA;var Jy={exports:{}};function $g(a,o,c){c=c||2;var f,_,E,S,T,O,k,V=o&&o.length,j=V?o[0]*c:a.length,$=wm(a,0,j,c,!0),W=[];if(!$||$.next===$.prev)return W;if(V&&($=function(te,ve,Be,Je){var Ne,Ze,rt,st=[];for(Ne=0,Ze=ve.length;Ne<Ze;Ne++)(rt=wm(te,ve[Ne]*Je,Ne<Ze-1?ve[Ne+1]*Je:te.length,Je,!1))===rt.next&&(rt.steiner=!0),st.push(cA(rt));for(st.sort(AC),Ne=0;Ne<st.length;Ne++)Be=PC(st[Ne],Be);return Be}(a,o,$,c)),a.length>80*c){f=E=a[0],_=S=a[1];for(var K=c;K<j;K+=c)(T=a[K])<f&&(f=T),(O=a[K+1])<_&&(_=O),T>E&&(E=T),O>S&&(S=O);k=0!==(k=Math.max(E-f,S-_))?32767/k:0}return Em($,W,c,f,_,k,0),W}function wm(a,o,c,f,_){var E,S;if(_===Oh(a,o,c,f)>0)for(E=o;E<c;E+=f)S=iv(E,a[E],a[E+1],S);else for(E=c-f;E>=o;E-=f)S=iv(E,a[E],a[E+1],S);return S&&tv(S,S.next)&&(wp(S),S=S.next),S}function Ah(a,o){if(!a)return a;o||(o=a);var c,f=a;do{if(c=!1,f.steiner||!tv(f,f.next)&&0!==Pa(f.prev,f,f.next))f=f.next;else{if(wp(f),(f=o=f.prev)===f.next)break;c=!0}}while(c||f!==o);return o}function Em(a,o,c,f,_,E,S){if(a){!S&&E&&function(V,j,$,W){var K=V;do{0===K.z&&(K.z=xb(K.x,K.y,j,$,W)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next}while(K!==V);K.prevZ.nextZ=null,K.prevZ=null,function(te){var ve,Be,Je,Ne,Ze,rt,st,Vt,At=1;do{for(Be=te,te=null,Ze=null,rt=0;Be;){for(rt++,Je=Be,st=0,ve=0;ve<At&&(st++,Je=Je.nextZ);ve++);for(Vt=At;st>0||Vt>0&&Je;)0!==st&&(0===Vt||!Je||Be.z<=Je.z)?(Ne=Be,Be=Be.nextZ,st--):(Ne=Je,Je=Je.nextZ,Vt--),Ze?Ze.nextZ=Ne:te=Ne,Ne.prevZ=Ze,Ze=Ne;Be=Je}Ze.nextZ=null,At*=2}while(rt>1)}(K)}(a,f,_,E);for(var T,O,k=a;a.prev!==a.next;)if(T=a.prev,O=a.next,E?aA(a,f,_,E):yb(a))o.push(T.i/c|0),o.push(a.i/c|0),o.push(O.i/c|0),wp(a),a=O.next,k=O.next;else if((a=O)===k){S?1===S?Em(a=vb(Ah(a),o,c),o,c,f,_,E,2):2===S&&lA(a,o,c,f,_,E):Em(Ah(a),o,c,f,_,E,1);break}}}function yb(a){var o=a.prev,c=a,f=a.next;if(Pa(o,c,f)>=0)return!1;for(var _=o.x,E=c.x,S=f.x,T=o.y,O=c.y,k=f.y,V=_<E?_<S?_:S:E<S?E:S,j=T<O?T<k?T:k:O<k?O:k,$=_>E?_>S?_:S:E>S?E:S,W=T>O?T>k?T:k:O>k?O:k,K=f.next;K!==o;){if(K.x>=V&&K.x<=$&&K.y>=j&&K.y<=W&&Ph(_,T,E,O,S,k,K.x,K.y)&&Pa(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function aA(a,o,c,f){var _=a.prev,E=a,S=a.next;if(Pa(_,E,S)>=0)return!1;for(var T=_.x,O=E.x,k=S.x,V=_.y,j=E.y,$=S.y,W=T<O?T<k?T:k:O<k?O:k,K=V<j?V<$?V:$:j<$?j:$,te=T>O?T>k?T:k:O>k?O:k,ve=V>j?V>$?V:$:j>$?j:$,Be=xb(W,K,o,c,f),Je=xb(te,ve,o,c,f),Ne=a.prevZ,Ze=a.nextZ;Ne&&Ne.z>=Be&&Ze&&Ze.z<=Je;){if(Ne.x>=W&&Ne.x<=te&&Ne.y>=K&&Ne.y<=ve&&Ne!==_&&Ne!==S&&Ph(T,V,O,j,k,$,Ne.x,Ne.y)&&Pa(Ne.prev,Ne,Ne.next)>=0||(Ne=Ne.prevZ,Ze.x>=W&&Ze.x<=te&&Ze.y>=K&&Ze.y<=ve&&Ze!==_&&Ze!==S&&Ph(T,V,O,j,k,$,Ze.x,Ze.y)&&Pa(Ze.prev,Ze,Ze.next)>=0))return!1;Ze=Ze.nextZ}for(;Ne&&Ne.z>=Be;){if(Ne.x>=W&&Ne.x<=te&&Ne.y>=K&&Ne.y<=ve&&Ne!==_&&Ne!==S&&Ph(T,V,O,j,k,$,Ne.x,Ne.y)&&Pa(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.prevZ}for(;Ze&&Ze.z<=Je;){if(Ze.x>=W&&Ze.x<=te&&Ze.y>=K&&Ze.y<=ve&&Ze!==_&&Ze!==S&&Ph(T,V,O,j,k,$,Ze.x,Ze.y)&&Pa(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.nextZ}return!0}function vb(a,o,c){var f=a;do{var _=f.prev,E=f.next.next;!tv(_,E)&&RC(_,f,f.next,E)&&Rh(_,E)&&Rh(E,_)&&(o.push(_.i/c|0),o.push(f.i/c|0),o.push(E.i/c|0),wp(f),wp(f.next),f=a=E),f=f.next}while(f!==a);return Ah(f)}function lA(a,o,c,f,_,E){var S=a;do{for(var T=S.next.next;T!==S.prev;){if(S.i!==T.i&&uA(S,T)){var O=Cm(S,T);return S=Ah(S,S.next),O=Ah(O,O.next),Em(S,o,c,f,_,E,0),void Em(O,o,c,f,_,E,0)}T=T.next}S=S.next}while(S!==a)}function AC(a,o){return a.x-o.x}function PC(a,o){var c=function(_,E){var S,T=E,O=_.x,k=_.y,V=-1/0;do{if(k<=T.y&&k>=T.next.y&&T.next.y!==T.y){var j=T.x+(k-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(j<=O&&j>V&&(V=j,S=T.x<T.next.x?T:T.next,j===O))return S}T=T.next}while(T!==E);if(!S)return null;var $,W=S,K=S.x,te=S.y,ve=1/0;T=S;do{O>=T.x&&T.x>=K&&O!==T.x&&Ph(k<te?O:V,k,K,te,k<te?V:O,k,T.x,T.y)&&($=Math.abs(k-T.y)/(O-T.x),Rh(T,_)&&($<ve||$===ve&&(T.x>S.x||T.x===S.x&&ev(S,T)))&&(S=T,ve=$)),T=T.next}while(T!==W);return S}(a,o);if(!c)return o;var f=Cm(c,a);return Ah(f,f.next),Ah(c,c.next)}function ev(a,o){return Pa(a.prev,a,o.prev)<0&&Pa(o.next,a,a.next)<0}function xb(a,o,c,f,_){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*_|0)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*_|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function cA(a){var o=a,c=a;do{(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next}while(o!==a);return c}function Ph(a,o,c,f,_,E,S,T){return(_-S)*(o-T)>=(a-S)*(E-T)&&(a-S)*(f-T)>=(c-S)*(o-T)&&(c-S)*(E-T)>=(_-S)*(f-T)}function uA(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(c,f){var _=c;do{if(_.i!==c.i&&_.next.i!==c.i&&_.i!==f.i&&_.next.i!==f.i&&RC(_,_.next,c,f))return!0;_=_.next}while(_!==c);return!1}(a,o)&&(Rh(a,o)&&Rh(o,a)&&function(c,f){var _=c,E=!1,S=(c.x+f.x)/2,T=(c.y+f.y)/2;do{_.y>T!=_.next.y>T&&_.next.y!==_.y&&S<(_.next.x-_.x)*(T-_.y)/(_.next.y-_.y)+_.x&&(E=!E),_=_.next}while(_!==c);return E}(a,o)&&(Pa(a.prev,a,o.prev)||Pa(a,o.prev,o))||tv(a,o)&&Pa(a.prev,a,a.next)>0&&Pa(o.prev,o,o.next)>0)}function Pa(a,o,c){return(o.y-a.y)*(c.x-o.x)-(o.x-a.x)*(c.y-o.y)}function tv(a,o){return a.x===o.x&&a.y===o.y}function RC(a,o,c,f){var _=Hg(Pa(a,o,c)),E=Hg(Pa(a,o,f)),S=Hg(Pa(c,f,a)),T=Hg(Pa(c,f,o));return _!==E&&S!==T||!(0!==_||!nv(a,c,o))||!(0!==E||!nv(a,f,o))||!(0!==S||!nv(c,a,f))||!(0!==T||!nv(c,o,f))}function nv(a,o,c){return o.x<=Math.max(a.x,c.x)&&o.x>=Math.min(a.x,c.x)&&o.y<=Math.max(a.y,c.y)&&o.y>=Math.min(a.y,c.y)}function Hg(a){return a>0?1:a<0?-1:0}function Rh(a,o){return Pa(a.prev,a,a.next)<0?Pa(a,o,a.next)>=0&&Pa(a,a.prev,o)>=0:Pa(a,o,a.prev)<0||Pa(a,a.next,o)<0}function Cm(a,o){var c=new qg(a.i,a.x,a.y),f=new qg(o.i,o.x,o.y),_=a.next,E=o.prev;return a.next=o,o.prev=a,c.next=_,_.prev=c,f.next=c,c.prev=f,E.next=f,f.prev=E,f}function iv(a,o,c,f){var _=new qg(a,o,c);return f?(_.next=f.next,_.prev=f,f.next.prev=_,f.next=_):(_.prev=_,_.next=_),_}function wp(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function qg(a,o,c){this.i=a,this.x=o,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Oh(a,o,c,f){for(var _=0,E=o,S=c-f;E<c;E+=f)_+=(a[S]-a[E])*(a[E+1]+a[S+1]),S=E;return _}Jy.exports=$g,Jy.exports.default=$g,$g.deviation=function(a,o,c,f){var _=o&&o.length,E=Math.abs(Oh(a,0,_?o[0]*c:a.length,c));if(_)for(var S=0,T=o.length;S<T;S++)E-=Math.abs(Oh(a,o[S]*c,S<T-1?o[S+1]*c:a.length,c));var O=0;for(S=0;S<f.length;S+=3){var k=f[S]*c,V=f[S+1]*c,j=f[S+2]*c;O+=Math.abs((a[k]-a[j])*(a[V+1]-a[k+1])-(a[k]-a[V])*(a[j+1]-a[k+1]))}return 0===E&&0===O?0:Math.abs((O-E)/E)},$g.flatten=function(a){for(var o=a[0][0].length,c={vertices:[],holes:[],dimensions:o},f=0,_=0;_<a.length;_++){for(var E=0;E<a[_].length;E++)for(var S=0;S<o;S++)c.vertices.push(a[_][E][S]);_>0&&c.holes.push(f+=a[_-1].length)}return c};var Wg=De(Jy.exports);function bb(a,o,c,f,_){Sm(a,o,c||0,f||a.length-1,_||Lh)}function Sm(a,o,c,f,_){for(;f>c;){if(f-c>600){var E=f-c+1,S=o-c+1,T=Math.log(E),O=.5*Math.exp(2*T/3),k=.5*Math.sqrt(T*O*(E-O)/E)*(S-E/2<0?-1:1);Sm(a,o,Math.max(c,Math.floor(o-S*O/E+k)),Math.min(f,Math.floor(o+(E-S)*O/E+k)),_)}var V=a[o],j=c,$=f;for(kh(a,c,o),_(a[f],V)>0&&kh(a,c,f);j<$;){for(kh(a,j,$),j++,$--;_(a[j],V)<0;)j++;for(;_(a[$],V)>0;)$--}0===_(a[c],V)?kh(a,c,$):kh(a,++$,f),$<=o&&(c=$+1),o<=$&&(f=$-1)}}function kh(a,o,c){var f=a[o];a[o]=a[c],a[c]=f}function Lh(a,o){return a<o?-1:a>o?1:0}function rv(a,o){const c=a.length;if(c<=1)return[a];const f=[];let _,E;for(let S=0;S<c;S++){const T=mi(a[S]);0!==T&&(a[S].area=Math.abs(T),void 0===E&&(E=T<0),E===T<0?(_&&f.push(_),_=[a[S]]):_.push(a[S]))}if(_&&f.push(_),o>1)for(let S=0;S<f.length;S++)f[S].length<=o||(bb(f[S],o,1,f[S].length-1,OC),f[S]=f[S].slice(0,o));return f}function OC(a,o){return o.area-a.area}function ov(a,o,c){const f=c.patternDependencies;let _=!1;for(const E of o){const S=E.paint.get(`${a}-pattern`);S.isConstant()||(_=!0);const T=S.constantOr(null);T&&(_=!0,f[T]=!0)}return _}function Zg(a,o,c,f,_){const E=_.patternDependencies;for(const S of o){const T=S.paint.get(`${a}-pattern`).value;if("constant"!==T.kind){let O=T.evaluate({zoom:f},c,{},_.availableImages);O=O&&O.name?O.name:O,E[O]=!0,c.patterns[S.id]=O}}return c}class Ep{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new En,this.indexArray=new di,this.indexArray2=new vs,this.programConfigurations=new fc(o.layers,o.zoom),this.segments=new Jo,this.segments2=new Jo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=o.projection}populate(o,c,f,_){this.hasPattern=ov("fill",this.layers,c);const E=this.layers[0].layout.get("fill-sort-key"),S=[];for(const{feature:T,id:O,index:k,sourceLayerIndex:V}of o){const j=this.layers[0]._featureFilter.needGeometry,$=Cd(T,j);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),$,f))continue;const W=E?E.evaluate($,{},f,c.availableImages):void 0,K={id:O,properties:T.properties,type:T.type,sourceLayerIndex:V,index:k,geometry:j?$.geometry:Ed(T,f,_),patterns:{},sortKey:W};S.push(K)}E&&S.sort((T,O)=>T.sortKey-O.sortKey);for(const T of S){const{geometry:O,index:k,sourceLayerIndex:V}=T;if(this.hasPattern){const j=Zg("fill",this.layers,T,this.zoom,c);this.patternFeatures.push(j)}else this.addFeature(T,O,k,f,{},c.availableImages);c.featureIndex.insert(o[k].feature,O,k,V,this.index)}}update(o,c,f,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,_)}addFeatures(o,c,f,_,E){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,c,f,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,TC),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,c,f,_,E,S=[]){for(const T of rv(c,500)){let O=0;for(const K of T)O+=K.length;const k=this.segments.prepareSegment(O,this.layoutVertexArray,this.indexArray),V=k.vertexLength,j=[],$=[];for(const K of T){if(0===K.length)continue;K!==T[0]&&$.push(j.length/2);const te=this.segments2.prepareSegment(K.length,this.layoutVertexArray,this.indexArray2),ve=te.vertexLength;this.layoutVertexArray.emplaceBack(K[0].x,K[0].y),this.indexArray2.emplaceBack(ve+K.length-1,ve),j.push(K[0].x),j.push(K[0].y);for(let Be=1;Be<K.length;Be++)this.layoutVertexArray.emplaceBack(K[Be].x,K[Be].y),this.indexArray2.emplaceBack(ve+Be-1,ve+Be),j.push(K[Be].x),j.push(K[Be].y);te.vertexLength+=K.length,te.primitiveLength+=K.length}const W=Wg(j,$);for(let K=0;K<W.length;K+=3)this.indexArray.emplaceBack(V+W[K],V+W[K+1],V+W[K+2]);k.vertexLength+=O,k.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,E,S,_)}}On(Ep,"FillBucket",{omit:["layers","patternFeatures"]});const kC=new We({"fill-sort-key":new Se(Qt.layout_fill["fill-sort-key"])});var LC={paint:new We({"fill-antialias":new ee(Qt.paint_fill["fill-antialias"]),"fill-opacity":new Se(Qt.paint_fill["fill-opacity"]),"fill-color":new Se(Qt.paint_fill["fill-color"]),"fill-outline-color":new Se(Qt.paint_fill["fill-outline-color"]),"fill-translate":new ee(Qt.paint_fill["fill-translate"]),"fill-translate-anchor":new ee(Qt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Se(Qt.paint_fill["fill-pattern"])}),layout:kC};const NC=bt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),wb=bt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),FC=bt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:BC}=NC;var Yl={},sv=ze,av=Nh;function Nh(a,o,c,f,_){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=f,this._values=_,a.readFields(mc,this,o)}function mc(a,o,c){1==a?o.id=c.readVarint():2==a?function(f,_){for(var E=f.readVarint()+f.pos;f.pos<E;){var S=_._keys[f.readVarint()],T=_._values[f.readVarint()];_.properties[S]=T}}(c,o):3==a?o.type=c.readVarint():4==a&&(o._geometry=c.pos)}function Mm(a){for(var o,c,f=0,_=0,E=a.length,S=E-1;_<E;S=_++)f+=((c=a[S]).x-(o=a[_]).x)*(o.y+c.y);return f}Nh.types=["Unknown","Point","LineString","Polygon"],Nh.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,c=a.readVarint()+a.pos,f=1,_=0,E=0,S=0,T=[];a.pos<c;){if(_<=0){var O=a.readVarint();f=7&O,_=O>>3}if(_--,1===f||2===f)E+=a.readSVarint(),S+=a.readSVarint(),1===f&&(o&&T.push(o),o=[]),o.push(new sv(E,S));else{if(7!==f)throw new Error("unknown command "+f);o&&o.push(o[0].clone())}}return o&&T.push(o),T},Nh.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,c=1,f=0,_=0,E=0,S=1/0,T=-1/0,O=1/0,k=-1/0;a.pos<o;){if(f<=0){var V=a.readVarint();c=7&V,f=V>>3}if(f--,1===c||2===c)(_+=a.readSVarint())<S&&(S=_),_>T&&(T=_),(E+=a.readSVarint())<O&&(O=E),E>k&&(k=E);else if(7!==c)throw new Error("unknown command "+c)}return[S,O,T,k]},Nh.prototype.toGeoJSON=function(a,o,c){var f,_,E=this.extent*Math.pow(2,c),S=this.extent*a,T=this.extent*o,O=this.loadGeometry(),k=Nh.types[this.type];function V(W){for(var K=0;K<W.length;K++){var te=W[K];W[K]=[360*(te.x+S)/E-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+T)/E)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(f=0;f<O.length;f++)j[f]=O[f][0];V(O=j);break;case 2:for(f=0;f<O.length;f++)V(O[f]);break;case 3:for(O=function(W){var K=W.length;if(K<=1)return[W];for(var te,ve,Be=[],Je=0;Je<K;Je++){var Ne=Mm(W[Je]);0!==Ne&&(void 0===ve&&(ve=Ne<0),ve===Ne<0?(te&&Be.push(te),te=[W[Je]]):te.push(W[Je]))}return te&&Be.push(te),Be}(O),f=0;f<O.length;f++)for(_=0;_<O[f].length;_++)V(O[f][_])}1===O.length?O=O[0]:k="Multi"+k;var $={type:"Feature",geometry:{type:k,coordinates:O},properties:this.properties};return"id"in this&&($.id=this.id),$};var Eb=av,lv=Cb;function Cb(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Sb,this,o),this.length=this._features.length}function Sb(a,o,c){15===a?o.version=c.readVarint():1===a?o.name=c.readString():5===a?o.extent=c.readVarint():2===a?o._features.push(c.pos):3===a?o._keys.push(c.readString()):4===a&&o._values.push(function(f){for(var _=null,E=f.readVarint()+f.pos;f.pos<E;){var S=f.readVarint()>>3;_=1===S?f.readString():2===S?f.readFloat():3===S?f.readDouble():4===S?f.readVarint64():5===S?f.readVarint():6===S?f.readSVarint():7===S?f.readBoolean():null}return _}(c))}Cb.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new Eb(this._pbf,o,this.extent,this._keys,this._values)};var zC=lv;function Mb(a,o,c){if(3===a){var f=new zC(c,c.readVarint()+c.pos);f.length&&(o[f.name]=f)}}var cv=Yl.VectorTile=function(a,o){this.layers=a.readFields(Mb,{},o)},Im=Yl.VectorTileFeature=av;function Xg(a,o,c,f){const _=[],E=0===f?(S,T,O,k,V,j)=>{S.push(new re(j,O+(j-T)/(k-T)*(V-O)))}:(S,T,O,k,V,j)=>{S.push(new re(T+(j-O)/(V-O)*(k-T),j))};for(const S of a){const T=[];for(const O of S){if(O.length<=2)continue;const k=[];for(let $=0;$<O.length-1;$++){const W=O[$].x,K=O[$].y,te=O[$+1].x,ve=O[$+1].y,Be=0===f?W:K,Je=0===f?te:ve;Be<o?Je>o&&E(k,W,K,te,ve,o):Be>c?Je<c&&E(k,W,K,te,ve,c):k.push(O[$]),Je<o&&Be>=o&&E(k,W,K,te,ve,o),Je>c&&Be<=c&&E(k,W,K,te,ve,c)}let V=O[O.length-1];const j=0===f?V.x:V.y;j>=o&&j<=c&&k.push(V),k.length&&(V=k[k.length-1],k[0].x===V.x&&k[0].y===V.y||k.push(k[0]),T.push(k))}T.length&&_.push(T)}return _}Yl.VectorTileLayer=lv;const VC=Im.types,uv=Math.pow(2,13);function Df(a,o,c,f,_,E,S,T){a.emplaceBack((o<<1)+S,(c<<1)+E,(Math.floor(f*uv)<<1)+_,Math.round(T))}function Dm(a,o,c){a.emplaceBack(o.x,o.y,o.z,16384*c[0],16384*c[1],16384*c[2])}class Cp{constructor(){this.acc=new re(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new re(o.x,o.y),this.max=new re(o.x,o.y))}append(o,c){this.currentPolyCount.edges++,this.acc._add(o);const f=this.min,_=this.max;o.x<f.x?f.x=o.x:o.x>_.x&&(_.x=o.x),o.y<f.y?f.y=o.y:o.y>_.y&&(_.y=o.y),((0===o.x||o.x===Ei)&&o.x===c.x)!=((0===o.y||o.y===Ei)&&o.y===c.y)&&this.processBorderOverlap(o,c),c.x<0!=o.x<0&&this.addBorderIntersection(0,hr(c.y,o.y,(0-c.x)/(o.x-c.x))),c.x>Ei!=o.x>Ei&&this.addBorderIntersection(1,hr(c.y,o.y,(Ei-c.x)/(o.x-c.x))),c.y<0!=o.y<0&&this.addBorderIntersection(2,hr(c.x,o.x,(0-c.y)/(o.y-c.y))),c.y>Ei!=o.y>Ei&&this.addBorderIntersection(3,hr(c.x,o.x,(Ei-c.y)/(o.y-c.y)))}addBorderIntersection(o,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[o];c<f[0]&&(f[0]=c),c>f[1]&&(f[1]=c)}processBorderOverlap(o,c){if(o.x===c.x){if(o.y===c.y)return;const f=0===o.x?0:1;this.addBorderIntersection(f,c.y),this.addBorderIntersection(f,o.y)}else{const f=0===o.y?2:3;this.addBorderIntersection(f,c.x),this.addBorderIntersection(f,o.x)}}centroid(){const o=this.polyCount.reduce((c,f)=>c+f.edges,0);return 0!==o?this.acc.div(o)._round():new re(0,0)}span(){return new re(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,c)=>o+ +(c[0]!==Number.MAX_VALUE),0)}}class Tm{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new sn,this.centroidVertexArray=new td,this.indexArray=new di,this.programConfigurations=new fc(o.layers,o.zoom),this.segments=new Jo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=o.enableTerrain}populate(o,c,f,_){this.features=[],this.hasPattern=ov("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(E){const S=Math.exp(Math.PI*(1-E.y/(1<<E.z)*2));return 80150034*S/(S*S+1)/Ei/(1<<E.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:E,id:S,index:T,sourceLayerIndex:O}of o){const k=this.layers[0]._featureFilter.needGeometry,V=Cd(E,k);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),V,f))continue;const j={id:S,sourceLayerIndex:O,index:T,geometry:k?V.geometry:Ed(E,f,_),properties:E.properties,type:E.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(Zg("fill-extrusion",this.layers,j,this.zoom,c)):this.addFeature(j,j.geometry,T,f,{},c.availableImages,_),c.featureIndex.insert(E,j.geometry,T,O,this.index,$)}this.sortBorders()}addFeatures(o,c,f,_,E){for(const S of this.features){const{geometry:T}=S;this.addFeature(S,T,S.index,c,f,_,E)}this.sortBorders()}update(o,c,f,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,BC),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,FC.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,wb.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,f,_,E,S,T){const O=[new re(0,0),new re(Ei,Ei)],k=T.projection,V="globe"===k.name,j=this.enableTerrain&&!V?new Cp:null,$="Polygon"===VC[o.type];V&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new wn);const W=rv(c,500);for(let Be=W.length-1;Be>=0;Be--){const Je=W[Be];(0===Je.length||(K=Je[0]).every(Ne=>Ne.x<=0)||K.every(Ne=>Ne.x>=Ei)||K.every(Ne=>Ne.y<=0)||K.every(Ne=>Ne.y>=Ei))&&W.splice(Be,1)}var K;let te;if(V)te=Yg(W,O,_);else{te=[];for(const Be of W)te.push({polygon:Be,bounds:O})}const ve=$?this.edgeRadius:0;for(const{polygon:Be,bounds:Je}of te){let Ne=0,Ze=0;for(const st of Be)$&&!st[0].equals(st[st.length-1])&&st.push(st[0]),Ze+=$?st.length-1:st.length;const rt=this.segments.prepareSegment(($?5:4)*Ze,this.layoutVertexArray,this.indexArray);if($){const st=[],Vt=[];Ne=rt.vertexLength;for(const en of Be){let bn,$t;en.length&&en!==Be[0]&&Vt.push(st.length/2),bn=en[1].sub(en[0])._perp()._unit();for(let an=1;an<en.length;an++){const ln=en[an],gn=en[an===en.length-1?1:an+1];let{x:In,y:Jt}=ln;if(ve){$t=gn.sub(ln)._perp()._unit();const Hn=bn.add($t)._unit(),ti=ve*Math.min(4,1/(bn.x*Hn.x+bn.y*Hn.y));In+=ti*Hn.x,Jt+=ti*Hn.y,bn=$t}Df(this.layoutVertexArray,In,Jt,0,0,1,1,0),rt.vertexLength++,st.push(ln.x,ln.y),V&&Dm(this.layoutVertexExtArray,k.projectTilePoint(In,Jt,_),k.upVector(_,In,Jt))}}const At=Wg(st,Vt);for(let en=0;en<At.length;en+=3)this.indexArray.emplaceBack(Ne+At[en],Ne+At[en+2],Ne+At[en+1]),rt.primitiveLength++}for(const st of Be){j&&st.length&&j.startRing(st[0]);let Vt,At,en,bn=st.length>4&&Tf(st[st.length-2],st[0],st[1]),$t=ve?Db(st[st.length-2],st[0],st[1],ve):0;At=st[1].sub(st[0])._perp()._unit();let an=!0;for(let ln=1,gn=0;ln<st.length;ln++){let In=st[ln-1],Jt=st[ln];const Hn=st[ln===st.length-1?1:ln+1];if(j&&$&&j.currentPolyCount.top++,hv(Jt,In,Je)){ve&&(At=Hn.sub(Jt)._perp()._unit(),an=!an);continue}j&&j.append(Jt,In);const ti=Jt.sub(In)._perp(),qn=ti.x/(Math.abs(ti.x)+Math.abs(ti.y)),ir=ti.y>0?1:0,Tn=In.dist(Jt);if(gn+Tn>32768&&(gn=0),ve){en=Hn.sub(Jt)._perp()._unit();let Wi=dv(In,Jt,Hn,Ib(At,en),ve);isNaN(Wi)&&(Wi=0);const Ri=Jt.sub(In)._unit();In=In.add(Ri.mult($t))._round(),Jt=Jt.add(Ri.mult(-Wi))._round(),$t=Wi,At=en}const bi=rt.vertexLength,rr=st.length>4&&Tf(In,Jt,Hn);let kr=Am(gn,bn,an);if(Df(this.layoutVertexArray,In.x,In.y,qn,ir,0,0,kr),Df(this.layoutVertexArray,In.x,In.y,qn,ir,0,1,kr),gn+=Tn,kr=Am(gn,rr,!an),bn=rr,Df(this.layoutVertexArray,Jt.x,Jt.y,qn,ir,0,0,kr),Df(this.layoutVertexArray,Jt.x,Jt.y,qn,ir,0,1,kr),rt.vertexLength+=4,this.indexArray.emplaceBack(bi+0,bi+1,bi+2),this.indexArray.emplaceBack(bi+1,bi+3,bi+2),rt.primitiveLength+=2,ve){const Wi=Ne+(1===ln?st.length-2:ln-2),Ri=1===ln?Ne:Wi+1;if(this.indexArray.emplaceBack(bi+1,Wi,bi+3),this.indexArray.emplaceBack(Wi,Ri,bi+3),rt.primitiveLength+=2,void 0===Vt&&(Vt=bi),!hv(Hn,st[ln],Je)){const Fo=ln===st.length-1?Vt:rt.vertexLength;this.indexArray.emplaceBack(bi+2,bi+3,Fo),this.indexArray.emplaceBack(bi+3,Fo+1,Fo),this.indexArray.emplaceBack(bi+3,Ri,Fo+1),rt.primitiveLength+=3}an=!an}if(V){const Wi=this.layoutVertexExtArray,Ri=k.projectTilePoint(In.x,In.y,_),Fo=k.projectTilePoint(Jt.x,Jt.y,_),Ji=k.upVector(_,In.x,In.y),er=k.upVector(_,Jt.x,Jt.y);Dm(Wi,Ri,Ji),Dm(Wi,Ri,Ji),Dm(Wi,Fo,er),Dm(Wi,Fo,er)}}$&&(Ne+=st.length-1)}}if(j&&j.polyCount.length>0){if(j.borders){j.vertexArrayOffset=this.centroidVertexArray.length;const Be=j.borders,Je=this.featuresOnBorder.push(j)-1;for(let Ne=0;Ne<4;Ne++)Be[Ne][0]!==Number.MAX_VALUE&&this.borders[Ne].push(Je)}this.encodeCentroid(j.borders?void 0:j.centroid(),j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,E,S,_)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((c,f)=>this.featuresOnBorder[c].borders[o][0]-this.featuresOnBorder[f].borders[o][0])}encodeCentroid(o,c,f=!0){let _,E;if(o)if(0!==o.y){const T=c.span()._mult(this.tileToMeter);_=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(T.x/10)),E=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else _=Math.ceil(7*(o.x+450)),E=0;else _=0,E=+f;let S=f?this.centroidVertexArray.length:c.vertexArrayOffset;for(const T of c.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let O=0;O<T.top;O++)this.centroidVertexArray.emplace(S++,_,E);for(let O=0;O<2*T.edges;O++)this.centroidVertexArray.emplace(S++,0,E),this.centroidVertexArray.emplace(S++,_,E)}}}function Ib(a,o){const c=a.add(o)._unit();return a.x*c.x+a.y*c.y}function Db(a,o,c,f){const _=o.sub(a)._perp()._unit(),E=c.sub(o)._perp()._unit();return dv(a,o,c,Ib(_,E),f)}function dv(a,o,c,f,_){const E=Math.sqrt(1-f*f);return Math.min(a.dist(o)/3,o.dist(c)/3,_*E/f)}function hv(a,o,c){return a.x<c[0].x&&o.x<c[0].x||a.x>c[1].x&&o.x>c[1].x||a.y<c[0].y&&o.y<c[0].y||a.y>c[1].y&&o.y>c[1].y}function Tf(a,o,c){if(a.x<0||a.x>=Ei||o.x<0||o.x>=Ei||c.x<0||c.x>=Ei)return!1;const f=c.sub(o),_=f.perp(),E=a.sub(o);return(f.x*E.x+f.y*E.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(E.x*E.x+E.y*E.y))>-.866&&_.x*E.x+_.y*E.y<0}function Am(a,o,c){const f=o?2|a:-3&a;return c?1|f:-2&f}function fv(){const a=Math.PI/32,o=Math.tan(a),c=vd;return c*Math.sqrt(1+2*o*o)-c}function Yg(a,o,c){const f=1<<c.z,_=zu(c.x/f),E=zu((c.x+1)/f),S=Zl(c.y/f),T=Zl((c.y+1)/f);return function(O,k,V,j,$=0,W){const K=[];if(!O.length||!V||!j)return K;const te=(st,Vt)=>{for(const At of st)K.push({polygon:At,bounds:Vt})},ve=Math.ceil(Math.log2(V)),Be=Math.ceil(Math.log2(j)),Je=ve-Be,Ne=[];for(let st=0;st<Math.abs(Je);st++)Ne.push(Je>0?0:1);for(let st=0;st<Math.min(ve,Be);st++)Ne.push(0),Ne.push(1);let Ze=O;if(Ze=Xg(Ze,k[0].y-$,k[1].y+$,1),Ze=Xg(Ze,k[0].x-$,k[1].x+$,0),!Ze.length)return K;const rt=[];for(Ne.length?rt.push({polygons:Ze,bounds:k,depth:0}):te(Ze,k);rt.length;){const st=rt.pop(),Vt=st.depth,At=Ne[Vt],en=st.bounds[0],bn=st.bounds[1],$t=0===At?en.x:en.y,an=0===At?bn.x:bn.y,ln=W?W(At,$t,an):.5*($t+an),gn=Xg(st.polygons,$t-$,ln+$,At),In=Xg(st.polygons,ln-$,an+$,At);if(gn.length){const Jt=[en,new re(0===At?ln:bn.x,1===At?ln:bn.y)];Ne.length>Vt+1?rt.push({polygons:gn,bounds:Jt,depth:Vt+1}):te(gn,Jt)}if(In.length){const Jt=[new re(0===At?ln:en.x,1===At?ln:en.y),bn];Ne.length>Vt+1?rt.push({polygons:In,bounds:Jt,depth:Vt+1}):te(In,Jt)}}return K}(a,o,Math.ceil((E-_)/11.25),Math.ceil((S-T)/11.25),1,(O,k,V)=>{if(0===O)return.5*(k+V);{const j=Zl((c.y+k/Ei)/f);return(eh(.5*(Zl((c.y+V/Ei)/f)+j))*f-c.y)*Ei}})}On(Tm,"FillExtrusionBucket",{omit:["layers","features"]}),On(Cp,"PartMetadata");const Kg=new We({"fill-extrusion-edge-radius":new ee(Qt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var UC={paint:new We({"fill-extrusion-opacity":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Se(Qt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Se(Qt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Se(Qt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Se(Qt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ee(Qt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Kg};function Tb(a,o,c){var f=2*Math.PI*6378137/256/Math.pow(2,c);return[a*f-2*Math.PI*6378137/2,o*f-2*Math.PI*6378137/2]}class Qg{constructor(o,c,f){this.z=o,this.x=c,this.y=f,this.key=Pm(0,o,o,c,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c){const f=(S=this.y,T=this.z,O=Tb(256*(E=this.x),256*(S=Math.pow(2,T)-S-1),T),k=Tb(256*(E+1),256*(S+1),T),O[0]+","+O[1]+","+k[0]+","+k[1]),_=function(E,S,T){let O,k="";for(let V=E;V>0;V--)O=1<<V-1,k+=(S&O?1:0)+(T&O?2:0);return k}(this.z,this.x,this.y);var E,S,T,O,k;return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===c?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ab{constructor(o,c){this.wrap=o,this.canonical=c,this.key=Pm(o,c.z,c.z,c.x,c.y)}}class gc{constructor(o,c,f,_,E){this.overscaledZ=o,this.wrap=c,this.canonical=new Qg(f,+_,+E),this.key=0===c&&o===f?this.canonical.key:Pm(c,o,f,_,E)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const c=this.canonical.z-o;return o>this.canonical.z?new gc(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new gc(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c=!0){if(this.overscaledZ===o&&c)return this.key;if(o>this.canonical.z)return Pm(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-o;return Pm(this.wrap*+c,o,o,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new gc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,f=2*this.canonical.x,_=2*this.canonical.y;return[new gc(c,this.wrap,c,f,_),new gc(c,this.wrap,c,f+1,_),new gc(c,this.wrap,c,f,_+1),new gc(c,this.wrap,c,f+1,_+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new gc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new gc(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ab(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pm(a,o,c,f,_){const E=1<<Math.min(c,22);let S=E*(_%E)+f%E;return a&&c<22&&(S+=E*E*((a<0?-2*a-1:2*a)%(1<<2*(22-c)))),16*(32*S+c)+(o-c)}On(Qg,"CanonicalTileID"),On(gc,"OverscaledTileID",{omit:["projMatrix"]});class Af extends re{constructor(o,c,f){super(o,c),this.z=f}}function Fh(a,o){return a.x*o.x+a.y*o.y}function Jg(a,o){if(1===a.length){let c=0;const f=o[c++];let _;for(;!_||f.equals(_);)if(_=o[c++],!_)return 1/0;for(;c<o.length;c++){const E=o[c],S=a[0],T=_.sub(f),O=E.sub(f),k=S.sub(f),V=Fh(T,T),j=Fh(T,O),$=Fh(O,O),W=Fh(k,T),K=Fh(k,O),te=V*$-j*j,ve=($*W-j*K)/te,Be=(V*K-j*W)/te,Je=f.z*(1-ve-Be)+_.z*ve+E.z*Be;if(isFinite(Je))return Je}return 1/0}{let c=1/0;for(const f of o)c=Math.min(c,f.z);return c}}function e_(a,o,c,f,_,E,S,T){const O=S*_.getElevationAt(a,o,!0,!0),k=0!==E[0],V=k?0===E[1]?S*(E[0]/7-450):S*function(j,$,W){const K=Math.floor($[0]/8),te=Math.floor($[1]/8),ve=10*($[0]-8*K),Be=10*($[1]-8*te),Je=j.getElevationAt(K,te,!0,!0),Ne=j.getMeterToDEM(W),Ze=Math.floor(.5*(ve*Ne-1)),rt=Math.floor(.5*(Be*Ne-1)),st=j.tileCoordToPixel(K,te),Vt=2*Ze+1,At=2*rt+1,en=(ti=Vt,qn=At,[(In=j).getElevationAtPixel(Jt=st.x-Ze,Hn=st.y-rt,!0),In.getElevationAtPixel(Jt+qn,Hn,!0),In.getElevationAtPixel(Jt,Hn+qn,!0),In.getElevationAtPixel(Jt+ti,Hn+qn,!0)]),bn=Math.abs(en[0]-en[1]),$t=Math.abs(en[2]-en[3]),an=Math.abs(en[0]-en[2])+Math.abs(en[1]-en[3]),ln=Math.min(.25,.5*Ne*(bn+$t)/Vt),gn=Math.min(.25,.5*Ne*an/At);var In,Jt,Hn,ti,qn;return Je+Math.max(ln*ve,gn*Be)}(_,E,T):O;return{base:O+(0===c)?-1:c,top:k?Math.max(V+f,O+c+2):O+f}}const jC=bt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:GC}=jC,pv=bt([{name:"a_packed",components:4,type:"Float32"}]),{members:Pb}=pv,Pf=Im.types,Rb=Math.cos(Math.PI/180*37.5);class Rm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Ht,this.layoutVertexArray2=new xn,this.indexArray=new di,this.programConfigurations=new fc(o.layers,o.zoom),this.segments=new Jo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,f,_){this.hasPattern=ov("line",this.layers,c);const E=this.layers[0].layout.get("line-sort-key"),S=[];for(const{feature:V,id:j,index:$,sourceLayerIndex:W}of o){const K=this.layers[0]._featureFilter.needGeometry,te=Cd(V,K);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),te,f))continue;const ve=E?E.evaluate(te,{},f):void 0,Be={id:j,properties:V.properties,type:V.type,sourceLayerIndex:W,index:$,geometry:K?te.geometry:Ed(V,f,_),patterns:{},sortKey:ve};S.push(Be)}E&&S.sort((V,j)=>V.sortKey-j.sortKey);const{lineAtlas:T,featureIndex:O}=c,k=this.addConstantDashes(T);for(const V of S){const{geometry:j,index:$,sourceLayerIndex:W}=V;if(k&&this.addFeatureDashes(V,T),this.hasPattern){const K=Zg("line",this.layers,V,this.zoom,c);this.patternFeatures.push(K)}else this.addFeature(V,j,$,f,T.positions,c.availableImages);O.insert(o[$].feature,j,$,W,this.index)}}addConstantDashes(o){let c=!1;for(const f of this.layers){const _=f.paint.get("line-dasharray").value,E=f.layout.get("line-cap").value;if("constant"!==_.kind||"constant"!==E.kind)c=!0;else{const S=E.value,T=_.value;if(!T)continue;o.addDash(T,S)}}return c}addFeatureDashes(o,c){const f=this.zoom;for(const _ of this.layers){const E=_.paint.get("line-dasharray").value,S=_.layout.get("line-cap").value;if("constant"===E.kind&&"constant"===S.kind)continue;let T,O;if("constant"===E.kind){if(T=E.value,!T)continue}else T=E.evaluate({zoom:f},o);O="constant"===S.kind?S.value:S.evaluate({zoom:f},o),c.addDash(T,O),o.patterns[_.id]=c.getKey(T,O)}}update(o,c,f,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,_)}addFeatures(o,c,f,_,E){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,c,f,_)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Pb)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,GC),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,f,_,E,S){const T=this.layers[0].layout,O=T.get("line-join").evaluate(o,{}),k=T.get("line-cap").evaluate(o,{}),V=T.get("line-miter-limit"),j=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const $ of c)this.addLine($,o,O,k,V,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,E,S,_)}addLine(o,c,f,_,E,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Be=0;Be<o.length-1;Be++)this.totalDistance+=o[Be].dist(o[Be+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T="Polygon"===Pf[c.type];let O=o.length;for(;O>=2&&o[O-1].equals(o[O-2]);)O--;let k=0;for(;k<O-1&&o[k].equals(o[k+1]);)k++;if(O<(T?3:2))return;"bevel"===f&&(E=1.05);const V=this.overscaling<=16?15*Ei/(512*this.overscaling):0,j=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let $,W,K,te,ve;this.e1=this.e2=-1,T&&($=o[O-2],ve=o[k].sub($)._unit()._perp());for(let Be=k;Be<O;Be++){if(K=Be===O-1?T?o[k+1]:void 0:o[Be+1],K&&o[Be].equals(K))continue;ve&&(te=ve),$&&(W=$),$=o[Be],ve=K?K.sub($)._unit()._perp():te,te=te||ve;let Je=te.add(ve);0===Je.x&&0===Je.y||Je._unit();const Ne=te.x*ve.x+te.y*ve.y,Ze=Je.x*ve.x+Je.y*ve.y,rt=0!==Ze?1/Ze:1/0,st=2*Math.sqrt(2-2*Ze),Vt=Ze<Rb&&W&&K,At=te.x*ve.y-te.y*ve.x>0;if(Vt&&Be>k){const $t=$.dist(W);if($t>2*V){const an=$.sub($.sub(W)._mult(V/$t)._round());this.updateDistance(W,an),this.addCurrentVertex(an,te,0,0,j),W=an}}const en=W&&K;let bn=en?f:T?"butt":_;if(en&&"round"===bn&&(rt<S?bn="miter":rt<=2&&(bn="fakeround")),"miter"===bn&&rt>E&&(bn="bevel"),"bevel"===bn&&(rt>2&&(bn="flipbevel"),rt<E&&(bn="miter")),W&&this.updateDistance(W,$),"miter"===bn)Je._mult(rt),this.addCurrentVertex($,Je,0,0,j);else if("flipbevel"===bn){if(rt>100)Je=ve.mult(-1);else{const $t=rt*te.add(ve).mag()/te.sub(ve).mag();Je._perp()._mult($t*(At?-1:1))}this.addCurrentVertex($,Je,0,0,j),this.addCurrentVertex($,Je.mult(-1),0,0,j)}else if("bevel"===bn||"fakeround"===bn){const $t=-Math.sqrt(rt*rt-1),an=At?$t:0,ln=At?0:$t;if(W&&this.addCurrentVertex($,te,an,ln,j),"fakeround"===bn){const gn=Math.round(180*st/Math.PI/20);for(let In=1;In<gn;In++){let Jt=In/gn;if(.5!==Jt){const ti=Jt-.5;Jt+=Jt*ti*(Jt-1)*((1.0904+Ne*(Ne*(3.55645-1.43519*Ne)-3.2452))*ti*ti+(.848013+Ne*(.215638*Ne-1.06021)))}const Hn=ve.sub(te)._mult(Jt)._add(te)._unit()._mult(At?-1:1);this.addHalfVertex($,Hn.x,Hn.y,!1,At,0,j)}}K&&this.addCurrentVertex($,ve,-an,-ln,j)}else if("butt"===bn)this.addCurrentVertex($,Je,0,0,j);else if("square"===bn){const $t=W?1:-1;W||this.addCurrentVertex($,Je,$t,$t,j),this.addCurrentVertex($,Je,0,0,j),W&&this.addCurrentVertex($,Je,$t,$t,j)}else"round"===bn&&(W&&(this.addCurrentVertex($,te,0,0,j),this.addCurrentVertex($,te,1,1,j,!0)),K&&(this.addCurrentVertex($,ve,-1,-1,j,!0),this.addCurrentVertex($,ve,0,0,j)));if(Vt&&Be<O-1){const $t=$.dist(K);if($t>2*V){const an=$.add(K.sub($)._mult(V/$t)._round());this.updateDistance($,an),this.addCurrentVertex(an,ve,0,0,j),$=an}}}}addCurrentVertex(o,c,f,_,E,S=!1){const T=c.y*_-c.x,O=-c.y-c.x*_;this.addHalfVertex(o,c.x+c.y*f,c.y-c.x*f,S,!1,f,E),this.addHalfVertex(o,T,O,S,!0,-_,E)}addHalfVertex({x:o,y:c},f,_,E,S,T,O){this.layoutVertexArray.emplaceBack((o<<1)+(E?1:0),(c<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*_)+128,1+(0===T?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),O.primitiveLength++),S?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,c){this.distance+=o.dist(c),this.updateScaledDistance()}}On(Rm,"LineBucket",{omit:["layers","patternFeatures"]});const $C=new We({"line-cap":new Se(Qt.layout_line["line-cap"]),"line-join":new Se(Qt.layout_line["line-join"]),"line-miter-limit":new ee(Qt.layout_line["line-miter-limit"]),"line-round-limit":new ee(Qt.layout_line["line-round-limit"]),"line-sort-key":new Se(Qt.layout_line["line-sort-key"])});var HC={paint:new We({"line-opacity":new Se(Qt.paint_line["line-opacity"]),"line-color":new Se(Qt.paint_line["line-color"]),"line-translate":new ee(Qt.paint_line["line-translate"]),"line-translate-anchor":new ee(Qt.paint_line["line-translate-anchor"]),"line-width":new Se(Qt.paint_line["line-width"]),"line-gap-width":new Se(Qt.paint_line["line-gap-width"]),"line-offset":new Se(Qt.paint_line["line-offset"]),"line-blur":new Se(Qt.paint_line["line-blur"]),"line-dasharray":new Se(Qt.paint_line["line-dasharray"]),"line-pattern":new Se(Qt.paint_line["line-pattern"]),"line-gradient":new Ge(Qt.paint_line["line-gradient"]),"line-trim-offset":new ee(Qt.paint_line["line-trim-offset"])}),layout:$C};const Om=new class extends Se{possiblyEvaluate(a,o){return o=new U(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(a,o)}evaluate(a,o,c,f){return o=Ie({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(a,o,c,f)}}(HC.paint.properties["line-width"].specification);function Ob(a,o){return o>0?o+2*a:a}Om.useIntegerZoom=!0;const kb=bt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Lb=bt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Nb=bt([{name:"a_projected_pos",components:4,type:"Float32"}],4);bt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mv=bt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Fb=bt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);bt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const km=bt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Lm=bt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);bt([{name:"triangle",components:3,type:"Uint16"}]),bt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),bt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),bt([{type:"Float32",name:"offsetX"}]),bt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var nl=24;const fu=128;function Sp(a,o){const{expression:c}=o;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new U(a+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:f,interpolationType:_}=c;let E=0;for(;E<f.length&&f[E]<=a;)E++;E=Math.max(0,E-1);let S=E;for(;S<f.length&&f[S]<a+1;)S++;S=Math.min(f.length-1,S);const T=f[E],O=f[S];return"composite"===c.kind?{kind:"composite",minZoom:T,maxZoom:O,interpolationType:_}:{kind:"camera",minZoom:T,maxZoom:O,minSize:c.evaluate(new U(T)),maxSize:c.evaluate(new U(O)),interpolationType:_}}}function Nm(a,{uSize:o,uSizeT:c},{lowerSize:f,upperSize:_}){return"source"===a.kind?f/fu:"composite"===a.kind?hr(f/fu,_/fu,c):o}function Bh(a,o){let c=0,f=0;if("constant"===a.kind)f=a.layoutSize;else if("source"!==a.kind){const{interpolationType:_,minZoom:E,maxZoom:S}=a,T=_?Ee(Lo.interpolationFactor(_,o,E,S),0,1):0;"camera"===a.kind?f=hr(a.minSize,a.maxSize,T):c=T}return{uSizeT:c,uSize:f}}var Fm=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:fu,evaluateSizeForFeature:Nm,evaluateSizeForZoom:Bh,getSizeData:Sp});function qC(a,o,c){return a.sections.forEach(f=>{f.text=function(_,E,S){const T=E.layout.get("text-transform").evaluate(S,{});return"uppercase"===T?_=_.toLocaleUpperCase():"lowercase"===T&&(_=_.toLocaleLowerCase()),B.applyArabicShaping&&(_=B.applyArabicShaping(_)),_}(f.text,o,c)}),a}const Mp={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function WC(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function ZC(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var Bb=Ro,gv=function(a,o,c,f,_){var E,S,T=8*_-f-1,O=(1<<T)-1,k=O>>1,V=-7,j=c?_-1:0,$=c?-1:1,W=a[o+j];for(j+=$,E=W&(1<<-V)-1,W>>=-V,V+=T;V>0;E=256*E+a[o+j],j+=$,V-=8);for(S=E&(1<<-V)-1,E>>=-V,V+=f;V>0;S=256*S+a[o+j],j+=$,V-=8);if(0===E)E=1-k;else{if(E===O)return S?NaN:1/0*(W?-1:1);S+=Math.pow(2,f),E-=k}return(W?-1:1)*S*Math.pow(2,E-f)},_v=function(a,o,c,f,_,E){var S,T,O,k=8*E-_-1,V=(1<<k)-1,j=V>>1,$=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,W=f?0:E-1,K=f?1:-1,te=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(T=isNaN(o)?1:0,S=V):(S=Math.floor(Math.log(o)/Math.LN2),o*(O=Math.pow(2,-S))<1&&(S--,O*=2),(o+=S+j>=1?$/O:$*Math.pow(2,1-j))*O>=2&&(S++,O/=2),S+j>=V?(T=0,S=V):S+j>=1?(T=(o*O-1)*Math.pow(2,_),S+=j):(T=o*Math.pow(2,j-1)*Math.pow(2,_),S=0));_>=8;a[c+W]=255&T,W+=K,T/=256,_-=8);for(S=S<<_|T,k+=_;k>0;a[c+W]=255&S,W+=K,S/=256,k-=8);a[c+W-K]|=128*te};function Ro(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Ro.Varint=0,Ro.Fixed64=1,Ro.Bytes=2,Ro.Fixed32=5;var Bm=4294967296,Rf=1/Bm,zb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function th(a){return a.type===Ro.Bytes?a.readVarint()+a.pos:a.pos+1}function Vb(a,o,c){var f=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));c.realloc(f);for(var _=c.pos-1;_>=a;_--)c.buf[_+f]=c.buf[_]}function yv(a,o){for(var c=0;c<a.length;c++)o.writeVarint(a[c])}function XC(a,o){for(var c=0;c<a.length;c++)o.writeSVarint(a[c])}function Ip(a,o){for(var c=0;c<a.length;c++)o.writeFloat(a[c])}function t_(a,o){for(var c=0;c<a.length;c++)o.writeDouble(a[c])}function vv(a,o){for(var c=0;c<a.length;c++)o.writeBoolean(a[c])}function Ub(a,o){for(var c=0;c<a.length;c++)o.writeFixed32(a[c])}function jb(a,o){for(var c=0;c<a.length;c++)o.writeSFixed32(a[c])}function Gb(a,o){for(var c=0;c<a.length;c++)o.writeFixed64(a[c])}function Of(a,o){for(var c=0;c<a.length;c++)o.writeSFixed64(a[c])}function n_(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function Dp(a,o,c){a[c]=o,a[c+1]=o>>>8,a[c+2]=o>>>16,a[c+3]=o>>>24}function $b(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}Ro.prototype={destroy:function(){this.buf=null},readFields:function(a,o,c){for(c=c||this.length;this.pos<c;){var f=this.readVarint(),_=f>>3,E=this.pos;this.type=7&f,a(_,o,this),this.pos===E&&this.skip(f)}return o},readMessage:function(a,o){return this.readFields(a,o,this.readVarint()+this.pos)},readFixed32:function(){var a=n_(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=$b(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=n_(this.buf,this.pos)+n_(this.buf,this.pos+4)*Bm;return this.pos+=8,a},readSFixed64:function(){var a=n_(this.buf,this.pos)+$b(this.buf,this.pos+4)*Bm;return this.pos+=8,a},readFloat:function(){var a=gv(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=gv(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var o,c,f=this.buf;return o=127&(c=f[this.pos++]),c<128?o:(o|=(127&(c=f[this.pos++]))<<7,c<128?o:(o|=(127&(c=f[this.pos++]))<<14,c<128?o:(o|=(127&(c=f[this.pos++]))<<21,c<128?o:function(_,E,S){var T,O,k=S.buf;if(T=(112&(O=k[S.pos++]))>>4,O<128||(T|=(127&(O=k[S.pos++]))<<3,O<128)||(T|=(127&(O=k[S.pos++]))<<10,O<128)||(T|=(127&(O=k[S.pos++]))<<17,O<128)||(T|=(127&(O=k[S.pos++]))<<24,O<128)||(T|=(1&(O=k[S.pos++]))<<31,O<128))return function zm(a,o,c){return c?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}(_,T,E);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(c=f[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,o=this.pos;return this.pos=a,a-o>=12&&zb?zb.decode(this.buf.subarray(o,a)):function(c,f,_){for(var E="",S=f;S<_;){var T,O,k,V=c[S],j=null,$=V>239?4:V>223?3:V>191?2:1;if(S+$>_)break;1===$?V<128&&(j=V):2===$?128==(192&(T=c[S+1]))&&(j=(31&V)<<6|63&T)<=127&&(j=null):3===$?(O=c[S+2],128==(192&(T=c[S+1]))&&128==(192&O)&&((j=(15&V)<<12|(63&T)<<6|63&O)<=2047||j>=55296&&j<=57343)&&(j=null)):4===$&&(O=c[S+2],k=c[S+3],128==(192&(T=c[S+1]))&&128==(192&O)&&128==(192&k)&&((j=(15&V)<<18|(63&T)<<12|(63&O)<<6|63&k)<=65535||j>=1114112)&&(j=null)),null===j?(j=65533,$=1):j>65535&&(j-=65536,E+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),E+=String.fromCharCode(j),S+=$}return E}(this.buf,o,a)},readBytes:function(){var a=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,a);return this.pos=a,o},readPackedVarint:function(a,o){if(this.type!==Ro.Bytes)return a.push(this.readVarint(o));var c=th(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==Ro.Bytes)return a.push(this.readSVarint());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Ro.Bytes)return a.push(this.readBoolean());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Ro.Bytes)return a.push(this.readFloat());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Ro.Bytes)return a.push(this.readDouble());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Ro.Bytes)return a.push(this.readFixed32());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Ro.Bytes)return a.push(this.readSFixed32());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Ro.Bytes)return a.push(this.readFixed64());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Ro.Bytes)return a.push(this.readSFixed64());var o=th(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var o=7&a;if(o===Ro.Varint)for(;this.buf[this.pos++]>127;);else if(o===Ro.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Ro.Fixed32)this.pos+=4;else{if(o!==Ro.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(a,o){this.writeVarint(a<<3|o)},realloc:function(a){for(var o=this.length||16;o<this.pos+a;)o*=2;if(o!==this.length){var c=new Uint8Array(o);c.set(this.buf),this.buf=c,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Dp(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Dp(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Dp(this.buf,-1&a,this.pos),Dp(this.buf,Math.floor(a*Rf),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Dp(this.buf,-1&a,this.pos),Dp(this.buf,Math.floor(a*Rf),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(o,c){var f,_,E,T;if(o>=0?(f=o%4294967296|0,_=o/4294967296|0):(_=~(-o/4294967296),4294967295^(f=~(-o%4294967296))?f=f+1|0:(f=0,_=_+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),E=f,(T=c).buf[T.pos++]=127&E|128,E>>>=7,T.buf[T.pos++]=127&E|128,E>>>=7,T.buf[T.pos++]=127&E|128,E>>>=7,T.buf[T.pos++]=127&E|128,T.buf[T.pos]=127&(E>>>=7),function(E,S){var T=(7&E)<<4;S.buf[S.pos++]|=T|((E>>>=3)?128:0),E&&(S.buf[S.pos++]=127&E|((E>>>=7)?128:0),E&&(S.buf[S.pos++]=127&E|((E>>>=7)?128:0),E&&(S.buf[S.pos++]=127&E|((E>>>=7)?128:0),E&&(S.buf[S.pos++]=127&E|((E>>>=7)?128:0),E&&(S.buf[S.pos++]=127&E)))))}(_,c)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(f,_,E){for(var S,T,O=0;O<_.length;O++){if((S=_.charCodeAt(O))>55295&&S<57344){if(!T){S>56319||O+1===_.length?(f[E++]=239,f[E++]=191,f[E++]=189):T=S;continue}if(S<56320){f[E++]=239,f[E++]=191,f[E++]=189,T=S;continue}S=T-55296<<10|S-56320|65536,T=null}else T&&(f[E++]=239,f[E++]=191,f[E++]=189,T=null);S<128?f[E++]=S:(S<2048?f[E++]=S>>6|192:(S<65536?f[E++]=S>>12|224:(f[E++]=S>>18|240,f[E++]=S>>12&63|128),f[E++]=S>>6&63|128),f[E++]=63&S|128)}return E}(this.buf,a,this.pos);var c=this.pos-o;c>=128&&Vb(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),_v(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),_v(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var o=a.length;this.writeVarint(o),this.realloc(o);for(var c=0;c<o;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,o){this.pos++;var c=this.pos;a(o,this);var f=this.pos-c;f>=128&&Vb(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f},writeMessage:function(a,o,c){this.writeTag(a,Ro.Bytes),this.writeRawMessage(o,c)},writePackedVarint:function(a,o){o.length&&this.writeMessage(a,yv,o)},writePackedSVarint:function(a,o){o.length&&this.writeMessage(a,XC,o)},writePackedBoolean:function(a,o){o.length&&this.writeMessage(a,vv,o)},writePackedFloat:function(a,o){o.length&&this.writeMessage(a,Ip,o)},writePackedDouble:function(a,o){o.length&&this.writeMessage(a,t_,o)},writePackedFixed32:function(a,o){o.length&&this.writeMessage(a,Ub,o)},writePackedSFixed32:function(a,o){o.length&&this.writeMessage(a,jb,o)},writePackedFixed64:function(a,o){o.length&&this.writeMessage(a,Gb,o)},writePackedSFixed64:function(a,o){o.length&&this.writeMessage(a,Of,o)},writeBytesField:function(a,o){this.writeTag(a,Ro.Bytes),this.writeBytes(o)},writeFixed32Field:function(a,o){this.writeTag(a,Ro.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(a,o){this.writeTag(a,Ro.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(a,o){this.writeTag(a,Ro.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(a,o){this.writeTag(a,Ro.Fixed64),this.writeSFixed64(o)},writeVarintField:function(a,o){this.writeTag(a,Ro.Varint),this.writeVarint(o)},writeSVarintField:function(a,o){this.writeTag(a,Ro.Varint),this.writeSVarint(o)},writeStringField:function(a,o){this.writeTag(a,Ro.Bytes),this.writeString(o)},writeFloatField:function(a,o){this.writeTag(a,Ro.Fixed32),this.writeFloat(o)},writeDoubleField:function(a,o){this.writeTag(a,Ro.Fixed64),this.writeDouble(o)},writeBooleanField:function(a,o){this.writeVarintField(a,!!o)}};var i_=De(Bb);const xv=3;function pu(a,o,c){o.glyphs=[],1===a&&c.readMessage(Sd,o)}function Sd(a,o,c){if(3===a){const{id:f,bitmap:_,width:E,height:S,left:T,top:O,advance:k}=c.readMessage(YC,{});o.glyphs.push({id:f,bitmap:new hu({width:E+2*xv,height:S+2*xv},_),metrics:{width:E,height:S,left:T,top:O,advance:k}})}else 4===a?o.ascender=c.readSVarint():5===a&&(o.descender=c.readSVarint())}function YC(a,o,c){1===a?o.id=c.readVarint():2===a?o.bitmap=c.readBytes():3===a?o.width=c.readVarint():4===a?o.height=c.readVarint():5===a?o.left=c.readSVarint():6===a?o.top=c.readSVarint():7===a&&(o.advance=c.readVarint())}const Hb=xv;function bv(a){let o=0,c=0;for(const S of a)o+=S.w*S.h,c=Math.max(c,S.w);a.sort((S,T)=>T.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let _=0,E=0;for(const S of a)for(let T=f.length-1;T>=0;T--){const O=f[T];if(!(S.w>O.w||S.h>O.h)){if(S.x=O.x,S.y=O.y,E=Math.max(E,S.y+S.h),_=Math.max(_,S.x+S.w),S.w===O.w&&S.h===O.h){const k=f.pop();T<f.length&&(f[T]=k)}else S.h===O.h?(O.x+=S.w,O.w-=S.w):S.w===O.w?(O.y+=S.h,O.h-=S.h):(f.push({x:O.x+S.w,y:O.y,w:O.w-S.w,h:S.h}),O.y+=S.h,O.h-=S.h);break}}return{w:_,h:E,fill:o/(_*E)||0}}const Pc=1;class wv{constructor(o,{pixelRatio:c,version:f,stretchX:_,stretchY:E,content:S}){this.paddedRect=o,this.pixelRatio=c,this.stretchX=_,this.stretchY=E,this.content=S,this.version=f}get tl(){return[this.paddedRect.x+Pc,this.paddedRect.y+Pc]}get br(){return[this.paddedRect.x+this.paddedRect.w-Pc,this.paddedRect.y+this.paddedRect.h-Pc]}get displaySize(){return[(this.paddedRect.w-2*Pc)/this.pixelRatio,(this.paddedRect.h-2*Pc)/this.pixelRatio]}}class qb{constructor(o,c){const f={},_={};this.haveRenderCallbacks=[];const E=[];this.addImages(o,f,E),this.addImages(c,_,E);const{w:S,h:T}=bv(E),O=new jc({width:S||1,height:T||1});for(const k in o){const V=o[k],j=f[k].paddedRect;jc.copy(V.data,O,{x:0,y:0},{x:j.x+Pc,y:j.y+Pc},V.data)}for(const k in c){const V=c[k],j=_[k].paddedRect,$=j.x+Pc,W=j.y+Pc,K=V.data.width,te=V.data.height;jc.copy(V.data,O,{x:0,y:0},{x:$,y:W},V.data),jc.copy(V.data,O,{x:0,y:te-1},{x:$,y:W-1},{width:K,height:1}),jc.copy(V.data,O,{x:0,y:0},{x:$,y:W+te},{width:K,height:1}),jc.copy(V.data,O,{x:K-1,y:0},{x:$-1,y:W},{width:1,height:te}),jc.copy(V.data,O,{x:0,y:0},{x:$+K,y:W},{width:1,height:te})}this.image=O,this.iconPositions=f,this.patternPositions=_}addImages(o,c,f){for(const _ in o){const E=o[_],S={x:0,y:0,w:E.data.width+2*Pc,h:E.data.height+2*Pc};f.push(S),c[_]=new wv(S,E),E.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(o,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>o.hasImage(f)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in o.updatedImages)this.patchUpdatedImage(this.iconPositions[f],o.getImage(f),c),this.patchUpdatedImage(this.patternPositions[f],o.getImage(f),c)}patchUpdatedImage(o,c,f){if(!o||!c||o.version===c.version)return;o.version=c.version;const[_,E]=o.tl;f.update(c.data,void 0,{x:_,y:E})}}On(wv,"ImagePosition"),On(qb,"ImageAtlas");const Gc={horizontal:1,vertical:2,horizontalOnly:3},Wb=-17;class Vm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,c){const f=new Vm;return f.scale=o||1,f.fontStack=c,f}static forImage(o){const c=new Vm;return c.imageName=o,c}}class Tp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c){const f=new Tp;for(let _=0;_<o.sections.length;_++){const E=o.sections[_];E.image?f.addImageSection(E):f.addTextSection(E,c)}return f}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(c,f){let _="";for(let E=0;E<c.length;E++){const S=c.charCodeAt(E+1)||null,T=c.charCodeAt(E-1)||null;_+=!f&&(S&&Cy(S)&&!Mp[c[E+1]]||T&&Cy(T)&&!Mp[c[E-1]])||!Mp[c[E]]?c[E]:Mp[c[E]]}return _}(this.text,o)}trim(){let o=0;for(let f=0;f<this.text.length&&kf[this.text.charCodeAt(f)];f++)o++;let c=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&kf[this.text.charCodeAt(f)];f--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const f=new Tp;return f.text=this.text.substring(o,c),f.sectionIndex=this.sectionIndex.slice(o,c),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(Vm.forText(o.scale,o.fontStack||c));const f=this.sections.length-1;for(let _=0;_<o.text.length;++_)this.sectionIndex.push(f)}addImageSection(o){const c=o.image?o.image.name:"";if(0===c.length)return void Ii("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Vm.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Ii("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ev(a,o,c,f,_,E,S,T,O,k,V,j,$,W,K){const te=Tp.fromFeature(a,_);j===Gc.vertical&&te.verticalizePunctuation($);let ve=[];const Be=function(st,Vt,At,en,bn,$t){if(!st)return[];const an=[],ln=function(Hn,ti,qn,ir,Tn,bi){let rr=0;for(let kr=0;kr<Hn.length();kr++){const Wi=Hn.getSection(kr);rr+=Ap(Hn.getCharCode(kr),Wi,ir,Tn,ti,bi)}return rr/Math.max(1,Math.ceil(rr/qn))}(st,Vt,At,en,bn,$t),gn=st.text.indexOf("\u200b")>=0;let In=0;for(let Hn=0;Hn<st.length();Hn++){const ti=st.getSection(Hn),qn=st.getCharCode(Hn);if(kf[qn]||(In+=Ap(qn,ti,en,bn,Vt,$t)),Hn<st.length()-1){const ir=!((Jt=qn)<11904||!(Wn["Bopomofo Extended"](Jt)||Wn.Bopomofo(Jt)||Wn["CJK Compatibility Forms"](Jt)||Wn["CJK Compatibility Ideographs"](Jt)||Wn["CJK Compatibility"](Jt)||Wn["CJK Radicals Supplement"](Jt)||Wn["CJK Strokes"](Jt)||Wn["CJK Symbols and Punctuation"](Jt)||Wn["CJK Unified Ideographs Extension A"](Jt)||Wn["CJK Unified Ideographs"](Jt)||Wn["Enclosed CJK Letters and Months"](Jt)||Wn["Halfwidth and Fullwidth Forms"](Jt)||Wn.Hiragana(Jt)||Wn["Ideographic Description Characters"](Jt)||Wn["Kangxi Radicals"](Jt)||Wn["Katakana Phonetic Extensions"](Jt)||Wn.Katakana(Jt)||Wn["Vertical Forms"](Jt)||Wn["Yi Radicals"](Jt)||Wn["Yi Syllables"](Jt)));(nh[qn]||ir||ti.imageName)&&an.push(Sv(Hn+1,In,ln,an,Zb(qn,st.getCharCode(Hn+1),ir&&gn),!1))}}var Jt;return KC(Sv(st.length(),In,ln,an,0,!0))}(te,k,E,o,f,W),{processBidirectionalText:Je,processStyledBidirectionalText:Ne}=B;if(Je&&1===te.sections.length){const st=Je(te.toString(),Be);for(const Vt of st){const At=new Tp;At.text=Vt,At.sections=te.sections;for(let en=0;en<Vt.length;en++)At.sectionIndex.push(0);ve.push(At)}}else if(Ne){const st=Ne(te.text,te.sectionIndex,Be);for(const Vt of st){const At=new Tp;At.text=Vt[0],At.sectionIndex=Vt[1],At.sections=te.sections,ve.push(At)}}else ve=function(st,Vt){const At=[],en=st.text;let bn=0;for(const $t of Vt)At.push(st.substring(bn,$t)),bn=$t;return bn<en.length&&At.push(st.substring(bn,en.length)),At}(te,Be);const Ze=[],rt={positionedLines:Ze,text:te.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:j,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(st,Vt,At,en,bn,$t,an,ln,gn,In,Jt,Hn){let ti=0,qn=0,ir=0;const Tn="right"===ln?1:"left"===ln?0:.5;let bi=!1;for(const Ji of bn){const er=Ji.getSections();for(const Ho of er){if(Ho.imageName)continue;const qo=Vt[Ho.fontStack];if(qo&&(bi=void 0!==qo.ascender&&void 0!==qo.descender,!bi))break}if(!bi)break}let rr=0;for(const Ji of bn){Ji.trim();const er=Ji.getMaxScale(),Ho=(er-1)*nl,qo={positionedGlyphs:[],lineOffset:0};st.positionedLines[rr]=qo;const Wo=qo.positionedGlyphs;let ai=0;if(!Ji.length()){qn+=$t,++rr;continue}let Gn=0,Js=0;for(let Mo=0;Mo<Ji.length();Mo++){const Ra=Ji.getSection(Mo),ea=Ji.getSectionIndex(Mo),ts=Ji.getCharCode(Mo);let Lr=Ra.scale,Us=null,Zo=null,Pl=null,aa=nl,ja=0;const Ga=!(gn===Gc.horizontal||!Jt&&!Tg(ts)||Jt&&(kf[ts]||(kr=ts,Wn.Arabic(kr)||Wn["Arabic Supplement"](kr)||Wn["Arabic Extended-A"](kr)||Wn["Arabic Presentation Forms-A"](kr)||Wn["Arabic Presentation Forms-B"](kr))));if(Ra.imageName){const Rl=en[Ra.imageName];if(!Rl)continue;Pl=Ra.imageName,st.iconsInText=st.iconsInText||!0,Zo=Rl.paddedRect;const il=Rl.displaySize;Lr=Lr*nl/Hn,Us={width:il[0],height:il[1],left:Pc,top:-Hb,advance:Ga?il[1]:il[0],localGlyph:!1},ja=bi?-Us.height*Lr:Wb+er*nl-il[1]*Lr,aa=Us.advance;const ad=(Ga?il[0]:il[1])*Lr-nl*er;ad>0&&ad>ai&&(ai=ad)}else{const Rl=At[Ra.fontStack];if(!Rl)continue;Rl[ts]&&(Zo=Rl[ts]);const il=Vt[Ra.fontStack];if(!il)continue;const ad=il.glyphs[ts];if(!ad)continue;if(Us=ad.metrics,aa=8203!==ts?nl:0,bi){const zp=void 0!==il.ascender?Math.abs(il.ascender):0,Vp=void 0!==il.descender?Math.abs(il.descender):0,eg=(zp+Vp)*Lr;Gn<eg&&(Gn=eg,Js=(zp-Vp)/2*Lr),ja=-zp*Lr}else ja=Wb+(er-Lr)*nl}Ga?(st.verticalizable=!0,Wo.push({glyph:ts,imageName:Pl,x:ti,y:qn+ja,vertical:Ga,scale:Lr,localGlyph:Us.localGlyph,fontStack:Ra.fontStack,sectionIndex:ea,metrics:Us,rect:Zo}),ti+=aa*Lr+In):(Wo.push({glyph:ts,imageName:Pl,x:ti,y:qn+ja,vertical:Ga,scale:Lr,localGlyph:Us.localGlyph,fontStack:Ra.fontStack,sectionIndex:ea,metrics:Us,rect:Zo}),ti+=Us.advance*Lr+In)}0!==Wo.length&&(ir=Math.max(ti-In,ir),bi?QC(Wo,Tn,ai,Js,$t*er/2):QC(Wo,Tn,ai,0,$t/2)),ti=0;const Et=$t*er+ai;qo.lineOffset=Math.max(ai,Ho),qn+=Et,++rr}var kr;const Wi=qn,{horizontalAlign:Ri,verticalAlign:Fo}=Xb(an);(function(Ji,er,Ho,qo,Wo,ai){const Gn=(er-Ho)*Wo,Js=-ai*qo;for(const Et of Ji)for(const Mo of Et.positionedGlyphs)Mo.x+=Gn,Mo.y+=Js})(st.positionedLines,Tn,Ri,Fo,ir,Wi),st.top+=-Fo*Wi,st.bottom=st.top+Wi,st.left+=-Ri*ir,st.right=st.left+ir,st.hasBaseline=bi}(rt,o,c,f,ve,S,T,O,j,k,$,K),!function(st){for(const Vt of st)if(0!==Vt.positionedGlyphs.length)return!1;return!0}(Ze)&&rt}const kf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nh={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ap(a,o,c,f,_,E){if(o.imageName){const S=f[o.imageName];return S?S.displaySize[0]*o.scale*nl/E+_:0}{const S=c[o.fontStack],T=S&&S.glyphs[a];return T?T.metrics.advance*o.scale+_:0}}function Cv(a,o,c,f){const _=Math.pow(a-o,2);return f?a<o?_/2:2*_:_+Math.abs(c)*c}function Zb(a,o,c){let f=0;return 10===a&&(f-=1e4),c&&(f+=150),40!==a&&65288!==a||(f+=50),41!==o&&65289!==o||(f+=50),f}function Sv(a,o,c,f,_,E){let S=null,T=Cv(o,c,_,E);for(const O of f){const k=Cv(o-O.x,c,_,E)+O.badness;k<=T&&(S=O,T=k)}return{index:a,x:o,priorBreak:S,badness:T}}function KC(a){return a?KC(a.priorBreak).concat(a.index):[]}function Xb(a){let o=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function QC(a,o,c,f,_){if(!(o||c||f||_))return;const E=a.length-1,S=a[E],T=(S.x+S.metrics.advance*S.scale)*o;for(let O=0;O<=E;O++)a[O].x-=T,a[O].y+=c+f+_}function Mv(a,o,c){const{horizontalAlign:f,verticalAlign:_}=Xb(c),E=o[0]-a.displaySize[0]*f,S=o[1]-a.displaySize[1]*_;return{image:a,top:S,bottom:S+a.displaySize[1],left:E,right:E+a.displaySize[0]}}function r_(a,o,c,f,_,E){const S=a.image;let T;if(S.content){const ve=S.content,Be=S.pixelRatio||1;T=[ve[0]/Be,ve[1]/Be,S.displaySize[0]-ve[2]/Be,S.displaySize[1]-ve[3]/Be]}const O=o.left*E,k=o.right*E;let V,j,$,W;"width"===c||"both"===c?(W=_[0]+O-f[3],j=_[0]+k+f[1]):(W=_[0]+(O+k-S.displaySize[0])/2,j=W+S.displaySize[0]);const K=o.top*E,te=o.bottom*E;return"height"===c||"both"===c?(V=_[1]+K-f[0],$=_[1]+te+f[2]):(V=_[1]+(K+te-S.displaySize[1])/2,$=V+S.displaySize[1]),{image:S,top:V,right:j,bottom:$,left:W,collisionPadding:T}}class zh extends re{constructor(o,c,f,_,E){super(o,c),this.angle=_,this.z=f,void 0!==E&&(this.segment=E)}clone(){return new zh(this.x,this.y,this.z,this.angle,this.segment)}}function JC(a,o,c,f,_){if(void 0===o.segment)return!0;let E=o,S=o.segment+1,T=0;for(;T>-c/2;){if(S--,S<0)return!1;T-=a[S].dist(E),E=a[S]}T+=a[S].dist(a[S+1]),S++;const O=[];let k=0;for(;T<c/2;){const V=a[S],j=a[S+1];if(!j)return!1;let $=a[S-1].angleTo(V)-V.angleTo(j);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:T,angleDelta:$}),k+=$;T-O[0].distance>f;)k-=O.shift().angleDelta;if(k>_)return!1;S++,T+=V.dist(j)}return!0}function Iv(a){let o=0;for(let c=0;c<a.length-1;c++)o+=a[c].dist(a[c+1]);return o}function Yb(a,o,c){return a?.6*o*c:0}function Kb(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function eS(a,o,c,f,_,E){const S=Yb(c,_,E),T=Kb(c,f)*E;let O=0;const k=Iv(a)/2;for(let V=0;V<a.length-1;V++){const j=a[V],$=a[V+1],W=j.dist($);if(O+W>k){const K=(k-O)/W,te=hr(j.x,$.x,K),ve=hr(j.y,$.y,K),Be=new zh(te,ve,0,$.angleTo(j),V);return!S||JC(a,Be,T,S,o)?Be:void 0}O+=W}}function tS(a,o,c,f,_,E,S,T,O){const k=Yb(f,E,S),V=Kb(f,_),j=V*S,$=0===a[0].x||a[0].x===O||0===a[0].y||a[0].y===O;return o-j<o/4&&(o=j+o/4),Dv(a,$?o/2*T%o:(V/2+2*E)*S*T%o,o,k,c,j,$,!1,O)}function Dv(a,o,c,f,_,E,S,T,O){const k=E/2,V=Iv(a);let j=0,$=o-c,W=[];for(let K=0;K<a.length-1;K++){const te=a[K],ve=a[K+1],Be=te.dist(ve),Je=ve.angleTo(te);for(;$+c<j+Be;){$+=c;const Ne=($-j)/Be,Ze=hr(te.x,ve.x,Ne),rt=hr(te.y,ve.y,Ne);if(Ze>=0&&Ze<O&&rt>=0&&rt<O&&$-k>=0&&$+k<=V){const st=new zh(Ze,rt,0,Je,K);st._round(),f&&!JC(a,st,E,f,_)||W.push(st)}}j+=Be}return T||W.length||S||(W=Dv(a,j/2,c,f,_,E,S,!0,O)),W}function Um(a,o,c,f,_){const E=[];for(let S=0;S<a.length;S++){const T=a[S];let O;for(let k=0;k<T.length-1;k++){let V=T[k],j=T[k+1];V.x<o&&j.x<o||(V.x<o?V=new re(o,V.y+(o-V.x)/(j.x-V.x)*(j.y-V.y))._round():j.x<o&&(j=new re(o,V.y+(o-V.x)/(j.x-V.x)*(j.y-V.y))._round()),V.y<c&&j.y<c||(V.y<c?V=new re(V.x+(c-V.y)/(j.y-V.y)*(j.x-V.x),c)._round():j.y<c&&(j=new re(V.x+(c-V.y)/(j.y-V.y)*(j.x-V.x),c)._round()),V.x>=f&&j.x>=f||(V.x>=f?V=new re(f,V.y+(f-V.x)/(j.x-V.x)*(j.y-V.y))._round():j.x>=f&&(j=new re(f,V.y+(f-V.x)/(j.x-V.x)*(j.y-V.y))._round()),V.y>=_&&j.y>=_||(V.y>=_?V=new re(V.x+(_-V.y)/(j.y-V.y)*(j.x-V.x),_)._round():j.y>=_&&(j=new re(V.x+(_-V.y)/(j.y-V.y)*(j.x-V.x),_)._round()),O&&V.equals(O[O.length-1])||(O=[V],E.push(O)),O.push(j)))))}}return E}On(zh,"Anchor");const Pp=1e20;function o_(a,o,c,f,_,E,S,T,O){for(let k=o;k<o+f;k++)Qb(a,c*E+k,E,_,S,T,O);for(let k=c;k<c+_;k++)Qb(a,k*E+o,1,f,S,T,O)}function Qb(a,o,c,f,_,E,S){E[0]=0,S[0]=-Pp,S[1]=Pp,_[0]=a[o];for(let T=1,O=0,k=0;T<f;T++){_[T]=a[o+T*c];const V=T*T;do{const j=E[O];k=(_[T]-_[j]+V-j*j)/(T-j)/2}while(k<=S[O]&&--O>-1);O++,E[O]=T,S[O]=k,S[O+1]=Pp}for(let T=0,O=0;T<f;T++){for(;S[O+1]<T;)O++;const k=E[O],V=T-k;a[o+T*c]=_[k]+V*V}}const Vs=2,Tv={none:0,ideographs:1,all:2};class Rp{constructor(o,c,f){this.requestManager=o,this.localGlyphMode=c,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,c){const f=[];for(const _ in o)for(const E of o[_])f.push({stack:_,id:E});it(f,({stack:_,id:E},S)=>{let T=this.entries[_];T||(T=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let O=T.glyphs[E];if(void 0!==O)return void S(null,{stack:_,id:E,glyph:O});if(O=this._tinySDF(T,_,E),O)return T.glyphs[E]=O,void S(null,{stack:_,id:E,glyph:O});const k=Math.floor(E/256);if(256*k>65535)return void S(new Error("glyphs > 65535 not supported"));if(T.ranges[k])return void S(null,{stack:_,id:E,glyph:O});let V=T.requests[k];V||(V=T.requests[k]=[],Rp.loadGlyphRange(_,k,this.url,this.requestManager,(j,$)=>{if($){T.ascender=$.ascender,T.descender=$.descender;for(const W in $.glyphs)this._doesCharSupportLocalGlyph(+W)||(T.glyphs[+W]=$.glyphs[+W]);T.ranges[k]=!0}for(const W of V)W(j,$);delete T.requests[k]})),V.push((j,$)=>{j?S(j):$&&S(null,{stack:_,id:E,glyph:$.glyphs[E]||null})})},(_,E)=>{if(_)c(_);else if(E){const S={};for(const{stack:T,id:O,glyph:k}of E)void 0===S[T]&&(S[T]={}),void 0===S[T].glyphs&&(S[T].glyphs={}),S[T].glyphs[O]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},S[T].ascender=this.entries[T].ascender,S[T].descender=this.entries[T].descender;c(null,S)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==Tv.none&&(this.localGlyphMode===Tv.all?!!this.localFontFamily:!!this.localFontFamily&&(Wn["CJK Unified Ideographs"](o)||Wn["Hangul Syllables"](o)||Wn.Hiragana(o)||Wn.Katakana(o)||Wn["CJK Symbols and Punctuation"](o)))}_tinySDF(o,c,f){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(f))return;let E=o.tinySDF;if(!E){let te="400";/bold/i.test(c)?te="900":/medium/i.test(c)?te="500":/light/i.test(c)&&(te="200"),E=o.tinySDF=new Rp.TinySDF({fontFamily:_,fontWeight:te,fontSize:24*Vs,buffer:3*Vs,radius:8*Vs}),E.fontWeight=te}if(this.localGlyphs[E.fontWeight][f])return this.localGlyphs[E.fontWeight][f];const S=String.fromCharCode(f),{data:T,width:O,height:k,glyphWidth:V,glyphHeight:j,glyphLeft:$,glyphTop:W,glyphAdvance:K}=E.draw(S);return this.localGlyphs[E.fontWeight][f]={id:f,bitmap:new hu({width:O,height:k},T),metrics:{width:V/Vs,height:j/Vs,left:$/Vs,top:W/Vs-27,advance:K/Vs,localGlyph:!0}}}}Rp.loadGlyphRange=function(a,o,c,f,_){const E=256*o,S=E+255,T=f.transformRequest(f.normalizeGlyphsURL(c).replace("{fontstack}",a).replace("{range}",`${E}-${S}`),Nr.Glyphs);Xo(T,(O,k)=>{if(O)_(O);else if(k){const V={},j=new i_(k).readFields(pu,{});for(const $ of j.glyphs)V[$.id]=$;_(null,{glyphs:V,ascender:j.ascender,descender:j.descender})}})},Rp.TinySDF=class{constructor({fontSize:a=24,buffer:o=3,radius:c=8,cutoff:f=.25,fontFamily:_="sans-serif",fontWeight:E="normal",fontStyle:S="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=c;const T=this.size=a+4*o,O=this._createCanvas(T),k=this.ctx=O.getContext("2d",{willReadFrequently:!0});k.font=`${S} ${E} ${a}px ${_}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(a){const o=document.createElement("canvas");return o.width=o.height=a,o}draw(a){const{width:o,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:_,actualBoundingBoxRight:E}=this.ctx.measureText(a),S=Math.ceil(c),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(E-_))),O=Math.min(this.size-this.buffer,S+Math.ceil(f)),k=T+2*this.buffer,V=O+2*this.buffer,j=Math.max(k*V,0),$=new Uint8ClampedArray(j),W={data:$,width:k,height:V,glyphWidth:T,glyphHeight:O,glyphTop:S,glyphLeft:0,glyphAdvance:o};if(0===T||0===O)return W;const{ctx:K,buffer:te,gridInner:ve,gridOuter:Be}=this;K.clearRect(te,te,T,O),K.fillText(a,te,te+S);const Je=K.getImageData(te,te,T,O);Be.fill(Pp,0,j),ve.fill(0,0,j);for(let Ne=0;Ne<O;Ne++)for(let Ze=0;Ze<T;Ze++){const rt=Je.data[4*(Ne*T+Ze)+3]/255;if(0===rt)continue;const st=(Ne+te)*k+Ze+te;if(1===rt)Be[st]=0,ve[st]=Pp;else{const Vt=.5-rt;Be[st]=Vt>0?Vt*Vt:0,ve[st]=Vt<0?Vt*Vt:0}}o_(Be,0,0,k,V,k,this.f,this.v,this.z),o_(ve,te,te,T,O,k,this.f,this.v,this.z);for(let Ne=0;Ne<j;Ne++){const Ze=Math.sqrt(Be[Ne])-Math.sqrt(ve[Ne]);$[Ne]=Math.round(255-255*(Ze/this.radius+this.cutoff))}return W}};const Vu=Pc;function Av(a,o,c,f){const _=[],E=a.image,S=E.pixelRatio,T=E.paddedRect.w-2*Vu,O=E.paddedRect.h-2*Vu,k=a.right-a.left,V=a.bottom-a.top,j=E.stretchX||[[0,T]],$=E.stretchY||[[0,O]],W=($t,an)=>$t+an[1]-an[0],K=j.reduce(W,0),te=$.reduce(W,0),ve=T-K,Be=O-te;let Je=0,Ne=K,Ze=0,rt=te,st=0,Vt=ve,At=0,en=Be;if(E.content&&f){const $t=E.content;Je=s_(j,0,$t[0]),Ze=s_($,0,$t[1]),Ne=s_(j,$t[0],$t[2]),rt=s_($,$t[1],$t[3]),st=$t[0]-Je,At=$t[1]-Ze,Vt=$t[2]-$t[0]-Ne,en=$t[3]-$t[1]-rt}const bn=($t,an,ln,gn)=>{const In=a_($t.stretch-Je,Ne,k,a.left),Jt=l_($t.fixed-st,Vt,$t.stretch,K),Hn=a_(an.stretch-Ze,rt,V,a.top),ti=l_(an.fixed-At,en,an.stretch,te),qn=a_(ln.stretch-Je,Ne,k,a.left),ir=l_(ln.fixed-st,Vt,ln.stretch,K),Tn=a_(gn.stretch-Ze,rt,V,a.top),bi=l_(gn.fixed-At,en,gn.stretch,te),rr=new re(In,Hn),kr=new re(qn,Hn),Wi=new re(qn,Tn),Ri=new re(In,Tn),Fo=new re(Jt/S,ti/S),Ji=new re(ir/S,bi/S),er=o*Math.PI/180;if(er){const Wo=Math.sin(er),ai=Math.cos(er),Gn=[ai,-Wo,Wo,ai];rr._matMult(Gn),kr._matMult(Gn),Ri._matMult(Gn),Wi._matMult(Gn)}const Ho=$t.stretch+$t.fixed,qo=an.stretch+an.fixed;return{tl:rr,tr:kr,bl:Ri,br:Wi,tex:{x:E.paddedRect.x+Vu+Ho,y:E.paddedRect.y+Vu+qo,w:ln.stretch+ln.fixed-Ho,h:gn.stretch+gn.fixed-qo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fo,pixelOffsetBR:Ji,minFontScaleX:Vt/S/k,minFontScaleY:en/S/V,isSDF:c}};if(f&&(E.stretchX||E.stretchY)){const $t=Jb(j,ve,K),an=Jb($,Be,te);for(let ln=0;ln<$t.length-1;ln++){const gn=$t[ln],In=$t[ln+1];for(let Jt=0;Jt<an.length-1;Jt++)_.push(bn(gn,an[Jt],In,an[Jt+1]))}}else _.push(bn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:O+1}));return _}function s_(a,o,c){let f=0;for(const _ of a)f+=Math.max(o,Math.min(c,_[1]))-Math.max(o,Math.min(c,_[0]));return f}function Jb(a,o,c){const f=[{fixed:-Vu,stretch:0}];for(const[_,E]of a){const S=f[f.length-1];f.push({fixed:_-S.stretch,stretch:S.stretch}),f.push({fixed:_-S.stretch,stretch:S.stretch+(E-_)})}return f.push({fixed:o+Vu,stretch:c}),f}function a_(a,o,c,f){return a/o*c+f}function l_(a,o,c,f){return a-o*c/f}function e1(a,o,c,f){const _=o+a.positionedLines[f].lineOffset;return 0===f?c+_/2:c+(_+(o+a.positionedLines[f-1].lineOffset))/2}class dA{constructor(o=[],c=hA){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:f}=this,_=c[o];for(;o>0;){const E=o-1>>1,S=c[E];if(f(_,S)>=0)break;c[o]=S,o=E}c[o]=_}_down(o){const{data:c,compare:f}=this,_=this.length>>1,E=c[o];for(;o<_;){let S=1+(o<<1),T=c[S];const O=S+1;if(O<this.length&&f(c[O],T)<0&&(S=O,T=c[O]),f(T,E)>=0)break;c[o]=T,o=S}c[o]=E}}function hA(a,o){return a<o?-1:a>o?1:0}function jm(a,o=1,c=!1){let f=1/0,_=1/0,E=-1/0,S=-1/0;const T=a[0];for(let W=0;W<T.length;W++){const K=T[W];(!W||K.x<f)&&(f=K.x),(!W||K.y<_)&&(_=K.y),(!W||K.x>E)&&(E=K.x),(!W||K.y>S)&&(S=K.y)}const O=Math.min(E-f,S-_);let k=O/2;const V=new dA([],Pn);if(0===O)return new re(f,_);for(let W=f;W<E;W+=O)for(let K=_;K<S;K+=O)V.push(new Md(W+k,K+k,k,a));let j=function(W){let K=0,te=0,ve=0;const Be=W[0];for(let Je=0,Ne=Be.length,Ze=Ne-1;Je<Ne;Ze=Je++){const rt=Be[Je],st=Be[Ze],Vt=rt.x*st.y-st.x*rt.y;te+=(rt.x+st.x)*Vt,ve+=(rt.y+st.y)*Vt,K+=3*Vt}return new Md(te/K,ve/K,0,W)}(a),$=V.length;for(;V.length;){const W=V.pop();(W.d>j.d||!j.d)&&(j=W,c&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,$)),W.max-j.d<=o||(k=W.h/2,V.push(new Md(W.p.x-k,W.p.y-k,k,a)),V.push(new Md(W.p.x+k,W.p.y-k,k,a)),V.push(new Md(W.p.x-k,W.p.y+k,k,a)),V.push(new Md(W.p.x+k,W.p.y+k,k,a)),$+=4)}return c&&(console.log(`num probes: ${$}`),console.log(`best distance: ${j.d}`)),j.p}function Pn(a,o){return o.max-a.max}class Md{constructor(o,c,f,_){this.p=new re(o,c),this.h=f,this.d=function(E,S){let T=!1,O=1/0;for(let k=0;k<S.length;k++){const V=S[k];for(let j=0,$=V.length,W=$-1;j<$;W=j++){const K=V[j],te=V[W];K.y>E.y!=te.y>E.y&&E.x<(te.x-K.x)*(E.y-K.y)/(te.y-K.y)+K.x&&(T=!T),O=Math.min(O,hb(E,K,te))}}return(T?1:-1)*Math.sqrt(O)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}}const Lf=7,c_=Number.POSITIVE_INFINITY,Pv=Math.sqrt(2);function u_(a,[o,c]){let f=0,_=0;if(c===c_){o<0&&(o=0);const E=o/Pv;switch(a){case"top-right":case"top-left":_=E-Lf;break;case"bottom-right":case"bottom-left":_=-E+Lf;break;case"bottom":_=-o+Lf;break;case"top":_=o-Lf}switch(a){case"top-right":case"bottom-right":f=-E;break;case"top-left":case"bottom-left":f=E;break;case"left":f=o;break;case"right":f=-o}}else{switch(o=Math.abs(o),c=Math.abs(c),a){case"top-right":case"top-left":case"top":_=c-Lf;break;case"bottom-right":case"bottom-left":case"bottom":_=-c+Lf}switch(a){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}}return[f,_]}function nS(a,o,c,f,_,E,S,T,O,k){a.createArrays(),a.tilePixelRatio=Ei/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const V=a.layers[0].layout,j=a.layers[0]._unevaluatedLayout._values,$={};if("composite"===a.textSizeData.kind){const{minZoom:te,maxZoom:ve}=a.textSizeData;$.compositeTextSizes=[j["text-size"].possiblyEvaluate(new U(te),T),j["text-size"].possiblyEvaluate(new U(ve),T)]}if("composite"===a.iconSizeData.kind){const{minZoom:te,maxZoom:ve}=a.iconSizeData;$.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new U(te),T),j["icon-size"].possiblyEvaluate(new U(ve),T)]}$.layoutTextSize=j["text-size"].possiblyEvaluate(new U(O+1),T),$.layoutIconSize=j["icon-size"].possiblyEvaluate(new U(O+1),T),$.textMaxSize=j["text-size"].possiblyEvaluate(new U(18),T);const W="map"===V.get("text-rotation-alignment")&&"point"!==V.get("symbol-placement"),K=V.get("text-size");for(const te of a.features){const ve=V.get("text-font").evaluate(te,{},T).join(","),Be=K.evaluate(te,{},T),Je=$.layoutTextSize.evaluate(te,{},T),Ne=($.layoutIconSize.evaluate(te,{},T),{horizontal:{},vertical:void 0}),Ze=te.text;let rt,st=[0,0];if(Ze){const en=Ze.toString(),bn=V.get("text-letter-spacing").evaluate(te,{},T)*nl,$t=V.get("text-line-height").evaluate(te,{},T)*nl,an=Dg(en)?bn:0,ln=V.get("text-anchor").evaluate(te,{},T),gn=V.get("text-variable-anchor");if(!gn){const qn=V.get("text-radial-offset").evaluate(te,{},T);st=qn?u_(ln,[qn*nl,c_]):V.get("text-offset").evaluate(te,{},T).map(ir=>ir*nl)}let In=W?"center":V.get("text-justify").evaluate(te,{},T);const Jt="point"===V.get("symbol-placement"),Hn=Jt?V.get("text-max-width").evaluate(te,{},T)*nl:1/0,ti=qn=>{a.allowVerticalPlacement&&Ig(en)&&(Ne.vertical=Ev(Ze,o,c,_,ve,Hn,$t,ln,qn,an,st,Gc.vertical,!0,Je,Be))};if(!W&&gn){const qn="auto"===In?gn.map(Tn=>d_(Tn)):[In];let ir=!1;for(let Tn=0;Tn<qn.length;Tn++){const bi=qn[Tn];if(!Ne.horizontal[bi])if(ir)Ne.horizontal[bi]=Ne.horizontal[0];else{const rr=Ev(Ze,o,c,_,ve,Hn,$t,"center",bi,an,st,Gc.horizontal,!1,Je,Be);rr&&(Ne.horizontal[bi]=rr,ir=1===rr.positionedLines.length)}}ti("left")}else{if("auto"===In&&(In=d_(ln)),Jt||V.get("text-writing-mode").indexOf("horizontal")>=0||!Ig(en)){const qn=Ev(Ze,o,c,_,ve,Hn,$t,ln,In,an,st,Gc.horizontal,!1,Je,Be);qn&&(Ne.horizontal[In]=qn)}ti(Jt?"left":In)}}let Vt=!1;if(te.icon&&te.icon.name){const en=f[te.icon.name];en&&(rt=Mv(_[te.icon.name],V.get("icon-offset").evaluate(te,{},T),V.get("icon-anchor").evaluate(te,{},T)),Vt=en.sdf,void 0===a.sdfIcons?a.sdfIcons=en.sdf:a.sdfIcons!==en.sdf&&Ii("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(en.pixelRatio!==a.pixelRatio||0!==V.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const At=n1(Ne.horizontal)||Ne.vertical;a.iconsInText||(a.iconsInText=!!At&&At.iconsInText),(At||rt)&&t1(a,te,Ne,rt,f,$,Je,0,st,Vt,S,T,k)}E&&a.generateCollisionDebugBuffers(O,a.collisionBoxArray)}function d_(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function t1(a,o,c,f,_,E,S,T,O,k,V,j,$){let W=E.textMaxSize.evaluate(o,{},j);void 0===W&&(W=S);const K=a.layers[0].layout,te=K.get("icon-offset").evaluate(o,{},j),ve=n1(c.horizontal)||c.vertical,Be="globe"===$.name,Je=nl,Ne=S/Je,Ze=a.tilePixelRatio*W/Je,rt=(ln=a.overscaling,a.zoom>18&&ln>2&&(ln>>=1),Math.max(Ei/(512*ln),1)*K.get("symbol-spacing")),st=K.get("text-padding")*a.tilePixelRatio,Vt=K.get("icon-padding")*a.tilePixelRatio,At=ot(K.get("text-max-angle")),en="map"===K.get("text-rotation-alignment")&&"point"!==K.get("symbol-placement"),bn="map"===K.get("icon-rotation-alignment")&&"point"!==K.get("symbol-placement"),$t=K.get("symbol-placement"),an=rt/2;var ln;const gn=K.get("icon-text-fit");let In;f&&"none"!==gn&&(a.allowVerticalPlacement&&c.vertical&&(In=r_(f,c.vertical,gn,K.get("icon-text-fit-padding"),te,Ne)),ve&&(f=r_(f,ve,gn,K.get("icon-text-fit-padding"),te,Ne)));const Jt=(Hn,ti,qn)=>{if(ti.x<0||ti.x>=Ei||ti.y<0||ti.y>=Ei)return;let ir=null;if(Be){const{x:Tn,y:bi,z:rr}=$.projectTilePoint(ti.x,ti.y,qn);ir={anchor:new zh(Tn,bi,rr,0,void 0),up:$.upVector(qn,ti.x,ti.y)}}!function(Tn,bi,rr,kr,Wi,Ri,Fo,Ji,er,Ho,qo,Wo,ai,Gn,Js,Et,Mo,Ra,ea,ts,Lr,Us,Zo,Pl,aa){const ja=Tn.addToLineVertexArray(bi,kr);let Ga,Rl,il,ad,zp,Vp,eg,y1=0,v1=0,x1=0,Jv=0,S_=-1,e0=-1;const Ad={};let Wc=Rg("");const jf=rr?rr.anchor:bi;let t0=0,b1=0;if(void 0===er._unevaluatedLayout.getValue("text-radial-offset")?[t0,b1]=er.layout.get("text-offset").evaluate(Lr,{},aa).map(Zc=>Zc*nl):(t0=er.layout.get("text-radial-offset").evaluate(Lr,{},aa)*nl,b1=c_),Tn.allowVerticalPlacement&&Wi.vertical){const Zc=Wi.vertical;if(Js)Vp=f_(Zc),Ji&&(eg=f_(Ji));else{const Xc=er.layout.get("text-rotate").evaluate(Lr,{},aa)+90;il=Op(Ho,jf,bi,qo,Wo,ai,Zc,Gn,Xc,Et),Ji&&(ad=Op(Ho,jf,bi,qo,Wo,ai,Ji,Ra,Xc))}}if(Ri){const Zc=er.layout.get("icon-rotate").evaluate(Lr,{},aa),Xc="none"!==er.layout.get("icon-text-fit"),Up=Av(Ri,Zc,Zo,Xc),n0=Ji?Av(Ji,Zc,Zo,Xc):void 0;Rl=Op(Ho,jf,bi,qo,Wo,ai,Ri,Ra,Zc),y1=4*Up.length;const w1=Tn.iconSizeData;let sh=null;"source"===w1.kind?(sh=[fu*er.layout.get("icon-size").evaluate(Lr,{},aa)],sh[0]>Nf&&Ii(`${Tn.layerIds[0]}: Value for "icon-size" is >= ${Vh}. Reduce your "icon-size".`)):"composite"===w1.kind&&(sh=[fu*Us.compositeIconSizes[0].evaluate(Lr,{},aa),fu*Us.compositeIconSizes[1].evaluate(Lr,{},aa)],(sh[0]>Nf||sh[1]>Nf)&&Ii(`${Tn.layerIds[0]}: Value for "icon-size" is >= ${Vh}. Reduce your "icon-size".`)),Tn.addSymbols(Tn.icon,Up,sh,ts,ea,Lr,!1,rr,bi,ja.lineStartIndex,ja.lineLength,-1,Pl,aa),S_=Tn.icon.placedSymbolArray.length-1,n0&&(v1=4*n0.length,Tn.addSymbols(Tn.icon,n0,sh,ts,ea,Lr,Gc.vertical,rr,bi,ja.lineStartIndex,ja.lineLength,-1,Pl,aa),e0=Tn.icon.placedSymbolArray.length-1)}for(const Zc in Wi.horizontal){const Xc=Wi.horizontal[Zc];Ga||(Wc=Rg(Xc.text),Js?zp=f_(Xc):Ga=Op(Ho,jf,bi,qo,Wo,ai,Xc,Gn,er.layout.get("text-rotate").evaluate(Lr,{},aa),Et));const Up=1===Xc.positionedLines.length;if(x1+=h_(Tn,rr,bi,Xc,Fo,er,Js,Lr,Et,ja,Wi.vertical?Gc.horizontal:Gc.horizontalOnly,Up?Object.keys(Wi.horizontal):[Zc],Ad,S_,Us,Pl,aa),Up)break}Wi.vertical&&(Jv+=h_(Tn,rr,bi,Wi.vertical,Fo,er,Js,Lr,Et,ja,Gc.vertical,["vertical"],Ad,e0,Us,Pl,aa));let Pd=-1;const M_=(Zc,Xc)=>Zc?Math.max(Zc,Xc):Xc;Pd=M_(zp,Pd),Pd=M_(Vp,Pd),Pd=M_(eg,Pd);const mS=Pd>-1?1:0;Tn.glyphOffsetArray.length>=Id.MAX_GLYPHS&&Ii("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Lr.sortKey&&Tn.addToSortKeyRanges(Tn.symbolInstances.length,Lr.sortKey),Tn.symbolInstances.emplaceBack(jf.x,jf.y,jf.z,bi.x,bi.y,Ad.right>=0?Ad.right:-1,Ad.center>=0?Ad.center:-1,Ad.left>=0?Ad.left:-1,Ad.vertical>=0?Ad.vertical:-1,S_,e0,Wc,void 0!==Ga?Ga:Tn.collisionBoxArray.length,void 0!==Ga?Ga+1:Tn.collisionBoxArray.length,void 0!==il?il:Tn.collisionBoxArray.length,void 0!==il?il+1:Tn.collisionBoxArray.length,void 0!==Rl?Rl:Tn.collisionBoxArray.length,void 0!==Rl?Rl+1:Tn.collisionBoxArray.length,ad||Tn.collisionBoxArray.length,ad?ad+1:Tn.collisionBoxArray.length,qo,x1,Jv,y1,v1,mS,0,t0,b1,Pd)}(a,ti,ir,Hn,c,f,_,In,a.layers[0],a.collisionBoxArray,o.index,o.sourceLayerIndex,a.index,st,en,O,0,Vt,bn,te,o,E,k,V,j)};if("line"===$t)for(const Hn of Um(o.geometry,0,0,Ei,Ei)){const ti=tS(Hn,rt,At,c.vertical||ve,f,Je,Ze,a.overscaling,Ei);for(const qn of ti)ve&&r1(a,ve.text,an,qn)||Jt(Hn,qn,j)}else if("line-center"===$t){for(const Hn of o.geometry)if(Hn.length>1){const ti=eS(Hn,At,c.vertical||ve,f,Je,Ze);ti&&Jt(Hn,ti,j)}}else if("Polygon"===o.type)for(const Hn of rv(o.geometry,0)){const ti=jm(Hn,16);Jt(Hn[0],new zh(ti.x,ti.y,0,0,void 0),j)}else if("LineString"===o.type)for(const Hn of o.geometry)Jt(Hn,new zh(Hn[0].x,Hn[0].y,0,0,void 0),j);else if("Point"===o.type)for(const Hn of o.geometry)for(const ti of Hn)Jt([ti],new zh(ti.x,ti.y,0,0,void 0),j)}const Vh=255,Nf=Vh*fu;function h_(a,o,c,f,_,E,S,T,O,k,V,j,$,W,K,te,ve){const Be=function(Ze,rt,st,Vt,At,en,bn,$t){const an=[];if(0===rt.positionedLines.length)return an;const ln=Vt.layout.get("text-rotate").evaluate(en,{})*Math.PI/180,gn=function(qn){const ir=qn[0],Tn=qn[1],bi=ir*Tn;return bi>0?[ir,-Tn]:bi<0?[-ir,Tn]:0===ir?[Tn,ir]:[Tn,-ir]}(st);let In=Math.abs(rt.top-rt.bottom);for(const qn of rt.positionedLines)In-=qn.lineOffset;const Jt=rt.positionedLines.length,Hn=In/Jt;let ti=rt.top-st[1];for(let qn=0;qn<Jt;++qn){const ir=rt.positionedLines[qn];ti=e1(rt,Hn,ti,qn);for(const Tn of ir.positionedGlyphs){if(!Tn.rect)continue;const bi=Tn.rect||{};let rr=Hb+1,kr=!0,Wi=1,Ri=0;if(Tn.imageName){const Zo=bn[Tn.imageName];if(!Zo)continue;if(Zo.sdf){Ii("SDF images are not supported in formatted text and will be ignored.");continue}kr=!1,Wi=Zo.pixelRatio,rr=Pc/Wi}const Fo=(At||$t)&&Tn.vertical,Ji=Tn.metrics.advance*Tn.scale/2,er=Tn.metrics,Ho=Tn.rect;if(null===Ho)continue;$t&&rt.verticalizable&&(Ri=Tn.imageName?Ji-Tn.metrics.width*Tn.scale/2:0);const qo=At?[Tn.x+Ji,Tn.y]:[0,0];let Wo=[0,0],ai=[0,0],Gn=!1;At||(Fo?(ai=[Tn.x+Ji+gn[0],Tn.y+gn[1]-Ri],Gn=!0):Wo=[Tn.x+Ji+st[0],Tn.y+st[1]-Ri]);const Js=Ho.w*Tn.scale/(Wi*(Tn.localGlyph?Vs:1)),Et=Ho.h*Tn.scale/(Wi*(Tn.localGlyph?Vs:1));let Mo,Ra,ea,ts;if(Fo){const Zo=Tn.y-ti,Pl=new re(-Ji,Ji-Zo),aa=-Math.PI/2,ja=new re(...ai);Mo=new re(-Ji+Wo[0],Wo[1]),Mo._rotateAround(aa,Pl)._add(ja),Mo.x+=-Zo+Ji,Mo.y-=(er.left-rr)*Tn.scale;const Ga=Tn.imageName?er.advance*Tn.scale:nl*Tn.scale,Rl=String.fromCharCode(Tn.glyph);WC(Rl)?Mo.x+=(1-rr)*Tn.scale:ZC(Rl)?Mo.x+=Ga-er.height*Tn.scale+(-rr-1)*Tn.scale:Mo.x+=Tn.imageName||er.width+2*rr===Ho.w&&er.height+2*rr===Ho.h?(Ga-Et)/2:(Ga-(er.height+2*rr)*Tn.scale)/2,Ra=new re(Mo.x,Mo.y-Js),ea=new re(Mo.x+Et,Mo.y),ts=new re(Mo.x+Et,Mo.y-Js)}else{const Zo=(er.left-rr)*Tn.scale-Ji+Wo[0],Pl=(-er.top-rr)*Tn.scale+Wo[1],aa=Zo+Js,ja=Pl+Et;Mo=new re(Zo,Pl),Ra=new re(aa,Pl),ea=new re(Zo,ja),ts=new re(aa,ja)}if(ln){let Zo;Zo=At?new re(0,0):Gn?new re(gn[0],gn[1]):new re(st[0],st[1]),Mo._rotateAround(ln,Zo),Ra._rotateAround(ln,Zo),ea._rotateAround(ln,Zo),ts._rotateAround(ln,Zo)}const Lr=new re(0,0),Us=new re(0,0);an.push({tl:Mo,tr:Ra,bl:ea,br:ts,tex:bi,writingMode:rt.writingMode,glyphOffset:qo,sectionIndex:Tn.sectionIndex,isSDF:kr,pixelOffsetTL:Lr,pixelOffsetBR:Us,minFontScaleX:0,minFontScaleY:0})}}return an}(0,f,O,E,S,T,_,a.allowVerticalPlacement),Je=a.textSizeData;let Ne=null;"source"===Je.kind?(Ne=[fu*E.layout.get("text-size").evaluate(T,{},ve)],Ne[0]>Nf&&Ii(`${a.layerIds[0]}: Value for "text-size" is >= ${Vh}. Reduce your "text-size".`)):"composite"===Je.kind&&(Ne=[fu*K.compositeTextSizes[0].evaluate(T,{},ve),fu*K.compositeTextSizes[1].evaluate(T,{},ve)],(Ne[0]>Nf||Ne[1]>Nf)&&Ii(`${a.layerIds[0]}: Value for "text-size" is >= ${Vh}. Reduce your "text-size".`)),a.addSymbols(a.text,Be,Ne,O,S,T,V,o,c,k.lineStartIndex,k.lineLength,W,te,ve);for(const Ze of j)$[Ze]=a.text.placedSymbolArray.length-1;return 4*Be.length}function n1(a){for(const o in a)return a[o];return null}function Op(a,o,c,f,_,E,S,T,O,k){let V=S.top,j=S.bottom,$=S.left,W=S.right;const K=S.collisionPadding;if(K&&($-=K[0],V-=K[1],W+=K[2],j+=K[3]),O){const te=new re($,V),ve=new re(W,V),Be=new re($,j),Je=new re(W,j),Ne=ot(O);let Ze=new re(0,0);k&&(Ze=new re(k[0],k[1])),te._rotateAround(Ne,Ze),ve._rotateAround(Ne,Ze),Be._rotateAround(Ne,Ze),Je._rotateAround(Ne,Ze),$=Math.min(te.x,ve.x,Be.x,Je.x),W=Math.max(te.x,ve.x,Be.x,Je.x),V=Math.min(te.y,ve.y,Be.y,Je.y),j=Math.max(te.y,ve.y,Be.y,Je.y)}return a.emplaceBack(o.x,o.y,o.z,c.x,c.y,$,V,W,j,T,f,_,E),a.length-1}function f_(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const o=a.bottom-a.top;return o>0?Math.max(10,o):null}function r1(a,o,c,f){const _=a.compareText;if(o in _){const E=_[o];for(let S=E.length-1;S>=0;S--)if(f.dist(E[S])<c)return!0}else _[o]=[];return _[o].push(f),!1}function Uh(a,o){const c=a.fovAboveCenter,f=a.elevation?a.elevation.getMinElevationBelowMSL()*o:0,_=(a._camera.position[2]*a.worldSize-f)/Math.cos(a._pitch),E=Math.sin(c)*_/Math.sin(Math.max(Math.PI/2-a._pitch-c,.01)),S=Math.sin(a._pitch)*E+_;return Math.min(1.01*S,_*(1/a._horizonShift))}function Ff(a,o){if(!o.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:o};const c=Math.pow(2,-a.z),f=a.x*c,_=(a.x+1)*c,E=a.y*c,S=(a.y+1)*c,T=zu(f),O=zu(_),k=Zl(E),V=Zl(S),j=o.project(T,k),$=o.project(O,k),W=o.project(O,V),K=o.project(T,V);let te=Math.min(j.x,$.x,W.x,K.x),ve=Math.min(j.y,$.y,W.y,K.y),Be=Math.max(j.x,$.x,W.x,K.x),Je=Math.max(j.y,$.y,W.y,K.y);const Ne=c/16;function Ze(st,Vt,At,en,bn,$t){const an=(At+bn)/2,ln=(en+$t)/2,gn=o.project(zu(an),Zl(ln)),In=Math.max(0,te-gn.x,ve-gn.y,gn.x-Be,gn.y-Je);te=Math.min(te,gn.x),Be=Math.max(Be,gn.x),ve=Math.min(ve,gn.y),Je=Math.max(Je,gn.y),In>Ne&&(Ze(st,gn,At,en,an,ln),Ze(gn,Vt,an,ln,bn,$t))}Ze(j,$,f,E,_,E),Ze($,W,_,E,_,S),Ze(W,K,_,S,f,S),Ze(K,j,f,S,f,E),te-=Ne,ve-=Ne,Be+=Ne,Je+=Ne;const rt=1/Math.max(Be-te,Je-ve);return{scale:rt,x:te*rt,y:ve*rt,x2:Be*rt,y2:Je*rt,projection:o}}const Rv=Nu(new Float32Array(16));class od{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,c){return{x:0,y:0,z:0}}unproject(o,c){return new Ur(0,0)}projectTilePoint(o,c,f){return{x:o,y:c,z:0}}locationPoint(o,c,f=!0){return o._coordinatePoint(o.locationCoordinate(c),f)}pixelsPerMeter(o,c){return wd(1,o)*c}pixelSpaceConversion(o,c,f){return 1}farthestPixelDistance(o){return Uh(o,o.pixelsPerMeter)}pointCoordinate(o,c,f,_){const E=o.horizonLineFromTop(!1),S=new re(c,Math.max(E,f));return o.rayIntersectionCoordinate(o.pointRayIntersection(S,_))}pointCoordinate3D(o,c,f){const _=new re(c,f);if(o.elevation)return o.elevation.pointCoordinate(_);{const E=this.pointCoordinate(o,_.x,_.y,0);return[E.x,E.y,E.z]}}isPointAboveHorizon(o,c){if(o.elevation)return!this.pointCoordinate3D(o,c.x,c.y);const f=o.horizonLineFromTop();return c.y<f}createInversionMatrix(o,c){return Rv}createTileMatrix(o,c,f){let _,E,S;const T=f.canonical,O=Nu(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=Ff(T,this);_=1,E=k.x+f.wrap*k.scale,S=k.y,Qd(O,O,[_/k.scale,_/k.scale,o.pixelsPerMeter/c])}else _=c/o.zoomScale(T.z),E=(T.x+Math.pow(2,T.z)*f.wrap)*_,S=T.y*_;return up(O,O,[E,S,0]),Qd(O,O,[_/Ei,_/Ei,1]),O}upVector(o,c,f){return[0,0,1]}upVectorScale(o,c,f){return{metersToTile:1}}}class iS extends od{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[c,f]=this.parallels=o.parallels||[29.5,45.5],_=Math.sin(ot(c));this.n=(_+Math.sin(ot(f)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(o,c){const{n:f,c:_,r0:E}=this,S=ot(o-this.center[0]),T=ot(c),O=Math.sqrt(_-2*f*Math.sin(T))/f;return{x:O*Math.sin(S*f),y:O*Math.cos(S*f)-E,z:0}}unproject(o,c){const{n:f,c:_,r0:E}=this,S=E+c;let T=Math.atan2(o,Math.abs(S))*Math.sign(S);S*f<0&&(T-=Math.PI*Math.sign(o)*Math.sign(S));const O=ot(this.center[0])*f;T=Re(T,-Math.PI-O,Math.PI-O);const k=Ee(Ue(T/f)+this.center[0],-180,180),V=Math.asin(Ee((_-(o*o+S*S)*f*f)/(2*f),-1,1)),j=Ee(Ue(V),-Xl,Xl);return new Ur(k,j)}}const Bf=1.340264,jh=-.081106,Kl=893e-6,Gh=.003796,kp=Math.sqrt(3)/2;class rS extends od{project(o,c){c=c/180*Math.PI,o=o/180*Math.PI;const f=Math.asin(kp*Math.sin(c)),_=f*f,E=_*_*_;return{x:.5*(o*Math.cos(f)/(kp*(Bf+3*jh*_+E*(7*Kl+9*Gh*_)))/Math.PI+.5),y:1-.5*(f*(Bf+jh*_+E*(Kl+Gh*_))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,_=f*f,E=_*_*_;for(let V,j,$,W=0;W<12&&(j=f*(Bf+jh*_+E*(Kl+Gh*_))-c,$=Bf+3*jh*_+E*(7*Kl+9*Gh*_),V=j/$,f=Ee(f-V,-Math.PI/3,Math.PI/3),_=f*f,E=_*_*_,!(Math.abs(V)<1e-12));++W);const S=kp*o*(Bf+3*jh*_+E*(7*Kl+9*Gh*_))/Math.cos(f),T=Math.asin(Math.sin(f)/kp),O=Ee(180*S/Math.PI,-180,180),k=Ee(180*T/Math.PI,-Xl,Xl);return new Ur(O,k)}}class oS extends od{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){return{x:.5+o/360,y:.5-c/360,z:0}}unproject(o,c){const f=360*(o-.5),_=Ee(360*(.5-c),-Xl,Xl);return new Ur(f,_)}}const zf=Math.PI/2;function ih(a){return Math.tan((zf+a)/2)}class sS extends od{constructor(o){super(o),this.center=o.center||[0,30];const[c,f]=this.parallels=o.parallels||[30,30];let _=ot(c),E=ot(f);this.southernCenter=_+E<0,this.southernCenter&&(_=-_,E=-E);const S=Math.cos(_),T=ih(_);this.n=_===E?Math.sin(_):Math.log(S/Math.cos(E))/Math.log(ih(E)/T),this.f=S*Math.pow(ih(_),this.n)/this.n}project(o,c){c=ot(c),this.southernCenter&&(c=-c),o=ot(o-this.center[0]);const f=1e-6,{n:_,f:E}=this;E>0?c<-zf+f&&(c=-zf+f):c>zf-f&&(c=zf-f);const S=E/Math.pow(ih(c),_);let T=S*Math.sin(_*o),O=E-S*Math.cos(_*o);return T=.5*(T/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:T,y:this.southernCenter?O:1-O,z:0}}unproject(o,c){o=(2*o-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:f,f:_}=this,E=_-c,S=Math.sign(E),T=Math.sign(f)*Math.sqrt(o*o+E*E);let O=Math.atan2(o,Math.abs(E))*S;E*f<0&&(O-=Math.PI*Math.sign(o)*S);const k=Ee(Ue(O/f)+this.center[0],-180,180),V=Ee(Ue(2*Math.atan(Math.pow(_/T,1/f))-zf),-Xl,Xl);return new Ur(k,this.southernCenter?-V:V)}}class o1 extends od{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,c){return{x:bd(o),y:eh(c),z:0}}unproject(o,c){const f=zu(o),_=Zl(c);return new Ur(f,_)}}const s1=ot(Xl);class Ov extends od{project(o,c){const f=(c=ot(c))*c,_=f*f;return{x:.5*((o=ot(o))*(.8707-.131979*f+_*(_*(.003971*f-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+f*(.015085+_*(.028874*f-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,_=25,E=0,S=f*f;do{S=f*f;const k=S*S;E=(f*(1.007226+S*(.015085+k*(.028874*S-.044475-.005916*k)))-c)/(1.007226+S*(.045255+k*(.259866*S-.311325-.005916*11*k))),f=Ee(f-E,-s1,s1)}while(Math.abs(E)>1e-6&&--_>0);S=f*f;const T=Ee(Ue(o/(.8707+S*(S*(S*S*S*(.003971-.001529*S)-.013791)-.131979))),-180,180),O=Ue(f);return new Ur(T,O)}}const Gm=ot(Xl);class aS extends od{project(o,c){c=ot(c),o=ot(o);const f=Math.cos(c),_=2/Math.PI,E=Math.acos(f*Math.cos(o/2)),S=Math.sin(E)/E,T=.5*(o*_+2*f*Math.sin(o/2)/S)||0,O=.5*(c+Math.sin(c)/S)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(o,c){let f=o=(2*o-.5)*Math.PI,_=c=(2*(1-c)-1)*Math.PI,E=25;const S=1e-6;let T=0,O=0;do{const k=Math.cos(_),V=Math.sin(_),j=2*V*k,$=V*V,W=k*k,K=Math.cos(f/2),te=Math.sin(f/2),ve=2*K*te,Be=te*te,Je=1-W*K*K,Ne=Je?1/Je:0,Ze=Je?Math.acos(k*K)*Math.sqrt(1/Je):0,rt=.5*(2*Ze*k*te+2*f/Math.PI)-o,st=.5*(Ze*V+_)-c,Vt=.5*Ne*(W*Be+Ze*k*K*$)+1/Math.PI,At=Ne*(ve*j/4-Ze*V*te),en=.125*Ne*(j*te-Ze*V*W*ve),bn=.5*Ne*($*K+Ze*Be*k)+.5,$t=At*en-bn*Vt;T=(st*At-rt*bn)/$t,O=(rt*en-st*Vt)/$t,f=Ee(f-T,-Math.PI,Math.PI),_=Ee(_-O,-Gm,Gm)}while((Math.abs(T)>S||Math.abs(O)>S)&&--E>0);return new Ur(Ue(f),Ue(_))}}class kv extends od{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ot(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){const{scale:f,cosPhi:_}=this;return{x:ot(o)*_*f+.5,y:-Math.sin(ot(c))/_*f+.5,z:0}}unproject(o,c){const{scale:f,cosPhi:_}=this,E=-(c-.5)/f,S=Ee(Ue((o-.5)/f)/_,-180,180),T=Math.asin(Ee(E*_,-1,1)),O=Ee(Ue(T),-Xl,Xl);return new Ur(S,O)}}class $h extends o1{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,c,f){const _=pp(o,c,f);return zs(_,_,ml(rd(f))),{x:_[0],y:_[1],z:_[2]}}locationPoint(o,c){const f=Ef(c.lat,c.lng),_=fl([],f),E=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(c),o._centerAltitude):o._centerAltitude;dp(f,f,_,wd(1,0)*Ei*E);const S=Nu(new Float64Array(16));return gf(S,o.pixelMatrix,o.globeMatrix),zs(f,f,S),new re(f[0],f[1])}pixelsPerMeter(o,c){return wd(1,0)*c}pixelSpaceConversion(o,c,f){const _=wd(1,o)*c,E=hr(wd(1,45)*c,_,f);return this.pixelsPerMeter(o,c)/E}createTileMatrix(o,c,f){const _=$y(rd(f.canonical));return gf(new Float64Array(16),o.globeMatrix,_)}createInversionMatrix(o,c){const{center:f}=o,_=ml(rd(c));return pm(_,_,ot(f.lng)),Fg(_,_,ot(f.lat)),Qd(_,_,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(o,c,f,_){return vm(o,c,f,!0)||new _p(0,0)}pointCoordinate3D(o,c,f){const _=this.pointCoordinate(o,c,f,0);return[_.x,_.y,_.z]}isPointAboveHorizon(o,c){return!vm(o,c.x,c.y,!1)}farthestPixelDistance(o){const c=function(_,E){const S=_.cameraToCenterDistance,T=_._centerAltitude*E,O=_._camera,k=_._camera.forward(),V=es([],zc([],k,-S),[0,0,T]),j=_.worldSize/(2*Math.PI),$=[0,0,-j],W=_.width/_.height,K=Math.tan(_.fovAboveCenter),te=zc([],O.up(),K),ve=zc([],O.right(),K*W),Be=fl([],es([],es([],k,te),ve)),Je=[];let Ne;if(new vf(V,Be).closestPointOnSphere($,j,Je)){const Ze=es([],Je,$),rt=uu([],Ze,V);Ne=Math.cos(_.fovAboveCenter)*hl(rt)}else{const Ze=uu([],V,$),rt=uu([],$,V);fl(rt,rt);const st=hl(Ze)-j;Ne=Math.sqrt(st*(st+2*j));const Vt=Math.acos(Ne/(j+st))-Math.acos(pl(k,rt));Ne*=Math.cos(Vt)}return 1.01*Ne}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),f=Mh(o.zoom);if(f>0){const _=Uh(o,wd(1,o.center.lat)*o.worldSize),E=o.worldSize/(2*Math.PI),S=Math.max(o.width,o.height)/o.worldSize*Math.PI;return hr(c,_+E*(1-Math.cos(S)),Math.pow(f,10))}return c}upVector(o,c,f){return pp(c,f,o,1)}upVectorScale(o){return{metersToTile:ym(Sh(rd(o)))}}}function lS(a){const o=a.parallels,c=!!o&&Math.abs(o[0]+o[1])<.01;switch(a.name){case"mercator":return new o1(a);case"equirectangular":return new oS(a);case"naturalEarth":return new Ov(a);case"equalEarth":return new rS(a);case"winkelTripel":return new aS(a);case"albers":return c?new kv(a):new iS(a);case"lambertConformalConic":return c?new kv(a):new sS(a);case"globe":return new $h(a)}throw new Error(`Invalid projection name: ${a.name}`)}const rh=Im.types,Lv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function p_(a,o,c,f,_,E,S,T,O,k,V,j,$){const W=T?Math.min(Nf,Math.round(T[0])):0,K=T?Math.min(Nf,Math.round(T[1])):0;a.emplaceBack(o,c,Math.round(32*f),Math.round(32*_),E,S,(W<<1)+(O?1:0),K,16*k,16*V,256*j,256*$)}function Nv(a,o,c,f,_,E,S){a.emplaceBack(o,c,f,_,E,S)}function Fv(a,o,c,f,_){a.emplaceBack(o,c,f,_),a.emplaceBack(o,c,f,_),a.emplaceBack(o,c,f,_),a.emplaceBack(o,c,f,_)}function m_(a){for(const o of a.sections)if(gd(o.text))return!0;return!1}class Bv{constructor(o){this.layoutVertexArray=new hn,this.indexArray=new di,this.programConfigurations=o,this.segments=new Jo,this.dynamicLayoutVertexArray=new xn,this.opacityVertexArray=new yi,this.placedSymbolArray=new yo,this.globeExtVertexArray=new Sn}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,c,f,_){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,kb.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Nb.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Lv,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Lb.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||_)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}On(Bv,"SymbolBuffers");class $m{constructor(o,c,f){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new f,this.segments=new Jo,this.collisionVertexArray=new fr,this.collisionVertexArrayExt=new pr}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,mv.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,Fb.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}On($m,"CollisionBuffers");class Id{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(S=>S.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Nu([]),this.placementViewportMatrix=Nu([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sp(this.zoom,c["text-size"]),this.iconSizeData=Sp(this.zoom,c["icon-size"]);const f=this.layers[0].layout,_=f.get("symbol-sort-key"),E=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==E&&void 0!==_.constantOr(1),this.sortFeaturesByY=("viewport-y"===E||"auto"===E&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(S=>Gc[S]),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new Bv(new fc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new Bv(new fc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new Ua,this.lineVertexArray=new Tl,this.symbolInstances=new us}calculateGlyphDependencies(o,c,f,_,E){for(let S=0;S<o.length;S++)if(c[o.charCodeAt(S)]=!0,_&&E){const T=Mp[o.charAt(S)];T&&(c[T.charCodeAt(0)]=!0)}}populate(o,c,f,_){const E=this.layers[0],S=E.layout,T="globe"===this.projection.name,O=S.get("text-font"),k=S.get("text-field"),V=S.get("icon-image"),j=("constant"!==k.value.kind||k.value.value instanceof Qo&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&("constant"!==O.value.kind||O.value.value.length>0),$="constant"!==V.value.kind||!!V.value.value||Object.keys(V.parameters).length>0,W=S.get("symbol-sort-key");if(this.features=[],!j&&!$)return;const K=c.iconDependencies,te=c.glyphDependencies,ve=c.availableImages,Be=new U(this.zoom);for(const{feature:Je,id:Ne,index:Ze,sourceLayerIndex:rt}of o){const st=E._featureFilter.needGeometry,Vt=Cd(Je,st);if(!E._featureFilter.filter(Be,Vt,f))continue;if(st||(Vt.geometry=Ed(Je,f,_)),T&&1!==Je.type&&f.z<=5){const $t=Vt.geometry,an=.98078528056,ln=(gn,In)=>pl(pp(gn.x,gn.y,f,1),pp(In.x,In.y,f,1))<an;for(let gn=0;gn<$t.length;gn++)$t[gn]=xm($t[gn],ln)}let At,en;if(j){const $t=E.getValueAndResolveTokens("text-field",Vt,f,ve),an=Qo.factory($t);m_(an)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===P()||this.hasRTLText&&B.isParsed())&&(At=qC(an,E,Vt))}if($){const $t=E.getValueAndResolveTokens("icon-image",Vt,f,ve);en=$t instanceof Pi?$t:Pi.fromString($t)}if(!At&&!en)continue;const bn=this.sortFeaturesByKey?W.evaluate(Vt,{},f):void 0;if(this.features.push({id:Ne,text:At,icon:en,index:Ze,sourceLayerIndex:rt,geometry:Vt.geometry,properties:Je.properties,type:rh[Je.type],sortKey:bn}),en&&(K[en.name]=!0),At){const $t=O.evaluate(Vt,{},f).join(","),an="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Gc.vertical)>=0;for(const ln of At.sections)if(ln.image)K[ln.image.name]=!0;else{const gn=Ig(At.toString()),In=ln.fontStack||$t,Jt=te[In]=te[In]||{};this.calculateGlyphDependencies(ln.text,Jt,an,this.allowVerticalPlacement,gn)}}}"line"===S.get("symbol-placement")&&(this.features=function(Je){const Ne={},Ze={},rt=[];let st=0;function Vt($t){rt.push(Je[$t]),st++}function At($t,an,ln){const gn=Ze[$t];return delete Ze[$t],Ze[an]=gn,rt[gn].geometry[0].pop(),rt[gn].geometry[0]=rt[gn].geometry[0].concat(ln[0]),gn}function en($t,an,ln){const gn=Ne[an];return delete Ne[an],Ne[$t]=gn,rt[gn].geometry[0].shift(),rt[gn].geometry[0]=ln[0].concat(rt[gn].geometry[0]),gn}function bn($t,an,ln){const gn=ln?an[0][an[0].length-1]:an[0][0];return`${$t}:${gn.x}:${gn.y}`}for(let $t=0;$t<Je.length;$t++){const an=Je[$t],ln=an.geometry,gn=an.text?an.text.toString():null;if(!gn){Vt($t);continue}const In=bn(gn,ln),Jt=bn(gn,ln,!0);if(In in Ze&&Jt in Ne&&Ze[In]!==Ne[Jt]){const Hn=en(In,Jt,ln),ti=At(In,Jt,rt[Hn].geometry);delete Ne[In],delete Ze[Jt],Ze[bn(gn,rt[ti].geometry,!0)]=ti,rt[Hn].geometry=null}else In in Ze?At(In,Jt,ln):Jt in Ne?en(In,Jt,ln):(Vt($t),Ne[In]=st-1,Ze[Jt]=st-1)}return rt.filter($t=>$t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Je,Ne)=>Je.sortKey-Ne.sortKey)}update(o,c,f,_){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,c,this.layers,f,_),this.icon.programConfigurations.updatePaintArrays(o,c,this.layers,f,_))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=lS(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const f=this.lineVertexArray.length;if(void 0!==o.segment)for(const{x:_,y:E}of c)this.lineVertexArray.emplaceBack(_,E);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,c,f,_,E,S,T,O,k,V,j,$,W,K){const te=o.indexArray,ve=o.layoutVertexArray,Be=o.globeExtVertexArray,Je=o.segments.prepareSegment(4*c.length,ve,te,this.canOverlap?S.sortKey:void 0),Ne=this.glyphOffsetArray.length,Ze=Je.vertexLength,rt=this.allowVerticalPlacement&&T===Gc.vertical?Math.PI/2:0,st=S.text&&S.text.sections;for(let At=0;At<c.length;At++){const{tl:en,tr:bn,bl:$t,br:an,tex:ln,pixelOffsetTL:gn,pixelOffsetBR:In,minFontScaleX:Jt,minFontScaleY:Hn,glyphOffset:ti,isSDF:qn,sectionIndex:ir}=c[At],Tn=Je.vertexLength,bi=ti[1];if(p_(ve,k.x,k.y,en.x,bi+en.y,ln.x,ln.y,f,qn,gn.x,gn.y,Jt,Hn),p_(ve,k.x,k.y,bn.x,bi+bn.y,ln.x+ln.w,ln.y,f,qn,In.x,gn.y,Jt,Hn),p_(ve,k.x,k.y,$t.x,bi+$t.y,ln.x,ln.y+ln.h,f,qn,gn.x,In.y,Jt,Hn),p_(ve,k.x,k.y,an.x,bi+an.y,ln.x+ln.w,ln.y+ln.h,f,qn,In.x,In.y,Jt,Hn),O){const{x:rr,y:kr,z:Wi}=O.anchor,[Ri,Fo,Ji]=O.up;Nv(Be,rr,kr,Wi,Ri,Fo,Ji),Nv(Be,rr,kr,Wi,Ri,Fo,Ji),Nv(Be,rr,kr,Wi,Ri,Fo,Ji),Nv(Be,rr,kr,Wi,Ri,Fo,Ji),Fv(o.dynamicLayoutVertexArray,rr,kr,Wi,rt)}else Fv(o.dynamicLayoutVertexArray,k.x,k.y,k.z,rt);te.emplaceBack(Tn,Tn+1,Tn+2),te.emplaceBack(Tn+1,Tn+2,Tn+3),Je.vertexLength+=4,Je.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ti[0]),At!==c.length-1&&ir===c[At+1].sectionIndex||o.programConfigurations.populatePaintArrays(ve.length,S,S.index,{},W,K,st&&st[ir])}const Vt=O?O.anchor:k;o.placedSymbolArray.emplaceBack(Vt.x,Vt.y,Vt.z,k.x,k.y,Ne,this.glyphOffsetArray.length-Ne,Ze,V,j,k.segment,f?f[0]:0,f?f[1]:0,_[0],_[1],T,0,!1,0,$,0)}_commitLayoutVertex(o,c,f,_,E,S,T){o.emplaceBack(c,f,_,E,S,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(o,c,f,_,E,S,T){const O=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),k=O.vertexLength,V=T.tileAnchorX,j=T.tileAnchorY;for(let W=0;W<4;W++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(c,-o.padding,-o.padding),f.collisionVertexArrayExt.emplaceBack(c,o.padding,-o.padding),f.collisionVertexArrayExt.emplaceBack(c,o.padding,o.padding),f.collisionVertexArrayExt.emplaceBack(c,-o.padding,o.padding),this._commitLayoutVertex(f.layoutVertexArray,_,E,S,V,j,new re(o.x1,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,_,E,S,V,j,new re(o.x2,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,_,E,S,V,j,new re(o.x2,o.y2)),this._commitLayoutVertex(f.layoutVertexArray,_,E,S,V,j,new re(o.x1,o.y2)),O.vertexLength+=4;const $=f.indexArray;$.emplaceBack(k,k+1),$.emplaceBack(k+1,k+2),$.emplaceBack(k+2,k+3),$.emplaceBack(k+3,k),O.primitiveLength+=4}_addTextDebugCollisionBoxes(o,c,f,_,E,S){for(let T=_;T<E;T++){const O=f.get(T),k=this.getSymbolInstanceTextSize(o,S,c,T);this._addCollisionDebugVertices(O,k,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,S)}}_addIconDebugCollisionBoxes(o,c,f,_,E,S){for(let T=_;T<E;T++){const O=f.get(T),k=this.getSymbolInstanceIconSize(o,c,S.placedIconSymbolIndex);this._addCollisionDebugVertices(O,k,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,S)}}generateCollisionDebugBuffers(o,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new $m(ei,km.members,vs),this.iconCollisionBox=new $m(ei,km.members,vs);const f=Bh(this.iconSizeData,o),_=Bh(this.textSizeData,o);for(let E=0;E<this.symbolInstances.length;E++){const S=this.symbolInstances.get(E);this._addTextDebugCollisionBoxes(_,o,c,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(_,o,c,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,o,c,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,o,c,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(o,c,f,_){const E=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:_),S=Nm(this.textSizeData,o,E)/nl;return this.tilePixelRatio*S}getSymbolInstanceIconSize(o,c,f){const _=this.icon.placedSymbolArray.get(f),E=Nm(this.iconSizeData,o,_);return this.tilePixelRatio*E}_commitDebugCollisionVertexUpdate(o,c,f){o.emplaceBack(c,-f,-f),o.emplaceBack(c,f,-f),o.emplaceBack(c,f,f),o.emplaceBack(c,-f,f)}_updateTextDebugCollisionBoxes(o,c,f,_,E,S){for(let T=_;T<E;T++){const O=f.get(T),k=this.getSymbolInstanceTextSize(o,S,c,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,O.padding)}}_updateIconDebugCollisionBoxes(o,c,f,_,E,S){for(let T=_;T<E;T++){const O=f.get(T),k=this.getSymbolInstanceIconSize(o,c,S);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,O.padding)}}updateCollisionDebugBuffers(o,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=Bh(this.iconSizeData,o),_=Bh(this.textSizeData,o);for(let E=0;E<this.symbolInstances.length;E++){const S=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(_,o,c,S.textBoxStartIndex,S.textBoxEndIndex,S),this._updateTextDebugCollisionBoxes(_,o,c,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._updateIconDebugCollisionBoxes(f,o,c,S.iconBoxStartIndex,S.iconBoxEndIndex,S.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,o,c,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,c,f,_,E,S,T,O,k){const V={};if(c<f){const{x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze,featureIndex:rt}=o.get(c);V.textBox={x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze},V.textFeatureIndex=rt}if(_<E){const{x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze,featureIndex:rt}=o.get(_);V.verticalTextBox={x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze},V.verticalTextFeatureIndex=rt}if(S<T){const{x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze,featureIndex:rt}=o.get(S);V.iconBox={x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze},V.iconFeatureIndex=rt}if(O<k){const{x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze,featureIndex:rt}=o.get(O);V.verticalIconBox={x1:j,y1:$,x2:W,y2:K,padding:te,projectedAnchorX:ve,projectedAnchorY:Be,projectedAnchorZ:Je,tileAnchorX:Ne,tileAnchorY:Ze},V.verticalIconFeatureIndex=rt}return V}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,c){const f=o.placedSymbolArray.get(c),_=f.vertexStartIndex+4*f.numGlyphs;for(let E=f.vertexStartIndex;E<_;E+=4)o.indexArray.emplaceBack(E,E+1,E+2),o.indexArray.emplaceBack(E+1,E+2,E+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(o),f=Math.cos(o),_=[],E=[],S=[];for(let T=0;T<this.symbolInstances.length;++T){S.push(T);const O=this.symbolInstances.get(T);_.push(0|Math.round(c*O.tileAnchorX+f*O.tileAnchorY)),E.push(O.featureIndex)}return S.sort((T,O)=>_[T]-_[O]||E[O]-E[T]),S}addToSortKeyRanges(o,c){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===c?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const f=this.symbolInstances.get(c);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:E,leftJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:k}=f;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),E>=0&&E!==_&&this.addIndicesForPlacedSymbol(this.text,E),S>=0&&S!==E&&S!==_&&this.addIndicesForPlacedSymbol(this.text,S),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}On(Id,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Id.MAX_GLYPHS=65535,Id.addDynamicAttributes=Fv;const Lp=new We({"symbol-placement":new ee(Qt.layout_symbol["symbol-placement"]),"symbol-spacing":new ee(Qt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ee(Qt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Se(Qt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ee(Qt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ee(Qt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ee(Qt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ee(Qt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ee(Qt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Se(Qt.layout_symbol["icon-size"]),"icon-text-fit":new ee(Qt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ee(Qt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Se(Qt.layout_symbol["icon-image"]),"icon-rotate":new Se(Qt.layout_symbol["icon-rotate"]),"icon-padding":new ee(Qt.layout_symbol["icon-padding"]),"icon-keep-upright":new ee(Qt.layout_symbol["icon-keep-upright"]),"icon-offset":new Se(Qt.layout_symbol["icon-offset"]),"icon-anchor":new Se(Qt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ee(Qt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ee(Qt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ee(Qt.layout_symbol["text-rotation-alignment"]),"text-field":new Se(Qt.layout_symbol["text-field"]),"text-font":new Se(Qt.layout_symbol["text-font"]),"text-size":new Se(Qt.layout_symbol["text-size"]),"text-max-width":new Se(Qt.layout_symbol["text-max-width"]),"text-line-height":new Se(Qt.layout_symbol["text-line-height"]),"text-letter-spacing":new Se(Qt.layout_symbol["text-letter-spacing"]),"text-justify":new Se(Qt.layout_symbol["text-justify"]),"text-radial-offset":new Se(Qt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ee(Qt.layout_symbol["text-variable-anchor"]),"text-anchor":new Se(Qt.layout_symbol["text-anchor"]),"text-max-angle":new ee(Qt.layout_symbol["text-max-angle"]),"text-writing-mode":new ee(Qt.layout_symbol["text-writing-mode"]),"text-rotate":new Se(Qt.layout_symbol["text-rotate"]),"text-padding":new ee(Qt.layout_symbol["text-padding"]),"text-keep-upright":new ee(Qt.layout_symbol["text-keep-upright"]),"text-transform":new Se(Qt.layout_symbol["text-transform"]),"text-offset":new Se(Qt.layout_symbol["text-offset"]),"text-allow-overlap":new ee(Qt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ee(Qt.layout_symbol["text-ignore-placement"]),"text-optional":new ee(Qt.layout_symbol["text-optional"])});var Hm={paint:new We({"icon-opacity":new Se(Qt.paint_symbol["icon-opacity"]),"icon-color":new Se(Qt.paint_symbol["icon-color"]),"icon-halo-color":new Se(Qt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Se(Qt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Se(Qt.paint_symbol["icon-halo-blur"]),"icon-translate":new ee(Qt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ee(Qt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Se(Qt.paint_symbol["text-opacity"]),"text-color":new Se(Qt.paint_symbol["text-color"],{runtimeType:La,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Se(Qt.paint_symbol["text-halo-color"]),"text-halo-width":new Se(Qt.paint_symbol["text-halo-width"]),"text-halo-blur":new Se(Qt.paint_symbol["text-halo-blur"]),"text-translate":new ee(Qt.paint_symbol["text-translate"]),"text-translate-anchor":new ee(Qt.paint_symbol["text-translate-anchor"])}),layout:Lp};class g_{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:eu,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}On(g_,"FormatSectionOverride",{omit:["defaultValue"]});class Hh extends dl{constructor(o){super(o,Hm)}recalculate(o,c){super.recalculate(o,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const _=[];for(const E of f)_.indexOf(E)<0&&_.push(E);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,c,f,_){const E=this.layout.get(o).evaluate(c,{},f,_),S=this._unevaluatedLayout._values[o];return S.isDataDriven()||Ns(S.value)||!E?E:(T=c.properties,E.replace(/{([^{}]+)}/g,(k,V)=>V in T?String(T[V]):""));var T}createBucket(o){return new Id(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of Hm.paint.overridableProperties){if(!Hh.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),f=new g_(c),_=new Pu(f,c.property.specification);let E=null;E="constant"===c.value.kind||"source"===c.value.kind?new cs("source",_):new Zn("composite",_,c.value.zoomStops,c.value._interpolationType),this.paint._values[o]=new Pe(c.property,E,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&Hh.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const f=o.get("text-field"),_=Hm.paint.properties[c];let E=!1;const S=T=>{for(const O of T)if(_.overrides&&_.overrides.hasOverride(O))return void(E=!0)};if("constant"===f.value.kind&&f.value.value instanceof Qo)S(f.value.value.sections);else if("source"===f.value.kind){const T=k=>{E||(k instanceof ia&&Cs(k.value)===Ir?S(k.value.sections):k instanceof bl?S(k.sections):k.eachChild(T))},O=f.value;O._styleExpression&&T(O._styleExpression.expression)}return E}getProgramConfiguration(o){return new Lu(this,o)}}var __={paint:new We({"background-color":new ee(Qt.paint_background["background-color"]),"background-pattern":new ee(Qt.paint_background["background-pattern"]),"background-opacity":new ee(Qt.paint_background["background-opacity"])})},Np={paint:new We({"raster-opacity":new ee(Qt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ee(Qt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ee(Qt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ee(Qt.paint_raster["raster-brightness-max"]),"raster-saturation":new ee(Qt.paint_raster["raster-saturation"]),"raster-contrast":new ee(Qt.paint_raster["raster-contrast"]),"raster-resampling":new ee(Qt.paint_raster["raster-resampling"]),"raster-fade-duration":new ee(Qt.paint_raster["raster-fade-duration"])})};class zv extends dl{constructor(o){super(o,{}),this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var Vv={paint:new We({"sky-type":new ee(Qt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ee(Qt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ee(Qt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ee(Qt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ee(Qt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ge(Qt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ee(Qt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ee(Qt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ee(Qt.paint_sky["sky-opacity"])})};function Fp(a,o,c){const f=[0,0,1],_=gC([]);return _C(_,_,c?-ot(a)+Math.PI:ot(a)),Bg(_,_,-ot(o)),_m(f,f,_),fl(f,f)}const fA={circle:class extends dl{constructor(a){super(a,MC)}createBucket(a){return new ub(a)}queryRadius(a){const o=a;return vp("circle-radius",this,o)+vp("circle-stroke-width",this,o)+xp(this.paint.get("circle-translate"))}queryIntersectsFeature(a,o,c,f,_,E,S,T){const O=mb(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,a.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c);return bp(a,f,E,S,T,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),O,k)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new Lu(this,a)}},heatmap:class extends dl{createBucket(a){return new Qy(a)}constructor(a){super(a,oA),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return vp("heatmap-radius",this,a)}queryIntersectsFeature(a,o,c,f,_,E,S,T){const O=this.paint.get("heatmap-radius").evaluate(o,c);return bp(a,f,E,S,T,!0,!0,new re(0,0),O)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new Lu(this,a)}},hillshade:class extends dl{constructor(a){super(a,DC)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends dl{constructor(a){super(a,LC)}getProgramIds(){const a=this.paint.get("fill-pattern"),o=a&&a.constantOr(1),c=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(a){return new Lu(this,a)}recalculate(a,o){super.recalculate(a,o);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Ep(a)}queryRadius(){return xp(this.paint.get("fill-translate"))}queryIntersectsFeature(a,o,c,f,_,E){return!a.queryGeometry.isAboveHorizon&&Uc(bm(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,a.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends dl{constructor(a){super(a,UC)}createBucket(a){return new Tm(a)}queryRadius(){return xp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new Lu(this,a)}queryIntersectsFeature(a,o,c,f,_,E,S,T,O){const k=mb(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,a.pixelToTileUnitsFactor),V=this.paint.get("fill-extrusion-height").evaluate(o,c),j=this.paint.get("fill-extrusion-base").evaluate(o,c),$=[0,0],W=T&&E.elevation,K=E.elevation?E.elevation.exaggeration():1,te=a.tile.getBucket(this);if(W&&te instanceof Tm){const Ze=te.centroidVertexArray,rt=O+1;rt<Ze.length&&($[0]=Ze.geta_centroid_pos0(rt),$[1]=Ze.geta_centroid_pos1(rt))}if(0===$[0]&&1===$[1])return!1;"globe"===E.projection.name&&(f=Yg([f],[new re(0,0),new re(Ei,Ei)],a.tileID.canonical).map(Ze=>Ze.polygon).flat());const ve=W?T:null,[Be,Je]=(rt=f,st=j,Vt=V,At=k,en=S,bn=ve,$t=$,an=K,ln=E.center.lat,"globe"===(Ze=E).projection.name?function(In,Jt,Hn,ti,qn,ir,Tn,bi,rr,kr,Wi){const Ri=[],Fo=[],Ji=In.projection.upVectorScale(Wi,In.center.lat,In.worldSize).metersToTile,er=[0,0,0,1],Ho=[0,0,0,1],qo=(ai,Gn,Js,Et)=>{ai[0]=Gn,ai[1]=Js,ai[2]=Et,ai[3]=1},Wo=fv();Hn>0&&(Hn+=Wo),ti+=Wo;for(const ai of Jt){const Gn=[],Js=[];for(const Et of ai){const Mo=Et.x+qn.x,Ra=Et.y+qn.y,ea=In.projection.projectTilePoint(Mo,Ra,Wi),ts=In.projection.upVector(Wi,Et.x,Et.y);let Lr=Hn,Us=ti;if(Tn){const Zo=e_(Mo,Ra,Hn,ti,Tn,bi,rr,kr);Lr+=Zo.base,Us+=Zo.top}0!==Hn?qo(er,ea.x+ts[0]*Ji*Lr,ea.y+ts[1]*Ji*Lr,ea.z+ts[2]*Ji*Lr):qo(er,ea.x,ea.y,ea.z),qo(Ho,ea.x+ts[0]*Ji*Us,ea.y+ts[1]*Ji*Us,ea.z+ts[2]*Ji*Us),zs(er,er,ir),zs(Ho,Ho,ir),Gn.push(new Af(er[0],er[1],er[2])),Js.push(new Af(Ho[0],Ho[1],Ho[2]))}Ri.push(Gn),Fo.push(Js)}return[Ri,Fo]}(Ze,rt,st,Vt,At,en,bn,$t,an,ln,a.tileID.canonical):bn?function(In,Jt,Hn,ti,qn,ir,Tn,bi,rr){const kr=[],Wi=[],Ri=[0,0,0,1];for(const Fo of In){const Ji=[],er=[];for(const Ho of Fo){const qo=Ho.x+ti.x,Wo=Ho.y+ti.y,ai=e_(qo,Wo,Jt,Hn,ir,Tn,bi,rr);Ri[0]=qo,Ri[1]=Wo,Ri[2]=ai.base,Ri[3]=1,nd(Ri,Ri,qn),Ri[3]=Math.max(Ri[3],1e-5);const Gn=new Af(Ri[0]/Ri[3],Ri[1]/Ri[3],Ri[2]/Ri[3]);Ri[0]=qo,Ri[1]=Wo,Ri[2]=ai.top,Ri[3]=1,nd(Ri,Ri,qn),Ri[3]=Math.max(Ri[3],1e-5);const Js=new Af(Ri[0]/Ri[3],Ri[1]/Ri[3],Ri[2]/Ri[3]);Ji.push(Gn),er.push(Js)}kr.push(Ji),Wi.push(er)}return[kr,Wi]}(rt,st,Vt,At,en,bn,$t,an,ln):function(In,Jt,Hn,ti,qn){const ir=[],Tn=[],bi=qn[8]*Jt,rr=qn[9]*Jt,kr=qn[10]*Jt,Wi=qn[11]*Jt,Ri=qn[8]*Hn,Fo=qn[9]*Hn,Ji=qn[10]*Hn,er=qn[11]*Hn;for(const Ho of In){const qo=[],Wo=[];for(const ai of Ho){const Gn=ai.x+ti.x,Js=ai.y+ti.y,Et=qn[0]*Gn+qn[4]*Js+qn[12],Mo=qn[1]*Gn+qn[5]*Js+qn[13],Ra=qn[2]*Gn+qn[6]*Js+qn[14],ea=qn[3]*Gn+qn[7]*Js+qn[15],ts=Et+bi,Lr=Mo+rr,Us=Ra+kr,Zo=Math.max(ea+Wi,1e-5),Pl=Et+Ri,aa=Mo+Fo,ja=Ra+Ji,Ga=Math.max(ea+er,1e-5);qo.push(new Af(ts/Zo,Lr/Zo,Us/Zo)),Wo.push(new Af(Pl/Ga,aa/Ga,ja/Ga))}ir.push(qo),Tn.push(Wo)}return[ir,Tn]}(rt,st,Vt,At,en)),Ne=a.queryGeometry;var Ze,rt,st,Vt,At,en,bn,$t,an,ln;return function(Ze,rt,st){let Vt=1/0;Uc(st,rt)&&(Vt=Jg(st,rt[0]));for(let At=0;At<rt.length;At++){const en=rt[At],bn=Ze[At];for(let $t=0;$t<en.length-1;$t++){const an=en[$t],ln=[an,en[$t+1],bn[$t+1],bn[$t],an];db(st,ln)&&(Vt=Math.min(Vt,Jg(st,ln)))}}return Vt!==1/0&&Vt}(Be,Je,Ne.isPointQuery()?Ne.screenBounds:Ne.screenGeometry)}},line:class extends dl{constructor(a){super(a,HC),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Tu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,o){super.recalculate(a,o),this.paint._values["line-floorwidth"]=Om.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Rm(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new Lu(this,a)}queryRadius(a){const o=a,c=Ob(vp("line-width",this,o),vp("line-gap-width",this,o)),f=vp("line-offset",this,o);return c/2+Math.abs(f)+xp(this.paint.get("line-translate"))}queryIntersectsFeature(a,o,c,f,_,E){if(a.queryGeometry.isAboveHorizon)return!1;const S=bm(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,a.pixelToTileUnitsFactor),T=a.pixelToTileUnitsFactor/2*Ob(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),O=this.paint.get("line-offset").evaluate(o,c);return O&&(f=function(k,V){const j=[],$=new re(0,0);for(let W=0;W<k.length;W++){const K=k[W],te=[];for(let ve=0;ve<K.length;ve++){const Be=K[ve],Je=K[ve+1],Ne=0===ve?$:Be.sub(K[ve-1])._unit()._perp(),Ze=ve===K.length-1?$:Je.sub(Be)._unit()._perp(),rt=Ne._add(Ze)._unit();rt._mult(1/(rt.x*Ze.x+rt.y*Ze.y)),te.push(rt._mult(V)._add(Be))}j.push(te)}return j}(f,O*a.pixelToTileUnitsFactor)),function(k,V,j){for(let $=0;$<V.length;$++){const W=V[$];if(k.length>=3)for(let K=0;K<W.length;K++)if(Mf(k,W[K]))return!0;if(Xy(k,W,j))return!0}return!1}(S,f,T)}isTileClipped(){return!0}},symbol:Hh,background:class extends dl{constructor(a){super(a,__)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends dl{constructor(a){super(a,Np)}getProgramIds(){return["raster"]}},sky:class extends dl{constructor(a){super(a,Vv),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Gg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(a,o){if("atmosphere"===this.paint.get("sky-type")){const f=this.paint.get("sky-atmosphere-sun"),_=!f,E=a.style.light,S=E.properties.get("position");return _&&"viewport"===E.properties.get("anchor")&&Ii("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?Fp(S.azimuthal,90-S.polar,o):Fp(f[0],90-f[1],o)}const c=this.paint.get("sky-gradient-center");return Fp(c[0],90-c[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}};class Vf{constructor(o,c,f,_){this.context=o,this.format=f,this.texture=o.gl.createTexture(),this.update(c,_)}update(o,c,f){const{width:_,height:E}=o,{context:S}=this,{gl:T}=S,{HTMLImageElement:O,HTMLCanvasElement:k,HTMLVideoElement:V,ImageData:j,ImageBitmap:$}=xe;if(T.bindTexture(T.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!c||!1!==c.premultiply)),f||this.size&&this.size[0]===_&&this.size[1]===E){const{x:W,y:K}=f||{x:0,y:0};o instanceof O||o instanceof k||o instanceof V||o instanceof j||$&&o instanceof $?T.texSubImage2D(T.TEXTURE_2D,0,W,K,T.RGBA,T.UNSIGNED_BYTE,o):T.texSubImage2D(T.TEXTURE_2D,0,W,K,_,E,T.RGBA,T.UNSIGNED_BYTE,o.data)}else this.size=[_,E],o instanceof O||o instanceof k||o instanceof V||o instanceof j||$&&o instanceof $?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,o):T.texImage2D(T.TEXTURE_2D,0,this.format,_,E,0,this.format,T.UNSIGNED_BYTE,o.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(o,c){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),o!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?o===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_NEAREST:o),this.filter=o),c!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,c),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class qm{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class cS{constructor(){this.tasks={},this.taskQueue=[],zn(["process"],this),this.invoker=new qm(this.process),this.nextId=0}add(o,c){const f=this.nextId++,_=function({type:E,isSymbolTile:S,zoom:T}){return T=T||0,"message"===E?0:"maybePrepare"!==E||S?"parseTile"!==E||S?"parseTile"===E&&S?300-T:"maybePrepare"===E&&S?400-T:500:200-T:100-T}(c);if(0===_){wi();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:o,metadata:c,priority:_,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){wi();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const o=this.pick();if(null===o)return;const c=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let o=null,c=1/0;for(let _=0;_<this.taskQueue.length;_++){const E=this.tasks[this.taskQueue[_]];E.priority<c&&(c=E.priority,o=_)}if(null===o)return null;const f=this.taskQueue[o];return this.taskQueue.splice(o,1),f}remove(){this.invoker.remove()}}class Uv{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const f=o[c];this._stringToNumber[f]=c,this._numberToString[c]=f}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const uS=["tile","layer","source","sourceLayer","state"];class a1{constructor(o,c,f,_,E){this.type="Feature",this._vectorTileFeature=o,this._z=c,this._x=f,this._y=_,this.properties=o.properties,this.id=E}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(o.id=this.id);for(const c of uS)void 0!==this[c]&&(o[c]=this[c]);return o}}const qh=new Uint16Array(8184);for(let a=0;a<2046;a++){let o=a+2,c=0,f=0,_=0,E=0,S=0,T=0;for(1&o?_=E=S=32:c=f=T=32;(o>>=1)>1;){const k=c+_>>1,V=f+E>>1;1&o?(_=c,E=f,c=S,f=T):(c=_,f=E,_=S,E=T),S=k,T=V}const O=4*a;qh[O+0]=c,qh[O+1]=f,qh[O+2]=_,qh[O+3]=E}const Dd=new Uint16Array(2178),Uf=new Uint8Array(1089),y_=new Uint16Array(1089);function Wm(a){return 0===a?-.03125:32===a?.03125:0}var v_=bt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const l1={type:2,extent:Ei,loadGeometry:()=>[[new re(0,0),new re(Ei+1,0),new re(Ei+1,Ei+1),new re(0,Ei+1),new re(0,0)]]};class x_{constructor(o,c,f,_,E){this.tileID=o,this.uid=Ct(),this.uses=0,this.tileSize=c,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=E,this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(o){const c=o+this.timeAdded;c<xa.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Ff(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,c,f){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(_,E){const S={};if(!E)return S;for(const T of _){const O=T.layerIds.map(k=>E.getLayer(k)).filter(Boolean);if(0!==O.length){T.layers=O,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(k=>O.filter(V=>V.id===k)[0]));for(const k of O)S[k.id]=T}}return S}(o.buckets,c.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof Id){if(this.hasSymbolBuckets=!0,!f)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof Id&&E.hasRTLText){this.hasRTLText=!0,B.isLoading()||B.isLoaded()||"deferred"!==P()||N();break}}this.queryPadding=0;for(const _ in this.buckets){const E=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(_).queryRadius(E))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new Po}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const f in this.buckets){const _=this.buckets[f];_.uploadPending()&&_.upload(o)}const c=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Vf(o,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Vf(o,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Vf(o,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,c,f,_,E,S,T,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:_,pixelPosMatrix:T,transform:S,params:E,tileTransform:this.tileTransform},o,c,f):{}}querySourceFeatures(o,c){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const _=f.loadVTLayers(),E=c?c.sourceLayer:"",S=_._geojsonTileLayer||_[E];if(!S)return;const T=lu(c&&c.filter),{z:O,x:k,y:V}=this.tileID.canonical,j={z:O,x:k,y:V};for(let $=0;$<S.length;$++){const W=S.feature($);if(T.needGeometry){const ve=Cd(W,!0);if(!T.filter(new U(this.tileID.overscaledZ),ve,this.tileID.canonical))continue}else if(!T.filter(new U(this.tileID.overscaledZ),W))continue;const K=f.getId(W,E),te=new a1(W,O,k,V,K);te.tile=j,o.push(te)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const c=this.expirationTime;if(o.cacheControl){const f=_t(o.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const f=Date.now();let _=!1;if(this.expirationTime>f)_=!1;else if(c)if(this.expirationTime<c)_=!0;else{const E=this.expirationTime-c;E?this.expirationTime=f+Math.max(E,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length||!c)return;const f=this.latestFeatureIndex.loadVTLayers(),_=c.style.listImages();for(const E in this.buckets){if(!c.style.hasLayer(E))continue;const S=this.buckets[E],T=S.layers[0].sourceLayer||"_geojsonTileLayer",O=f[T],k=o[T];if(!O||!k||0===Object.keys(k).length)continue;if(S.update(k,O,_,this.imageAtlas&&this.imageAtlas.patternPositions||{}),S instanceof Rm||S instanceof Ep){const j=c.style._getSourceCache(S.layers[0].source);c._terrain&&c._terrain.enabled&&j&&S.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(j.id,this.tileID)}const V=c&&c.style&&c.style.getLayer(E);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(S)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xa.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=xa.now()+o}setTexture(o,c){const f=c.context,_=f.gl;this.texture=this.texture||c.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new Vf(f,o,_.RGBA,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE))}setDependencies(o,c){const f={};for(const _ of c)f[_]=!0;this.dependencies[o]=f}hasDependency(o,c){for(const f of o){const _=this.dependencies[f];if(_)for(const E of c)if(_[E])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,c){if(!c||"mercator"===c.name||this._tileDebugBuffer)return;const f=Ed(l1,this.tileID.canonical,this.tileTransform)[0],_=new En,E=new Tc;for(let S=0;S<f.length;S++){const{x:T,y:O}=f[S];_.emplaceBack(T,O),E.emplaceBack(S)}E.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(E),this._tileDebugBuffer=o.createVertexBuffer(_,yf.members),this._tileDebugSegments=Jo.simpleSegment(0,0,_.length,E.length)}_makeTileBoundsBuffers(o,c){if(this._tileBoundsBuffer||!c||"mercator"===c.name)return;const f=Ed(l1,this.tileID.canonical,this.tileTransform)[0];let _,E;if(this.isRaster){const S=function(T,O){const k=Ff(T,O),V=Math.pow(2,T.z);for(let ve=0;ve<33;ve++)for(let Be=0;Be<33;Be++){const Je=zu((T.x+(Be+Wm(Be))/32)/V),Ne=Zl((T.y+(ve+Wm(ve))/32)/V),Ze=O.project(Je,Ne),rt=33*ve+Be;Dd[2*rt+0]=Math.round((Ze.x*k.scale-k.x)*Ei),Dd[2*rt+1]=Math.round((Ze.y*k.scale-k.y)*Ei)}Uf.fill(0),y_.fill(0);for(let ve=2045;ve>=0;ve--){const Be=4*ve,Je=qh[Be+0],Ne=qh[Be+1],Ze=qh[Be+2],rt=qh[Be+3],st=Je+Ze>>1,Vt=Ne+rt>>1,At=st+Vt-Ne,en=Vt+Je-st,bn=33*Ne+Je,$t=33*rt+Ze,an=33*Vt+st,ln=Math.hypot((Dd[2*bn+0]+Dd[2*$t+0])/2-Dd[2*an+0],(Dd[2*bn+1]+Dd[2*$t+1])/2-Dd[2*an+1])>=16;Uf[an]=Uf[an]||(ln?1:0),ve<1022&&(Uf[an]=Uf[an]||Uf[33*(Ne+en>>1)+(Je+At>>1)]||Uf[33*(rt+en>>1)+(Ze+At>>1)])}const j=new sn,$=new di;let W=0;function K(ve,Be){const Je=33*Be+ve;return 0===y_[Je]&&(j.emplaceBack(Dd[2*Je+0],Dd[2*Je+1],ve*Ei/32,Be*Ei/32),y_[Je]=++W),y_[Je]-1}function te(ve,Be,Je,Ne,Ze,rt){const st=ve+Je>>1,Vt=Be+Ne>>1;if(Math.abs(ve-Ze)+Math.abs(Be-rt)>1&&Uf[33*Vt+st])te(Ze,rt,ve,Be,st,Vt),te(Je,Ne,Ze,rt,st,Vt);else{const At=K(ve,Be),en=K(Je,Ne),bn=K(Ze,rt);$.emplaceBack(At,en,bn)}}return te(0,0,32,32,32,0),te(32,32,0,0,0,32),{vertices:j,indices:$}}(this.tileID.canonical,c);_=S.vertices,E=S.indices}else{_=new sn,E=new di;for(const{x:T,y:O}of f)_.emplaceBack(T,O,0,0);const S=Wg(_.int16,void 0,4);for(let T=0;T<S.length;T+=3)E.emplaceBack(S[T],S[T+1],S[T+2])}this._tileBoundsBuffer=o.createVertexBuffer(_,v_.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(E),this._tileBoundsSegments=Jo.simpleSegment(0,0,_.length,E.length)}_makeGlobeTileDebugBuffers(o,c){const f=c.projection;if(!f||"globe"!==f.name||c.freezeTileCoverage)return;const _=this.tileID.canonical,E=ml(jy(_,c)),S=Mh(c.zoom);let T;S>0&&(T=fm(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,_,c,E,T,S),this._makeGlobeTileDebugTextBuffer(o,_,c,E,T,S)}_globePoint(o,c,f,_,E,S,T){let O=pp(o,c,f);if(S){const k=1<<f.z,V=bd(_.center.lng),j=eh(_.center.lat),$=(f.x+.5)/k-V;let W=0;$>.5?W=-1:$<-.5&&(W=1);let K=(o/Ei+f.x)/k+W,te=(c/Ei+f.y)/k;K=(K-V)*_._pixelsPerMercatorPixel+V,te=(te-j)*_._pixelsPerMercatorPixel+j;const ve=[K*_.worldSize,te*_.worldSize,0];zs(ve,ve,S),O=Ch(O,ve,T)}return zs(O,O,E)}_makeGlobeTileDebugBorderBuffer(o,c,f,_,E,S){const T=new En,O=new Tc,k=new Pt,V=($,W,K,te,ve)=>{const Be=(K-$)/(ve-1),Je=(te-W)/(ve-1),Ne=T.length;for(let Ze=0;Ze<ve;Ze++){const rt=$+Ze*Be,st=W+Ze*Je;T.emplaceBack(rt,st);const Vt=this._globePoint(rt,st,c,f,_,E,S);k.emplaceBack(Vt[0],Vt[1],Vt[2]),O.emplaceBack(Ne+Ze)}},j=Ei;V(0,0,j,0,16),V(j,0,j,j,16),V(j,j,0,j,16),V(0,j,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(O),this._tileDebugBuffer=o.createVertexBuffer(T,yf.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(k,bC.members),this._tileDebugSegments=Jo.simpleSegment(0,0,T.length,O.length)}_makeGlobeTileDebugTextBuffer(o,c,f,_,E,S){const T=Ei/4,O=new En,k=new di,V=new Pt,j=25;k.reserve(32),O.reserve(j),V.reserve(j);const $=(W,K)=>j*W+K;for(let W=0;W<j;W++){const K=W*T;for(let te=0;te<j;te++){const ve=te*T;O.emplaceBack(ve,K);const Be=this._globePoint(ve,K,c,f,_,E,S);V.emplaceBack(Be[0],Be[1],Be[2])}}for(let W=0;W<4;W++)for(let K=0;K<4;K++){const te=$(W,K),ve=$(W,K+1),Be=$(W+1,K),Je=$(W+1,K+1);k.emplaceBack(te,ve,Be),k.emplaceBack(Be,ve,Je)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(k),this._tileDebugTextBuffer=o.createVertexBuffer(O,yf.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(V,bC.members),this._tileDebugTextSegments=Jo.simpleSegment(0,0,j,32)}}class jv{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,c,f){const _=String(c);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][_]=this.stateChanges[o][_]||{},Ie(this.stateChanges[o][_],f),null===this.deletedStates[o]){this.deletedStates[o]={};for(const E in this.state[o])E!==_&&(this.deletedStates[o][E]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][_]){this.deletedStates[o][_]={};for(const E in this.state[o][_])f[E]||(this.deletedStates[o][_][E]=null)}else for(const E in f)this.deletedStates[o]&&this.deletedStates[o][_]&&null===this.deletedStates[o][_][E]&&delete this.deletedStates[o][_][E]}removeFeatureState(o,c,f){if(null===this.deletedStates[o])return;const _=String(c);if(this.deletedStates[o]=this.deletedStates[o]||{},f&&void 0!==c)null!==this.deletedStates[o][_]&&(this.deletedStates[o][_]=this.deletedStates[o][_]||{},this.deletedStates[o][_][f]=null);else if(void 0!==c)if(this.stateChanges[o]&&this.stateChanges[o][_])for(f in this.deletedStates[o][_]={},this.stateChanges[o][_])this.deletedStates[o][_][f]=null;else this.deletedStates[o][_]=null;else this.deletedStates[o]=null}getState(o,c){const f=String(c),_=Ie({},(this.state[o]||{})[f],(this.stateChanges[o]||{})[f]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const E=this.deletedStates[o][c];if(null===E)return{};for(const S in E)delete _[S]}return _}initializeTileState(o,c){o.setFeatureState(this.state,c)}coalesceChanges(o,c){const f={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const E={};for(const S in this.stateChanges[_])this.state[_][S]||(this.state[_][S]={}),Ie(this.state[_][S],this.stateChanges[_][S]),E[S]=this.state[_][S];f[_]=E}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const E={};if(null===this.deletedStates[_])for(const S in this.state[_])E[S]={},this.state[_][S]={};else for(const S in this.deletedStates[_]){if(null===this.deletedStates[_][S])this.state[_][S]={};else if(this.state[_][S])for(const T of Object.keys(this.deletedStates[_][S]))delete this.state[_][S][T];E[S]=this.state[_][S]}f[_]=f[_]||{},Ie(f[_],E)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(f).length)for(const _ in o)o[_].setFeatureState(f,c)}}class Zm{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,c){const f=this.toIdx(o,c);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(o,c){return this.leaves[this.toIdx(o,c)]}toIdx(o,c){return c*this.size+o}}function c1(a,o,c,f){let _=0,E=Number.MAX_VALUE;for(let S=0;S<3;S++)if(Math.abs(f[S])<1e-15){if(c[S]<a[S]||c[S]>o[S])return null}else{const T=1/f[S];let O=(a[S]-c[S])*T,k=(o[S]-c[S])*T;if(O>k){const V=O;O=k,k=V}if(O>_&&(_=O),k<E&&(E=k),_>E)return null}return _}function Gv(a,o,c,f,_,E,S,T,O,k,V){const j=f-a,$=_-o,W=E-c,K=S-a,te=T-o,ve=O-c,Be=V[1]*ve-V[2]*te,Je=V[2]*K-V[0]*ve,Ne=V[0]*te-V[1]*K,Ze=j*Be+$*Je+W*Ne;if(Math.abs(Ze)<1e-15)return null;const rt=1/Ze,st=k[0]-a,Vt=k[1]-o,At=k[2]-c,en=(st*Be+Vt*Je+At*Ne)*rt;if(en<0||en>1)return null;const bn=Vt*W-At*$,$t=At*j-st*W,an=st*$-Vt*j,ln=(V[0]*bn+V[1]*$t+V[2]*an)*rt;return ln<0||en+ln>1?null:(K*bn+te*$t+ve*an)*rt}function u1(a,o,c){return(a-o)/(c-o)}function $v(a,o,c,f,_,E,S,T,O){const k=1<<c,V=E-f,j=S-_,$=(a+1)/k*V+f,W=(o+0)/k*j+_,K=(o+1)/k*j+_;T[0]=(a+0)/k*V+f,T[1]=W,O[0]=$,O[1]=K}class dS{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(E){const S=Math.ceil(Math.log2(E.dim/8)),T=[];let O=Math.ceil(Math.pow(2,S));const k=1/O,V=(W,K,te,ve,Be)=>{const Je=ve?1:0,Ne=(W+1)*te-Je,Ze=K*te,rt=(K+1)*te-Je;Be[0]=W*te,Be[1]=Ze,Be[2]=Ne,Be[3]=rt};let j=new Zm(O);const $=[];for(let W=0;W<O*O;W++){V(W%O,Math.floor(W/O),k,!1,$);const K=mu($[0],$[1],E),te=mu($[2],$[1],E),ve=mu($[2],$[3],E),Be=mu($[0],$[3],E);j.minimums.push(Math.min(K,te,ve,Be)),j.maximums.push(Math.max(K,te,ve,Be)),j.leaves.push(1)}for(T.push(j),O/=2;O>=1;O/=2){const W=T[T.length-1];j=new Zm(O);for(let K=0;K<O*O;K++){V(K%O,Math.floor(K/O),2,!0,$);const te=W.getElevation($[0],$[1]),ve=W.getElevation($[2],$[1]),Be=W.getElevation($[2],$[3]),Je=W.getElevation($[0],$[3]),Ne=W.isLeaf($[0],$[1]),Ze=W.isLeaf($[2],$[1]),rt=W.isLeaf($[2],$[3]),st=W.isLeaf($[0],$[3]),Vt=Math.min(te.min,ve.min,Be.min,Je.min),At=Math.max(te.max,ve.max,Be.max,Je.max),en=Ne&&Ze&&rt&&st;j.maximums.push(At),j.minimums.push(Vt),j.leaves.push(At-Vt<=5&&en?1:0)}T.push(j)}return T}(this.dem),f=c.length-1,_=c[f];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(c,0,0,f,0)}raycastRoot(o,c,f,_,E,S,T=1){return c1([o,c,-100],[f,_,this.maximums[0]*T],E,S)}raycast(o,c,f,_,E,S,T=1){if(!this.nodeCount)return null;const O=this.raycastRoot(o,c,f,_,E,S,T);if(null==O)return null;const k=[],V=[],j=[],$=[],W=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;W.length>0;){const{idx:K,t:te,nodex:ve,nodey:Be,depth:Je}=W.pop();if(this.leaves[K]){$v(ve,Be,Je,o,c,f,_,j,$);const Ze=1<<Je,rt=(ve+0)/Ze,st=(ve+1)/Ze,Vt=(Be+0)/Ze,At=(Be+1)/Ze,en=mu(rt,Vt,this.dem)*T,bn=mu(st,Vt,this.dem)*T,$t=mu(st,At,this.dem)*T,an=mu(rt,At,this.dem)*T,ln=Gv(j[0],j[1],en,$[0],j[1],bn,$[0],$[1],$t,E,S),gn=Gv($[0],$[1],$t,j[0],$[1],an,j[0],j[1],en,E,S),In=Math.min(null!==ln?ln:Number.MAX_VALUE,null!==gn?gn:Number.MAX_VALUE);if(In!==Number.MAX_VALUE)return In;{const Jt=dp([],E,S,te);if(d1(en,bn,an,$t,u1(Jt[0],j[0],$[0]),u1(Jt[1],j[1],$[1]))>=Jt[2])return te}continue}let Ne=0;for(let Ze=0;Ze<this._siblingOffset.length;Ze++){$v((ve<<1)+this._siblingOffset[Ze][0],(Be<<1)+this._siblingOffset[Ze][1],Je+1,o,c,f,_,j,$),j[2]=-100,$[2]=this.maximums[this.childOffsets[K]+Ze]*T;const rt=c1(j,$,E,S);if(null!=rt){const st=rt;k[Ze]=st;let Vt=!1;for(let At=0;At<Ne&&!Vt;At++)st>=k[V[At]]&&(V.splice(At,0,Ze),Vt=!0);Vt||(V[Ne]=Ze),Ne++}}for(let Ze=0;Ze<Ne;Ze++){const rt=V[Ze];W.push({idx:this.childOffsets[K]+rt,t:k[rt],nodex:(ve<<1)+this._siblingOffset[rt][0],nodey:(Be<<1)+this._siblingOffset[rt][1],depth:Je+1})}}return null}_addNode(o,c,f){return this.minimums.push(o),this.maximums.push(c),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(o,c,f,_,E){if(1===o[_].isLeaf(c,f))return;this.childOffsets[E]||(this.childOffsets[E]=this.nodeCount);const S=_-1,T=o[S];let O=0,k=0;for(let V=0;V<this._siblingOffset.length;V++){const j=2*c+this._siblingOffset[V][0],$=2*f+this._siblingOffset[V][1],W=T.getElevation(j,$),K=T.isLeaf(j,$),te=this._addNode(W.min,W.max,K);K&&(O|=1<<V),k||(k=te)}for(let V=0;V<this._siblingOffset.length;V++)O&1<<V||this._construct(o,2*c+this._siblingOffset[V][0],2*f+this._siblingOffset[V][1],S,k+V)}}function d1(a,o,c,f,_,E){return hr(hr(a,c,E),hr(o,f,E),_)}function mu(a,o,c){const f=c.dim,_=Ee(a*f-.5,0,f-1),E=Ee(o*f-.5,0,f-1),S=Math.floor(_),T=Math.floor(E),O=Math.min(S+1,f-1),k=Math.min(T+1,f-1);return d1(c.get(S,T),c.get(O,T),c.get(S,k),c.get(O,k),_-S,E-T)}const h1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Bp(a,o,c){return(256*a*256+256*o+c)/10-1e4}function Ks(a,o,c){return 256*a+o+c/256-32768}class b_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,c,f,_=!1,E=!1){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(f&&"mapbox"!==f&&"terrarium"!==f)return Ii(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const S=this.dim=c.height-2,T=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=f||"mapbox",this.borderReady=_,!_){for(let O=0;O<S;O++)T[this._idx(-1,O)]=T[this._idx(0,O)],T[this._idx(S,O)]=T[this._idx(S-1,O)],T[this._idx(O,-1)]=T[this._idx(O,0)],T[this._idx(O,S)]=T[this._idx(O,S-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(S,-1)]=T[this._idx(S-1,0)],T[this._idx(-1,S)]=T[this._idx(0,S-1)],T[this._idx(S,S)]=T[this._idx(S-1,S-1)],E&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new dS(this)}get(o,c,f=!1){f&&(o=Ee(o,-1,this.dim),c=Ee(c,-1,this.dim));const _=4*this._idx(o,c);return("terrarium"===this.encoding?Ks:Bp)(this.pixels[_],this.pixels[_+1],this.pixels[_+2])}static getUnpackVector(o){return h1[o]}get unpackVector(){return h1[this.encoding]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}static pack(o,c){const f=[0,0,0,0],_=b_.getUnpackVector(c);let E=Math.floor((o+_[3])/_[2]);return f[2]=E%256,E=Math.floor(E/256),f[1]=E%256,E=Math.floor(E/256),f[0]=E,f}getPixels(){return new jc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,c,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let _=c*this.dim,E=c*this.dim+this.dim,S=f*this.dim,T=f*this.dim+this.dim;switch(c){case-1:_=E-1;break;case 1:E=_+1}switch(f){case-1:S=T-1;break;case 1:T=S+1}const O=-c*this.dim,k=-f*this.dim;for(let V=S;V<T;V++)for(let j=_;j<E;j++){const $=4*this._idx(j,V),W=4*this._idx(j+O,V+k);this.pixels[$+0]=o.pixels[W+0],this.pixels[$+1]=o.pixels[W+1],this.pixels[$+2]=o.pixels[W+2],this.pixels[$+3]=o.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}On(b_,"DEMData"),On(dS,"DemMinMaxQuadTree",{omit:["dem"]});class Xm{constructor(o,c){this.max=o,this.onRemove=c,this.reset()}reset(){for(const o in this.data)for(const c of this.data[o])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(o,c,f){const _=o.wrapped().key;void 0===this.data[_]&&(this.data[_]=[]);const E={value:c,timeout:void 0};if(void 0!==f&&(E.timeout=setTimeout(()=>{this.remove(o,E)},f)),this.data[_].push(E),this.order.push(_),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const c=this.data[o].shift();return c.timeout&&clearTimeout(c.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),c.value}getByKey(o){const c=this.data[o];return c?c[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,c){if(!this.has(o))return this;const f=o.wrapped().key,_=void 0===c?0:this.data[f].indexOf(c),E=this.data[f][_];return this.data[f].splice(_,1),E.timeout&&clearTimeout(E.timeout),0===this.data[f].length&&delete this.data[f],this.onRemove(E.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(o){const c=[];for(const f in this.data)for(const _ of this.data[f])o(_.value)||c.push(_);for(const f of c)this.remove(f.value.tileID,f)}}class Hc{constructor(o,c,f){this.func=o,this.mask=c,this.range=f}}Hc.ReadOnly=!1,Hc.ReadWrite=!0,Hc.disabled=new Hc(519,Hc.ReadOnly,[0,1]);class qv{constructor(o,c,f,_,E,S){this.test=o,this.ref=c,this.mask=f,this.fail=_,this.depthFail=E,this.pass=S}}qv.disabled=new qv({func:519,mask:0},0,0,7680,7680,7680);class _c{constructor(o,c,f){this.blendFunction=o,this.blendColor=c,this.mask=f}}_c.Replace=[1,0],_c.disabled=new _c(_c.Replace,Zs.transparent,[!1,!1,!1,!1]),_c.unblended=new _c(_c.Replace,Zs.transparent,[!0,!0,!0,!0]),_c.alphaBlended=new _c([1,771],Zs.transparent,[!0,!0,!0,!0]);class Td{constructor(o,c,f){this.enable=o,this.mode=c,this.frontFace=f}}Td.disabled=new Td(!1,1029,2305),Td.backCCW=new Td(!0,1029,2305),Td.backCW=new Td(!0,1029,2304),Td.frontCW=new Td(!0,1028,2304),Td.frontCCW=new Td(!0,1028,2305);class oh extends ba{constructor(o,c,f){super(),this.id=o,this._onlySymbols=f,c.on("data",_=>{"source"===_.dataType&&"metadata"===_.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===_.dataType&&"content"===_.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new Xm(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new jv,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(o){this.map=o,this._minTileCacheSize=void 0===this._minTileCacheSize&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const c=this._tiles[o];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,c){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,c)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const f=this._tiles[c];f.upload(o),f.prepare(this.map.style.imageManager)}}getIds(){return gt(this._tiles).map(o=>o.tileID).sort(Zv).map(o=>o.key)}getRenderableIds(o){const c=[];for(const f in this._tiles)this._isIdRenderable(+f,o)&&c.push(this._tiles[f]);return o?c.sort((f,_)=>{const E=f.tileID,S=_.tileID,T=new re(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),O=new re(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-S.overscaledZ||O.y-T.y||O.x-T.x}).map(f=>f.tileID.key):c.map(f=>f.tileID).sort(Zv).map(f=>f.key)}hasRenderableParent(o){const c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(+o,"reloading")}}_reloadTile(o,c){const f=this._tiles[o];f&&("loading"!==f.state&&(f.state=c),this._loadTile(f,this._tileLoaded.bind(this,f,o,c)))}_tileLoaded(o,c,f,_){if(_)if(o.state="errored",404!==_.status)this._source.fire(new da(_,{tile:o}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const E=this.map.painter.terrain;this.update(this.transform,E.getScaledDemTileSize(),!0),E.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=xa.now(),"expired"===f&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),"raster-dem"===this._source.type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new ka("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const c=this.getRenderableIds();for(let _=0;_<c.length;_++){const E=c[_];if(o.neighboringTiles&&o.neighboringTiles[E]){const S=this.getTileByID(E);f(o,S),f(S,o)}}function f(_,E){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let S=E.tileID.canonical.x-_.tileID.canonical.x;const T=E.tileID.canonical.y-_.tileID.canonical.y,O=Math.pow(2,_.tileID.canonical.z),k=E.tileID.key;0===S&&0===T||Math.abs(T)>1||(Math.abs(S)>1&&(1===Math.abs(S+O)?S+=O:1===Math.abs(S-O)&&(S-=O)),E.dem&&_.dem&&(_.dem.backfillBorder(E.dem,S,T),_.neighboringTiles&&_.neighboringTiles[k]&&(_.neighboringTiles[k].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,c,f,_){for(const E in this._tiles){let S=this._tiles[E];if(_[E]||!S.hasData()||S.tileID.overscaledZ<=c||S.tileID.overscaledZ>f)continue;let T=S.tileID;for(;S&&S.tileID.overscaledZ>c+1;){const k=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[k.key],S&&S.hasData()&&(T=k)}let O=T;for(;O.overscaledZ>c;)if(O=O.scaledTo(O.overscaledZ-1),o[O.key]){_[T.key]=T;break}}}findLoadedParent(o,c){if(o.key in this._loadedParentTiles){const f=this._loadedParentTiles[o.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=o.overscaledZ-1;f>=c;f--){const _=o.scaledTo(f),E=this._getLoadedTile(_);if(E)return E}}_getLoadedTile(o){const c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,c){c=c||this._source.tileSize;const f=Math.ceil(o.width/c)+1,_=Math.ceil(o.height/c)+1,E=Math.floor(f*_*5),S="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,E):E,T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(T)}handleWrapJump(o){const c=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,c){const f={};for(const _ in this._tiles){const E=this._tiles[_];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+c),f[E.tileID.key]=E}this._tiles=f;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(o,c,f){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let _;this.updateCacheSize(o,c),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?_=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new gc(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(_=o.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(_=_.filter(T=>this._source.hasTile(T)))):_=[];const E=this._updateRetainedTiles(_);if(f1(this._source.type)&&0!==_.length){const T={},O={},k=Object.keys(E);for(const j of k){const $=E[j],W=this._tiles[j];if(!W||W.fadeEndTime&&W.fadeEndTime<=xa.now())continue;const K=this.findLoadedParent($,Math.max($.overscaledZ-oh.maxOverzooming,this._source.minzoom));K&&(this._addTile(K.tileID),T[K.tileID.key]=K.tileID),O[j]=$}const V=_[_.length-1].overscaledZ;for(const j in this._tiles){const $=this._tiles[j];if(E[j]||!$.hasData())continue;let W=$.tileID;for(;W.overscaledZ>V;){W=W.scaledTo(W.overscaledZ-1);const K=this._tiles[W.key];if(K&&K.hasData()&&O[W.key]){E[j]=$.tileID;break}}}for(const j in T)E[j]||(this._coveredTiles[j]=!0,E[j]=T[j])}for(const T in E)this._tiles[T].clearFadeHold();const S=function(T,O){const k=[];for(const V in T)V in O||k.push(V);return k}(this._tiles,E);for(const T of S){const O=this._tiles[T];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const c={};if(0===o.length)return c;const f={},_=o.reduce((k,V)=>Math.min(k,V.overscaledZ),1/0),E=o[0].overscaledZ,S=Math.max(E-oh.maxOverzooming,this._source.minzoom),T=Math.max(E+oh.maxUnderzooming,this._source.minzoom),O={};for(const k of o){const V=this._addTile(k);c[k.key]=k,V.hasData()||_<this._source.maxzoom&&(O[k.key]=k)}this._retainLoadedChildren(O,_,T,c);for(const k of o){let V=this._tiles[k.key];if(V.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const $=k.children(this._source.maxzoom)[0],W=this.getTile($);if(W&&W.hasData()){c[$.key]=$;continue}}else{const $=k.children(this._source.maxzoom);if(c[$[0].key]&&c[$[1].key]&&c[$[2].key]&&c[$[3].key])continue}let j=V.wasRequested();for(let $=k.overscaledZ-1;$>=S;--$){const W=k.scaledTo($);if(f[W.key]||(f[W.key]=!0,V=this.getTile(W),!V&&j&&(V=this._addTile(W)),V&&(c[W.key]=W,j=V.wasRequested(),V.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const c=[];let f,_=this._tiles[o].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){f=this._loadedParentTiles[_.key];break}c.push(_.key);const E=_.scaledTo(_.overscaledZ-1);if(f=this._getLoadedTile(E),f)break;_=E}for(const E of c)this._loadedParentTiles[E]=f}}_addTile(o){let c=this._tiles[o.key];if(c)return c;c=this._cache.getAndRemove(o),c&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));const f=!!c;if(!f){const _=this.map?this.map.painter:null;c=new x_(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,_,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))}return c?(c.uses++,this._tiles[o.key]=c,f||this._source.fire(new ka("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(o,c){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const f=c.getExpiryTimeout();f&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},f))}_removeTile(o){const c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&"reloading"!==c.state?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,c,f){const _=[],E=this.transform;if(!E)return _;const S="globe"===E.projection.name,T=bd(E.center.lng);for(const O in this._tiles){const k=this._tiles[O];if(f&&k.clearQueryDebugViz(),k.holdingForFade())continue;let V;if(S){const j=k.tileID.canonical;if(0===j.z){const $=[Math.abs(Ee(T,...Km(j,-1))-T),Math.abs(Ee(T,...Km(j,1))-T)];V=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(Ee(T,...Km(j,-1))-T),Math.abs(Ee(T,...Km(j,0))-T),Math.abs(Ee(T,...Km(j,1))-T)];V=[$.indexOf(Math.min(...$))-1]}}else V=[0];for(const j of V){const $=o.containsTile(k,E,c,j);$&&_.push($)}}return _}getVisibleCoordinates(o){const c=this.getRenderableIds(o).map(f=>this._tiles[f].tileID);for(const f of c)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(f1(this._source.type))for(const o in this._tiles){const c=this._tiles[o];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=xa.now())return!0}return!1}setFeatureState(o,c,f){this._state.updateState(o=o||"_geojsonTileLayer",c,f)}removeFeatureState(o,c,f){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,f)}getFeatureState(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)}setDependencies(o,c,f){const _=this._tiles[o];_&&_.setDependencies(c,f)}reloadTilesForDependencies(o,c){for(const f in this._tiles)this._tiles[f].hasDependency(o,c)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(o,c))}_preloadTiles(o,c){if(!this._sourceLoaded){const T=()=>{this._sourceLoaded&&(this._source.off("data",T),this._preloadTiles(o,c))};return void this._source.on("data",T)}const f=new Map,_=Array.isArray(o)?o:[o],E=this.map.painter.terrain,S=this.usedForTerrain&&E?E.getScaledDemTileSize():this._source.tileSize;for(const T of _){const O=T.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of O)f.set(k.key,k);this.usedForTerrain&&T.updateElevation(!1)}it(Array.from(f.values()),(T,O)=>{const k=new x_(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,V=>{"raster-dem"===this._source.type&&k.dem&&this._backfillDEM(k),O(V,k)})},c)}}function Zv(a,o){const c=Math.abs(2*a.wrap)-+(a.wrap<0),f=Math.abs(2*o.wrap)-+(o.wrap<0);return a.overscaledZ-o.overscaledZ||f-c||o.canonical.y-a.canonical.y||o.canonical.x-a.canonical.x}function f1(a){return"raster"===a||"image"===a||"video"===a||"custom"===a}function Km(a,o){const c=1<<a.z;return[a.x/c+o,(a.x+1)/c+o]}oh.maxOverzooming=10,oh.maxUnderzooming=3;class Qm{constructor(o,c,f){this._demTile=o,this._dem=this._demTile.dem,this._scale=c,this._offset=f}static create(o,c,f){const _=f||o.findDEMTileFor(c);if(!_||!_.dem)return;const E=_.dem,S=_.tileID,T=1<<c.canonical.z-S.canonical.z;return new Qm(_,_.tileSize/Ei/T,[(c.canonical.x/T-S.canonical.x)*E.dim,(c.canonical.y/T-S.canonical.y)*E.dim])}tileCoordToPixel(o,c){const f=c*this._scale+this._offset[1],_=Math.floor(o*this._scale+this._offset[0]),E=Math.floor(f);return new re(_,E)}getElevationAt(o,c,f,_){const E=o*this._scale+this._offset[0],S=c*this._scale+this._offset[1],T=Math.floor(E),O=Math.floor(S),k=this._dem;return _=!!_,f?hr(hr(k.get(T,O,_),k.get(T,O+1,_),S-O),hr(k.get(T+1,O,_),k.get(T+1,O+1,_),S-O),E-T):k.get(T,O,_)}getElevationAtPixel(o,c,f){return this._dem.get(o,c,!!f)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*wd(1,o)*this._dem.stride}}class p1{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new hi(Ei,16,0),this.featureIndexArray=new mf,this.promoteId=c}insert(o,c,f,_,E,S=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,_,E,S);const O=this.grid;for(let k=0;k<c.length;k++){const V=c[k],j=[1/0,1/0,-1/0,-1/0];for(let $=0;$<V.length;$++){const W=V[$];j[0]=Math.min(j[0],W.x),j[1]=Math.min(j[1],W.y),j[2]=Math.max(j[2],W.x),j[3]=Math.max(j[3],W.y)}j[0]<Ei&&j[1]<Ei&&j[2]>=0&&j[3]>=0&&O.insert(T,j[0],j[1],j[2],j[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new cv(new i_(this.rawTileData)).layers,this.sourceLayerCoder=new Uv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,c,f,_){this.loadVTLayers();const E=o.params||{},S=lu(E.filter),T=o.tileResult,O=o.transform,k=T.bufferedTilespaceBounds,V=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(K,te,ve,Be)=>pb(T.bufferedTilespaceGeometry,K,te,ve,Be));V.sort(hS);let j=null;O.elevation&&V.length>0&&(j=Qm.create(O.elevation,this.tileID));const $={};let W;for(let K=0;K<V.length;K++){const te=V[K];if(te===W)continue;W=te;const ve=this.featureIndexArray.get(te);let Be=null;this.loadMatchingFeature($,ve,S,E.layers,E.availableImages,c,f,_,(Je,Ne,Ze,rt=0)=>(Be||(Be=Ed(Je,this.tileID.canonical,o.tileTransform)),Ne.queryIntersectsFeature(T,Je,Ze,Be,this.z,o.transform,o.pixelPosMatrix,j,rt)))}return $}loadMatchingFeature(o,c,f,_,E,S,T,O,k){const{featureIndex:V,bucketIndex:j,sourceLayerIndex:$,layoutVertexArrayOffset:W}=c,K=this.bucketLayerIDs[j];if(_&&!function(Je,Ne){for(let Ze=0;Ze<Je.length;Ze++)if(Ne.indexOf(Je[Ze])>=0)return!0;return!1}(_,K))return;const te=this.sourceLayerCoder.decode($),ve=this.vtLayers[te].feature(V);if(f.needGeometry){const Je=Cd(ve,!0);if(!f.filter(new U(this.tileID.overscaledZ),Je,this.tileID.canonical))return}else if(!f.filter(new U(this.tileID.overscaledZ),ve))return;const Be=this.getId(ve,te);for(let Je=0;Je<K.length;Je++){const Ne=K[Je];if(_&&_.indexOf(Ne)<0)continue;const Ze=S[Ne];if(!Ze)continue;let rt={};void 0!==Be&&O&&(rt=O.getState(Ze.sourceLayer||"_geojsonTileLayer",Be));const st=Ie({},T[Ne]);st.paint=Xv(st.paint,Ze.paint,ve,rt,E),st.layout=Xv(st.layout,Ze.layout,ve,rt,E);const Vt=!k||k(ve,Ze,rt,W);if(!Vt)continue;const At=new a1(ve,this.z,this.x,this.y,Be);At.layer=st;let en=o[Ne];void 0===en&&(en=o[Ne]=[]),en.push({featureIndex:V,feature:At,intersectionZ:Vt})}}lookupSymbolFeatures(o,c,f,_,E,S,T,O){const k={};this.loadVTLayers();const V=lu(E);for(const j of o)this.loadMatchingFeature(k,{bucketIndex:f,sourceLayerIndex:_,featureIndex:j,layoutVertexArrayOffset:0},V,S,T,O,c);return k}loadFeature(o){const{featureIndex:c,sourceLayerIndex:f}=o;this.loadVTLayers();const _=this.sourceLayerCoder.decode(f),E=this.vtFeatures[_];if(E[c])return E[c];const S=this.vtLayers[_].feature(c);return E[c]=S,S}hasLayer(o){for(const c of this.bucketLayerIDs)for(const f of c)if(o===f)return!0;return!1}getId(o,c){let f=o.id;if(this.promoteId){const _="string"==typeof this.promoteId?this.promoteId:this.promoteId[c];null!=_&&(f=o.properties[_]),"boolean"==typeof f&&(f=Number(f))}return f}}function Xv(a,o,c,f,_){return Kt(a,(E,S)=>{const T=o instanceof Le?o.get(S):null;return T&&T.evaluate?T.evaluate(c,f,_):T})}function hS(a,o){return o-a}On(p1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class m1{constructor(o,c){this.width=o,this.height=c,this.nextRow=0,this.image=new hu({width:o,height:c}),this.positions={},this.uploaded=!1}getDash(o,c){const f=this.getKey(o,c);return this.positions[f]}trim(){const o=this.width,c=this.height=Ut(this.nextRow);this.image.resize({width:o,height:c})}getKey(o,c){return o.join(",")+c}getDashRanges(o,c,f){const _=[];let E=o.length%2==1?-o[o.length-1]*f:0,S=o[0]*f,T=!0;_.push({left:E,right:S,isDash:T,zeroLength:0===o[0]});let O=o[0];for(let k=1;k<o.length;k++){T=!T;const V=o[k];E=O*f,O+=V,S=O*f,_.push({left:E,right:S,isDash:T,zeroLength:0===V})}return _}addRoundDash(o,c,f){const _=c/2;for(let E=-f;E<=f;E++){const S=this.width*(this.nextRow+f+E);let T=0,O=o[T];for(let k=0;k<this.width;k++){k/O.right>1&&(O=o[++T]);const V=Math.abs(k-O.left),j=Math.abs(k-O.right),$=Math.min(V,j);let W;const K=E/f*(_+1);if(O.isDash){const te=_-Math.abs(K);W=Math.sqrt($*$+te*te)}else W=_-Math.sqrt($*$+K*K);this.image.data[S+k]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(o,c){for(let O=o.length-1;O>=0;--O){const k=o[O],V=o[O+1];k.zeroLength?o.splice(O,1):V&&V.isDash===k.isDash&&(V.left=k.left,o.splice(O,1))}const f=o[0],_=o[o.length-1];f.isDash===_.isDash&&(f.left=_.left-this.width,_.right=f.right+this.width);const E=this.width*this.nextRow;let S=0,T=o[S];for(let O=0;O<this.width;O++){O/T.right>1&&(T=o[++S]);const k=Math.abs(O-T.left),V=Math.abs(O-T.right),j=Math.min(k,V);this.image.data[E+O]=Math.max(0,Math.min(255,(T.isDash?j:-j)+c+128))}}addDash(o,c){const f=this.getKey(o,c);if(this.positions[f])return this.positions[f];const _="round"===c,E=_?7:0,S=2*E+1;if(this.nextRow+S>this.height)return Ii("LineAtlas out of space"),null;0===o.length&&o.push(1);let T=0;for(let V=0;V<o.length;V++)o[V]<0&&(Ii("Negative value is found in line dasharray, replacing values with 0"),o[V]=0),T+=o[V];if(0!==T){const V=this.width/T,j=this.getDashRanges(o,this.width,V);_?this.addRoundDash(j,V,E):this.addRegularDash(j,"square"===c?.5*V:0)}const O=this.nextRow+E;this.nextRow+=S;const k={tl:[O,E],br:[T,0]};return this.positions[f]=k,k}}On(m1,"LineAtlas");const fS=1*Vs;class Yv{constructor(o){const c={},f=[];for(const T in o){const O=o[T],k=c[T]={};for(const V in O.glyphs){const j=O.glyphs[+V];if(!j||0===j.bitmap.width||0===j.bitmap.height)continue;const $=j.metrics.localGlyph?fS:1,W={x:0,y:0,w:j.bitmap.width+2*$,h:j.bitmap.height+2*$};f.push(W),k[V]=W}}const{w:_,h:E}=bv(f),S=new hu({width:_||1,height:E||1});for(const T in o){const O=o[T];for(const k in O.glyphs){const V=O.glyphs[+k];if(!V||0===V.bitmap.width||0===V.bitmap.height)continue;const j=c[T][k],$=V.metrics.localGlyph?fS:1;hu.copy(V.bitmap,S,{x:0,y:0},{x:j.x+$,y:j.y+$},V.bitmap)}}this.image=S,this.positions=c}}On(Yv,"GlyphAtlas");class g1{constructor(o){this.tileID=new gc(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=Ff(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,c,f,_,E){this.status="parsing",this.data=o,this.collisionBoxArray=new Po;const S=new Uv(Object.keys(o.layers).sort()),T=new p1(this.tileID,this.promoteId);T.bucketLayerIDs=[];const O={},k=new m1(256,256),V={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:f},j=c.familiesBySource[this.source];for(const rt in j){const st=o.layers[rt];if(!st)continue;let Vt=!1,At=!1;for(const $t of j[rt])"symbol"===$t[0].type?Vt=!0:At=!0;if(!0===this.isSymbolTile&&!Vt||!1===this.isSymbolTile&&!At)continue;1===st.version&&Ii(`Vector tile source "${this.source}" layer "${rt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const en=S.encode(rt),bn=[];for(let $t=0;$t<st.length;$t++){const an=st.feature($t),ln=T.getId(an,rt);bn.push({feature:an,id:ln,index:$t,sourceLayerIndex:en})}for(const $t of j[rt]){const an=$t[0];void 0!==this.isSymbolTile&&"symbol"===an.type!==this.isSymbolTile||an.minzoom&&this.zoom<Math.floor(an.minzoom)||an.maxzoom&&this.zoom>=an.maxzoom||"none"!==an.visibility&&(Qs($t,this.zoom,f),(O[an.id]=an.createBucket({index:T.bucketLayerIDs.length,layers:$t,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:en,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(bn,V,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push($t.map(ln=>ln.id)))}}let $,W,K,te;k.trim();const ve={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Be=()=>{if($)return E($);if(W&&K&&te){const rt=new Yv(W),st=new qb(K,te);for(const Vt in O){const At=O[Vt];At instanceof Id?(Qs(At.layers,this.zoom,f),nS(At,W,rt.positions,K,st.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):At.hasPattern&&(At instanceof Rm||At instanceof Ep||At instanceof Tm)&&(Qs(At.layers,this.zoom,f),At.addFeatures(V,this.tileID.canonical,st.patternPositions,f,this.tileTransform))}this.status="done",E(null,{buckets:gt(O).filter(Vt=>!Vt.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rt.image,lineAtlas:k,imageAtlas:st,glyphMap:this.returnDependencies?W:null,iconMap:this.returnDependencies?K:null,glyphPositions:this.returnDependencies?rt.positions:null})}},Je=Kt(V.glyphDependencies,rt=>Object.keys(rt).map(Number));Object.keys(Je).length?_.send("getGlyphs",{uid:this.uid,stacks:Je},(rt,st)=>{$||($=rt,W=st,Be())},void 0,!1,ve):W={};const Ne=Object.keys(V.iconDependencies);Ne.length?_.send("getImages",{icons:Ne,source:this.source,tileID:this.tileID,type:"icons"},(rt,st)=>{$||($=rt,K=st,Be())},void 0,!1,ve):K={};const Ze=Object.keys(V.patternDependencies);Ze.length?_.send("getImages",{icons:Ze,source:this.source,tileID:this.tileID,type:"patterns"},(rt,st)=>{$||($=rt,te=st,Be())},void 0,!1,ve):te={},Be()}}function Qs(a,o,c){const f=new U(o);for(const _ of a)_.recalculate(f,c)}class Kv{constructor(o){this.entries={},this.scheduler=o}request(o,c,f,_){const E=this.entries[o]=this.entries[o]||{callbacks:[]};if(E.result){const[S,T]=E.result;return this.scheduler?this.scheduler.add(()=>{_(S,T)},c):_(S,T),()=>{}}return E.callbacks.push(_),E.cancel||(E.cancel=f((S,T)=>{E.result=[S,T];for(const O of E.callbacks)this.scheduler?this.scheduler.add(()=>{O(S,T)},c):O(S,T);setTimeout(()=>delete this.entries[o],3e3)})),()=>{E.result||(E.callbacks=E.callbacks.filter(S=>S!==_),E.callbacks.length||(E.cancel(),delete this.entries[o]))}}}function pS(a,o,c){const f=JSON.stringify(a.request);return a.data&&(this.deduped.entries[f]={result:[null,a.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},_=>{const E=Xo(a.request,(S,T,O,k)=>{S?_(S):T&&_(null,{vectorTile:c?void 0:new cv(new i_(T)),rawData:T,cacheControl:O,expires:k})});return()=>{E.cancel(),_()}},o)}const w_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class qc{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,f]=new Uint8Array(o,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const _=f>>4;if(1!==_)throw new Error(`Got v${_} data when expected v1.`);const E=w_[15&f];if(!E)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(o,2,1),[T]=new Uint32Array(o,4,1);return new qc(T,S,E,o)}constructor(o,c=64,f=Float64Array,_){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=f,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const E=w_.indexOf(this.ArrayType),S=2*o*this.ArrayType.BYTES_PER_ELEMENT,T=o*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-T%8)%8;if(E<0)throw new Error(`Unexpected typed array class: ${f}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+O,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+S+T+O),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+O,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+E]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=o)}add(o,c){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=o,this.coords[this._pos++]=c,f}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return Jm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,c,f,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:E,coords:S,nodeSize:T}=this,O=[0,E.length-1,0],k=[];for(;O.length;){const V=O.pop()||0,j=O.pop()||0,$=O.pop()||0;if(j-$<=T){for(let ve=$;ve<=j;ve++){const Be=S[2*ve],Je=S[2*ve+1];Be>=o&&Be<=f&&Je>=c&&Je<=_&&k.push(E[ve])}continue}const W=$+j>>1,K=S[2*W],te=S[2*W+1];K>=o&&K<=f&&te>=c&&te<=_&&k.push(E[W]),(0===V?o<=K:c<=te)&&(O.push($),O.push(W-1),O.push(1-V)),(0===V?f>=K:_>=te)&&(O.push(W+1),O.push(j),O.push(1-V))}return k}within(o,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:E,nodeSize:S}=this,T=[0,_.length-1,0],O=[],k=f*f;for(;T.length;){const V=T.pop()||0,j=T.pop()||0,$=T.pop()||0;if(j-$<=S){for(let ve=$;ve<=j;ve++)C_(E[2*ve],E[2*ve+1],o,c)<=k&&O.push(_[ve]);continue}const W=$+j>>1,K=E[2*W],te=E[2*W+1];C_(K,te,o,c)<=k&&O.push(_[W]),(0===V?o-f<=K:c-f<=te)&&(T.push($),T.push(W-1),T.push(1-V)),(0===V?o+f>=K:c+f>=te)&&(T.push(W+1),T.push(j),T.push(1-V))}return O}}function Jm(a,o,c,f,_,E){if(_-f<=c)return;const S=f+_>>1;_1(a,o,S,f,_,E),Jm(a,o,c,f,S-1,1-E),Jm(a,o,c,S+1,_,1-E)}function _1(a,o,c,f,_,E){for(;_>f;){if(_-f>600){const k=_-f+1,V=c-f+1,j=Math.log(k),$=.5*Math.exp(2*j/3),W=.5*Math.sqrt(j*$*(k-$)/k)*(V-k/2<0?-1:1);_1(a,o,c,Math.max(f,Math.floor(c-V*$/k+W)),Math.min(_,Math.floor(c+(k-V)*$/k+W)),E)}const S=o[2*c+E];let T=f,O=_;for(E_(a,o,f,c),o[2*_+E]>S&&E_(a,o,f,_);T<O;){for(E_(a,o,T,O),T++,O--;o[2*T+E]<S;)T++;for(;o[2*O+E]>S;)O--}o[2*f+E]===S?E_(a,o,f,O):(O++,E_(a,o,O,_)),O<=c&&(f=O+1),c<=O&&(_=O-1)}}function E_(a,o,c,f){Qv(a,c,f),Qv(o,2*c,2*f),Qv(o,2*c+1,2*f+1)}function Qv(a,o,c){const f=a[o];a[o]=a[c],a[c]=f}function C_(a,o,c,f){const _=a-c,E=o-f;return _*_+E*E}m.ARRAY_TYPE=Bc,m.AUTH_ERR_MSG=et,m.Aabb=Al,m.Actor=class{constructor(a,o,c){this.target=a,this.parent=o,this.mapId=c,this.callbacks={},this.cancelCallbacks={},zn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=wi()?a:xe,this.scheduler=new cS}send(a,o,c,f,_=!1,E){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=E,this.callbacks[S]=c);const T=fe(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:a,hasCallback:!!c,targetMapId:f,mustQueue:_,sourceMapId:this.mapId,data:$l(o,T)},T),{cancel:()=>{c&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(a){const o=a.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(o.mustQueue||wi()){const f=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,o),f&&f.metadata||{type:"message"})}else this.processTask(c,o)}processTask(a,o){if("<response>"===o.type){const c=this.callbacks[a];delete this.callbacks[a],c&&(o.error?c(ku(o.error)):c(null,ku(o.data)))}else{const c=fe(this.globalScope)?void 0:[],f=o.hasCallback?(E,S)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:E?$l(E):null,data:$l(S,c)},c)}:E=>{},_=ku(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,_,f);else if(this.parent.getWorkerSource){const E=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,E[0],_.source)[E[1]](_,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},m.CanonicalTileID=Qg,m.Color=Zs,m.ColorMode=_c,m.CullFaceMode=Td,m.DEMData=b_,m.DataConstantProperty=ee,m.DedupedRequest=Kv,m.DepthMode=Hc,m.EXTENT=Ei,m.Elevation=class{isDataAvailableAtPoint(a){const o=this._source();if(this.isUsingMockSource()||!o||a.y<0||a.y>1)return!1;const c=o.getSource().maxzoom,f=1<<c,_=Math.floor(a.x),E=Math.floor((a.x-_)*f),S=Math.floor(a.y*f),T=this.findDEMTileFor(new gc(c,_,c,E,S));return!(!T||!T.dem)}getAtPointOrZero(a,o=0){return this.getAtPoint(a,o)||0}getAtPoint(a,o,c=!0){if(this.isUsingMockSource())return null;null==o&&(o=null);const f=this._source();if(!f||a.y<0||a.y>1)return o;const _=f.getSource().maxzoom,E=1<<_,S=Math.floor(a.x),T=a.x-S,O=new gc(_,S,_,Math.floor(T*E),Math.floor(a.y*E)),k=this.findDEMTileFor(O);if(!k||!k.dem)return o;const V=k.dem,j=1<<k.tileID.canonical.z,$=(T*j-k.tileID.canonical.x)*V.dim,W=(a.y*j-k.tileID.canonical.y)*V.dim,K=Math.floor($),te=Math.floor(W);return(c?this.exaggeration():1)*hr(hr(V.get(K,te),V.get(K,te+1),W-te),hr(V.get(K+1,te),V.get(K+1,te+1),W-te),$-K)}getAtTileOffset(a,o,c){const f=1<<a.canonical.z;return this.getAtPointOrZero(new _p(a.wrap+(a.canonical.x+o/Ei)/f,(a.canonical.y+c/Ei)/f))}getAtTileOffsetFunc(a,o,c,f){return _=>{const E=this.getAtTileOffset(a,_.x,_.y),S=f.upVector(a.canonical,_.x,_.y);return zc(S,S,E*f.upVectorScale(a.canonical,o,c).metersToTile),S}}getForTilePoints(a,o,c,f){if(this.isUsingMockSource())return!1;const _=Qm.create(this,a,f);return!!_&&(o.forEach(E=>{E[2]=this.exaggeration()*_.getElevationAt(E[0],E[1],c)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(a);if(!o||!o.dem)return null;const c=o.dem.tree,f=o.tileID,_=1<<a.canonical.z-f.canonical.z;let E=a.canonical.x/_-f.canonical.x,S=a.canonical.y/_-f.canonical.y,T=0;for(let O=0;O<a.canonical.z-f.canonical.z&&!c.leaves[T];O++){E*=2,S*=2;const k=2*Math.floor(S)+Math.floor(E);T=c.childOffsets[T]+k,E%=1,S%=1}return{min:this.exaggeration()*c.minimums[T],max:this.exaggeration()*c.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,o,c){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},m.ErrorEvent=da,m.EvaluationParameters=U,m.Event=ka,m.Evented=ba,m.FillExtrusionBucket=Tm,m.Frustum=xf,m.FrustumCorners=By,m.GLOBE_RADIUS=id,m.GLOBE_SCALE_MATCH_LATITUDE=45,m.GLOBE_ZOOM_THRESHOLD_MAX=wC,m.GLOBE_ZOOM_THRESHOLD_MIN=hp,m.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,o){const c=new En,f=new di,_=[],E=a+1+2,S=o[0]+1,T=o[0]+1+(1+o.length),O=(k,V,j)=>{let $=k===E-1?k-2:0===k?k:k-1;return $+=j?24575:0,[$,V]};for(let k=0;k<E;++k)c.emplaceBack(...O(k,0,!0));for(let k=0;k<S;++k)for(let V=0;V<E;++V)c.emplaceBack(...O(V,k,(0===V||V===E-1)&&!0));for(let k=0;k<o.length;++k){const V=o[k];for(let j=0;j<E;++j)c.emplaceBack(...O(j,V,!0))}for(let k=0;k<o.length;++k){const V=f.length,j=o[k]+1+2,$=new di;for(let te=0;te<j-1;te++){const ve=te===j-2,Be=ve?E*(T-o.length+k-te):E;for(let Je=0;Je<E-1;Je++){const Ne=te*E+Je;0===te||ve||0===Je||Je===E-2?($.emplaceBack(Ne+1,Ne,Ne+Be),$.emplaceBack(Ne+Be,Ne+Be+1,Ne+1)):(f.emplaceBack(Ne+1,Ne,Ne+Be),f.emplaceBack(Ne+Be,Ne+Be+1,Ne+1))}}const W=Jo.simpleSegment(0,V,c.length,f.length-V);for(let te=0;te<$.uint16.length;te+=3)f.emplaceBack($.uint16[te],$.uint16[te+1],$.uint16[te+2]);const K=Jo.simpleSegment(0,V,c.length,f.length-V);_.push({withoutSkirts:W,withSkirts:K})}return{vertices:c,indices:f,segments:_}}_createGrid(a){const o=this._fillGridMeshWithLods(64,Vc);this._gridSegments=o.segments,this._gridBuffer=a.createVertexBuffer(o.vertices,yf.members),this._gridIndexBuffer=a.createIndexBuffer(o.indices,!0)}_createPoles(a){const o=new di;for(let _=0;_<=64;_++)o.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=a.createIndexBuffer(o,!0);const c=new Ao,f=new Ao;this._poleSegments=[];for(let _=0,E=0;_<hp;_++){const S=360/(1<<_);c.emplaceBack(0,-id,0,.5,0),f.emplaceBack(0,-id,0,.5,1);for(let T=0;T<=64;T++){const O=T/64,k=hr(0,S,O),[V,j,$]=fp(mp,gp,k,id);c.emplaceBack(V,j,$,O,0),f.emplaceBack(V,j,$,O,1)}this._poleSegments.push(Jo.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(c,xC,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(f,xC,!1)}getGridBuffers(a,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,o){if(!this._wireframeSegments){const c=new vs,f=64,_=f+1+2,E=1;this._wireframeSegments=[];for(let S=0,T=0;S<Vc.length;S++){const O=Vc[S];for(let V=E;V<O+E;V++)for(let j=E;j<f+E;j++){const $=V*_+j;c.emplaceBack($,$+1),c.emplaceBack($,$+_),c.emplaceBack($,$+_+1)}const k=O*f*3;this._wireframeSegments.push(Jo.simpleSegment(0,T,(O+1)*_,k)),T+=k}this._wireframeIndexBuffer=a.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},m.GlyphManager=Rp,m.ImagePosition=wv,m.KDBush=qc,m.LivePerformanceUtils=Hs,m.LngLat=Ur,m.LngLatBounds=Kd,m.LocalGlyphMode=Tv,m.MAX_MERCATOR_LATITUDE=Xl,m.MercatorCoordinate=_p,m.ONE_EM=nl,m.OverscaledTileID=gc,m.PerformanceMarkers=Ll,m.Point=re,m.Properties=We,m.RGBAImage=jc,m.Ray=vf,m.RequestManager=class{constructor(a,o,c){this._transformRequestFn=a,this._customAccessToken=o,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const a=function(){let o="";for(let c=0;c<10;c++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",he,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}}normalizeStyleURL(a,o){if(!ke(a))return a;const c=Dn(a);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeGlyphsURL(a,o){if(!ke(a))return a;const c=Dn(a);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeSourceURL(a,o,c,f){if(!ke(a))return a;const _=Dn(a);return _.path=`/v4/${_.authority}.json`,_.params.push("secure"),c&&_.params.push(`language=${c}`),f&&_.params.push(`worldview=${f}`),this._makeAPIURL(_,this._customAccessToken||o)}normalizeSpriteURL(a,o,c,f){const _=Dn(a);return ke(a)?(_.path=`/styles/v1${_.path}/sprite${o}${c}`,this._makeAPIURL(_,this._customAccessToken||f)):(_.path+=`${o}${c}`,yn(_))}normalizeTileURL(a,o,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!ke(a))return a;const f=Dn(a);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||c&&"raster"!==f.authority&&512===c?"@2x":""}${mt.supported?".webp":"$1"}`),"raster"===f.authority?f.path=`/${tt.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${tt.TILE_URL_VERSION}${f.path}`);const _=this._customAccessToken||function(E){for(const S of E){const T=S.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(f.params)||tt.ACCESS_TOKEN;return tt.REQUIRE_ACCESS_TOKEN&&_&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,_)}canonicalizeTileURL(a,o){const c=Dn(a);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return a;let f="mapbox://";c.path.match(/^\/raster\/v1\//)?f+=`raster/${c.path.replace(`/${tt.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${c.path.replace(`/${tt.TILE_URL_VERSION}/`,"")}`;let _=c.params;return o&&(_=_.filter(E=>!E.match(/^access_token=/))),_.length&&(f+=`?${_.join("&")}`),f}canonicalizeTileset(a,o){const c=!!o&&ke(o),f=[];for(const _ of a.tiles||[])Tt(_)?f.push(this.canonicalizeTileURL(_,c)):f.push(_);return f}_makeAPIURL(a,o){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Dn(tt.API_URL);if(a.protocol=f.protocol,a.authority=f.authority,"http"===a.protocol){const _=a.params.indexOf("secure");_>=0&&a.params.splice(_,1)}if("/"!==f.path&&(a.path=`${f.path}${a.path}`),!tt.REQUIRE_ACCESS_TOKEN)return yn(a);if(o=o||tt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if("s"===o[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return a.params=a.params.filter(_=>-1===_.indexOf("access_token")),a.params.push(`access_token=${o||""}`),yn(a)}},m.ResourceType=Nr,m.SegmentVector=Jo,m.SourceCache=oh,m.StencilMode=qv,m.StructArrayLayout1ui2=Tc,m.StructArrayLayout2f1f2i16=ii,m.StructArrayLayout2i4=En,m.StructArrayLayout2ui4=vs,m.StructArrayLayout3f12=pr,m.StructArrayLayout3ui6=di,m.StructArrayLayout4i8=sn,m.StructArrayLayout5f20=Ao,m.Texture=Vf,m.Tile=x_,m.Transitionable=J,m.Uniform1f=Xd,m.Uniform1i=class extends yd{constructor(a){super(a),this.current=0}set(a,o,c){this.fetchUniformLocation(a,o)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},m.Uniform2f=class extends yd{constructor(a){super(a),this.current=[0,0]}set(a,o,c){this.fetchUniformLocation(a,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},m.Uniform3f=class extends yd{constructor(a){super(a),this.current=[0,0,0]}set(a,o,c){this.fetchUniformLocation(a,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},m.Uniform4f=Kx,m.UniformColor=Qx,m.UniformMatrix2f=class extends yd{constructor(a){super(a),this.current=pC}set(a,o,c){if(this.fetchUniformLocation(a,o))for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}},m.UniformMatrix3f=class extends yd{constructor(a){super(a),this.current=fC}set(a,o,c){if(this.fetchUniformLocation(a,o))for(let f=0;f<9;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}},m.UniformMatrix4f=class extends yd{constructor(a){super(a),this.current=hC}set(a,o,c){if(this.fetchUniformLocation(a,o)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},m.UnwrappedTileID=Ab,m.ValidationError=Vn,m.VectorTileFeature=Im,m.VectorTileWorkerSource=class extends ba{constructor(a,o,c,f,_){super(),this.actor=a,this.layerIndex=o,this.availableImages=c,this.loadVectorData=_||pS,this.loading={},this.loaded={},this.deduped=new Kv(a.scheduler),this.isSpriteLoaded=f,this.scheduler=a.scheduler}loadTile(a,o){const c=a.uid,f=a&&a.request,_=f&&f.collectResourceTiming,E=this.loading[c]=new g1(a);E.abort=this.loadVectorData(a,(S,T)=>{const O=!this.loading[c];if(delete this.loading[c],O||S||!T)return E.status="done",O||(this.loaded[c]=E),o(S);const k=T.rawData,V={};T.expires&&(V.expires=T.expires),T.cacheControl&&(V.cacheControl=T.cacheControl),E.vectorTile=T.vectorTile||new cv(new i_(k));const j=()=>{E.parse(E.vectorTile,this.layerIndex,this.availableImages,this.actor,($,W)=>{if($||!W)return o($);const K={};if(_){const te=kc(f);te.length>0&&(K.resourceTiming=JSON.parse(JSON.stringify(te)))}o(null,Ie({rawTileData:k.slice(0)},W,V,K))})};this.isSpriteLoaded?j():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(j,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):j()}),this.loaded=this.loaded||{},this.loaded[c]=E})}reloadTile(a,o){const c=this.loaded,f=a.uid,_=this;if(c&&c[f]){const E=c[f];E.showCollisionBoxes=a.showCollisionBoxes,E.enableTerrain=!!a.enableTerrain,E.projection=a.projection,E.tileTransform=Ff(a.tileID.canonical,a.projection);const S=(T,O)=>{const k=E.reloadCallback;k&&(delete E.reloadCallback,E.parse(E.vectorTile,_.layerIndex,this.availableImages,_.actor,k)),o(T,O)};"parsing"===E.status?E.reloadCallback=S:"done"===E.status&&(E.vectorTile?E.parse(E.vectorTile,this.layerIndex,this.availableImages,this.actor,S):S())}}abortTile(a,o){const c=a.uid,f=this.loading[c];f&&(f.abort&&f.abort(),delete this.loading[c]),o()}removeTile(a,o){const c=this.loaded,f=a.uid;c&&c[f]&&delete c[f],o()}},m.WritingMode=Gc,m.ZoomDependentExpression=Zn,m.add=es,m.addDynamicAttributes=Fv,m.adjoint=function(a,o){var c=o[0],f=o[1],_=o[2],E=o[3],S=o[4],T=o[5],O=o[6],k=o[7],V=o[8];return a[0]=S*V-T*k,a[1]=_*k-f*V,a[2]=f*T-_*S,a[3]=T*O-E*V,a[4]=c*V-_*O,a[5]=_*E-c*T,a[6]=E*k-S*O,a[7]=f*O-c*k,a[8]=c*S-f*E,a},m.asyncAll=it,m.bezier=on,m.bindAll=zn,m.boundsAttributes=v_,m.bufferConvexPolygon=function(a,o){const c=[];for(let f=0;f<a.length;f++){const _=Re(f-1,-1,a.length-1),E=Re(f+1,-1,a.length-1),S=a[f],T=a[E],O=a[_].sub(S).unit(),k=T.sub(S).unit(),V=k.angleWithSep(O.x,O.y),j=O.add(k).unit().mult(-1*o/Math.sin(V/2));c.push(S.add(j))}return c},m.cacheEntryPossiblyAdded=function(a){Ci++,Ci>fn&&(a.getActor().send("enforceCacheSizeLimit",Gt),Ci=0)},m.calculateGlobeLabelMatrix=function(a,o){const{x:c,y:f}=a.point,_=gl(c,f,a.worldSize/a._pixelsPerMercatorPixel,0,0);return gf(_,_,$y(rd(o)))},m.calculateGlobeMatrix=function(a){const{x:o,y:c}=a.point,{lng:f,lat:_}=a._center;return gl(o,c,a.worldSize,f,_)},m.calculateGlobeMercatorMatrix=function(a){const o=a.pixelsPerMeter,c=o/wd(1,a.center.lat),f=Nu(new Float64Array(16));return up(f,f,[a.point.x,a.point.y,0]),Qd(f,f,[c,c,o]),Float32Array.from(f)},m.circumferenceAtLatitude=cb,m.clamp=Ee,m.clearTileCache=function(a){if(!Mi())return;const o=xe.caches.delete(pt);a&&o.catch(a).then(()=>a())},m.clipLine=Um,m.clone=function(a){var o=new Bc(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},m.clone$1=mn,m.collisionCircleLayout=Lm,m.config=tt,m.conjugate=function(a,o){return a[0]=-o[0],a[1]=-o[1],a[2]=-o[2],a[3]=o[3],a},m.create=function(){var a=new Bc(16);return Bc!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},m.create$1=Lg,m.createExpression=Ml,m.createLayout=bt,m.createStyleLayer=function(a){return"custom"===a.type?new zv(a):new fA[a.type](a)},m.cross=Fy,m.degToRad=ot,m.distance=function(a,o){return Math.hypot(o[0]-a[0],o[1]-a[1],o[2]-a[2])},m.div=function(a,o,c){return a[0]=o[0]/c[0],a[1]=o[1]/c[1],a[2]=o[2]/c[2],a},m.dot=pl,m.earthRadius=vd,m.ease=Lt,m.easeCubicInOut=Me,m.ecefToLatLng=function([a,o,c]){const f=Math.hypot(a,o,c),_=Math.atan2(a,c),E=.5*Math.PI-Math.acos(-o/f);return new Ur(Ue(_),Ue(E))},m.emitValidationErrors=Zt,m.endsWith=Jn,m.enforceCacheSizeLimit=function(a){Ni(),cn&&cn.then(o=>{o.keys().then(c=>{for(let f=0;f<c.length-a;f++)o.delete(c[f])})})},m.evaluateSizeForFeature=Nm,m.evaluateSizeForZoom=Bh,m.evaluateVariableOffset=u_,m.evented=I,m.exactEquals=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]&&a[3]===o[3]},m.exactEquals$1=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]},m.exported=xa,m.exported$1=mt,m.extend=Ie,m.extend$1=Nl,m.fillExtrusionHeightLift=fv,m.filterObject=Qn,m.fromMat4=function(a,o){return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[4],a[4]=o[5],a[5]=o[6],a[6]=o[8],a[7]=o[9],a[8]=o[10],a},m.fromQuat=function(a,o){var c=o[0],f=o[1],_=o[2],E=o[3],S=c+c,T=f+f,O=_+_,k=c*S,V=f*S,j=f*T,$=_*S,W=_*T,K=_*O,te=E*S,ve=E*T,Be=E*O;return a[0]=1-j-K,a[1]=V+Be,a[2]=$-ve,a[3]=0,a[4]=V-Be,a[5]=1-k-K,a[6]=W+te,a[7]=0,a[8]=$+ve,a[9]=W-te,a[10]=1-k-j,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},m.fromRotation=function(a,o){var c=Math.sin(o),f=Math.cos(o);return a[0]=f,a[1]=c,a[2]=0,a[3]=-c,a[4]=f,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},m.fromScaling=Ry,m.furthestTileCorner=function(a){const o=Math.round((a+45+360)%360/90)%4;return Ke[o]},m.getAABBPointSquareDist=function(a,o,c){let f=0;for(let _=0;_<2;++_){const E=c?c[_]:0;a[_]>E&&(f+=(a[_]-E)*(a[_]-E)),o[_]<E&&(f+=(E-o[_])*(E-o[_]))}return f},m.getAnchorAlignment=Xb,m.getAnchorJustification=d_,m.getBounds=function(a){let o=1/0,c=1/0,f=-1/0,_=-1/0;for(const E of a)o=Math.min(o,E.x),c=Math.min(c,E.y),f=Math.max(f,E.x),_=Math.max(_,E.y);return{min:new re(o,c),max:new re(f,_)}},m.getColumn=$e,m.getDefaultExportFromCjs=De,m.getGridMatrix=function(a,o,c,f){const _=o.getNorth(),E=o.getSouth(),S=o.getWest(),T=o.getEast(),O=1<<a.z,k=T-S,V=_-E,j=k/64,$=-V/Vc[c],W=[0,j,0,$,0,0,_,S,0];if(a.z>0){const K=180/f;Ng(W,W,[K/k+1,0,0,0,K/V+1,0,-.5*K/j,.5*K/$,1])}return W[2]=O,W[5]=a.x,W[8]=a.y,W},m.getImage=je,m.getJSON=function(a,o){return po(Ie(a,{type:"json"}),o)},m.getLatitudinalLod=function(a){const o=Xl-5;a=Ee(a,-o,o)/o*90;const c=Math.pow(Math.abs(Math.sin(ot(a))),3);return Math.round(c*(Vc.length-1))},m.getMapSessionAPI=wo,m.getPerformanceMeasurement=kc,m.getProjection=lS,m.getRTLTextPluginStatus=P,m.getReferrer=cr,m.getTilePoint=function(a,{x:o,y:c},f=0){return new re(((o-f)*a.scale-a.x)*Ei,(c*a.scale-a.y)*Ei)},m.getTileVec3=function(a,o,c=0){return Fu(((o.x-c)*a.scale-a.x)*Ei,(o.y*a.scale-a.y)*Ei,CC(o.z,o.y))},m.getVideo=function(a,o){const c=xe.document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let f=0;f<a.length;f++){const _=xe.document.createElement("source");$s(a[f])||(c.crossOrigin="Anonymous"),_.src=a[f],c.appendChild(_)}return{cancel:()=>{}}},m.globeCenterToScreenPoint=function(a){const o=[0,0,0],c=Nu(new Float64Array(16));return gf(c,a.pixelMatrix,a.globeMatrix),zs(o,o,c),new re(o[0],o[1])},m.globeDenormalizeECEF=$y,m.globeECEFOrigin=function(a,o){const c=[0,0,0];return zs(c,c,ml(rd(o.canonical))),zs(c,c,a),c},m.globeMetersToEcef=ym,m.globeNormalizeECEF=ml,m.globePixelsToTileUnits=function(a,o){return Ei/(512*Math.pow(2,a))*Sh(rd(o))},m.globePoleMatrixForTile=function(a,o,c){const f=Nu(new Float64Array(16)),_=(o/(1<<a)-.5)*Math.PI*2;return pm(f,c.globeMatrix,_),Float32Array.from(f)},m.globeTileBounds=rd,m.globeTiltAtLngLat=lb,m.globeToMercatorTransition=Mh,m.globeUseCustomAntiAliasing=function(a,o,c){const f=Mh(c.zoom),_=a.style.map._antialias,E=!!o.extStandardDerivatives,S=o.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===f&&!_&&!S&&E},m.identity=Nu,m.identity$1=gC,m.invert=fm,m.isFullscreen=function(){return!!xe.document.fullscreenElement||!!xe.document.webkitFullscreenElement},m.isLngLatBehindGlobe=zg,m.isMapAuthenticated=function(a){return go.has(a)},m.isMapboxURL=ke,m.isSafariWithAntialiasingBug=function(a){const o=a.navigator?a.navigator.userAgent:null;return!!fe(a)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},m.latFromMercatorY=Zl,m.latLngToECEF=Ef,m.len=ib,m.length=hl,m.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},m.lngFromMercatorX=zu,m.loadVectorTile=pS,m.makeRequest=po,m.mapValue=function(a,o,c,f,_){return Ee((a-o)/(c-o)*(_-f)+f,f,_)},m.mercatorScale=Sf,m.mercatorXfromLng=bd,m.mercatorYfromLat=eh,m.mercatorZfromAltitude=wd,m.mul=ky,m.mul$1=nb,m.multiply=gf,m.multiply$1=Ng,m.multiply$2=tb,m.nextPowerOfTwo=Ut,m.normalize=fl,m.normalize$1=yC,m.normalize$2=_f,m.number=hr,m.ortho=function(a,o,c,f,_,E,S){var T=1/(o-c),O=1/(f-_),k=1/(E-S);return a[0]=-2*T,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*O,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*k,a[11]=0,a[12]=(o+c)*T,a[13]=(_+f)*O,a[14]=(S+E)*k,a[15]=1,a},m.pbf=Bb,m.perspective=function(a,o,c,f,_){var E,S=1/Math.tan(o/2);return a[0]=S/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=S,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=_&&_!==1/0?(a[10]=(_+f)*(E=1/(f-_)),a[14]=2*_*f*E):(a[10]=-1,a[14]=-2*f),a},m.pick=function(a,o){const c={};for(let f=0;f<o.length;f++){const _=o[f];_ in a&&(c[_]=a[_])}return c},m.plugin=B,m.pointGeometry=ze,m.polesInViewport=function(a){const o=Nu(new Float64Array(16));gf(o,a.pixelMatrix,a.globeMatrix);const c=[0,Bu,0],f=[0,Ac,0];return zs(c,c,o),zs(f,f,o),[c[0]>0&&c[0]<=a.width&&c[1]>0&&c[1]<=a.height&&!zg(a,new Ur(a.center.lat,90)),f[0]>0&&f[0]<=a.width&&f[1]>0&&f[1]<=a.height&&!zg(a,new Ur(a.center.lat,-90))]},m.polygonContainsPoint=Mf,m.polygonIntersectsBox=pb,m.polygonIntersectsPolygon=db,m.polygonizeBounds=function(a,o,c=0,f=!0){const _=new re(c,c),E=a.sub(_),S=o.add(_),T=[E,new re(S.x,E.y),S,new re(E.x,S.y)];return f&&T.push(E.clone()),T},m.posAttributes=yf,m.postMapLoadEvent=zo,m.postPerformanceEvent=mo,m.postTurnstileEvent=or,m.potpack=bv,m.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},m.radToDeg=Ue,m.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],m.registerForPluginStateChange=function(a){return a({pluginStatus:b,pluginURL:u}),I.on("pluginStateChange",a),a},m.removeAuthState=function(a){go.delete(a)},m.renderColorRamp=Gg,m.resample=tl,m.rotateX=Fg,m.rotateX$1=Bg,m.rotateY=pm,m.rotateY$1=_C,m.rotateZ=function(a,o,c){var f=Math.sin(c),_=Math.cos(c),E=o[0],S=o[1],T=o[2],O=o[3],k=o[4],V=o[5],j=o[6],$=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=E*_+k*f,a[1]=S*_+V*f,a[2]=T*_+j*f,a[3]=O*_+$*f,a[4]=k*_-E*f,a[5]=V*_-S*f,a[6]=j*_-T*f,a[7]=$*_-O*f,a},m.rotateZ$1=function(a,o,c){c*=.5;var f=o[0],_=o[1],E=o[2],S=o[3],T=Math.sin(c),O=Math.cos(c);return a[0]=f*O+_*T,a[1]=_*O-f*T,a[2]=E*O+S*T,a[3]=S*O-E*T,a},m.scale=Qd,m.scale$1=rb,m.scale$2=zc,m.scaleAndAdd=dp,m.set=function(a,o,c,f){return a[0]=o,a[1]=c,a[2]=f,a},m.setCacheLimits=function(a,o){Gt=a,fn=o},m.setColumn=function(a,o,c){a[4*o+0]=c[0],a[4*o+1]=c[1],a[4*o+2]=c[2],a[4*o+3]=c[3]},m.setRTLTextPlugin=function(a,o,c=!1){if(b===Ag||b===Pg||b===Va)throw new Error("setRTLTextPlugin cannot be called multiple times.");u=xa.resolveURL(a),b=Ag,ed=o,C(),c||N()},m.smoothstep=dt,m.spec=Qt,m.squaredLength=function(a){var o=a[0],c=a[1],f=a[2];return o*o+c*c+f*f},m.storeAuthState=function(a,o){o?go.add(a):go.delete(a)},m.sub=uu,m.subtract=Ny,m.symbolSize=Fm,m.tileAABB=function(a,o,c,f,_,E,S,T,O){if("globe"===O.name)return function EC(a,o,c){const f=o/a.worldSize,_=a.globeMatrix;if(c.z<=1){const At=rd(c).getCorners();return Gy(At,_,f),Al.fromPoints(At)}const E=wf(c),S=Jd(E);Gy(S,_,f);const T=Number.MAX_VALUE,O=[-T,-T,-T],k=[T,T,T];if(E.contains(a.center)){for(const bn of S)mm(k,k,bn),gm(O,O,bn);O[2]=0;const At=a.point,en=[At.x*f,At.y*f,0];return mm(k,k,en),gm(O,O,en),new Al(k,O)}const V=[_[12]*f,_[13]*f,_[14]*f],j=E.getCenter(),$=Ee(a.center.lat,-Xl,Xl),W=Ee(j.lat,-Xl,Xl),K=bd(a.center.lng),te=eh($);let ve=K-bd(j.lng);const Be=te-eh(W);ve>.5?ve-=1:ve<-.5&&(ve+=1);let Je=0;Math.abs(ve)>Math.abs(Be)?Je=ve>=0?1:3:(Je=Be>=0?0:2,dp(V,V,[_[4]*f,_[5]*f,_[6]*f],-Math.sin(ot(Be>=0?E.getSouth():E.getNorth()))*id));const Ne=S[Je],Ze=S[(Je+1)%4],rt=new Vy(Ne,Ze,V),st=[Uy(rt,0)||Ne[0],Uy(rt,1)||Ne[1],Uy(rt,2)||Ne[2]],Vt=Mh(a.zoom);if(Vt>0){const At=function({x:bn,y:$t,z:an},ln,gn,In,Jt){const Hn=1/(1<<an);let ti=bn*Hn,qn=ti+Hn,ir=$t*Hn,Tn=ir+Hn,bi=0;const rr=(ti+qn)/2-In;return rr>.5?bi=-1:rr<-.5&&(bi=1),ti=((ti+bi)*ln-(In*=ln))*gn+In,qn=((qn+bi)*ln-In)*gn+In,ir=(ir*ln-(Jt*=ln))*gn+Jt,Tn=(Tn*ln-Jt)*gn+Jt,[[ti,Tn,0],[qn,Tn,0],[qn,ir,0],[ti,ir,0]]}(c,o,a._pixelsPerMercatorPixel,K,te);for(let bn=0;bn<S.length;bn++)Ch(S[bn],At[bn],Vt);const en=es([],At[Je],At[(Je+1)%4]);zc(en,en,.5),Ch(st,en,Vt)}for(const At of S)mm(k,k,At),gm(O,O,At);return k[2]=Math.min(Ne[2],Ze[2]),mm(k,k,st),gm(O,O,st),new Al(k,O)}(a,o,new Qg(c,f,_));const k=Ff({z:c,x:f,y:_},O);return new Al([(E+k.x/k.scale)*o,o*(k.y/k.scale),S],[(E+k.x2/k.scale)*o,o*(k.y2/k.scale),T])},m.tileCornersToBounds=wf,m.tileTransform=Ff,m.transformMat3=function(a,o,c){var f=o[0],_=o[1],E=o[2];return a[0]=f*c[0]+_*c[3]+E*c[6],a[1]=f*c[1]+_*c[4]+E*c[7],a[2]=f*c[2]+_*c[5]+E*c[8],a},m.transformMat4=zs,m.transformMat4$1=nd,m.transformQuat=_m,m.transitionTileAABBinECEF=jy,m.translate=up,m.transpose=function(a,o){if(a===o){var c=o[1],f=o[2],_=o[5];a[1]=o[3],a[2]=o[6],a[3]=c,a[5]=o[7],a[6]=f,a[7]=_}else a[0]=o[0],a[1]=o[3],a[2]=o[6],a[3]=o[1],a[4]=o[4],a[5]=o[7],a[6]=o[2],a[7]=o[5],a[8]=o[8];return a},m.triggerPluginCompletionEvent=g,m.uniqueId=Ct,m.updateGlobeVertexNormal=function(a,o,c,f,_){const E=5*o+2;a.float32[E+0]=c,a.float32[E+1]=f,a.float32[E+2]=_},m.validateCustomStyleLayer=function(a){const o=[],c=a.id;return void 0===c&&o.push({message:`layers.${c}: missing required property "id"`}),void 0===a.render&&o.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},m.validateFilter=a=>kt(uc(a)),m.validateFog=a=>kt(w(a)),m.validateLayer=a=>kt(sa(a)),m.validateLight=a=>kt(h(a)),m.validateSource=a=>kt(qd(a)),m.validateStyle=ie,m.validateTerrain=a=>kt(y(a)),m.values=gt,m.vectorTile=Yl,m.version=He,m.warnOnce=Ii,m.window=xe,m.wrap=Re}),Fe(0,function(m){function xe(qe){if("number"==typeof qe||"boolean"==typeof qe||"string"==typeof qe||null==qe)return JSON.stringify(qe);if(Array.isArray(qe)){let se="[";for(const je of qe)se+=`${xe(je)},`;return`${se}]`}let oe="{";for(const se of Object.keys(qe).sort())oe+=`${se}:${xe(qe[se])},`;return`${oe}}`}function He(qe){let oe="";for(const se of m.refProperties)oe+=`/${xe(qe[se])}`;return oe}class ct{constructor(oe){this.keyCache={},oe&&this.replace(oe)}replace(oe){this._layerConfigs={},this._layers={},this.update(oe,[])}update(oe,se){for(const et of oe)this._layerConfigs[et.id]=et,(this._layers[et.id]=m.createStyleLayer(et)).compileFilter(),this.keyCache[et.id]&&delete this.keyCache[et.id];for(const et of se)delete this.keyCache[et],delete this._layerConfigs[et],delete this._layers[et];this.familiesBySource={};const je=function(et,ke){const Tt={};for(let Ye=0;Ye<et.length;Ye++){const Nt=ke&&ke[et[Ye].id]||He(et[Ye]);ke&&(ke[et[Ye].id]=Nt);let _n=Tt[Nt];_n||(_n=Tt[Nt]=[]),_n.push(et[Ye])}const It=[];for(const Ye in Tt)It.push(Tt[Ye]);return It}(m.values(this._layerConfigs),this.keyCache);for(const et of je){const ke=et.map(Dn=>this._layers[Dn.id]),Tt=ke[0];if("none"===Tt.visibility)continue;const It=Tt.source||"";let Ye=this.familiesBySource[It];Ye||(Ye=this.familiesBySource[It]={});const Nt=Tt.sourceLayer||"_geojsonTileLayer";let _n=Ye[Nt];_n||(_n=Ye[Nt]=[]),_n.push(ke)}}}class tt{loadTile(oe,se){const{uid:je,encoding:et,rawImageData:ke,padding:Tt,buildQuadTree:It}=oe,Ye=m.window.ImageBitmap&&ke instanceof m.window.ImageBitmap?this.getImageData(ke,Tt):ke;se(null,new m.DEMData(je,Ye,et,Tt<1,It))}getImageData(oe,se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(oe.width,oe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=oe.width,this.offscreenCanvas.height=oe.height,this.offscreenCanvasContext.drawImage(oe,0,0,oe.width,oe.height);const je=this.offscreenCanvasContext.getImageData(-se,-se,oe.width+2*se,oe.height+2*se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),je}}function mt(qe,oe){if(0!==qe.length){Xt(qe[0],oe);for(var se=1;se<qe.length;se++)Xt(qe[se],!oe)}}function Xt(qe,oe){for(var se=0,je=0,et=0,ke=qe.length,Tt=ke-1;et<ke;Tt=et++){var It=(qe[et][0]-qe[Tt][0])*(qe[Tt][1]+qe[et][1]),Ye=se+It;je+=Math.abs(se)>=Math.abs(It)?se-Ye+It:It-Ye+se,se=Ye}se+je>=0!=!!oe&&qe.reverse()}var Mt=m.getDefaultExportFromCjs(function qe(oe,se){var je,et=oe&&oe.type;if("FeatureCollection"===et)for(je=0;je<oe.features.length;je++)qe(oe.features[je],se);else if("GeometryCollection"===et)for(je=0;je<oe.geometries.length;je++)qe(oe.geometries[je],se);else if("Feature"===et)qe(oe.geometry,se);else if("Polygon"===et)mt(oe.coordinates,se);else if("MultiPolygon"===et)for(je=0;je<oe.coordinates.length;je++)mt(oe.coordinates[je],se);return oe});const yt=m.VectorTileFeature.prototype.toGeoJSON;var Rt={exports:{}},pn=m.pointGeometry,he=m.vectorTile.VectorTileFeature,De=ce;function ce(qe,oe){this.options=oe||{},this.features=qe,this.length=qe.length}function ge(qe,oe){this.id="number"==typeof qe.id?qe.id:void 0,this.type=qe.type,this.rawGeometry=1===qe.type?[qe.geometry]:qe.geometry,this.properties=qe.tags,this.extent=oe||4096}ce.prototype.feature=function(qe){return new ge(this.features[qe],this.options.extent)},ge.prototype.loadGeometry=function(){var qe=this.rawGeometry;this.geometry=[];for(var oe=0;oe<qe.length;oe++){for(var se=qe[oe],je=[],et=0;et<se.length;et++)je.push(new pn(se[et][0],se[et][1]));this.geometry.push(je)}return this.geometry},ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var qe=this.geometry,oe=1/0,se=-1/0,je=1/0,et=-1/0,ke=0;ke<qe.length;ke++)for(var Tt=qe[ke],It=0;It<Tt.length;It++){var Ye=Tt[It];oe=Math.min(oe,Ye.x),se=Math.max(se,Ye.x),je=Math.min(je,Ye.y),et=Math.max(et,Ye.y)}return[oe,je,se,et]},ge.prototype.toGeoJSON=he.prototype.toGeoJSON;var ue=m.pbf,ze=De;function de(qe){var oe=new ue;return function(se,je){for(var et in se.layers)je.writeMessage(3,re,se.layers[et])}(qe,oe),oe.finish()}function re(qe,oe){var se;oe.writeVarintField(15,qe.version||1),oe.writeStringField(1,qe.name||""),oe.writeVarintField(5,qe.extent||4096);var je={keys:[],values:[],keycache:{},valuecache:{}};for(se=0;se<qe.length;se++)je.feature=qe.feature(se),oe.writeMessage(2,Ae,je);var et=je.keys;for(se=0;se<et.length;se++)oe.writeStringField(3,et[se]);var ke=je.values;for(se=0;se<ke.length;se++)oe.writeMessage(4,Me,ke[se])}function Ae(qe,oe){var se=qe.feature;void 0!==se.id&&oe.writeVarintField(1,se.id),oe.writeMessage(2,ne,qe),oe.writeVarintField(3,se.type),oe.writeMessage(4,Ke,se)}function ne(qe,oe){var se=qe.feature,je=qe.keys,et=qe.values,ke=qe.keycache,Tt=qe.valuecache;for(var It in se.properties){var Ye=se.properties[It],Nt=ke[It];if(null!==Ye){void 0===Nt&&(je.push(It),ke[It]=Nt=je.length-1),oe.writeVarint(Nt);var _n=typeof Ye;"string"!==_n&&"boolean"!==_n&&"number"!==_n&&(Ye=JSON.stringify(Ye));var Dn=_n+":"+Ye,yn=Tt[Dn];void 0===yn&&(et.push(Ye),Tt[Dn]=yn=et.length-1),oe.writeVarint(yn)}}}function ot(qe,oe){return(oe<<3)+(7&qe)}function Ue(qe){return qe<<1^qe>>31}function Ke(qe,oe){for(var se=qe.loadGeometry(),je=qe.type,et=0,ke=0,Tt=se.length,It=0;It<Tt;It++){var Ye=se[It],Nt=1;1===je&&(Nt=Ye.length),oe.writeVarint(ot(1,Nt));for(var _n=3===je?Ye.length-1:Ye.length,Dn=0;Dn<_n;Dn++){1===Dn&&1!==je&&oe.writeVarint(ot(2,_n-1));var yn=Ye[Dn].x-et,qi=Ye[Dn].y-ke;oe.writeVarint(Ue(yn)),oe.writeVarint(Ue(qi)),et+=yn,ke+=qi}3===je&&oe.writeVarint(ot(7,1))}}function Me(qe,oe){var se=typeof qe;"string"===se?oe.writeStringField(1,qe):"boolean"===se?oe.writeBooleanField(7,qe):"number"===se&&(qe%1!=0?oe.writeDoubleField(3,qe):qe<0?oe.writeSVarintField(6,qe):oe.writeVarintField(5,qe))}Rt.exports=de,Rt.exports.fromVectorTileJs=de,Rt.exports.fromGeojsonVt=function(qe,oe){oe=oe||{};var se={};for(var je in qe)se[je]=new ze(qe[je].features,oe),se[je].name=je,se[je].version=oe.version,se[je].extent=oe.extent;return de({layers:se})},Rt.exports.GeoJSONWrapper=ze;var on=m.getDefaultExportFromCjs(Rt.exports);const Lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:qe=>qe},Ee=Math.fround||(dt=new Float32Array(1),qe=>(dt[0]=+qe,dt[0]));var dt;const Re=3,it=5,gt=6;class Ie{constructor(oe){this.options=Object.assign(Object.create(Lt),oe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(oe){const{log:se,minZoom:je,maxZoom:et}=this.options;se&&console.time("total time");const ke=`prepare ${oe.length} points`;se&&console.time(ke),this.points=oe;const Tt=[];for(let Ye=0;Ye<oe.length;Ye++){const Nt=oe[Ye];if(!Nt.geometry)continue;const[_n,Dn]=Nt.geometry.coordinates,yn=Ee(Cn(_n)),qi=Ee(Ut(Dn));Tt.push(yn,qi,1/0,Ye,-1,1),this.options.reduce&&Tt.push(0)}let It=this.trees[et+1]=this._createTree(Tt);se&&console.timeEnd(ke);for(let Ye=et;Ye>=je;Ye--){const Nt=+Date.now();It=this.trees[Ye]=this._createTree(this._cluster(It,Ye)),se&&console.log("z%d: %d clusters in %dms",Ye,It.numItems,+Date.now()-Nt)}return se&&console.timeEnd("total time"),this}getClusters(oe,se){let je=((oe[0]+180)%360+360)%360-180;const et=Math.max(-90,Math.min(90,oe[1]));let ke=180===oe[2]?180:((oe[2]+180)%360+360)%360-180;const Tt=Math.max(-90,Math.min(90,oe[3]));if(oe[2]-oe[0]>=360)je=-180,ke=180;else if(je>ke){const Dn=this.getClusters([je,et,180,Tt],se),yn=this.getClusters([-180,et,ke,Tt],se);return Dn.concat(yn)}const It=this.trees[this._limitZoom(se)],Ye=It.range(Cn(je),Ut(Tt),Cn(ke),Ut(et)),Nt=It.data,_n=[];for(const Dn of Ye){const yn=this.stride*Dn;_n.push(Nt[yn+it]>1?qt(Nt,yn,this.clusterProps):this.points[Nt[yn+Re]])}return _n}getChildren(oe){const se=this._getOriginId(oe),je=this._getOriginZoom(oe),et="No cluster with the specified id.",ke=this.trees[je];if(!ke)throw new Error(et);const Tt=ke.data;if(se*this.stride>=Tt.length)throw new Error(et);const It=this.options.radius/(this.options.extent*Math.pow(2,je-1)),Ye=ke.within(Tt[se*this.stride],Tt[se*this.stride+1],It),Nt=[];for(const _n of Ye){const Dn=_n*this.stride;Tt[Dn+4]===oe&&Nt.push(Tt[Dn+it]>1?qt(Tt,Dn,this.clusterProps):this.points[Tt[Dn+Re]])}if(0===Nt.length)throw new Error(et);return Nt}getLeaves(oe,se,je){const et=[];return this._appendLeaves(et,oe,se=se||10,je=je||0,0),et}getTile(oe,se,je){const et=this.trees[this._limitZoom(oe)],ke=Math.pow(2,oe),{extent:Tt,radius:It}=this.options,Ye=It/Tt,Nt=(je-Ye)/ke,_n=(je+1+Ye)/ke,Dn={features:[]};return this._addTileFeatures(et.range((se-Ye)/ke,Nt,(se+1+Ye)/ke,_n),et.data,se,je,ke,Dn),0===se&&this._addTileFeatures(et.range(1-Ye/ke,Nt,1,_n),et.data,ke,je,ke,Dn),se===ke-1&&this._addTileFeatures(et.range(0,Nt,Ye/ke,_n),et.data,-1,je,ke,Dn),Dn.features.length?Dn:null}getClusterExpansionZoom(oe){let se=this._getOriginZoom(oe)-1;for(;se<=this.options.maxZoom;){const je=this.getChildren(oe);if(se++,1!==je.length)break;oe=je[0].properties.cluster_id}return se}_appendLeaves(oe,se,je,et,ke){const Tt=this.getChildren(se);for(const It of Tt){const Ye=It.properties;if(Ye&&Ye.cluster?ke+Ye.point_count<=et?ke+=Ye.point_count:ke=this._appendLeaves(oe,Ye.cluster_id,je,et,ke):ke<et?ke++:oe.push(It),oe.length===je)break}return ke}_createTree(oe){const se=new m.KDBush(oe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let je=0;je<oe.length;je+=this.stride)se.add(oe[je],oe[je+1]);return se.finish(),se.data=oe,se}_addTileFeatures(oe,se,je,et,ke,Tt){for(const It of oe){const Ye=It*this.stride,Nt=se[Ye+it]>1;let _n,Dn,yn;if(Nt)_n=Ct(se,Ye,this.clusterProps),Dn=se[Ye],yn=se[Ye+1];else{const ji=this.points[se[Ye+Re]];_n=ji.properties;const[Fi,or]=ji.geometry.coordinates;Dn=Cn(Fi),yn=Ut(or)}const qi={type:1,geometry:[[Math.round(this.options.extent*(Dn*ke-je)),Math.round(this.options.extent*(yn*ke-et))]],tags:_n};let Yi;Yi=Nt||this.options.generateId?se[Ye+Re]:this.points[se[Ye+Re]].id,void 0!==Yi&&(qi.id=Yi),Tt.features.push(qi)}}_limitZoom(oe){return Math.max(this.options.minZoom,Math.min(Math.floor(+oe),this.options.maxZoom+1))}_cluster(oe,se){const{radius:je,extent:et,reduce:ke,minPoints:Tt}=this.options,It=je/(et*Math.pow(2,se)),Ye=oe.data,Nt=[],_n=this.stride;for(let Dn=0;Dn<Ye.length;Dn+=_n){if(Ye[Dn+2]<=se)continue;Ye[Dn+2]=se;const yn=Ye[Dn],qi=Ye[Dn+1],Yi=oe.within(Ye[Dn],Ye[Dn+1],It),ji=Ye[Dn+it];let Fi=ji;for(const or of Yi){const dr=or*_n;Ye[dr+2]>se&&(Fi+=Ye[dr+it])}if(Fi>ji&&Fi>=Tt){let or,dr=yn*ji,zo=qi*ji,Vi=-1;const mo=((Dn/_n|0)<<5)+(se+1)+this.points.length;for(const ta of Yi){const wo=ta*_n;if(Ye[wo+2]<=se)continue;Ye[wo+2]=se;const go=Ye[wo+it];dr+=Ye[wo]*go,zo+=Ye[wo+1]*go,Ye[wo+4]=mo,ke&&(or||(or=this._map(Ye,Dn,!0),Vi=this.clusterProps.length,this.clusterProps.push(or)),ke(or,this._map(Ye,wo)))}Ye[Dn+4]=mo,Nt.push(dr/Fi,zo/Fi,1/0,mo,-1,Fi),ke&&Nt.push(Vi)}else{for(let or=0;or<_n;or++)Nt.push(Ye[Dn+or]);if(Fi>1)for(const or of Yi){const dr=or*_n;if(!(Ye[dr+2]<=se)){Ye[dr+2]=se;for(let zo=0;zo<_n;zo++)Nt.push(Ye[dr+zo])}}}}return Nt}_getOriginId(oe){return oe-this.points.length>>5}_getOriginZoom(oe){return(oe-this.points.length)%32}_map(oe,se,je){if(oe[se+it]>1){const Tt=this.clusterProps[oe[se+gt]];return je?Object.assign({},Tt):Tt}const et=this.points[oe[se+Re]].properties,ke=this.options.map(et);return je&&ke===et?Object.assign({},ke):ke}}function qt(qe,oe,se){return{type:"Feature",id:qe[oe+Re],properties:Ct(qe,oe,se),geometry:{type:"Point",coordinates:[(je=qe[oe],360*(je-.5)),Bn(qe[oe+1])]}};var je}function Ct(qe,oe,se){const je=qe[oe+it],et=je>=1e4?`${Math.round(je/1e3)}k`:je>=1e3?Math.round(je/100)/10+"k":je,ke=qe[oe+gt],Tt=-1===ke?{}:Object.assign({},se[ke]);return Object.assign(Tt,{cluster:!0,cluster_id:qe[oe+Re],point_count:je,point_count_abbreviated:et})}function Cn(qe){return qe/360+.5}function Ut(qe){const oe=Math.sin(qe*Math.PI/180),se=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return se<0?0:se>1?1:se}function Bn(qe){const oe=(180-360*qe)*Math.PI/180;return 360*Math.atan(Math.exp(oe))/Math.PI-90}function zn(qe,oe,se,je){for(var et,ke=je,Tt=se-oe>>1,It=se-oe,Ye=qe[oe],Nt=qe[oe+1],_n=qe[se],Dn=qe[se+1],yn=oe+3;yn<se;yn+=3){var qi=Jn(qe[yn],qe[yn+1],Ye,Nt,_n,Dn);if(qi>ke)et=yn,ke=qi;else if(qi===ke){var Yi=Math.abs(yn-Tt);Yi<It&&(et=yn,It=Yi)}}ke>je&&(et-oe>3&&zn(qe,oe,et,je),qe[et+2]=ke,se-et>3&&zn(qe,et,se,je))}function Jn(qe,oe,se,je,et,ke){var Tt=et-se,It=ke-je;if(0!==Tt||0!==It){var Ye=((qe-se)*Tt+(oe-je)*It)/(Tt*Tt+It*It);Ye>1?(se=et,je=ke):Ye>0&&(se+=Tt*Ye,je+=It*Ye)}return(Tt=qe-se)*Tt+(It=oe-je)*It}function Kt(qe,oe,se,je){var et={id:void 0===qe?null:qe,type:oe,geometry:se,tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ke){var Tt=ke.geometry,It=ke.type;if("Point"===It||"MultiPoint"===It||"LineString"===It)Qn(ke,Tt);else if("Polygon"===It||"MultiLineString"===It)for(var Ye=0;Ye<Tt.length;Ye++)Qn(ke,Tt[Ye]);else if("MultiPolygon"===It)for(Ye=0;Ye<Tt.length;Ye++)for(var Nt=0;Nt<Tt[Ye].length;Nt++)Qn(ke,Tt[Ye][Nt])}(et),et}function Qn(qe,oe){for(var se=0;se<oe.length;se+=3)qe.minX=Math.min(qe.minX,oe[se]),qe.minY=Math.min(qe.minY,oe[se+1]),qe.maxX=Math.max(qe.maxX,oe[se]),qe.maxY=Math.max(qe.maxY,oe[se+1])}function mn(qe,oe,se,je){if(oe.geometry){var et=oe.geometry.coordinates,ke=oe.geometry.type,Tt=Math.pow(se.tolerance/((1<<se.maxZoom)*se.extent),2),It=[],Ye=oe.id;if(se.promoteId?Ye=oe.properties[se.promoteId]:se.generateId&&(Ye=je||0),"Point"===ke)Mr(et,It);else if("MultiPoint"===ke)for(var Nt=0;Nt<et.length;Nt++)Mr(et[Nt],It);else if("LineString"===ke)Ii(et,It,Tt,!1);else if("MultiLineString"===ke){if(se.lineMetrics){for(Nt=0;Nt<et.length;Nt++)Ii(et[Nt],It=[],Tt,!1),qe.push(Kt(Ye,"LineString",It,oe.properties));return}vr(et,It,Tt,!1)}else if("Polygon"===ke)vr(et,It,Tt,!0);else{if("MultiPolygon"!==ke){if("GeometryCollection"===ke){for(Nt=0;Nt<oe.geometry.geometries.length;Nt++)mn(qe,{id:Ye,geometry:oe.geometry.geometries[Nt],properties:oe.properties},se,je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Nt=0;Nt<et.length;Nt++){var _n=[];vr(et[Nt],_n,Tt,!0),It.push(_n)}}qe.push(Kt(Ye,ke,It,oe.properties))}}function Mr(qe,oe){oe.push(mi(qe[0])),oe.push(wi(qe[1])),oe.push(0)}function Ii(qe,oe,se,je){for(var et,ke,Tt=0,It=0;It<qe.length;It++){var Ye=mi(qe[It][0]),Nt=wi(qe[It][1]);oe.push(Ye),oe.push(Nt),oe.push(0),It>0&&(Tt+=je?(et*Nt-Ye*ke)/2:Math.sqrt(Math.pow(Ye-et,2)+Math.pow(Nt-ke,2))),et=Ye,ke=Nt}var _n=oe.length-3;oe[2]=1,zn(oe,0,_n,se),oe[_n+2]=1,oe.size=Math.abs(Tt),oe.start=0,oe.end=oe.size}function vr(qe,oe,se,je){for(var et=0;et<qe.length;et++){var ke=[];Ii(qe[et],ke,se,je),oe.push(ke)}}function mi(qe){return qe/360+.5}function wi(qe){var oe=Math.sin(qe*Math.PI/180),se=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return se<0?0:se>1?1:se}function _t(qe,oe,se,je,et,ke,Tt,It){if(je/=oe,ke>=(se/=oe)&&Tt<je)return qe;if(Tt<se||ke>=je)return null;for(var Ye=[],Nt=0;Nt<qe.length;Nt++){var _n=qe[Nt],Dn=_n.geometry,yn=_n.type,qi=0===et?_n.minX:_n.minY,Yi=0===et?_n.maxX:_n.maxY;if(qi>=se&&Yi<je)Ye.push(_n);else if(!(Yi<se||qi>=je)){var ji=[];if("Point"===yn||"MultiPoint"===yn)we(Dn,ji,se,je,et);else if("LineString"===yn)fe(Dn,ji,se,je,et,!1,It.lineMetrics);else if("MultiLineString"===yn)$e(Dn,ji,se,je,et,!1);else if("Polygon"===yn)$e(Dn,ji,se,je,et,!0);else if("MultiPolygon"===yn)for(var Fi=0;Fi<Dn.length;Fi++){var or=[];$e(Dn[Fi],or,se,je,et,!0),or.length&&ji.push(or)}if(ji.length){if(It.lineMetrics&&"LineString"===yn){for(Fi=0;Fi<ji.length;Fi++)Ye.push(Kt(_n.id,yn,ji[Fi],_n.tags));continue}"LineString"!==yn&&"MultiLineString"!==yn||(1===ji.length?(yn="LineString",ji=ji[0]):yn="MultiLineString"),"Point"!==yn&&"MultiPoint"!==yn||(yn=3===ji.length?"Point":"MultiPoint"),Ye.push(Kt(_n.id,yn,ji,_n.tags))}}}return Ye.length?Ye:null}function we(qe,oe,se,je,et){for(var ke=0;ke<qe.length;ke+=3){var Tt=qe[ke+et];Tt>=se&&Tt<=je&&(oe.push(qe[ke]),oe.push(qe[ke+1]),oe.push(qe[ke+2]))}}function fe(qe,oe,se,je,et,ke,Tt){for(var It,Ye,Nt=le(qe),_n=0===et?Gt:fn,Dn=qe.start,yn=0;yn<qe.length-3;yn+=3){var qi=qe[yn],Yi=qe[yn+1],ji=qe[yn+2],Fi=qe[yn+3],or=qe[yn+4],dr=0===et?qi:Yi,zo=0===et?Fi:or,Vi=!1;Tt&&(It=Math.sqrt(Math.pow(qi-Fi,2)+Math.pow(Yi-or,2))),dr<se?zo>se&&(Ye=_n(Nt,qi,Yi,Fi,or,se),Tt&&(Nt.start=Dn+It*Ye)):dr>je?zo<je&&(Ye=_n(Nt,qi,Yi,Fi,or,je),Tt&&(Nt.start=Dn+It*Ye)):pt(Nt,qi,Yi,ji),zo<se&&dr>=se&&(Ye=_n(Nt,qi,Yi,Fi,or,se),Vi=!0),zo>je&&dr<=je&&(Ye=_n(Nt,qi,Yi,Fi,or,je),Vi=!0),!ke&&Vi&&(Tt&&(Nt.end=Dn+It*Ye),oe.push(Nt),Nt=le(qe)),Tt&&(Dn+=It)}var mo=qe.length-3;qi=qe[mo],Yi=qe[mo+1],ji=qe[mo+2],(dr=0===et?qi:Yi)>=se&&dr<=je&&pt(Nt,qi,Yi,ji),mo=Nt.length-3,ke&&mo>=3&&(Nt[mo]!==Nt[0]||Nt[mo+1]!==Nt[1])&&pt(Nt,Nt[0],Nt[1],Nt[2]),Nt.length&&oe.push(Nt)}function le(qe){var oe=[];return oe.size=qe.size,oe.start=qe.start,oe.end=qe.end,oe}function $e(qe,oe,se,je,et,ke){for(var Tt=0;Tt<qe.length;Tt++)fe(qe[Tt],oe,se,je,et,ke,!1)}function pt(qe,oe,se,je){qe.push(oe),qe.push(se),qe.push(je)}function Gt(qe,oe,se,je,et,ke){var Tt=(ke-oe)/(je-oe);return qe.push(ke),qe.push(se+(et-se)*Tt),qe.push(1),Tt}function fn(qe,oe,se,je,et,ke){var Tt=(ke-se)/(et-se);return qe.push(oe+(je-oe)*Tt),qe.push(ke),qe.push(1),Tt}function cn(qe,oe){for(var se=[],je=0;je<qe.length;je++){var et,ke=qe[je],Tt=ke.type;if("Point"===Tt||"MultiPoint"===Tt||"LineString"===Tt)et=Wt(ke.geometry,oe);else if("MultiLineString"===Tt||"Polygon"===Tt){et=[];for(var It=0;It<ke.geometry.length;It++)et.push(Wt(ke.geometry[It],oe))}else if("MultiPolygon"===Tt)for(et=[],It=0;It<ke.geometry.length;It++){for(var Ye=[],Nt=0;Nt<ke.geometry[It].length;Nt++)Ye.push(Wt(ke.geometry[It][Nt],oe));et.push(Ye)}se.push(Kt(ke.id,Tt,et,ke.tags))}return se}function Wt(qe,oe){var se=[];se.size=qe.size,void 0!==qe.start&&(se.start=qe.start,se.end=qe.end);for(var je=0;je<qe.length;je+=3)se.push(qe[je]+oe,qe[je+1],qe[je+2]);return se}function Mi(qe,oe){if(qe.transformed)return qe;var se,je,et,ke=1<<qe.z,Tt=qe.x,It=qe.y;for(se=0;se<qe.features.length;se++){var Ye=qe.features[se],Nt=Ye.geometry,_n=Ye.type;if(Ye.geometry=[],1===_n)for(je=0;je<Nt.length;je+=2)Ye.geometry.push(Ni(Nt[je],Nt[je+1],oe,ke,Tt,It));else for(je=0;je<Nt.length;je++){var Dn=[];for(et=0;et<Nt[je].length;et+=2)Dn.push(Ni(Nt[je][et],Nt[je][et+1],oe,ke,Tt,It));Ye.geometry.push(Dn)}}return qe.transformed=!0,qe}function Ni(qe,oe,se,je,et,ke){return[Math.round(se*(qe*je-et)),Math.round(se*(oe*je-ke))]}function Nn(qe,oe,se,je,et){for(var ke=oe===et.maxZoom?0:et.tolerance/((1<<oe)*et.extent),Tt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:se,y:je,z:oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},It=0;It<qe.length;It++){Tt.numFeatures++,Ci(Tt,qe[It],ke,et);var Ye=qe[It].minX,Nt=qe[It].minY,_n=qe[It].maxX,Dn=qe[It].maxY;Ye<Tt.minX&&(Tt.minX=Ye),Nt<Tt.minY&&(Tt.minY=Nt),_n>Tt.maxX&&(Tt.maxX=_n),Dn>Tt.maxY&&(Tt.maxY=Dn)}return Tt}function Ci(qe,oe,se,je){var et=oe.geometry,ke=oe.type,Tt=[];if("Point"===ke||"MultiPoint"===ke)for(var It=0;It<et.length;It+=3)Tt.push(et[It]),Tt.push(et[It+1]),qe.numPoints++,qe.numSimplified++;else if("LineString"===ke)Nr(Tt,et,qe,se,!1,!1);else if("MultiLineString"===ke||"Polygon"===ke)for(It=0;It<et.length;It++)Nr(Tt,et[It],qe,se,"Polygon"===ke,0===It);else if("MultiPolygon"===ke)for(var Ye=0;Ye<et.length;Ye++){var Nt=et[Ye];for(It=0;It<Nt.length;It++)Nr(Tt,Nt[It],qe,se,!0,0===It)}if(Tt.length){var _n=oe.tags||null;if("LineString"===ke&&je.lineMetrics){for(var Dn in _n={},oe.tags)_n[Dn]=oe.tags[Dn];_n.mapbox_clip_start=et.start/et.size,_n.mapbox_clip_end=et.end/et.size}var yn={geometry:Tt,type:"Polygon"===ke||"MultiPolygon"===ke?3:"LineString"===ke||"MultiLineString"===ke?2:1,tags:_n};null!==oe.id&&(yn.id=oe.id),qe.features.push(yn)}}function Nr(qe,oe,se,je,et,ke){var Tt=je*je;if(je>0&&oe.size<(et?Tt:je))se.numPoints+=oe.length/3;else{for(var It=[],Ye=0;Ye<oe.length;Ye+=3)(0===je||oe[Ye+2]>Tt)&&(se.numSimplified++,It.push(oe[Ye]),It.push(oe[Ye+1])),se.numPoints++;et&&function(Nt,_n){for(var Dn=0,yn=0,qi=Nt.length,Yi=qi-2;yn<qi;Yi=yn,yn+=2)Dn+=(Nt[yn]-Nt[Yi])*(Nt[yn+1]+Nt[Yi+1]);if(Dn>0===_n)for(yn=0,qi=Nt.length;yn<qi/2;yn+=2){var ji=Nt[yn],Fi=Nt[yn+1];Nt[yn]=Nt[qi-2-yn],Nt[yn+1]=Nt[qi-1-yn],Nt[qi-2-yn]=ji,Nt[qi-1-yn]=Fi}}(It,ke),qe.push(It)}}function nr(qe,oe){var se=(oe=this.options=function(et,ke){for(var Tt in ke)et[Tt]=ke[Tt];return et}(Object.create(this.options),oe)).debug;if(se&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");var et,ke,Tt,It,Ye,Nt,je=function(et,ke){var Tt=[];if("FeatureCollection"===et.type)for(var It=0;It<et.features.length;It++)mn(Tt,et.features[It],ke,It);else mn(Tt,"Feature"===et.type?et:{geometry:et},ke);return Tt}(qe,oe);this.tiles={},this.tileCoords=[],se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),It=et=je,Ye=_t(et,1,-1-(Tt=(ke=oe).buffer/ke.extent),Tt,0,-1,2,ke),Nt=_t(et,1,1-Tt,2+Tt,0,-1,2,ke),(Ye||Nt)&&(It=_t(et,1,-Tt,1+Tt,0,-1,2,ke)||[],Ye&&(It=cn(Ye,1).concat(It)),Nt&&(It=It.concat(cn(Nt,-1)))),(je=It).length&&this.splitTile(je,0,0,0),se&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function cr(qe,oe,se){return 32*((1<<qe)*se+oe)+qe}function po(qe,oe){const se=qe.tileID.canonical;if(!this._geoJSONIndex)return oe(null,null);const je=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!je)return oe(null,null);const et=new class{constructor(Tt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.EXTENT,this.length=Tt.length,this._features=Tt}feature(Tt){return new class{constructor(It){this._feature=It,this.extent=m.EXTENT,this.type=It.type,this.properties=It.tags,"id"in It&&!isNaN(It.id)&&(this.id=parseInt(It.id,10))}loadGeometry(){if(1===this._feature.type){const It=[];for(const Ye of this._feature.geometry)It.push([new m.Point(Ye[0],Ye[1])]);return It}{const It=[];for(const Ye of this._feature.geometry){const Nt=[];for(const _n of Ye)Nt.push(new m.Point(_n[0],_n[1]));It.push(Nt)}return It}}toGeoJSON(It,Ye,Nt){return yt.call(this,It,Ye,Nt)}}(this._features[Tt])}}(je.features);let ke=on(et);0===ke.byteOffset&&ke.byteLength===ke.buffer.byteLength||(ke=new Uint8Array(ke)),oe(null,{vectorTile:et,rawData:ke.buffer})}nr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},nr.prototype.splitTile=function(qe,oe,se,je,et,ke,Tt){for(var It=[qe,oe,se,je],Ye=this.options,Nt=Ye.debug;It.length;){je=It.pop(),se=It.pop(),oe=It.pop(),qe=It.pop();var _n=1<<oe,Dn=cr(oe,se,je),yn=this.tiles[Dn];if(!yn&&(Nt>1&&console.time("creation"),yn=this.tiles[Dn]=Nn(qe,oe,se,je,Ye),this.tileCoords.push({z:oe,x:se,y:je}),Nt)){Nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,se,je,yn.numFeatures,yn.numPoints,yn.numSimplified),console.timeEnd("creation"));var qi="z"+oe;this.stats[qi]=(this.stats[qi]||0)+1,this.total++}if(yn.source=qe,et){if(oe===Ye.maxZoom||oe===et)continue;var Yi=1<<et-oe;if(se!==Math.floor(ke/Yi)||je!==Math.floor(Tt/Yi))continue}else if(oe===Ye.indexMaxZoom||yn.numPoints<=Ye.indexMaxPoints)continue;if(yn.source=null,0!==qe.length){Nt>1&&console.time("clipping");var ji,Fi,or,dr,zo,Vi,mo=.5*Ye.buffer/Ye.extent,ta=.5-mo,wo=.5+mo,go=1+mo;ji=Fi=or=dr=null,zo=_t(qe,_n,se-mo,se+wo,0,yn.minX,yn.maxX,Ye),Vi=_t(qe,_n,se+ta,se+go,0,yn.minX,yn.maxX,Ye),qe=null,zo&&(ji=_t(zo,_n,je-mo,je+wo,1,yn.minY,yn.maxY,Ye),Fi=_t(zo,_n,je+ta,je+go,1,yn.minY,yn.maxY,Ye),zo=null),Vi&&(or=_t(Vi,_n,je-mo,je+wo,1,yn.minY,yn.maxY,Ye),dr=_t(Vi,_n,je+ta,je+go,1,yn.minY,yn.maxY,Ye),Vi=null),Nt>1&&console.timeEnd("clipping"),It.push(ji||[],oe+1,2*se,2*je),It.push(Fi||[],oe+1,2*se,2*je+1),It.push(or||[],oe+1,2*se+1,2*je),It.push(dr||[],oe+1,2*se+1,2*je+1)}}},nr.prototype.getTile=function(qe,oe,se){var je=this.options,et=je.extent,ke=je.debug;if(qe<0||qe>24)return null;var Tt=1<<qe,It=cr(qe,oe=(oe%Tt+Tt)%Tt,se);if(this.tiles[It])return Mi(this.tiles[It],et);ke>1&&console.log("drilling down to z%d-%d-%d",qe,oe,se);for(var Ye,Nt=qe,_n=oe,Dn=se;!Ye&&Nt>0;)Nt--,_n=Math.floor(_n/2),Dn=Math.floor(Dn/2),Ye=this.tiles[cr(Nt,_n,Dn)];return Ye&&Ye.source?(ke>1&&console.log("found parent tile z%d-%d-%d",Nt,_n,Dn),ke>1&&console.time("drilling down"),this.splitTile(Ye.source,Nt,_n,Dn,qe,oe,se),ke>1&&console.timeEnd("drilling down"),this.tiles[It]?Mi(this.tiles[It],et):null):null};class Xo extends m.VectorTileWorkerSource{constructor(oe,se,je,et,ke){super(oe,se,je,et,po),ke&&(this.loadGeoJSON=ke)}loadData(oe,se){const je=oe&&oe.request,et=je&&je.collectResourceTiming;this.loadGeoJSON(oe,(ke,Tt)=>{if(ke||!Tt)return se(ke);if("object"!=typeof Tt)return se(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`));{Mt(Tt,!0);try{if(oe.filter){const Ye=m.createExpression(oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ye.result)throw new Error(Ye.value.map(_n=>`${_n.key}: ${_n.message}`).join(", "));Tt={type:"FeatureCollection",features:Tt.features.filter(_n=>Ye.value.evaluate({zoom:0},_n))}}this._geoJSONIndex=oe.cluster?new Ie(function({superclusterOptions:Ye,clusterProperties:Nt}){if(!Nt||!Ye)return Ye;const _n={},Dn={},yn={accumulated:null,zoom:0},qi={properties:null},Yi=Object.keys(Nt);for(const ji of Yi){const[Fi,or]=Nt[ji],dr=m.createExpression(or),zo=m.createExpression("string"==typeof Fi?[Fi,["accumulated"],["get",ji]]:Fi);_n[ji]=dr.value,Dn[ji]=zo.value}return Ye.map=ji=>{qi.properties=ji;const Fi={};for(const or of Yi)Fi[or]=_n[or].evaluate(yn,qi);return Fi},Ye.reduce=(ji,Fi)=>{qi.properties=Fi;for(const or of Yi)yn.accumulated=ji[or],ji[or]=Dn[or].evaluate(yn,qi)},Ye}(oe)).load(Tt.features):new nr(Ye=Tt,oe.geojsonVtOptions)}catch(Ye){return se(Ye)}this.loaded={};const It={};if(et){const Ye=m.getPerformanceMeasurement(je);Ye&&(It.resourceTiming={},It.resourceTiming[oe.source]=JSON.parse(JSON.stringify(Ye)))}se(null,It)}var Ye})}reloadTile(oe,se){const je=this.loaded;return je&&je[oe.uid]?super.reloadTile(oe,se):this.loadTile(oe,se)}loadGeoJSON(oe,se){if(oe.request)m.getJSON(oe.request,se);else{if("string"!=typeof oe.data)return se(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`));try{return se(null,JSON.parse(oe.data))}catch{return se(new Error(`Input data given to '${oe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(oe,se){try{se(null,this._geoJSONIndex.getClusterExpansionZoom(oe.clusterId))}catch(je){se(je)}}getClusterChildren(oe,se){try{se(null,this._geoJSONIndex.getChildren(oe.clusterId))}catch(je){se(je)}}getClusterLeaves(oe,se){try{se(null,this._geoJSONIndex.getLeaves(oe.clusterId,oe.limit,oe.offset))}catch(je){se(je)}}}class $s{constructor(oe){this.self=oe,this.actor=new m.Actor(oe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=m.getProjection({name:"mercator"}),this.workerSourceTypes={vector:m.VectorTileWorkerSource,geojson:Xo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(se,je)=>{if(this.workerSourceTypes[se])throw new Error(`Worker source with name "${se}" already registered.`);this.workerSourceTypes[se]=je},this.self.registerRTLTextPlugin=se=>{if(m.plugin.isParsed())throw new Error("RTL text plugin already registered.");m.plugin.applyArabicShaping=se.applyArabicShaping,m.plugin.processBidirectionalText=se.processBidirectionalText,m.plugin.processStyledBidirectionalText=se.processStyledBidirectionalText}}clearCaches(oe,se,je){delete this.layerIndexes[oe],delete this.availableImages[oe],delete this.workerSources[oe],delete this.demWorkerSources[oe],je()}checkIfReady(oe,se,je){je()}setReferrer(oe,se){this.referrer=se}spriteLoaded(oe,se){this.isSpriteLoaded[oe]=se;for(const je in this.workerSources[oe]){const et=this.workerSources[oe][je];for(const ke in et)et[ke]instanceof m.VectorTileWorkerSource&&(et[ke].isSpriteLoaded=se,et[ke].fire(new m.Event("isSpriteLoaded")))}}setImages(oe,se,je){this.availableImages[oe]=se;for(const et in this.workerSources[oe]){const ke=this.workerSources[oe][et];for(const Tt in ke)ke[Tt].availableImages=se}je()}enableTerrain(oe,se,je){this.terrain=se,je()}setProjection(oe,se){this.projections[oe]=m.getProjection(se)}setLayers(oe,se,je){this.getLayerIndex(oe).replace(se),je()}updateLayers(oe,se,je){this.getLayerIndex(oe).update(se.layers,se.removedIds),je()}loadTile(oe,se,je){const et=this.enableTerrain?m.extend({enableTerrain:this.terrain},se):se;et.projection=this.projections[oe]||this.defaultProjection,this.getWorkerSource(oe,se.type,se.source).loadTile(et,je)}loadDEMTile(oe,se,je){const et=this.enableTerrain?m.extend({buildQuadTree:this.terrain},se):se;this.getDEMWorkerSource(oe,se.source).loadTile(et,je)}reloadTile(oe,se,je){const et=this.enableTerrain?m.extend({enableTerrain:this.terrain},se):se;et.projection=this.projections[oe]||this.defaultProjection,this.getWorkerSource(oe,se.type,se.source).reloadTile(et,je)}abortTile(oe,se,je){this.getWorkerSource(oe,se.type,se.source).abortTile(se,je)}removeTile(oe,se,je){this.getWorkerSource(oe,se.type,se.source).removeTile(se,je)}removeSource(oe,se,je){if(!this.workerSources[oe]||!this.workerSources[oe][se.type]||!this.workerSources[oe][se.type][se.source])return;const et=this.workerSources[oe][se.type][se.source];delete this.workerSources[oe][se.type][se.source],void 0!==et.removeSource?et.removeSource(se,je):je()}loadWorkerSource(oe,se,je){try{this.self.importScripts(se.url),je()}catch(et){je(et.toString())}}syncRTLPluginState(oe,se,je){try{m.plugin.setState(se);const et=m.plugin.getPluginURL();if(m.plugin.isLoaded()&&!m.plugin.isParsed()&&null!=et){this.self.importScripts(et);const ke=m.plugin.isParsed();je(ke?void 0:new Error(`RTL Text Plugin failed to import scripts from ${et}`),ke)}}catch(et){je(et.toString())}}getAvailableImages(oe){let se=this.availableImages[oe];return se||(se=[]),se}getLayerIndex(oe){let se=this.layerIndexes[oe];return se||(se=this.layerIndexes[oe]=new ct),se}getWorkerSource(oe,se,je){return this.workerSources[oe]||(this.workerSources[oe]={}),this.workerSources[oe][se]||(this.workerSources[oe][se]={}),this.workerSources[oe][se][je]||(this.workerSources[oe][se][je]=new this.workerSourceTypes[se]({send:(ke,Tt,It,Ye,Nt,_n)=>{this.actor.send(ke,Tt,It,oe,Nt,_n)},scheduler:this.actor.scheduler},this.getLayerIndex(oe),this.getAvailableImages(oe),this.isSpriteLoaded[oe])),this.workerSources[oe][se][je]}getDEMWorkerSource(oe,se){return this.demWorkerSources[oe]||(this.demWorkerSources[oe]={}),this.demWorkerSources[oe][se]||(this.demWorkerSources[oe][se]=new tt),this.demWorkerSources[oe][se]}enforceCacheSizeLimit(oe,se){m.enforceCacheSizeLimit(se)}getWorkerPerformanceMetrics(oe,se,je){je(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new $s(self)),$s}),Fe(0,function(m){function xe(b,u){if(Array.isArray(b)){if(!Array.isArray(u)||b.length!==u.length)return!1;for(let g=0;g<b.length;g++)if(!xe(b[g],u[g]))return!1;return!0}if("object"==typeof b&&null!==b&&null!==u){if("object"!=typeof u||Object.keys(b).length!==Object.keys(u).length)return!1;for(const g in b)if(!xe(b[g],u[g]))return!1;return!0}return b===u}var He=ct;function ct(b){return u=b,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var C,I,P=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(P);try{I=new Worker(N),C=!0}catch{C=!1}return I&&I.terminate(),URL.revokeObjectURL(N),C}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var C=document.createElement("canvas");C.width=C.height=1;var I=C.getContext("2d");if(!I)return!1;var P=I.getImageData(0,0,1,1);return P&&P.width===C.width}()||(void 0===tt[g=u&&u.failIfMajorPerformanceCaveat]&&(tt[g]=function(C){var I,N,B,U,P=(N=C,B=document.createElement("canvas"),(U=Object.create(ct.webGLContextAttributes)).failIfMajorPerformanceCaveat=N,B.getContext("webgl",U)||B.getContext("experimental-webgl",U));if(!P)return!1;try{I=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!I||P.isContextLost())&&(P.shaderSource(I,"void main() {}"),P.compileShader(I),!0===P.getShaderParameter(I,P.COMPILE_STATUS))}(g)),!tt[g]||document.documentMode));var u,g}var tt={};function mt(b,u,g){const C=m.window.document.createElement(b);return void 0!==u&&(C.className=u),g&&g.appendChild(C),C}function Xt(b,u,g){const C=m.window.document.createElementNS("http://www.w3.org/2000/svg",b);for(const I of Object.keys(u))C.setAttributeNS(null,I,u[I]);return g&&g.appendChild(C),C}ct.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Mt=m.window.document&&m.window.document.documentElement.style,yt=Mt&&void 0!==Mt.userSelect?"userSelect":"WebkitUserSelect";let Rt;function pn(){Mt&&yt&&(Rt=Mt[yt],Mt[yt]="none")}function he(){Mt&&yt&&(Mt[yt]=Rt)}function De(b){b.preventDefault(),b.stopPropagation(),m.window.removeEventListener("click",De,!0)}function ce(){m.window.addEventListener("click",De,!0),m.window.setTimeout(()=>{m.window.removeEventListener("click",De,!0)},0)}function ge(b,u){const g=b.getBoundingClientRect();return de(b,g,u)}function ue(b,u){const g=b.getBoundingClientRect(),C=[];for(let I=0;I<u.length;I++)C.push(de(b,g,u[I]));return C}function ze(b){return void 0!==m.window.InstallTrigger&&2===b.button&&b.ctrlKey&&m.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button}function de(b,u,g){const C=b.offsetWidth===u.width?1:b.offsetWidth/u.width;return new m.Point((g.clientX-u.left)*C,(g.clientY-u.top)*C)}function re(b,u){var g=u[0],C=u[1],I=u[2],P=u[3],N=g*P-I*C;return N?(b[0]=P*(N=1/N),b[1]=-C*N,b[2]=-I*N,b[3]=g*N,b):null}function Ae(b){const{userImage:u}=b;return!!(u&&u.render&&u.render())&&(b.data.replace(new Uint8Array(u.data.buffer)),!0)}class ne extends m.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new m.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:g,callback:C}of this.requestors)this._notify(g,C);this.requestors=[]}}hasImage(u){return!!this.getImage(u)}getImage(u){return this.images[u]}addImage(u,g){this._validate(u,g)&&(this.images[u]=g)}_validate(u,g){let C=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new m.ErrorEvent(new Error(`Image "${u}" has invalid "stretchX" value`))),C=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new m.ErrorEvent(new Error(`Image "${u}" has invalid "stretchY" value`))),C=!1),this._validateContent(g.content,g)||(this.fire(new m.ErrorEvent(new Error(`Image "${u}" has invalid "content" value`))),C=!1),C}_validateStretch(u,g){if(!u)return!0;let C=0;for(const I of u){if(I[0]<C||I[1]<I[0]||g<I[1])return!1;C=I[1]}return!0}_validateContent(u,g){return!(u&&(4!==u.length||u[0]<0||g.data.width<u[0]||u[1]<0||g.data.height<u[1]||u[2]<0||g.data.width<u[2]||u[3]<0||g.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,g){g.version=this.images[u].version+1,this.images[u]=g,this.updatedImages[u]=!0}removeImage(u){const g=this.images[u];delete this.images[u],delete this.patterns[u],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u,g){let C=!0;if(!this.isLoaded())for(const I of u)this.images[I]||(C=!1);this.isLoaded()||C?this._notify(u,g):this.requestors.push({ids:u,callback:g})}_notify(u,g){const C={};for(const I of u){this.images[I]||this.fire(new m.Event("styleimagemissing",{id:I}));const P=this.images[I];P?C[I]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!(!P.userImage||!P.userImage.render)}:m.warnOnce(`Image "${I}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,C)}getPixelSize(){const{width:u,height:g}=this.atlasImage;return{width:u,height:g}}getPattern(u){const g=this.patterns[u],C=this.getImage(u);if(!C)return null;if(g&&g.position.version===C.version)return g.position;if(g)g.position.version=C.version;else{const I={w:C.data.width+2,h:C.data.height+2,x:0,y:0},P=new m.ImagePosition(I,C);this.patterns[u]={bin:I,position:P}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const g=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new m.Texture(u,this.atlasImage,g.RGBA),this.atlasTexture&&this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const P in this.patterns)u.push(this.patterns[P].bin);const{w:g,h:C}=m.potpack(u),I=this.atlasImage;I.resize({width:g||1,height:C||1});for(const P in this.patterns){const{bin:N}=this.patterns[P],B=N.x+1,U=N.y+1,q=this.images[P].data,H=q.width,J=q.height;m.RGBAImage.copy(q,I,{x:0,y:0},{x:B,y:U},{width:H,height:J}),m.RGBAImage.copy(q,I,{x:0,y:J-1},{x:B,y:U-1},{width:H,height:1}),m.RGBAImage.copy(q,I,{x:0,y:0},{x:B,y:U+J},{width:H,height:1}),m.RGBAImage.copy(q,I,{x:H-1,y:0},{x:B-1,y:U},{width:1,height:J}),m.RGBAImage.copy(q,I,{x:0,y:0},{x:B+H,y:U},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const g of u){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const C=this.images[g];Ae(C)&&this.updateImage(g,C)}}}const ot=new m.Properties({anchor:new m.DataConstantProperty(m.spec.light.anchor),position:new class{constructor(){this.specification=m.spec.light.position}possiblyEvaluate(b,u){return function([g,C,I]){const P=m.degToRad(C+90),N=m.degToRad(I);return{x:g*Math.cos(P)*Math.sin(N),y:g*Math.sin(P)*Math.sin(N),z:g*Math.cos(N),azimuthal:C,polar:I}}(b.expression.evaluate(u))}interpolate(b,u,g){return{x:m.number(b.x,u.x,g),y:m.number(b.y,u.y,g),z:m.number(b.z,u.z,g),azimuthal:m.number(b.azimuthal,u.azimuthal,g),polar:m.number(b.polar,u.polar,g)}}},color:new m.DataConstantProperty(m.spec.light.color),intensity:new m.DataConstantProperty(m.spec.light.intensity)});class Ue extends m.Evented{constructor(u){super(),this._transitionable=new m.Transitionable(ot),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,g={}){if(!this._validate(m.validateLight,u,g))for(const C in u){const I=u[C];m.endsWith(C,"-transition")?this._transitionable.setTransition(C.slice(0,-11),I):this._transitionable.setValue(C,I)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,C){return(!C||!1!==C.validate)&&m.emitValidationErrors(this,u.call(m.validateStyle,m.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:m.spec})))}}const Ke=new m.Properties({source:new m.DataConstantProperty(m.spec.terrain.source),exaggeration:new m.DataConstantProperty(m.spec.terrain.exaggeration)});let Me=class extends m.Evented{constructor(b,u){super(),this._transitionable=new m.Transitionable(Ke),this.set(b),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(b){for(const u in b){const g=b[u];m.endsWith(u,"-transition")?this._transitionable.setTransition(u.slice(0,-11),g):this._transitionable.setValue(u,g)}}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}};function on(b,u,g,C){const I=m.smoothstep(45,65,g),[P,N]=Lt(b,C),B=m.length(u);let U=1-Math.min(1,Math.exp((B-P)/(N-P)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*I*b.alpha}function Lt(b,u){const g=.5/Math.tan(.5*u);return[b.range[0]+g,b.range[1]+g]}const Ee=new m.Properties({range:new m.DataConstantProperty(m.spec.fog.range),color:new m.DataConstantProperty(m.spec.fog.color),"high-color":new m.DataConstantProperty(m.spec.fog["high-color"]),"space-color":new m.DataConstantProperty(m.spec.fog["space-color"]),"horizon-blend":new m.DataConstantProperty(m.spec.fog["horizon-blend"]),"star-intensity":new m.DataConstantProperty(m.spec.fog["star-intensity"])});class dt extends m.Evented{constructor(u,g){super(),this._transitionable=new m.Transitionable(Ee),this.set(u),this._transitioning=this._transitionable.untransitioned(),this._transform=g}get state(){const u=this._transform,g="globe"===u.projection.name,C=m.globeToMercatorTransition(u.zoom),I=this.properties.get("range"),P=[.5,3];return{range:g?[m.number(P[0],I[0],C),m.number(P[1],I[1],C)]:I,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,g={}){if(!this._validate(m.validateFog,u,g)){for(const C of Object.keys(m.spec.fog))u&&void 0===u[C]&&(u[C]=m.spec.fog[C].default);for(const C in u){const I=u[C];m.endsWith(C,"-transition")?this._transitionable.setTransition(C.slice(0,-11),I):this._transitionable.setValue(C,I)}}}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const g=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:m.smoothstep(45,65,u))*g.a}getOpacityAtLatLng(u,g){return this._transform.projection.supportsFog?function(C,I,P){const N=m.MercatorCoordinate.fromLngLat(I),B=P.elevation?P.elevation.getAtPointOrZero(N):0,U=[N.x,N.y,B];return m.transformMat4(U,U,P.mercatorFogMatrix),on(C,U,P.pitch,P._fov)}(this.state,u,g):0}getFovAdjustedRange(u){return this._transform.projection.supportsFog?Lt(this.state,u):[0,1]}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,C){return(!C||!1!==C.validate)&&m.emitValidationErrors(this,u.call(m.validateStyle,m.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:m.spec})))}}class Re{constructor(u,g){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=m.uniqueId();const C=this.workerPool.acquire(this.id);for(let I=0;I<C.length;I++){const P=new Re.Actor(C[I],g,this.id);P.name=`Worker ${I}`,this.actors.push(P)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(u,g,C){m.asyncAll(this.actors,(I,P)=>{I.send(u,g,P)},C=C||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(u=>{u.remove()}),this.actors=[],this.workerPool.release(this.id)}}function it(b,u,g){return u*(m.EXTENT/(b.tileSize*Math.pow(2,g-b.tileID.overscaledZ)))}Re.Actor=m.Actor;class gt{constructor(u,g,C,I){this.screenBounds=u,this.cameraPoint=g,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=C,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,I)}static createFromScreenPoints(u,g){let C,I;if(u instanceof m.Point||"number"==typeof u[0]){const P=m.Point.convert(u);C=[P],I=g.isPointAboveHorizon(P)}else{const P=m.Point.convert(u[0]),N=m.Point.convert(u[1]);C=[P,N],I=m.polygonizeBounds(P,N).every(B=>g.isPointAboveHorizon(B))}return new gt(C,g.getCameraPoint(),I,g)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(u){return m.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const g=this.screenBounds[0],C=1===this.screenBounds.length?this.screenBounds[0].add(new m.Point(1,1)):this.screenBounds[1],I=m.polygonizeBounds(g,C,0,!1);return this.cameraPoint.y>C.y&&(this.cameraPoint.x>g.x&&this.cameraPoint.x<C.x?I.splice(3,0,this.cameraPoint):this.cameraPoint.x>=C.x?I[2]=this.cameraPoint:this.cameraPoint.x<=g.x&&(I[3]=this.cameraPoint)),m.bufferConvexPolygon(I,u)}bufferedCameraGeometryGlobe(u){const g=this.screenBounds[0],C=1===this.screenBounds.length?this.screenBounds[0].add(new m.Point(1,1)):this.screenBounds[1],I=m.polygonizeBounds(g,C,u),P=this.cameraPoint.clone();switch(3*((P.y>g.y)+(P.y>C.y))+((P.x>g.x)+(P.x>C.x))){case 0:I[0]=P,I[4]=P.clone();break;case 1:I.splice(1,0,P);break;case 2:I[1]=P;break;case 3:I.splice(4,0,P);break;case 5:I.splice(2,0,P);break;case 6:I[3]=P;break;case 7:I.splice(3,0,P);break;case 8:I[2]=P}return I}containsTile(u,g,C,I=0){const P=u.queryPadding/g._pixelsPerMercatorPixel+1,N=C?this._bufferedCameraMercator(P,g):this._bufferedScreenMercator(P,g);let B=u.tileID.wrap+(N.unwrapped?I:0);const U=N.polygon.map(Le=>m.getTilePoint(u.tileTransform,Le,B));if(!m.polygonIntersectsBox(U,0,0,m.EXTENT,m.EXTENT))return;B=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?I:0);const q=this.screenGeometryMercator.polygon.map(Le=>m.getTileVec3(u.tileTransform,Le,B)),H=q.map(Le=>new m.Point(Le[0],Le[1])),J=g.getFreeCameraOptions().position||new m.MercatorCoordinate(0,0,0),_e=m.getTileVec3(u.tileTransform,J,B),Ce=q.map(Le=>{const ee=m.sub(Le,Le,_e);return m.normalize(ee,ee),new m.Ray(_e,ee)}),Te=it(u,1,g.zoom)*g._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:Ce,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(Pe=m.getBounds(U),Pe.min.x=m.clamp(Pe.min.x,0,m.EXTENT),Pe.min.y=m.clamp(Pe.min.y,0,m.EXTENT),Pe.max.x=m.clamp(Pe.max.x,0,m.EXTENT),Pe.max.y=m.clamp(Pe.max.y,0,m.EXTENT),Pe),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:Te};var Pe}_bufferedScreenMercator(u,g){const C=Ct(u);if(this._screenRaycastCache[C])return this._screenRaycastCache[C];{let I;return I="globe"===g.projection.name?this._projectAndResample(this.bufferedScreenGeometry(u),g):{polygon:this.bufferedScreenGeometry(u).map(P=>g.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[C]=I,I}}_bufferedCameraMercator(u,g){const C=Ct(u);if(this._cameraRaycastCache[C])return this._cameraRaycastCache[C];{let I;return I="globe"===g.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),g):{polygon:this.bufferedCameraGeometry(u).map(P=>g.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[C]=I,I}}_projectAndResample(u,g){const C=function(P,N){const B=m.multiply([],N.pixelMatrix,N.globeMatrix),U=[0,-m.GLOBE_RADIUS,0,1],q=[0,m.GLOBE_RADIUS,0,1],H=[0,0,0,1];m.transformMat4$1(U,U,B),m.transformMat4$1(q,q,B),m.transformMat4$1(H,H,B);const J=new m.Point(U[0]/U[3],U[1]/U[3]),_e=new m.Point(q[0]/q[3],q[1]/q[3]),Ce=m.polygonContainsPoint(P,J)&&U[3]<H[3],Te=m.polygonContainsPoint(P,_e)&&q[3]<H[3];if(!Ce&&!Te)return null;const Pe=function(ut,St,bt){for(let zt=1;zt<ut.length;zt++){const En=qt(St.pointCoordinate3D(ut[zt-1]).x),Pt=qt(St.pointCoordinate3D(ut[zt]).x);if(bt<0){if(En<Pt)return{idx:zt,t:-En/(Pt-1-En)}}else if(Pt<En)return{idx:zt,t:(1-En)/(Pt+1-En)}}return null}(P,N,Ce?-1:1);if(!Pe)return null;const{idx:Le,t:ee}=Pe;let Se=Le>1?Ie(P.slice(0,Le),N):[],Ge=Le<P.length?Ie(P.slice(Le),N):[];Se=Se.map(ut=>new m.Point(qt(ut.x),ut.y)),Ge=Ge.map(ut=>new m.Point(qt(ut.x),ut.y));const We=[...Se];0===We.length&&We.push(Ge[Ge.length-1]);const ht=m.number(We[We.length-1].y,(0===Ge.length?Se[0]:Ge[0]).y,ee);let ft;return ft=Ce?[new m.Point(0,ht),new m.Point(0,0),new m.Point(1,0),new m.Point(1,ht)]:[new m.Point(1,ht),new m.Point(1,1),new m.Point(0,1),new m.Point(0,ht)],We.push(...ft),0===Ge.length?We.push(Se[0]):We.push(...Ge),{polygon:We.map(ut=>new m.MercatorCoordinate(ut.x,ut.y)),unwrapped:!1}}(u,g);if(C)return C;const I=function(P,N){let B=!1,U=-1/0,q=0;for(let J=0;J<P.length-1;J++)P[J].x>U&&(U=P[J].x,q=J);for(let J=0;J<P.length-1;J++){const _e=(q+J)%(P.length-1),Ce=P[_e],Te=P[_e+1];Math.abs(Ce.x-Te.x)>.5&&(Ce.x<Te.x?(Ce.x+=1,0===_e&&(P[P.length-1].x+=1)):(Te.x+=1,_e+1===P.length-1&&(P[0].x+=1)),B=!0)}const H=m.mercatorXfromLng(N.center.lng);return B&&H<Math.abs(H-1)&&P.forEach(J=>{J.x-=1}),{polygon:P,unwrapped:B}}(Ie(u,g).map(P=>new m.Point(qt(P.x),P.y)),g);return{polygon:I.polygon.map(P=>new m.MercatorCoordinate(P.x,P.y)),unwrapped:I.unwrapped}}}function Ie(b,u){return m.resample(b,g=>{const C=u.pointCoordinate3D(g);g.x=C.x,g.y=C.y},1/256)}function qt(b){return b<0?1+b%1:b%1}function Ct(b){return 100*b|0}function Cn(b,u,g,C,I){const P=function(N,B){if(N)return I(N);if(B){b.url&&B.tiles&&b.tiles&&delete b.tiles;const U=m.pick(m.extend(B,b),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);B.vector_layers&&(U.vectorLayers=B.vector_layers,U.vectorLayerIds=U.vectorLayers.map(q=>q.id)),U.tiles=u.canonicalizeTileset(U,b.url),I(null,U)}};return b.url?m.getJSON(u.transformRequest(u.normalizeSourceURL(b.url,null,g,C),m.ResourceType.Source),P):m.exported.frame(()=>P(null,b))}class Ut{constructor(u,g,C){this.bounds=m.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=g||0,this.maxzoom=C||24}validateBounds(u){return Array.isArray(u)&&4===u.length?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const g=Math.pow(2,u.z),C=Math.floor(m.mercatorXfromLng(this.bounds.getWest())*g),I=Math.floor(m.mercatorYfromLat(this.bounds.getNorth())*g),P=Math.ceil(m.mercatorXfromLng(this.bounds.getEast())*g),N=Math.ceil(m.mercatorYfromLat(this.bounds.getSouth())*g);return u.x>=C&&u.x<P&&u.y>=I&&u.y<N}}class Bn{constructor(u,g,C){this.context=u;const I=u.gl;this.buffer=I.createBuffer(),this.dynamicDraw=!!C,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),I.bufferData(I.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Jn{constructor(u,g,C,I){this.length=g.length,this.attributes=C,this.itemSize=g.bytesPerElement,this.dynamicDraw=I,this.context=u;const P=u.gl;this.buffer=P.createBuffer(),u.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,g){for(let C=0;C<this.attributes.length;C++){const I=g.attributes[this.attributes[C].name];void 0!==I&&u.enableVertexAttribArray(I)}}setVertexAttribPointers(u,g,C){for(let I=0;I<this.attributes.length;I++){const P=this.attributes[I],N=g.attributes[P.name];void 0!==N&&u.vertexAttribPointer(N,P.components,u[zn[P.type]],!1,this.itemSize,P.offset+this.itemSize*(C||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Kt{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Qn extends Kt{getDefault(){return m.Color.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class mn extends Kt{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class Mr extends Kt{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class Ii extends Kt{getDefault(){return[!0,!0,!0,!0]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class vr extends Kt{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class mi extends Kt{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class wi extends Kt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const g=this.current;(u.func!==g.func||u.ref!==g.ref||u.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class _t extends Kt{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class we extends Kt{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=u,this.dirty=!1}}class fe extends Kt{getDefault(){return[0,1]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class le extends Kt{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=u,this.dirty=!1}}class $e extends Kt{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class pt extends Kt{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.BLEND):g.disable(g.BLEND),this.current=u,this.dirty=!1}}class Gt extends Kt{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class fn extends Kt{getDefault(){return m.Color.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class cn extends Kt{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class Wt extends Kt{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=u,this.dirty=!1}}class Mi extends Kt{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class Ni extends Kt{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let Nn,Ci=class extends Kt{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}};class Nr extends Kt{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class nr extends Kt{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class cr extends Kt{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class po extends Kt{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Xo extends Kt{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class $s extends Kt{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class qe extends Kt{getDefault(){return null}set(u){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class oe extends Kt{constructor(u){super(u),this.vao=u.extVertexArrayObject}getDefault(){return null}set(u){this.vao&&(u!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(u),this.current=u,this.dirty=!1)}}class se extends Kt{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class je extends Kt{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class et extends Kt{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class ke extends Kt{constructor(u,g){super(u),this.context=u,this.parent=g}getDefault(){return null}}class Tt extends ke{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class It extends ke{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,this.attachment(),g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Ye extends It{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Nt{constructor(u,g,C,I){this.context=u,this.width=g,this.height=C;const P=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new Tt(u,P),I&&(this.depthAttachment=new It(u,P))}destroy(){const u=this.context.gl,g=this.colorAttachment.get();if(g&&u.deleteTexture(g),this.depthAttachment){const C=this.depthAttachment.get();C&&u.deleteRenderbuffer(C)}u.deleteFramebuffer(this.framebuffer)}}class _n{constructor(u,g=!1){if(this.gl=u,this.isWebGL2=g,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),g){const C=u;this.extVertexArrayObject={createVertexArrayOES:C.createVertexArray.bind(u),deleteVertexArrayOES:C.deleteVertexArray.bind(u),bindVertexArrayOES:C.bindVertexArray.bind(u)}}this.clearColor=new Qn(this),this.clearDepth=new mn(this),this.clearStencil=new Mr(this),this.colorMask=new Ii(this),this.depthMask=new vr(this),this.stencilMask=new mi(this),this.stencilFunc=new wi(this),this.stencilOp=new _t(this),this.stencilTest=new we(this),this.depthRange=new fe(this),this.depthTest=new le(this),this.depthFunc=new $e(this),this.blend=new pt(this),this.blendFunc=new Gt(this),this.blendColor=new fn(this),this.blendEquation=new cn(this),this.cullFace=new Wt(this),this.cullFaceSide=new Mi(this),this.frontFace=new Ni(this),this.program=new Ci(this),this.activeTexture=new Nr(this),this.viewport=new nr(this),this.bindFramebuffer=new cr(this),this.bindRenderbuffer=new po(this),this.bindTexture=new Xo(this),this.bindVertexBuffer=new $s(this),this.bindElementBuffer=new qe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new oe(this),this.pixelStoreUnpack=new se(this),this.pixelStoreUnpackPremultiplyAlpha=new je(this),this.pixelStoreUnpackFlipY=new et(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),g||(this.extTextureHalfFloat=u.getExtension("OES_texture_half_float")),(g||this.extTextureHalfFloat&&u.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=g||u.getExtension("OES_standard_derivatives"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,g){return new Bn(this,u,g)}createVertexBuffer(u,g,C){return new Jn(this,u,g,C)}createRenderbuffer(u,g,C){const I=this.gl,P=I.createRenderbuffer();return this.bindRenderbuffer.set(P),I.renderbufferStorage(I.RENDERBUFFER,u,g,C),this.bindRenderbuffer.set(null),P}createFramebuffer(u,g,C){return new Nt(this,u,g,C)}clear({color:u,depth:g,stencil:C}){const I=this.gl;let P=0;u&&(P|=I.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),void 0!==g&&(P|=I.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),void 0!==C&&(P|=I.STENCIL_BUFFER_BIT,this.clearStencil.set(C),this.stencilMask.set(255)),I.clear(P)}setCullFace(u){!1===u.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){xe(u.blendFunction,m.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Dn extends m.Evented{constructor(u,g,C,I){if(super(),this.id=u,this.dispatcher=C,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,m.extend(this,m.pick(g,["url","scheme","tileSize","promoteId"])),this._options=m.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(I),this._tileWorkers={},this._deduped=new m.DedupedRequest}load(u){this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"}));const g=Array.isArray(this.map._language)?this.map._language.join():this.map._language,C=this.map._worldview;this._tileJSONRequest=Cn(this._options,this.map._requestManager,g,C,(I,P)=>{this._tileJSONRequest=null,this._loaded=!0,I?(g&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${g}`),C&&2!==C.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${C}`),this.fire(new m.ErrorEvent(I))):P&&(m.extend(this,P),P.bounds&&(this.tileBounds=new Ut(P.bounds,this.minzoom,this.maxzoom)),m.postTurnstileEvent(P.tiles,this.map._requestManager._customAccessToken),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(I)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return m.extend({},this._options)}loadTile(u,g){const C=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),I={request:this.map._requestManager.transformRequest(C,m.ResourceType.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:m.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile};if(I.request.collectResourceTiming=this._collectResourceTiming,u.actor&&"expired"!==u.state)"loading"===u.state?u.reloadCallback=g:u.request=u.actor.send("reloadTile",I,P.bind(this));else if(u.actor=this._tileWorkers[C]=this._tileWorkers[C]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",I,P.bind(this),void 0,!0);else{const N=m.loadVectorTile.call({deduped:this._deduped},I,(B,U)=>{B||!U?P.call(this,B):(I.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},u.actor&&u.actor.send("loadTile",I,P.bind(this),void 0,!0))},!0);u.request={cancel:N}}function P(N,B){return delete u.request,u.aborted?g(null):N&&404!==N.status?g(N):(B&&B.resourceTiming&&(u.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&u.setExpiryData(B),u.loadVectorData(B,this.map.painter),m.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id})}unloadTile(u){u.unloadVectorData(),u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class yn extends m.Evented{constructor(u,g,C,I){super(),this.id=u,this.dispatcher=C,this.setEventedParent(I),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=m.extend({type:"raster"},g),m.extend(this,m.pick(g,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Cn(this._options,this.map._requestManager,null,null,(g,C)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new m.ErrorEvent(g)):C&&(m.extend(this,C),C.bounds&&(this.tileBounds=new Ut(C.bounds,this.minzoom,this.maxzoom)),m.postTurnstileEvent(C.tiles),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(g)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return m.extend({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,g){const C=m.exported.devicePixelRatio>=2,I=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),C,this.tileSize);u.request=m.getImage(this.map._requestManager.transformRequest(I,m.ResourceType.Tile),(P,N,B,U)=>(delete u.request,u.aborted?(u.state="unloaded",g(null)):P?(u.state="errored",g(P)):N?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:B,expires:U}),u.setTexture(N,this.map.painter),u.state="loaded",m.cacheEntryPossiblyAdded(this.dispatcher),void g(null)):g(null)))}static loadTileData(u,g,C){u.setTexture(g,C)}static unloadTileData(u,g){u.texture&&g.saveTileTexture(u.texture)}abortTile(u,g){u.request&&(u.request.cancel(),delete u.request),g()}unloadTile(u,g){u.texture&&this.map.painter.saveTileTexture(u.texture),g()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function qi(b,u,g,C,I,P,N,B){const U=[b,g,I,u,C,P,1,1,1],q=[N,B,1],H=m.adjoint([],U),[J,_e,Ce]=m.transformMat3(q,q,m.transpose(H,H));return m.multiply$1(U,[J,0,0,0,_e,0,0,0,Ce],U)}class Yi extends m.Evented{constructor(u,g,C,I){super(),this.id=u,this.dispatcher=C,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(I),this.options=g,this._dirty=!1}load(u,g){this._loaded=g||!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=m.getImage(this.map._requestManager.transformRequest(this.url,m.ResourceType.Image),(C,I)=>{if(this._imageRequest=null,this._loaded=!0,C)this.fire(new m.ErrorEvent(C));else if(I){const{HTMLImageElement:P}=m.window;this.image=I instanceof P?m.exported.getImageData(I):I,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,u&&(this.coordinates=u),this._finishLoading()}})}loaded(){return this._loaded}updateImage(u){return this.image&&u.url?(this._imageRequest&&u.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=u.url,this.load(u.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(u){this.coordinates=u,this._boundsArray=void 0;const g=u.map(m.MercatorCoordinate.fromLngLat);return this.tileID=function(C){let I=1/0,P=1/0,N=-1/0,B=-1/0;for(const J of C)I=Math.min(I,J.x),P=Math.min(P,J.y),N=Math.max(N,J.x),B=Math.max(B,J.y);const U=Math.max(N-I,B-P),q=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),H=Math.pow(2,q);return new m.CanonicalTileID(q,Math.floor((I+N)/2*H),Math.floor((P+B)/2*H))}(g),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(u){for(const U in this.tiles){const q=this.tiles[U];"loaded"!==q.state&&(q.state="loaded",q.texture=this.texture)}if(this._boundsArray)return;const g=m.tileTransform(this.tileID,this.map.transform.projection),[C,I,P,N]=this.coordinates.map(U=>{const q=g.projection.project(U[0],U[1]);return m.getTilePoint(g,q)._round()});this.perspectiveTransform=function(U,q,H,J,_e,Ce,Te,Pe,Le,ee){const Se=qi(0,0,U,0,0,q,U,q),Ge=qi(H,J,_e,Ce,Te,Pe,Le,ee);return m.multiply$1(Ge,m.adjoint(Se,Se),Ge),[Ge[6]/Ge[8]*U/m.EXTENT,Ge[7]/Ge[8]*q/m.EXTENT]}(this.width,this.height,C.x,C.y,I.x,I.y,N.x,N.y,P.x,P.y);const B=this._boundsArray=new m.StructArrayLayout4i8;B.emplaceBack(C.x,C.y,0,0),B.emplaceBack(I.x,I.y,m.EXTENT,0),B.emplaceBack(N.x,N.y,0,m.EXTENT),B.emplaceBack(P.x,P.y,m.EXTENT,m.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=u.createVertexBuffer(B,m.boundsAttributes.members),this.boundsSegments=m.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const u=this.map.painter.context,g=u.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new m.Texture(u,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(u)}loadTile(u,g){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={},g(null)):(u.state="errored",g(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ji={vector:Dn,raster:yn,"raster-dem":class extends yn{constructor(b,u,g,C){super(b,u,g,C),this.type="raster-dem",this.maxzoom=22,this._options=m.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(b,u){const g=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function C(I,P){I&&(b.state="errored",u(I)),P&&(b.dem=P,b.dem.onDeserialize(),b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0,b.state="loaded",u(null))}b.request=m.getImage(this.map._requestManager.transformRequest(g,m.ResourceType.Tile),function(I,P,N,B){if(delete b.request,b.aborted)b.state="unloaded",u(null);else if(I)b.state="errored",u(I);else if(P){this.map._refreshExpiredTiles&&b.setExpiryData({cacheControl:N,expires:B});const U=m.window.ImageBitmap&&P instanceof m.window.ImageBitmap&&(null==Nn&&(Nn=m.window.OffscreenCanvas&&new m.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof m.window.createImageBitmap),Nn),q=1-(P.width-m.prevPowerOfTwo(P.width))/2;q<1||b.neighboringTiles||(b.neighboringTiles=this._getNeighboringTiles(b.tileID));const H=U?P:m.exported.getImageData(P,q),J={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:q};b.actor&&"expired"!==b.state||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",J,C.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(b){const u=b.canonical,g=Math.pow(2,u.z),C=(u.x-1+g)%g,I=0===u.x?b.wrap-1:b.wrap,P=(u.x+1+g)%g,N=u.x+1===g?b.wrap+1:b.wrap,B={};return B[new m.OverscaledTileID(b.overscaledZ,I,u.z,C,u.y).key]={backfilled:!1},B[new m.OverscaledTileID(b.overscaledZ,N,u.z,P,u.y).key]={backfilled:!1},u.y>0&&(B[new m.OverscaledTileID(b.overscaledZ,I,u.z,C,u.y-1).key]={backfilled:!1},B[new m.OverscaledTileID(b.overscaledZ,b.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},B[new m.OverscaledTileID(b.overscaledZ,N,u.z,P,u.y-1).key]={backfilled:!1}),u.y+1<g&&(B[new m.OverscaledTileID(b.overscaledZ,I,u.z,C,u.y+1).key]={backfilled:!1},B[new m.OverscaledTileID(b.overscaledZ,b.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},B[new m.OverscaledTileID(b.overscaledZ,N,u.z,P,u.y+1).key]={backfilled:!1}),B}unloadTile(b){b.demTexture&&this.map.painter.saveTileTexture(b.demTexture),b.fbo&&(b.fbo.destroy(),delete b.fbo),b.dem&&delete b.dem,delete b.neighboringTiles,b.state="unloaded"}},geojson:class extends m.Evented{constructor(b,u,g,C){super(),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(C),this._data=u.data,this._options=m.extend({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const I=m.EXTENT/this.tileSize;this.workerOptions=m.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*I,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*I,extent:m.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:m.EXTENT,radius:(void 0!==u.clusterRadius?u.clusterRadius:50)*I,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}onAdd(b){this.map=b,this.setData(this._data)}setData(b){return this._data=b,this._updateWorkerData(),this}getClusterExpansionZoom(b,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:b,source:this.id},u),this}getClusterChildren(b,u){return this.actor.send("geojson.getClusterChildren",{clusterId:b,source:this.id},u),this}getClusterLeaves(b,u,g,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:b,limit:u,offset:g},C),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new m.Event("dataloading",{dataType:"source"})),this._loaded=!1;const b=m.extend({},this.workerOptions),u=this._data;"string"==typeof u?(b.request=this.map._requestManager.transformRequest(m.exported.resolveURL(u),m.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,b,(g,C)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new m.ErrorEvent(g));else{const I={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&C&&C.resourceTiming&&C.resourceTiming[this.id]&&(I.resourceTiming=C.resourceTiming[this.id]),this.fire(new m.Event("data",I)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(b,u){const g=b.actor?"reloadTile":"loadTile";b.actor=this.actor,b.request=this.actor.send(g,{type:this.type,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:m.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(C,I)=>(delete b.request,b.unloadVectorData(),b.aborted?u(null):C?u(C):(b.loadVectorData(I,this.map.painter,"reloadTile"===g),u(null))),void 0,"loadTile"===g)}abortTile(b){b.request&&(b.request.cancel(),delete b.request),b.aborted=!0}unloadTile(b){b.unloadVectorData(),this.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return m.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Yi{constructor(b,u,g,C){super(b,u,g,C),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const b=this.options;this.urls=[];for(const u of b.urls)this.urls.push(this.map._requestManager.transformRequest(u,m.ResourceType.Source).url);m.getVideo(this.urls,(u,g)=>{this._loaded=!0,u?this.fire(new m.ErrorEvent(u)):g&&(this.video=g,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){const u=this.video.seekable;b<u.start(0)||b>u.end(0)?this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const b=this.map.painter.context,u=b.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new m.Texture(b,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(b)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Yi,canvas:class extends Yi{constructor(b,u,g,C){super(b,u,g,C),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(I=>!Array.isArray(I)||2!==I.length||I.some(P=>"number"!=typeof P))||this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${b}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${b}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof m.window.HTMLCanvasElement||this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new m.ErrorEvent(new m.ValidationError(`sources.${b}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof m.window.HTMLCanvasElement?this.options.canvas:m.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new m.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const u=this.map.painter.context;this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new m.Texture(u,this.canvas,u.gl.RGBA,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const b of[this.canvas.width,this.canvas.height])if(isNaN(b)||b<=0)return!0;return!1}},custom:class extends m.Evented{constructor(b,u,g,C){super(),this.id=b,this.type="custom",this._dataType="raster",this._dispatcher=g,this._implementation=u,this.setEventedParent(C),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new m.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new m.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ut(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),m.extend(this,m.pick(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return m.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(b){this._map=b,this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(b),this.load()}onRemove(b){this._implementation.onRemove&&this._implementation.onRemove(b)}hasTile(b){if(this._implementation.hasTile){const{x:u,y:g,z:C}=b.canonical;return this._implementation.hasTile({x:u,y:g,z:C})}return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b,u){const{x:g,y:C,z:I}=b.tileID.canonical,P=new m.window.AbortController;b.request=Promise.resolve(this._implementation.loadTile({x:g,y:C,z:I},{signal:P.signal})).then(function(N){return delete b.request,b.aborted?(b.state="unloaded",u(null)):void 0===N?(b.state="errored",u(null)):null===N?(this.loadTileData(b,{width:this.tileSize,height:this.tileSize,data:null}),b.state="loaded",u(null)):(B=N)instanceof m.window.ImageData||B instanceof m.window.HTMLCanvasElement||B instanceof m.window.ImageBitmap||B instanceof m.window.HTMLImageElement?(this.loadTileData(b,N),b.state="loaded",void u(null)):(b.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var B}.bind(this)).catch(N=>{20!==N.code&&(b.state="errored",u(N))}),b.request.cancel=()=>P.abort()}loadTileData(b,u){yn.loadTileData(b,u,this._map.painter)}unloadTileData(b){yn.unloadTileData(b,this._map.painter)}unloadTile(b,u){if(this.unloadTileData(b),this._implementation.unloadTile){const{x:g,y:C,z:I}=b.tileID.canonical;this._implementation.unloadTile({x:g,y:C,z:I})}u()}abortTile(b,u){b.request&&b.request.cancel&&(b.request.cancel(),delete b.request),u()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(b=>({x:b.canonical.x,y:b.canonical.y,z:b.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Fi=function(b,u,g,C){const I=new ji[u.type](b,u,g,C);if(I.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${I.id}`);return m.bindAll(["load","abort","unload","serialize","prepare"],I),I};function or(b,u){const g=m.identity([]);return m.scale(g,g,[.5*b.width,.5*-b.height,1]),m.translate(g,g,[1,-1,0]),m.multiply(g,g,b.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(g)}function dr(b,u,g,C,I,P,N,B=!1){const U=b.tilesIn(C,N,B);U.sort(Vi);const q=[];for(const J of U)q.push({wrappedTileID:J.tile.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(u,g,b._state,J,I,P,or(b.transform,J.tile.tileID),B)});const H=function(J){const _e={},Ce={};for(const Te of J){const Pe=Te.queryResults,Le=Te.wrappedTileID,ee=Ce[Le]=Ce[Le]||{};for(const Se in Pe){const Ge=Pe[Se],We=ee[Se]=ee[Se]||{},ht=_e[Se]=_e[Se]||[];for(const ft of Ge)We[ft.featureIndex]||(We[ft.featureIndex]=!0,ht.push(ft))}}return _e}(q);for(const J in H)H[J].forEach(_e=>{const Ce=_e.feature,Te=Ce.layer;Te&&"background"!==Te.type&&"sky"!==Te.type&&(Ce.source=Te.source,Te["source-layer"]&&(Ce.sourceLayer=Te["source-layer"]),Ce.state=void 0!==Ce.id?b.getFeatureState(Te["source-layer"],Ce.id):{})});return H}function zo(b,u){const g=b.getRenderableIds().map(P=>b.getTileByID(P)),C=[],I={};for(let P=0;P<g.length;P++){const N=g[P],B=N.tileID.canonical.key;I[B]||(I[B]=!0,N.querySourceFeatures(C,u))}return C}function Vi(b,u){const g=b.tileID,C=u.tileID;return g.overscaledZ-C.overscaledZ||g.canonical.y-C.canonical.y||g.wrap-C.wrap||g.canonical.x-C.canonical.x}function mo(){return null!=ed.workerClass?new ed.workerClass:new m.window.Worker(ed.workerUrl)}const ta="mapboxgl_preloaded_worker_pool";class wo{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<wo.workerCount;)this.workers.push(new mo);return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],0===this.numActive()&&(this.workers.forEach(g=>{g.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ta]}numActive(){return Object.keys(this.active).length}}let go;function Ll(){return go||(go=new wo),go}function Hs(b,u){const g={};for(const C in b)"ref"!==C&&(g[C]=b[C]);return m.refProperties.forEach(C=>{C in u&&(g[C]=u[C])}),g}function Vd(b){b=b.slice();const u=Object.create(null);for(let g=0;g<b.length;g++)u[b[g].id]=b[g];for(let g=0;g<b.length;g++)"ref"in b[g]&&(b[g]=Hs(b[g],u[b[g].ref]));return b}wo.workerCount=2;const _i={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function kc(b,u,g){g.push({command:_i.addSource,args:[b,u[b]]})}function Cr(b,u,g){u.push({command:_i.removeSource,args:[b]}),g[b]=!0}function Yo(b,u,g,C){Cr(b,g,C),kc(b,u,g)}function Iu(b,u,g){let C;for(C in b[g])if(b[g].hasOwnProperty(C)&&"data"!==C&&!xe(b[g][C],u[g][C]))return!1;for(C in u[g])if(u[g].hasOwnProperty(C)&&"data"!==C&&!xe(b[g][C],u[g][C]))return!1;return!0}function is(b,u,g,C,I,P){let N;for(N in u=u||{},b=b||{})b.hasOwnProperty(N)&&(xe(b[N],u[N])||g.push({command:P,args:[C,N,u[N],I]}));for(N in u)u.hasOwnProperty(N)&&!b.hasOwnProperty(N)&&(xe(b[N],u[N])||g.push({command:P,args:[C,N,u[N],I]}))}function xa(b){return b.id}function rs(b,u){return b[u.id]=u,b}class ic{constructor(u,g){this.reset(u,g)}reset(u,g){this.points=u||[],this._distances=[0];for(let C=1;C<this.points.length;C++)this._distances[C]=this._distances[C-1]+this.points[C].dist(this.points[C-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(1===this.points.length)return this.points[0];u=m.clamp(u,0,1);let g=1,C=this._distances[g];const I=u*this.paddedLength+this.padding;for(;C<I&&g<this._distances.length;)C=this._distances[++g];const P=g-1,N=this._distances[P],B=C-N,U=B>0?(I-N)/B:0;return this.points[P].mult(1-U).add(this.points[g].mult(U))}}class ka{constructor(u,g,C){const I=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(u/C),this.yCellCount=Math.ceil(g/C);for(let N=0;N<this.xCellCount*this.yCellCount;N++)I.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=g,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,g,C,I,P){this._forEachCell(g,C,I,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(g),this.bboxes.push(C),this.bboxes.push(I),this.bboxes.push(P)}insertCircle(u,g,C,I){this._forEachCell(g-I,C-I,g+I,C+I,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(g),this.circles.push(C),this.circles.push(I)}_insertBoxCell(u,g,C,I,P,N){this.boxCells[P].push(N)}_insertCircleCell(u,g,C,I,P,N){this.circleCells[P].push(N)}_query(u,g,C,I,P,N){if(C<0||u>this.width||I<0||g>this.height)return!P&&[];const B=[];if(u<=0&&g<=0&&this.width<=C&&this.height<=I){if(P)return!0;for(let U=0;U<this.boxKeys.length;U++)B.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const q=this.circles[3*U],H=this.circles[3*U+1],J=this.circles[3*U+2];B.push({key:this.circleKeys[U],x1:q-J,y1:H-J,x2:q+J,y2:H+J})}return N?B.filter(N):B}return this._forEachCell(u,g,C,I,this._queryCell,B,{hitTest:P,seenUids:{box:{},circle:{}}},N),P?B.length>0:B}_queryCircle(u,g,C,I,P){const N=u-C,B=u+C,U=g-C,q=g+C;if(B<0||N>this.width||q<0||U>this.height)return!I&&[];const H=[];return this._forEachCell(N,U,B,q,this._queryCellCircle,H,{hitTest:I,circle:{x:u,y:g,radius:C},seenUids:{box:{},circle:{}}},P),I?H.length>0:H}query(u,g,C,I,P){return this._query(u,g,C,I,!1,P)}hitTest(u,g,C,I,P){return this._query(u,g,C,I,!0,P)}hitTestCircle(u,g,C,I){return this._queryCircle(u,g,C,!0,I)}_queryCell(u,g,C,I,P,N,B,U){const q=B.seenUids,H=this.boxCells[P];if(null!==H){const _e=this.bboxes;for(const Ce of H)if(!q.box[Ce]){q.box[Ce]=!0;const Te=4*Ce;if(u<=_e[Te+2]&&g<=_e[Te+3]&&C>=_e[Te+0]&&I>=_e[Te+1]&&(!U||U(this.boxKeys[Ce]))){if(B.hitTest)return N.push(!0),!0;N.push({key:this.boxKeys[Ce],x1:_e[Te],y1:_e[Te+1],x2:_e[Te+2],y2:_e[Te+3]})}}}const J=this.circleCells[P];if(null!==J){const _e=this.circles;for(const Ce of J)if(!q.circle[Ce]){q.circle[Ce]=!0;const Te=3*Ce;if(this._circleAndRectCollide(_e[Te],_e[Te+1],_e[Te+2],u,g,C,I)&&(!U||U(this.circleKeys[Ce]))){if(B.hitTest)return N.push(!0),!0;{const Pe=_e[Te],Le=_e[Te+1],ee=_e[Te+2];N.push({key:this.circleKeys[Ce],x1:Pe-ee,y1:Le-ee,x2:Pe+ee,y2:Le+ee})}}}}}_queryCellCircle(u,g,C,I,P,N,B,U){const q=B.circle,H=B.seenUids,J=this.boxCells[P];if(null!==J){const Ce=this.bboxes;for(const Te of J)if(!H.box[Te]){H.box[Te]=!0;const Pe=4*Te;if(this._circleAndRectCollide(q.x,q.y,q.radius,Ce[Pe+0],Ce[Pe+1],Ce[Pe+2],Ce[Pe+3])&&(!U||U(this.boxKeys[Te])))return N.push(!0),!0}}const _e=this.circleCells[P];if(null!==_e){const Ce=this.circles;for(const Te of _e)if(!H.circle[Te]){H.circle[Te]=!0;const Pe=3*Te;if(this._circlesCollide(Ce[Pe],Ce[Pe+1],Ce[Pe+2],q.x,q.y,q.radius)&&(!U||U(this.circleKeys[Te])))return N.push(!0),!0}}}_forEachCell(u,g,C,I,P,N,B,U){const q=this._convertToXCellCoord(u),H=this._convertToYCellCoord(g),J=this._convertToXCellCoord(C),_e=this._convertToYCellCoord(I);for(let Ce=q;Ce<=J;Ce++)for(let Te=H;Te<=_e;Te++)if(P.call(this,u,g,C,I,this.xCellCount*Te+Ce,N,B,U))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,g,C,I,P,N){const B=I-u,U=P-g,q=C+N;return q*q>B*B+U*U}_circleAndRectCollide(u,g,C,I,P,N,B){const U=(N-I)/2,q=Math.abs(u-(I+U));if(q>U+C)return!1;const H=(B-P)/2,J=Math.abs(g-(P+H));if(J>H+C)return!1;if(q<=U||J<=H)return!0;const _e=q-U,Ce=J-H;return _e*_e+Ce*Ce<=C*C}}const da={unknown:0,flipRequired:1,flipNotRequired:2},ba=Math.tan(85*Math.PI/180);function Qt(b,u,g,C,I,P,N){const B=m.create();if(g)if("globe"===P.name){const U=m.calculateGlobeLabelMatrix(I,u);m.multiply(B,B,U)}else{const U=re([],N);B[0]=U[0],B[1]=U[1],B[4]=U[2],B[5]=U[3],C||m.rotateZ(B,B,I.angle)}else m.multiply(B,I.labelPlaneMatrix,b);return B}function Nl(b,u,g,C,I,P,N){const B=Qt(b,u,g,C,I,P,N);return"globe"===P.name&&g||(B[2]=B[6]=B[10]=B[14]=0),B}function fs(b,u,g,C,I,P,N){if(g){if("globe"===P.name){const B=Qt(b,u,g,C,I,P,N);return m.invert(B,B),m.multiply(B,b,B),B}{const B=m.clone(b),U=m.identity([]);return U[0]=N[0],U[1]=N[1],U[4]=N[2],U[5]=N[3],m.multiply(B,B,U),C||m.rotateZ(B,B,-I.angle),B}}return I.glCoordMatrix}function qs(b,u,g,C){const I=[b,u,g,1];g?m.transformMat4$1(I,I,C):sr(I,I,C);const P=I[3];return I[0]/=P,I[1]/=P,I[2]/=P,I}function Ko(b,u){return Math.min(.5+b/u*.5,1.5)}function bc(b,u){const g=b[0]/b[3],C=b[1]/b[3];return g>=-u[0]&&g<=u[0]&&C>=-u[1]&&C<=u[1]}function Fl(b,u,g,C,I,P,N,B,U,q){const H=g.transform,J=C?b.textSizeData:b.iconSizeData,_e=m.evaluateSizeForZoom(J,g.transform.zoom),Ce="globe"===H.projection.name,Te=[256/g.width*2+1,256/g.height*2+1],Pe=C?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;Pe.clear();let Le=null;Ce&&(Le=C?b.text.globeExtVertexArray:b.icon.globeExtVertexArray);const ee=b.lineVertexArray,Se=C?b.text.placedSymbolArray:b.icon.placedSymbolArray,Ge=g.transform.width/g.transform.height;let We,ht=!1;for(let ft=0;ft<Se.length;ft++){const ut=Se.get(ft),{numGlyphs:St,writingMode:bt}=ut;if(bt!==m.WritingMode.vertical||ht||We===m.WritingMode.horizontal||(ht=!0),We=bt,(ut.hidden||bt===m.WritingMode.vertical)&&!ht){gi(St,Pe);continue}ht=!1;const zt=new m.Point(ut.tileAnchorX,ut.tileAnchorY);let{x:En,y:Pt,z:sn}=H.projection.projectTilePoint(zt.x,zt.y,q.canonical);if(U){const[$i,ei,ii]=U(zt);En+=$i,Pt+=ei,sn+=ii}const Ht=[En,Pt,sn,1];if(m.transformMat4$1(Ht,Ht,u),!bc(Ht,Te)){gi(St,Pe);continue}const xn=Ko(g.transform.cameraToCenterDistance,Ht[3]),Bt=m.evaluateSizeForFeature(J,_e,ut),rn=N?Bt/xn:Bt*xn,wn=qs(En,Pt,sn,I);if(wn[3]<=0){gi(St,Pe);continue}let hn={};const Sn=N?null:U,yi=tn(ut,rn,!1,B,u,I,P,b.glyphOffsetArray,ee,Pe,Le,wn,zt,hn,Ge,Sn,H.projection,q,N);ht=yi.useVertical,Sn&&yi.needsFlipping&&(hn={}),(yi.notEnoughRoom||ht||yi.needsFlipping&&tn(ut,rn,!0,B,u,I,P,b.glyphOffsetArray,ee,Pe,Le,wn,zt,hn,Ge,Sn,H.projection,q,N).notEnoughRoom)&&gi(St,Pe)}C?(b.text.dynamicLayoutVertexBuffer.updateData(Pe),Le&&b.text.globeExtVertexBuffer.updateData(Le)):(b.icon.dynamicLayoutVertexBuffer.updateData(Pe),Le&&b.icon.globeExtVertexBuffer.updateData(Le))}function Ws(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe){const{lineStartIndex:Le,glyphStartIndex:ee,segment:Se}=B,Ge=ee+B.numGlyphs,We=Le+B.lineLength,ht=u.getoffsetX(ee),ft=u.getoffsetX(Ge-1),ut=La(b*ht,g,C,I,P,N,Se,Le,We,U,q,H,J,_e,!0,Ce,Te,Pe);if(!ut)return null;const St=La(b*ft,g,C,I,P,N,Se,Le,We,U,q,H,J,_e,!0,Ce,Te,Pe);return St?{first:ut,last:St}:null}function eu(b,u,g,C){return b===m.WritingMode.horizontal&&Math.abs(C)>Math.abs(g)?{useVertical:!0}:b===m.WritingMode.vertical?C>0?{needsFlipping:!0}:null:u!==da.unknown&&(0===(I=g)||Math.abs(C/I)>ba)?u===da.flipRequired?{needsFlipping:!0}:null:g<0?{needsFlipping:!0}:null;var I}function tn(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe,Le,ee,Se){const Ge=u/24,We=b.lineOffsetX*Ge,ht=b.lineOffsetY*Ge,{lineStartIndex:ft,glyphStartIndex:ut,numGlyphs:St,segment:bt,writingMode:zt,flipState:En}=b,Pt=ft+b.lineLength,sn=Ht=>{if(H){const[wn,hn,Sn]=Ht.up,yi=q.length;m.updateGlobeVertexNormal(H,yi+0,wn,hn,Sn),m.updateGlobeVertexNormal(H,yi+1,wn,hn,Sn),m.updateGlobeVertexNormal(H,yi+2,wn,hn,Sn),m.updateGlobeVertexNormal(H,yi+3,wn,hn,Sn)}const[xn,Bt,rn]=Ht.point;m.addDynamicAttributes(q,xn,Bt,rn,Ht.angle)};if(St>1){const Ht=Ws(Ge,B,We,ht,g,J,_e,b,U,P,Ce,Pe,!1,Le,ee,Se);if(!Ht)return{notEnoughRoom:!0};if(C&&!g){let[xn,Bt,rn]=Ht.first.point,[wn,hn,Sn]=Ht.last.point;[xn,Bt]=qs(xn,Bt,rn,N),[wn,hn]=qs(wn,hn,Sn,N);const yi=eu(zt,En,(wn-xn)*Te,hn-Bt);if(b.flipState=yi&&yi.needsFlipping?da.flipRequired:da.flipNotRequired,yi)return yi}sn(Ht.first);for(let xn=ut+1;xn<ut+St-1;xn++){const Bt=La(Ge*B.getoffsetX(xn),We,ht,g,J,_e,bt,ft,Pt,U,P,Ce,Pe,!1,!1,Le,ee,Se);if(!Bt)return q.length-=4*(xn-ut),{notEnoughRoom:!0};sn(Bt)}sn(Ht.last)}else{if(C&&!g){const xn=qs(_e.x,_e.y,0,I),Bt=ft+bt+1,rn=new m.Point(U.getx(Bt),U.gety(Bt)),wn=qs(rn.x,rn.y,0,I),hn=wn[3]>0?wn:Ai(_e,rn,xn,1,I,void 0,Le,ee.canonical),Sn=eu(zt,En,(hn[0]-xn[0])*Te,hn[1]-xn[1]);if(b.flipState=Sn&&Sn.needsFlipping?da.flipRequired:da.flipNotRequired,Sn)return Sn}const Ht=La(Ge*B.getoffsetX(ut),We,ht,g,J,_e,bt,ft,Pt,U,P,Ce,Pe,!1,!1,Le,ee,Se);if(!Ht)return{notEnoughRoom:!0};sn(Ht)}return{}}function Ln(b,u,g,C,I){const{x:P,y:N,z:B}=C.projectTilePoint(b.x,b.y,u);if(!I)return qs(P,N,B,g);const[U,q,H]=I(b);return qs(P+U,N+q,B+H,g)}function Ai(b,u,g,C,I,P,N,B){const U=Ln(b.sub(u)._unit()._add(b),B,I,N,P);return m.sub(U,g,U),m.normalize(U,U),m.scaleAndAdd(U,g,U,C)}function La(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe,Le,ee){const Se=C?b-u:b+u;let Ge=Se>0?1:-1,We=0;C&&(Ge*=-1,We=Math.PI),Ge<0&&(We+=Math.PI);let ht=B+N+(Ge>0?0:1)|0,ft=I,ut=I,St=0,bt=0;const zt=Math.abs(Se),En=[],Pt=[];let sn=P,Ht=sn;const xn=()=>Ai(Ht,sn,ut,zt-St+1,H,_e,Pe,Le.canonical);for(;St+bt<=zt;){if(ht+=Ge,ht<B||ht>=U)return null;if(ut=ft,Ht=sn,En.push(ut),Ce&&Pt.push(Ht),sn=new m.Point(q.getx(ht),q.gety(ht)),ft=J[ht],!ft){const ii=Ln(sn,Le.canonical,H,Pe,_e);ft=ii[3]>0?J[ht]=ii:xn()}St+=bt,bt=m.distance(ut,ft)}Te&&_e&&(J[ht]&&(ft=xn(),bt=m.distance(ut,ft)),J[ht]=ft);const Bt=(zt-St)/bt,rn=sn.sub(Ht)._mult(Bt)._add(Ht),wn=m.sub([],ft,ut),hn=m.scaleAndAdd([],ut,wn,Bt);let Sn=[0,0,1],yi=wn[0],$i=wn[1];if(ee&&(Sn=Pe.upVector(Le.canonical,rn.x,rn.y),0!==Sn[0]||0!==Sn[1]||1!==Sn[2])){const ii=[Sn[2],0,-Sn[0]],fr=m.cross([],Sn,ii);m.normalize(ii,ii),m.normalize(fr,fr),yi=m.dot(wn,ii),$i=m.dot(wn,fr)}if(g){const ii=m.cross([],Sn,wn);m.normalize(ii,ii),m.scaleAndAdd(hn,hn,ii,g*Ge)}const ei=We+Math.atan2($i,yi);return En.push(hn),Ce&&Pt.push(rn),{point:hn,angle:ei,path:En,tilePath:Pt,up:Sn}}function gi(b,u){const g=u.length,C=g+4*b;u.resize(C),u.float32.fill(-1/0,4*g,4*C)}function sr(b,u,g){const C=u[0],I=u[1];return b[0]=g[0]*C+g[4]*I+g[12],b[1]=g[1]*C+g[5]*I+g[13],b[3]=g[3]*C+g[7]*I+g[15],b}const Bl=100;class Ir{constructor(u,g,C=new ka(u.width+200,u.height+200,25),I=new ka(u.width+200,u.height+200,25)){this.transform=u,this.grid=C,this.ignoredGrid=I,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+Bl,this.screenBottomBoundary=u.height+Bl,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=g}placeCollisionBox(u,g,C,I,P,N,B,U){let q=C.projectedAnchorX,H=C.projectedAnchorY,J=C.projectedAnchorZ;const _e=C.elevation,Ce=C.tileID,Te=u.getProjection();if(_e&&Ce){const[ft,ut,St]=Te.upVector(Ce.canonical,C.tileAnchorX,C.tileAnchorY),bt=Te.upVectorScale(Ce.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;q+=ft*_e*bt,H+=ut*_e*bt,J+=St*_e*bt}const Pe=this.projectAndGetPerspectiveRatio(B,q,H,J,C.tileID,"globe"===Te.name||!!_e||this.transform.pitch>0,Te),Le=N*Pe.perspectiveRatio,ee=(C.x1*g+I.x-C.padding)*Le+Pe.point.x,Se=(C.y1*g+I.y-C.padding)*Le+Pe.point.y,Ge=(C.x2*g+I.x+C.padding)*Le+Pe.point.x,We=(C.y2*g+I.y+C.padding)*Le+Pe.point.y,ht=Pe.perspectiveRatio<=.55||Pe.occluded;return!this.isInsideGrid(ee,Se,Ge,We)||!P&&this.grid.hitTest(ee,Se,Ge,We,U)||ht?{box:[],offscreen:!1,occluded:Pe.occluded}:{box:[ee,Se,Ge,We],offscreen:this.isOffscreen(ee,Se,Ge,We),occluded:!1}}placeCollisionCircles(u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe){const Le=[],ee=this.transform.elevation,Se=u.getProjection(),Ge=ee?ee.getAtTileOffsetFunc(Pe,this.transform.center.lat,this.transform.worldSize,Se):null,We=new m.Point(C.tileAnchorX,C.tileAnchorY);let{x:ht,y:ft,z:ut}=Se.projectTilePoint(We.x,We.y,Pe.canonical);if(Ge){const[rn,wn,hn]=Ge(We);ht+=rn,ft+=wn,ut+=hn}const St="globe"===Se.name,bt=this.projectAndGetPerspectiveRatio(B,ht,ft,ut,Pe,St||!!ee||this.transform.pitch>0,Se),{perspectiveRatio:zt}=bt,En=(J?N/zt:N*zt)/m.ONE_EM,Pt=qs(ht,ft,ut,U),sn=bt.signedDistanceFromCamera>0?Ws(En,P,C.lineOffsetX*En,C.lineOffsetY*En,!1,Pt,We,C,I,U,{},ee&&!J?Ge:null,J&&!!ee,Se,Pe,J):null;let Ht=!1,xn=!1,Bt=!0;if(sn&&!bt.occluded){const rn=.5*Ce*zt+Te,wn=new m.Point(-100,-100),hn=new m.Point(this.screenRightBoundary,this.screenBottomBoundary),Sn=new ic,{first:yi,last:$i}=sn,ei=yi.path.length;let ii=[];for(let di=ei-1;di>=1;di--)ii.push(yi.path[di]);for(let di=1;di<$i.path.length;di++)ii.push($i.path[di]);const fr=2.5*rn;q&&(ii=ii.map(([di,_o,No],$o)=>(Ge&&!St&&(No=Ge($o<ei-1?yi.tilePath[ei-1-$o]:$i.tilePath[$o-ei+2])[2]),qs(di,_o,No,q))),ii.some(di=>di[3]<=0)&&(ii=[]));let pr=[];if(ii.length>0){let di=1/0,_o=-1/0,No=1/0,$o=-1/0;for(const Ao of ii)di=Math.min(di,Ao[0]),No=Math.min(No,Ao[1]),_o=Math.max(_o,Ao[0]),$o=Math.max($o,Ao[1]);_o>=wn.x&&di<=hn.x&&$o>=wn.y&&No<=hn.y&&(pr=[ii.map(Ao=>new m.Point(Ao[0],Ao[1]))],(di<wn.x||_o>hn.x||No<wn.y||$o>hn.y)&&(pr=m.clipLine(pr,wn.x,wn.y,hn.x,hn.y)))}for(const di of pr){Sn.reset(di,.25*rn);let _o=0;_o=Sn.length<=.5*rn?1:Math.ceil(Sn.paddedLength/fr)+1;for(let No=0;No<_o;No++){const $o=No/Math.max(_o-1,1),Ao=Sn.lerp($o),Dl=Ao.x+Bl,vs=Ao.y+Bl;Le.push(Dl,vs,rn,0);const Tc=Dl-rn,cu=vs-rn,Hi=Dl+rn,Po=vs+rn;if(Bt=Bt&&this.isOffscreen(Tc,cu,Hi,Po),xn=xn||this.isInsideGrid(Tc,cu,Hi,Po),!g&&this.grid.hitTestCircle(Dl,vs,rn,_e)&&(Ht=!0,!H))return{circles:[],offscreen:!1,collisionDetected:Ht,occluded:!1}}}}return{circles:!H&&Ht||!xn?[]:Le,offscreen:Bt,collisionDetected:Ht,occluded:bt.occluded}}queryRenderedSymbols(u){if(0===u.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const g=[];let C=1/0,I=1/0,P=-1/0,N=-1/0;for(const H of u){const J=new m.Point(H.x+Bl,H.y+Bl);C=Math.min(C,J.x),I=Math.min(I,J.y),P=Math.max(P,J.x),N=Math.max(N,J.y),g.push(J)}const B=this.grid.query(C,I,P,N).concat(this.ignoredGrid.query(C,I,P,N)),U={},q={};for(const H of B){const J=H.key;if(void 0===U[J.bucketInstanceId]&&(U[J.bucketInstanceId]={}),U[J.bucketInstanceId][J.featureIndex])continue;const _e=[new m.Point(H.x1,H.y1),new m.Point(H.x2,H.y1),new m.Point(H.x2,H.y2),new m.Point(H.x1,H.y2)];m.polygonIntersectsPolygon(g,_e)&&(U[J.bucketInstanceId][J.featureIndex]=!0,void 0===q[J.bucketInstanceId]&&(q[J.bucketInstanceId]=[]),q[J.bucketInstanceId].push(J.featureIndex))}return q}insertCollisionBox(u,g,C,I,P){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:I,collisionGroupID:P},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,g,C,I,P){const N=g?this.ignoredGrid:this.grid,B={bucketInstanceId:C,featureIndex:I,collisionGroupID:P};for(let U=0;U<u.length;U+=4)N.insertCircle(B,u[U],u[U+1],u[U+2])}projectAndGetPerspectiveRatio(u,g,C,I,P,N,B){const U=[g,C,I,1];let q=!1;I||this.transform.pitch>0?(m.transformMat4$1(U,U,u),this.fogState&&P&&"globe"!==B.name&&(q=function(_e,Ce,Te,Pe,Le,ee){const Se=ee.calculateFogTileMatrix(Le),Ge=[Ce,Te,Pe];return m.transformMat4(Ge,Ge,Se),on(_e,Ge,ee.pitch,ee._fov)}(this.fogState,g,C,I,P.toUnwrapped(),this.transform)>.9)):sr(U,U,u);const H=U[3];return{point:new m.Point((U[0]/H+1)/2*this.transform.width+Bl,(-U[1]/H+1)/2*this.transform.height+Bl),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(B)/H*.5,1.5),signedDistanceFromCamera:H,occluded:N&&U[2]>H||q}}isOffscreen(u,g,C,I){return C<Bl||u>=this.screenRightBoundary||I<Bl||g>this.screenBottomBoundary}isInsideGrid(u,g,C,I){return C>=0&&u<this.gridRightBoundary&&I>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const u=m.identity([]);return m.translate(u,u,[-100,-100,0]),u}}function na(b,u,g){const C=u.createTileMatrix(b,b.worldSize,g.toUnwrapped());return m.multiply(new Float32Array(16),b.projMatrix,C)}function br(b,u,g){if(u.projection.name===g.projection.name)return b.projMatrix;const C=g.clone();return C.setProjection(u.projection),na(C,u.getProjection(),b)}function Io(b,u,g){return u.name===g.projection.name?b.projMatrix:na(g,u,b)}class hf{constructor(u,g,C,I){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?g:-g))):I&&C?1:0,this.placed=C}isHidden(){return 0===this.opacity&&!this.placed}}class nn{constructor(u,g,C,I,P,N=!1){this.text=new hf(u?u.text:null,g,C,P),this.icon=new hf(u?u.icon:null,g,I,P),this.clipped=N}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Bi{constructor(u,g,C,I=!1){this.text=u,this.icon=g,this.skipFade=C,this.clipped=I}}class Ia{constructor(){this.invProjMatrix=m.create(),this.viewportMatrix=m.create(),this.circles=[]}}class vl{constructor(u,g,C,I,P){this.bucketInstanceId=u,this.featureIndex=g,this.sourceLayerIndex=C,this.bucketIndex=I,this.tileID=P}}class yh{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const g=++this.maxGroupID;this.collisionGroups[u]={ID:g,predicate:C=>C.collisionGroupID===g}}return this.collisionGroups[u]}}function Ts(b,u,g,C,I){const{horizontalAlign:P,verticalAlign:N}=m.getAnchorAlignment(b),B=-(P-.5)*u,U=-(N-.5)*g,q=m.evaluateVariableOffset(b,C);return new m.Point(B+q[0]*I,U+q[1]*I)}function Ot(b,u,g,C,I){const P=new m.Point(b,u);return g&&P._rotate(C?I:-I),P}class mr{constructor(u,g,C,I,P){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new Ir(this.transform,P),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new yh(C),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,g,C,I){const P=C.getBucket(g),N=C.latestFeatureIndex;if(!P||!N||g.id!==P.layerIds[0])return;const B=P.layers[0].layout,U=C.collisionBoxArray,q=Math.pow(2,this.transform.zoom-C.tileID.overscaledZ),H=C.tileSize/m.EXTENT,J=C.tileID.toUnwrapped();this.transform.setProjection(P.projection);const _e=(Ce=C.tileID,Te=P.getProjection(),Pe=this.transform,Te.name===this.projection?Pe.calculateProjMatrix(Ce.toUnwrapped()):na(Pe,Te,Ce));var Ce,Te,Pe;const Le="map"===B.get("text-pitch-alignment"),ee="map"===B.get("text-rotation-alignment");g.compileFilter();const Se=g.dynamicFilter(),Ge=g.dynamicFilterNeedsFeature(),We=this.transform.calculatePixelsToTileUnitsMatrix(C),ht=Nl(_e,C.tileID.canonical,Le,ee,this.transform,P.getProjection(),We);let ft=null;if(Le){const bt=fs(_e,C.tileID.canonical,Le,ee,this.transform,P.getProjection(),We);ft=m.multiply([],this.transform.labelPlaneMatrix,bt)}let ut=null;Se&&C.latestFeatureIndex&&(ut={unwrappedTileID:J,dynamicFilter:Se,dynamicFilterNeedsFeature:Ge,featureIndex:C.latestFeatureIndex}),this.retainedQueryData[P.bucketInstanceId]=new vl(P.bucketInstanceId,N,P.sourceLayerIndex,P.index,C.tileID);const St={bucket:P,layout:B,posMatrix:_e,textLabelPlaneMatrix:ht,labelToScreenMatrix:ft,clippingData:ut,scale:q,textPixelRatio:H,holdingForFade:C.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:m.evaluateSizeForZoom(P.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:m.evaluateSizeForZoom(P.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(I)for(const bt of P.sortKeyRanges){const{sortKey:zt,symbolInstanceStart:En,symbolInstanceEnd:Pt}=bt;u.push({sortKey:zt,symbolInstanceStart:En,symbolInstanceEnd:Pt,parameters:St})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:St})}attemptAnchorPlacement(u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe,Le,ee,Se){const{textOffset0:Ge,textOffset1:We,crossTileID:ht}=_e,ft=[Ge,We],ut=Ts(u,C,I,ft,P),St=this.collisionIndex.placeCollisionBox(Te,P,g,Ot(ut.x,ut.y,N,B,this.transform.angle),J,U,q,H.predicate);if(Le){const bt=Te.getSymbolInstanceIconSize(Se,this.transform.zoom,_e.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Te,bt,Le,Ot(ut.x,ut.y,N,B,this.transform.angle),J,U,q,H.predicate).box.length)return}if(St.box.length>0){let bt;return this.prevPlacement&&this.prevPlacement.variableOffsets[ht]&&this.prevPlacement.placements[ht]&&this.prevPlacement.placements[ht].text&&(bt=this.prevPlacement.variableOffsets[ht].anchor),this.variableOffsets[ht]={textOffset:ft,width:C,height:I,anchor:u,textScale:P,prevAnchor:bt},this.markUsedJustification(Te,u,_e,Pe),Te.allowVerticalPlacement&&(this.markUsedOrientation(Te,Pe,_e),this.placedOrientations[ht]=Pe),{shift:ut,placedGlyphBoxes:St}}}placeLayerBucketPart(u,g,C,I){const{bucket:P,layout:N,posMatrix:B,textLabelPlaneMatrix:U,labelToScreenMatrix:q,clippingData:H,textPixelRatio:J,holdingForFade:_e,collisionBoxArray:Ce,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:Pe,collisionGroup:Le}=u.parameters,ee=N.get("text-optional"),Se=N.get("icon-optional"),Ge=N.get("text-allow-overlap"),We=N.get("icon-allow-overlap"),ht="map"===N.get("text-rotation-alignment"),ft="map"===N.get("text-pitch-alignment"),ut="none"!==N.get("icon-text-fit"),St="viewport-y"===N.get("symbol-z-order");this.transform.setProjection(P.projection);let bt=Ge&&(We||!P.hasIconData()||Se),zt=We&&(Ge||!P.hasTextData()||ee);!P.collisionArrays&&Ce&&P.deserializeCollisionBoxes(Ce),C&&I&&P.updateCollisionDebugBuffers(this.transform.zoom,Ce);const En=(Pt,sn,Ht)=>{const{crossTileID:xn,numVerticalGlyphVertices:Bt}=Pt;if(H){const Hi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Po=null;if(H.dynamicFilterNeedsFeature){const Tr=this.retainedQueryData[P.bucketInstanceId];Po=H.featureIndex.loadFeature({featureIndex:Pt.featureIndex,bucketIndex:Tr.bucketIndex,sourceLayerIndex:Tr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,H.dynamicFilter)(Hi,Po,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new m.Point(Pt.tileAnchorX,Pt.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[xn]=new Bi(!1,!1,!1,!0),void g.add(xn)}if(g.has(xn))return;if(_e)return void(this.placements[xn]=new Bi(!1,!1,!1));let rn=!1,wn=!1,hn=!0,Sn=!1,yi=!1,$i=null,ei={box:null,offscreen:null,occluded:null},ii={box:null,offscreen:null,occluded:null},fr=null,pr=null,di=null,_o=0,No=0,$o=0;Ht.textFeatureIndex?_o=Ht.textFeatureIndex:Pt.useRuntimeCollisionCircles&&(_o=Pt.featureIndex),Ht.verticalTextFeatureIndex&&(No=Ht.verticalTextFeatureIndex);const Ao=Hi=>{Hi.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const Po=this.transform.elevation;(Po||Hi.elevation)&&(Hi.elevation=Po?Po.getAtTileOffset(Hi.tileID,Hi.tileAnchorX,Hi.tileAnchorY):0)},Dl=Ht.textBox;if(Dl){Ao(Dl);const Hi=Tr=>{let yo=m.WritingMode.horizontal;if(P.allowVerticalPlacement&&!Tr&&this.prevPlacement){const Hl=this.prevPlacement.placedOrientations[xn];Hl&&(this.placedOrientations[xn]=Hl,yo=Hl,this.markUsedOrientation(P,yo,Pt))}return yo},Po=(Tr,yo)=>{if(P.allowVerticalPlacement&&Bt>0&&Ht.verticalTextBox){for(const Hl of P.writingModes)if(Hl===m.WritingMode.vertical?(ei=yo(),ii=ei):ei=Tr(),ei&&ei.box&&ei.box.length)break}else ei=Tr()};if(N.get("text-variable-anchor")){let Tr=N.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[xn]){const us=this.prevPlacement.variableOffsets[xn];Tr.indexOf(us.anchor)>0&&(Tr=Tr.filter(Ua=>Ua!==us.anchor),Tr.unshift(us.anchor))}const yo=(us,Ua,Tl)=>{const Zd=P.getSymbolInstanceTextSize(Te,Pt,this.transform.zoom,sn),mf=(us.x2-us.x1)*Zd+2*us.padding,td=(us.y2-us.y1)*Zd+2*us.padding,ql=ut&&!We?Ua:null;ql&&Ao(ql);let _d={box:[],offscreen:!1,occluded:!1};const ap=Ge?2*Tr.length:Tr.length;for(let wh=0;wh<ap;++wh){const lp=this.attemptAnchorPlacement(Tr[wh%Tr.length],us,mf,td,Zd,ht,ft,J,B,Le,wh>=Tr.length,Pt,sn,P,Tl,ql,Te,Pe);if(lp&&(_d=lp.placedGlyphBoxes,_d&&_d.box&&_d.box.length)){rn=!0,$i=lp.shift;break}}return _d};Po(()=>yo(Dl,Ht.iconBox,m.WritingMode.horizontal),()=>{const us=Ht.verticalTextBox;return us&&Ao(us),P.allowVerticalPlacement&&!(ei&&ei.box&&ei.box.length)&&Bt>0&&us?yo(us,Ht.verticalIconBox,m.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),ei&&(rn=ei.box,hn=ei.offscreen,Sn=ei.occluded);const Hl=Hi(!(!ei||!ei.box));if(!rn&&this.prevPlacement){const us=this.prevPlacement.variableOffsets[xn];us&&(this.variableOffsets[xn]=us,this.markUsedJustification(P,us.anchor,Pt,Hl))}}else{const Tr=(yo,Hl)=>{const us=P.getSymbolInstanceTextSize(Te,Pt,this.transform.zoom,sn),Ua=this.collisionIndex.placeCollisionBox(P,us,yo,new m.Point(0,0),Ge,J,B,Le.predicate);return Ua&&Ua.box&&Ua.box.length&&(this.markUsedOrientation(P,Hl,Pt),this.placedOrientations[xn]=Hl),Ua};Po(()=>Tr(Dl,m.WritingMode.horizontal),()=>{const yo=Ht.verticalTextBox;return P.allowVerticalPlacement&&Bt>0&&yo?(Ao(yo),Tr(yo,m.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Hi(!!(ei&&ei.box&&ei.box.length))}}if(fr=ei,rn=fr&&fr.box&&fr.box.length>0,hn=fr&&fr.offscreen,Sn=fr&&fr.occluded,Pt.useRuntimeCollisionCircles){const Hi=P.text.placedSymbolArray.get(Pt.centerJustifiedTextSymbolIndex>=0?Pt.centerJustifiedTextSymbolIndex:Pt.verticalPlacedTextSymbolIndex),Po=m.evaluateSizeForFeature(P.textSizeData,Te,Hi),Tr=N.get("text-padding");pr=this.collisionIndex.placeCollisionCircles(P,Ge,Hi,P.lineVertexArray,P.glyphOffsetArray,Po,B,U,q,C,ft,Le.predicate,Pt.collisionCircleDiameter*Po/m.ONE_EM,Tr,this.retainedQueryData[P.bucketInstanceId].tileID),rn=Ge||pr.circles.length>0&&!pr.collisionDetected,hn=hn&&pr.offscreen,Sn=pr.occluded}if(Ht.iconFeatureIndex&&($o=Ht.iconFeatureIndex),Ht.iconBox){const Hi=Po=>{Ao(Po);const Tr=ut&&$i?Ot($i.x,$i.y,ht,ft,this.transform.angle):new m.Point(0,0),yo=P.getSymbolInstanceIconSize(Pe,this.transform.zoom,Pt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,yo,Po,Tr,We,J,B,Le.predicate)};ii&&ii.box&&ii.box.length&&Ht.verticalIconBox?(di=Hi(Ht.verticalIconBox),wn=di.box.length>0):(di=Hi(Ht.iconBox),wn=di.box.length>0),hn=hn&&di.offscreen,yi=di.occluded}const vs=ee||0===Pt.numHorizontalGlyphVertices&&0===Bt,Tc=Se||0===Pt.numIconVertices;if(vs||Tc?Tc?vs||(wn=wn&&rn):rn=wn&&rn:wn=rn=wn&&rn,rn&&fr&&fr.box&&this.collisionIndex.insertCollisionBox(fr.box,N.get("text-ignore-placement"),P.bucketInstanceId,ii&&ii.box&&No?No:_o,Le.ID),wn&&di&&this.collisionIndex.insertCollisionBox(di.box,N.get("icon-ignore-placement"),P.bucketInstanceId,$o,Le.ID),pr&&(rn&&this.collisionIndex.insertCollisionCircles(pr.circles,N.get("text-ignore-placement"),P.bucketInstanceId,_o,Le.ID),C)){const Hi=P.bucketInstanceId;let Po=this.collisionCircleArrays[Hi];void 0===Po&&(Po=this.collisionCircleArrays[Hi]=new Ia);for(let Tr=0;Tr<pr.circles.length;Tr+=4)Po.circles.push(pr.circles[Tr+0]),Po.circles.push(pr.circles[Tr+1]),Po.circles.push(pr.circles[Tr+2]),Po.circles.push(pr.collisionDetected?1:0)}const cu="globe"!==P.projection.name;bt=bt&&(cu||!Sn),zt=zt&&(cu||!yi),this.placements[xn]=new Bi(rn||bt,wn||zt,hn||P.justReloaded),g.add(xn)};if(St){const Pt=P.getSortedSymbolIndexes(this.transform.angle);for(let sn=Pt.length-1;sn>=0;--sn){const Ht=Pt[sn];En(P.symbolInstances.get(Ht),Ht,P.collisionArrays[Ht])}}else for(let Pt=u.symbolInstanceStart;Pt<u.symbolInstanceEnd;Pt++)En(P.symbolInstances.get(Pt),Pt,P.collisionArrays[Pt]);if(C&&P.bucketInstanceId in this.collisionCircleArrays){const Pt=this.collisionCircleArrays[P.bucketInstanceId];m.invert(Pt.invProjMatrix,B),Pt.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(u,g,C,I){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:U,crossTileID:q}=C,H=m.getAnchorJustification(g),J=I===m.WritingMode.vertical?U:"left"===H?P:"center"===H?N:"right"===H?B:-1;P>=0&&(u.text.placedSymbolArray.get(P).crossTileID=J>=0&&P!==J?0:q),N>=0&&(u.text.placedSymbolArray.get(N).crossTileID=J>=0&&N!==J?0:q),B>=0&&(u.text.placedSymbolArray.get(B).crossTileID=J>=0&&B!==J?0:q),U>=0&&(u.text.placedSymbolArray.get(U).crossTileID=J>=0&&U!==J?0:q)}markUsedOrientation(u,g,C){const I=g===m.WritingMode.horizontal||g===m.WritingMode.horizontalOnly?g:0,P=g===m.WritingMode.vertical?g:0,{leftJustifiedTextSymbolIndex:N,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:q}=C,H=u.text.placedSymbolArray;N>=0&&(H.get(N).placedOrientation=I),B>=0&&(H.get(B).placedOrientation=I),U>=0&&(H.get(U).placedOrientation=I),q>=0&&(H.get(q).placedOrientation=P)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let C=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const I=g?g.symbolFadeChange(u):1,P=g?g.opacities:{},N=g?g.variableOffsets:{},B=g?g.placedOrientations:{};for(const U in this.placements){const q=this.placements[U],H=P[U];H?(this.opacities[U]=new nn(H,I,q.text,q.icon,null,q.clipped),C=C||q.text!==H.text.placed||q.icon!==H.icon.placed):(this.opacities[U]=new nn(null,I,q.text,q.icon,q.skipFade,q.clipped),C=C||q.text||q.icon)}for(const U in P){const q=P[U];if(!this.opacities[U]){const H=new nn(q,I,!1,!1);H.isHidden()||(this.opacities[U]=H,C=C||q.text.placed||q.icon.placed)}}for(const U in N)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=N[U]);for(const U in B)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=B[U]);C?this.lastPlacementChangeTime=u:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:u)}updateLayerOpacities(u,g){const C=new Set;for(const I of g){const P=I.getBucket(u);P&&I.latestFeatureIndex&&u.id===P.layerIds[0]&&this.updateBucketOpacities(P,C,I.collisionBoxArray)}}updateBucketOpacities(u,g,C){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const I=u.layers[0].layout,P=!!u.layers[0].dynamicFilter(),N=new nn(null,0,!1,!1,!0),B=I.get("text-allow-overlap"),U=I.get("icon-allow-overlap"),q=I.get("text-variable-anchor"),H="map"===I.get("text-rotation-alignment"),J="map"===I.get("text-pitch-alignment"),_e="none"!==I.get("icon-text-fit"),Ce=new nn(null,0,B&&(U||!u.hasIconData()||I.get("icon-optional")),U&&(B||!u.hasTextData()||I.get("text-optional")),!0);!u.collisionArrays&&C&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(C);const Te=(Le,ee,Se)=>{for(let Ge=0;Ge<ee/4;Ge++)Le.opacityVertexArray.emplaceBack(Se)};let Pe=0;for(let Le=0;Le<u.symbolInstances.length;Le++){const ee=u.symbolInstances.get(Le),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:Ge,crossTileID:We,numIconVertices:ht}=ee,ft=g.has(We);let ut=this.opacities[We];ft?ut=N:ut||(ut=Ce,this.opacities[We]=ut),g.add(We);const St=Se>0||Ge>0,bt=ht>0,zt=this.placedOrientations[We],En=zt===m.WritingMode.vertical,Pt=zt===m.WritingMode.horizontal||zt===m.WritingMode.horizontalOnly;if(!St&&!bt||ut.isHidden()||Pe++,St){const sn=As(ut.text);Te(u.text,Se,En?Cs:sn),Te(u.text,Ge,Pt?Cs:sn);const Ht=ut.text.isHidden(),{leftJustifiedTextSymbolIndex:xn,centerJustifiedTextSymbolIndex:Bt,rightJustifiedTextSymbolIndex:rn,verticalPlacedTextSymbolIndex:wn}=ee,hn=u.text.placedSymbolArray,Sn=Ht||En?1:0;xn>=0&&(hn.get(xn).hidden=Sn),Bt>=0&&(hn.get(Bt).hidden=Sn),rn>=0&&(hn.get(rn).hidden=Sn),wn>=0&&(hn.get(wn).hidden=Ht||Pt?1:0);const yi=this.variableOffsets[We];yi&&this.markUsedJustification(u,yi.anchor,ee,zt);const $i=this.placedOrientations[We];$i&&(this.markUsedJustification(u,"left",ee,$i),this.markUsedOrientation(u,$i,ee))}if(bt){const sn=As(ut.icon),{placedIconSymbolIndex:Ht,verticalPlacedIconSymbolIndex:xn}=ee,Bt=u.icon.placedSymbolArray,rn=ut.icon.isHidden()?1:0;Ht>=0&&(Te(u.icon,ht,En?Cs:sn),Bt.get(Ht).hidden=rn),xn>=0&&(Te(u.icon,ee.numVerticalIconVertices,Pt?Cs:sn),Bt.get(xn).hidden=rn)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const sn=u.collisionArrays[Le];if(sn){let Ht=new m.Point(0,0),xn=!0;if(sn.textBox||sn.verticalTextBox){if(q){const rn=this.variableOffsets[We];rn?(Ht=Ts(rn.anchor,rn.width,rn.height,rn.textOffset,rn.textScale),H&&Ht._rotate(J?this.transform.angle:-this.transform.angle)):xn=!1}P&&(xn=!ut.clipped),sn.textBox&&oi(u.textCollisionBox.collisionVertexArray,ut.text.placed,!xn||En,Ht.x,Ht.y),sn.verticalTextBox&&oi(u.textCollisionBox.collisionVertexArray,ut.text.placed,!xn||Pt,Ht.x,Ht.y)}const Bt=xn&&!(Pt||!sn.verticalIconBox);sn.iconBox&&oi(u.iconCollisionBox.collisionVertexArray,ut.icon.placed,Bt,_e?Ht.x:0,_e?Ht.y:0),sn.verticalIconBox&&oi(u.iconCollisionBox.collisionVertexArray,ut.icon.placed,!Bt,_e?Ht.x:0,_e?Ht.y:0)}}}if(u.fullyClipped=0===Pe,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const Le=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Le.invProjMatrix,u.placementViewportMatrix=Le.viewportMatrix,u.collisionCircleArray=Le.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return 0===this.fadeDuration?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,g){const C=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*C>u}setStale(){this.stale=!0}}function oi(b,u,g,C,I){b.emplaceBack(u?1:0,g?1:0,C||0,I||0),b.emplaceBack(u?1:0,g?1:0,C||0,I||0),b.emplaceBack(u?1:0,g?1:0,C||0,I||0),b.emplaceBack(u?1:0,g?1:0,C||0,I||0)}const ur=Math.pow(2,25),Zs=Math.pow(2,24),Wa=Math.pow(2,17),pd=Math.pow(2,16),Qo=Math.pow(2,9),Pi=Math.pow(2,8),Ud=Math.pow(2,1);function As(b){if(0===b.opacity&&!b.placed)return 0;if(1===b.opacity&&b.placed)return 4294967295;const u=b.placed?1:0,g=Math.floor(127*b.opacity);return g*ur+u*Zs+g*Wa+u*pd+g*Qo+u*Pi+g*Ud+u}const Cs=0;class Za{constructor(u){this._sortAcrossTiles="viewport-y"!==u.layout.get("symbol-z-order")&&void 0!==u.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,g,C,I,P){const N=this._bucketParts;for(;this._currentTileIndex<u.length;)if(g.getBucketParts(N,I,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,N.sort((B,U)=>B.sortKey-U.sortKey));this._currentPartIndex<N.length;){const B=N[this._currentPartIndex];if(g.placeLayerBucketPart(B,this._seenCrossTileIDs,C,0===B.symbolInstanceStart),this._currentPartIndex++,P())return!0}return!1}}class Vo{constructor(u,g,C,I,P,N,B,U){this.placement=new mr(u,P,N,B,U),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(u,g,C){const I=m.exported.now(),P=()=>{const N=m.exported.now()-I;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=g[u[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if("symbol"===N.type&&(!N.minzoom||N.minzoom<=B)&&(!N.maxzoom||N.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new Za(N)),this._inProgressLayer.continuePlacement(C[N.source],this.placement,this._showCollisionBoxes,N,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const ia=512/m.EXTENT/2;class ra{constructor(u,g,C){this.tileID=u,this.bucketInstanceId=C,this.index=new m.KDBush(g.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const I=u.canonical.x*m.EXTENT,P=u.canonical.y*m.EXTENT;for(let N=0;N<g.length;N++){const{key:B,crossTileID:U,tileAnchorX:q,tileAnchorY:H}=g.get(N),J=Math.floor((I+q)*ia),_e=Math.floor((P+H)*ia);this.index.add(J,_e),this.keys.push(B),this.crossTileIDs.push(U)}this.index.finish()}findMatches(u,g,C){const I=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z),P=ia/Math.pow(2,g.canonical.z-this.tileID.canonical.z),N=g.canonical.x*m.EXTENT,B=g.canonical.y*m.EXTENT;for(let U=0;U<u.length;U++){const q=u.get(U);if(q.crossTileID)continue;const{key:H,tileAnchorX:J,tileAnchorY:_e}=q,Ce=Math.floor((N+J)*P),Te=Math.floor((B+_e)*P),Pe=this.index.range(Ce-I,Te-I,Ce+I,Te+I);for(const Le of Pe){const ee=this.crossTileIDs[Le];if(this.keys[Le]===H&&!C.has(ee)){C.add(ee),q.crossTileID=ee;break}}}}}class xl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const g=Math.round((u-this.lng)/360);if(0!==g)for(const C in this.indexes){const I=this.indexes[C],P={};for(const N in I){const B=I[N];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+g),P[B.tileID.key]=B}this.indexes[C]=P}this.lng=u}addBucket(u,g,C){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let P=0;P<g.symbolInstances.length;P++)g.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const I=this.usedCrossTileIDs[u.overscaledZ];for(const P in this.indexes){const N=this.indexes[P];if(Number(P)>u.overscaledZ)for(const B in N){const U=N[B];U.tileID.isChildOf(u)&&U.findMatches(g.symbolInstances,u,I)}else{const B=N[u.scaledTo(Number(P)).key];B&&B.findMatches(g.symbolInstances,u,I)}}for(let P=0;P<g.symbolInstances.length;P++){const N=g.symbolInstances.get(P);N.crossTileID||(N.crossTileID=C.generate(),I.add(N.crossTileID))}return void 0===this.indexes[u.overscaledZ]&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new ra(u,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(u,g){for(const C of g.crossTileIDs)this.usedCrossTileIDs[u].delete(C)}removeStaleBuckets(u){let g=!1;for(const C in this.indexes){const I=this.indexes[C];for(const P in I)u[I[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(C,I[P]),delete I[P],g=!0)}return g}}class Xa{constructor(){this.layerIndexes={},this.crossTileIDs=new xl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,g,C,I){let P=this.layerIndexes[u.id];void 0===P&&(P=this.layerIndexes[u.id]=new rc);let N=!1;const B={};"globe"!==I.name&&P.handleWrapJump(C);for(const U of g){const q=U.getBucket(u);q&&u.id===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(U.tileID,q,this.crossTileIDs)&&(N=!0),B[q.bucketInstanceId]=!0)}return P.removeStaleBuckets(B)&&(N=!0),N}pruneUnusedLayers(u){const g={};u.forEach(C=>{g[C]=!0});for(const C in this.layerIndexes)g[C]||delete this.layerIndexes[C]}}const bl=(b,u)=>m.emitValidationErrors(b,u&&u.filter(g=>"source.canvas"!==g.identifier)),ps=m.pick(_i,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),zl=m.pick(_i,["setCenter","setZoom","setBearing","setPitch"]),xi={version:8,layers:[],sources:{}},Uo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ko extends m.Evented{constructor(u,g={}){super(),this.map=u,this.dispatcher=new Re(Ll(),this),this.imageManager=new ne,this.imageManager.setEventedParent(this),this.glyphManager=new m.GlyphManager(u._requestManager,g.localFontFamily?m.LocalGlyphMode.all:g.localIdeographFontFamily?m.LocalGlyphMode.ideographs:m.LocalGlyphMode.none,g.localFontFamily||g.localIdeographFontFamily),this.crossTileSymbolIndex=new Xa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",m.getReferrer());const C=this;this._rtlTextPluginCallback=ko.registerForPluginStateChange(I=>{C.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:I.pluginStatus,pluginURL:I.pluginURL},(P,N)=>{if(m.triggerPluginCompletionEvent(P),N&&N.every(B=>B))for(const B in C._sourceCaches){const U=C._sourceCaches[B],q=U.getSource().type;"vector"!==q&&"geojson"!==q||U.reload()}})}),this.on("data",I=>{if("source"!==I.dataType||"metadata"!==I.sourceDataType)return;const P=this.getSource(I.sourceId);if(P&&P.vectorLayerIds)for(const N in this._layers){const B=this._layers[N];B.source===P.id&&this._validateLayer(B)}})}loadURL(u,g={}){this.fire(new m.Event("dataloading",{dataType:"style"}));const C="boolean"==typeof g.validate?g.validate:!m.isMapboxURL(u);u=this.map._requestManager.normalizeStyleURL(u,g.accessToken);const I=this.map._requestManager.transformRequest(u,m.ResourceType.Style);this._request=m.getJSON(I,(P,N)=>{this._request=null,P?this.fire(new m.ErrorEvent(P)):N&&this._load(N,C)})}loadJSON(u,g={}){this.fire(new m.Event("dataloading",{dataType:"style"})),this._request=m.exported.frame(()=>{this._request=null,this._load(u,!1!==g.validate)})}loadEmpty(){this.fire(new m.Event("dataloading",{dataType:"style"})),this._load(xi,!1)}_updateLayerCount(u,g){const C=g?1:-1;u.is3D()&&(this._num3DLayers+=C),"circle"===u.type&&(this._numCircleLayers+=C),"symbol"===u.type&&(this._numSymbolLayers+=C)}_load(u,g){if(g&&bl(this,m.validateStyle(u)))return;this._loaded=!0,this.stylesheet=m.clone$1(u),this._updateMapProjection();for(const I in u.sources)this.addSource(I,u.sources[I],{validate:!1});this._changed=!1,u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(u.glyphs);const C=Vd(this.stylesheet.layers);this._order=C.map(I=>I.id),this._layers={},this._serializedLayers={};for(const I of C){const P=m.createStyleLayer(I);P.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ue(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new m.Event("data",{dataType:"style"})),this.fire(new m.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(u){this._spriteRequest=function(g,C,I){let P,N,B;const U=m.exported.devicePixelRatio>1?"@2x":"";let q=m.getJSON(C.transformRequest(C.normalizeSpriteURL(g,U,".json"),m.ResourceType.SpriteJSON),(_e,Ce)=>{q=null,B||(B=_e,P=Ce,J())}),H=m.getImage(C.transformRequest(C.normalizeSpriteURL(g,U,".png"),m.ResourceType.SpriteImage),(_e,Ce)=>{H=null,B||(B=_e,N=Ce,J())});function J(){if(B)I(B);else if(P&&N){const _e=m.exported.getImageData(N),Ce={};for(const Te in P){const{width:Pe,height:Le,x:ee,y:Se,sdf:Ge,pixelRatio:We,stretchX:ht,stretchY:ft,content:ut}=P[Te],St=new m.RGBAImage({width:Pe,height:Le});m.RGBAImage.copy(_e,St,{x:ee,y:Se},{x:0,y:0},{width:Pe,height:Le}),Ce[Te]={data:St,pixelRatio:We,sdf:Ge,stretchX:ht,stretchY:ft,content:ut}}I(null,Ce)}}return{cancel(){q&&(q.cancel(),q=null),H&&(H.cancel(),H=null)}}}(u,this.map._requestManager,(g,C)=>{if(this._spriteRequest=null,g)this.fire(new m.ErrorEvent(g));else if(C)for(const I in C)this.imageManager.addImage(I,C[I]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new m.Event("data",{dataType:"style"}))})}_validateLayer(u){const g=this.getSource(u.source);if(!g)return;const C=u.sourceLayer;C&&("geojson"===g.type||g.vectorLayerIds&&-1===g.vectorLayerIds.indexOf(C))&&this.fire(new m.ErrorEvent(new Error(`Source layer "${C}" does not exist on source "${g.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(u){const g=[];for(const C of u){const I=this._layers[C];"custom"!==I.type&&g.push(I.serialize())}return g}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(u){return!!this.terrain&&("function"==typeof u.isLayerDraped?u.isLayerDraped():Uo[u.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(u){if(!this._loaded)return;const g=this._changed;if(this._changed){const I=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(I.length||P.length)&&this._updateWorkerLayers(I,P);for(const N in this._updatedSources){const B=this._updatedSources[N];"reload"===B?this._reloadSource(N):"clear"===B&&this._clearSource(N)}this._updateTilesForChangedImages();for(const N in this._updatedPaintProps)this._layers[N].updateTransitions(u);this.light.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._resetUpdates()}const C={};for(const I in this._sourceCaches){const P=this._sourceCaches[I];C[I]=P.used,P.used=!1}for(const I of this._order){const P=this._layers[I];if(P.recalculate(u,this._availableImages),!P.isHidden(u.zoom)){const B=this._getLayerSourceCache(P);B&&(B.used=!0)}const N=this.map.painter;if(N){const B=P.getProgramIds();if(!B)continue;const U=P.getProgramConfiguration(u.zoom);for(const q of B)N.useProgram(q,U)}}for(const I in C){const P=this._sourceCaches[I];C[I]!==P.used&&P.getSource().fire(new m.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new m.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const g in this._sourceCaches)this._sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateWorkerLayers(u,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(u),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(u){if(this._checkLoaded(),bl(this,m.validateStyle(u)))return!1;(u=m.clone$1(u)).layers=Vd(u.layers);const g=function(I,P){if(!I)return[{command:_i.setStyle,args:[P]}];let N=[];try{if(!xe(I.version,P.version))return[{command:_i.setStyle,args:[P]}];xe(I.center,P.center)||N.push({command:_i.setCenter,args:[P.center]}),xe(I.zoom,P.zoom)||N.push({command:_i.setZoom,args:[P.zoom]}),xe(I.bearing,P.bearing)||N.push({command:_i.setBearing,args:[P.bearing]}),xe(I.pitch,P.pitch)||N.push({command:_i.setPitch,args:[P.pitch]}),xe(I.sprite,P.sprite)||N.push({command:_i.setSprite,args:[P.sprite]}),xe(I.glyphs,P.glyphs)||N.push({command:_i.setGlyphs,args:[P.glyphs]}),xe(I.transition,P.transition)||N.push({command:_i.setTransition,args:[P.transition]}),xe(I.light,P.light)||N.push({command:_i.setLight,args:[P.light]}),xe(I.fog,P.fog)||N.push({command:_i.setFog,args:[P.fog]}),xe(I.projection,P.projection)||N.push({command:_i.setProjection,args:[P.projection]});const B={},U=[];!function(J,_e,Ce,Te){let Pe;for(Pe in _e=_e||{},J=J||{})J.hasOwnProperty(Pe)&&(_e.hasOwnProperty(Pe)||Cr(Pe,Ce,Te));for(Pe in _e){if(!_e.hasOwnProperty(Pe))continue;const Le=_e[Pe];J.hasOwnProperty(Pe)?xe(J[Pe],Le)||("geojson"===J[Pe].type&&"geojson"===Le.type&&Iu(J,_e,Pe)?Ce.push({command:_i.setGeoJSONSourceData,args:[Pe,Le.data]}):Yo(Pe,_e,Ce,Te)):kc(Pe,_e,Ce)}}(I.sources,P.sources,U,B);const q=[];I.layers&&I.layers.forEach(J=>{J.source&&B[J.source]?N.push({command:_i.removeLayer,args:[J.id]}):q.push(J)});let H=I.terrain;H&&B[H.source]&&(N.push({command:_i.setTerrain,args:[void 0]}),H=void 0),N=N.concat(U),xe(H,P.terrain)||N.push({command:_i.setTerrain,args:[P.terrain]}),function(J,_e,Ce){_e=_e||[];const Te=(J=J||[]).map(xa),Pe=_e.map(xa),Le=J.reduce(rs,{}),ee=_e.reduce(rs,{}),Se=Te.slice(),Ge=Object.create(null);let We,ht,ft,ut,St,bt,zt;for(We=0,ht=0;We<Te.length;We++)ft=Te[We],ee.hasOwnProperty(ft)?ht++:(Ce.push({command:_i.removeLayer,args:[ft]}),Se.splice(Se.indexOf(ft,ht),1));for(We=0,ht=0;We<Pe.length;We++)ft=Pe[Pe.length-1-We],Se[Se.length-1-We]!==ft&&(Le.hasOwnProperty(ft)?(Ce.push({command:_i.removeLayer,args:[ft]}),Se.splice(Se.lastIndexOf(ft,Se.length-ht),1)):ht++,bt=Se[Se.length-We],Ce.push({command:_i.addLayer,args:[ee[ft],bt]}),Se.splice(Se.length-We,0,ft),Ge[ft]=!0);for(We=0;We<Pe.length;We++)if(ft=Pe[We],ut=Le[ft],St=ee[ft],!Ge[ft]&&!xe(ut,St))if(xe(ut.source,St.source)&&xe(ut["source-layer"],St["source-layer"])&&xe(ut.type,St.type)){for(zt in is(ut.layout,St.layout,Ce,ft,null,_i.setLayoutProperty),is(ut.paint,St.paint,Ce,ft,null,_i.setPaintProperty),xe(ut.filter,St.filter)||Ce.push({command:_i.setFilter,args:[ft,St.filter]}),xe(ut.minzoom,St.minzoom)&&xe(ut.maxzoom,St.maxzoom)||Ce.push({command:_i.setLayerZoomRange,args:[ft,St.minzoom,St.maxzoom]}),ut)ut.hasOwnProperty(zt)&&"layout"!==zt&&"paint"!==zt&&"filter"!==zt&&"metadata"!==zt&&"minzoom"!==zt&&"maxzoom"!==zt&&(0===zt.indexOf("paint.")?is(ut[zt],St[zt],Ce,ft,zt.slice(6),_i.setPaintProperty):xe(ut[zt],St[zt])||Ce.push({command:_i.setLayerProperty,args:[ft,zt,St[zt]]}));for(zt in St)St.hasOwnProperty(zt)&&!ut.hasOwnProperty(zt)&&"layout"!==zt&&"paint"!==zt&&"filter"!==zt&&"metadata"!==zt&&"minzoom"!==zt&&"maxzoom"!==zt&&(0===zt.indexOf("paint.")?is(ut[zt],St[zt],Ce,ft,zt.slice(6),_i.setPaintProperty):xe(ut[zt],St[zt])||Ce.push({command:_i.setLayerProperty,args:[ft,zt,St[zt]]}))}else Ce.push({command:_i.removeLayer,args:[ft]}),bt=Se[Se.lastIndexOf(ft)+1],Ce.push({command:_i.addLayer,args:[St,bt]})}(q,P.layers,N)}catch(B){console.warn("Unable to compute style diff:",B),N=[{command:_i.setStyle,args:[P]}]}return N}(this.serialize(),u).filter(I=>!(I.command in zl));if(0===g.length)return!1;const C=g.filter(I=>!(I.command in ps));if(C.length>0)throw new Error(`Unimplemented: ${C.map(I=>I.command).join(", ")}.`);return g.forEach(I=>{"setTransition"!==I.command&&"setProjection"!==I.command&&this[I.command].apply(this,I.args)}),this.stylesheet=u,this._updateMapProjection(),!0}addImage(u,g){return this.getImage(u)?this.fire(new m.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,g),this._afterImageUpdated(u),this)}updateImage(u,g){this.imageManager.updateImage(u,g)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u),this._afterImageUpdated(u),this):this.fire(new m.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new m.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(u,g,C={}){if(this._checkLoaded(),void 0!==this.getSource(u))throw new Error("There is already a source with this ID");if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(m.validateSource,`sources.${u}`,g,null,C))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const I=Fi(u,g,this.dispatcher,this);I.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u),source:I.serialize(),sourceId:u}));const P=N=>{const B=(N?"symbol:":"other:")+u,U=this._sourceCaches[B]=new m.SourceCache(B,I,N);(N?this._symbolSourceCaches:this._otherSourceCaches)[u]=U,U.style=this,U.onAdd(this.map)};P(!1),"vector"!==g.type&&"geojson"!==g.type||P(!0),I.onAdd&&I.onAdd(this.map),this._changed=!0}removeSource(u){this._checkLoaded();const g=this.getSource(u);if(!g)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===u)return this.fire(new m.ErrorEvent(new Error(`Source "${u}" cannot be removed while layer "${I}" is using it.`)));if(this.terrain&&this.terrain.get().source===u)return this.fire(new m.ErrorEvent(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const C=this._getSourceCaches(u);for(const I of C)delete this._sourceCaches[I.id],delete this._updatedSources[I.id],I.fire(new m.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:I.getSource().id})),I.setEventedParent(null),I.clearTiles();return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],g.setEventedParent(null),g.onRemove&&g.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(u,g){this._checkLoaded(),this.getSource(u).setData(g),this._changed=!0}getSource(u){const g=this._getSourceCache(u);return g&&g.getSource()}_getSources(){const u=[];for(const g in this._otherSourceCaches){const C=this._getSourceCache(g);C&&u.push(C.getSource())}return u}addLayer(u,g,C={}){this._checkLoaded();const I=u.id;if(this.getLayer(I))return void this.fire(new m.ErrorEvent(new Error(`Layer with id "${I}" already exists on this map`)));let P;if("custom"===u.type){if(bl(this,m.validateCustomStyleLayer(u)))return;P=m.createStyleLayer(u)}else{if("object"==typeof u.source&&(this.addSource(I,u.source),u=m.clone$1(u),u=m.extend(u,{source:I})),this._validate(m.validateLayer,`layers.${I}`,u,{arrayIndex:-1},C))return;P=m.createStyleLayer(u),this._validateLayer(P),P.setEventedParent(this,{layer:{id:I}}),this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0)}const N=g?this._order.indexOf(g):this._order.length;if(g&&-1===N)return void this.fire(new m.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`)));this._order.splice(N,0,I),this._layerOrderChanged=!0,this._layers[I]=P;const B=this._getLayerSourceCache(P);if(this._removedLayers[I]&&P.source&&B&&"custom"!==P.type){const U=this._removedLayers[I];delete this._removedLayers[I],U.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",B.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(u,g){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===g)return;const C=this._order.indexOf(u);this._order.splice(C,1);const I=g?this._order.indexOf(g):this._order.length;g&&-1===I?this.fire(new m.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`))):(this._order.splice(I,0,u),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(u){this._checkLoaded();const g=this._layers[u];if(!g)return void this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be removed.`)));g.setEventedParent(null),this._updateLayerCount(g,!1);const C=this._order.indexOf(u);this._order.splice(C,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=g,delete this._layers[u],delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],g.onRemove&&g.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(u){return this._layers[u]}hasLayer(u){return u in this._layers}hasLayerType(u){for(const g in this._layers)if(this._layers[g].type===u)return!0;return!1}setLayerZoomRange(u,g,C){this._checkLoaded();const I=this.getLayer(u);I?I.minzoom===g&&I.maxzoom===C||(null!=g&&(I.minzoom=g),null!=C&&(I.maxzoom=C),this._updateLayer(I)):this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(u,g,C={}){this._checkLoaded();const I=this.getLayer(u);if(I){if(!xe(I.filter,g))return null==g?(I.filter=void 0,void this._updateLayer(I)):void(this._validate(m.validateFilter,`layers.${I.id}.filter`,g,{layerType:I.type},C)||(I.filter=m.clone$1(g),this._updateLayer(I)))}else this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be filtered.`)))}getFilter(u){const g=this.getLayer(u);return g&&m.clone$1(g.filter)}setLayoutProperty(u,g,C,I={}){this._checkLoaded();const P=this.getLayer(u);P?xe(P.getLayoutProperty(g),C)||(P.setLayoutProperty(g,C,I),this._updateLayer(P)):this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(u,g){const C=this.getLayer(u);if(C)return C.getLayoutProperty(g);this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style.`)))}setPaintProperty(u,g,C,I={}){this._checkLoaded();const P=this.getLayer(u);P?xe(P.getPaintProperty(g),C)||(P.setPaintProperty(g,C,I)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[u]=!0):this.fire(new m.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(u,g){const C=this.getLayer(u);return C&&C.getPaintProperty(g)}setFeatureState(u,g){this._checkLoaded();const C=u.source,I=u.sourceLayer,P=this.getSource(C);if(!P)return void this.fire(new m.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`)));const N=P.type;if("geojson"===N&&I)return void this.fire(new m.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===N&&!I)return void this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===u.id&&this.fire(new m.ErrorEvent(new Error("The feature id parameter must be provided.")));const B=this._getSourceCaches(C);for(const U of B)U.setFeatureState(I,u.id,g)}removeFeatureState(u,g){this._checkLoaded();const C=u.source,I=this.getSource(C);if(!I)return void this.fire(new m.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`)));const P=I.type,N="vector"===P?u.sourceLayer:void 0;if("vector"===P&&!N)return void this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(g&&"string"!=typeof u.id&&"number"!=typeof u.id)return void this.fire(new m.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const B=this._getSourceCaches(C);for(const U of B)U.removeFeatureState(N,u.id,g)}getFeatureState(u){this._checkLoaded();const g=u.source,C=u.sourceLayer,I=this.getSource(g);if(I){if("vector"!==I.type||C)return void 0===u.id&&this.fire(new m.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(g)[0].getFeatureState(C,u.id);this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new m.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return m.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const u={};for(const g in this._sourceCaches){const C=this._sourceCaches[g].getSource();u[C.id]||(u[C.id]=C.serialize())}return m.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:u,layers:this._serializeLayers(this._order)},g=>void 0!==g)}_updateLayer(u){this._updatedLayers[u.id]=!0;const g=this._getLayerSourceCache(u);u.source&&!this._updatedSources[u.source]&&g&&"raster"!==g.getSource().type&&(this._updatedSources[u.source]="reload",g.pause()),this._changed=!0,u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const g=N=>"fill-extrusion"===this._layers[N].type,C={},I=[];for(let N=this._order.length-1;N>=0;N--){const B=this._order[N];if(g(B)){C[B]=N;for(const U of u){const q=U[B];if(q)for(const H of q)I.push(H)}}}I.sort((N,B)=>B.intersectionZ-N.intersectionZ);const P=[];for(let N=this._order.length-1;N>=0;N--){const B=this._order[N];if(g(B))for(let U=I.length-1;U>=0;U--){const q=I[U].feature;if(C[q.layer.id]<N)break;P.push(q),I.pop()}else for(const U of u){const q=U[B];if(q)for(const H of q)P.push(H.feature)}}return P}queryRenderedFeatures(u,g,C){g&&g.filter&&this._validate(m.validateFilter,"queryRenderedFeatures.filter",g.filter,null,g);const I={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new m.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of g.layers){const q=this._layers[U];if(!q)return this.fire(new m.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];I[q.source]=!0}}const P=[];g.availableImages=this._availableImages;const N=g&&g.layers?g.layers.some(U=>{const q=this.getLayer(U);return q&&q.is3D()}):this.has3DLayers(),B=gt.createFromScreenPoints(u,C);for(const U in this._sourceCaches){const q=this._sourceCaches[U].getSource().id;g.layers&&!I[q]||P.push(dr(this._sourceCaches[U],this._layers,this._serializedLayers,B,g,C,N,!!this.map._showQueryGeometry))}return this.placement&&P.push(function(U,q,H,J,_e,Ce,Te){const Pe={},Le=Ce.queryRenderedSymbols(J),ee=[];for(const Se of Object.keys(Le).map(Number))ee.push(Te[Se]);ee.sort(Vi);for(const Se of ee){const Ge=Se.featureIndex.lookupSymbolFeatures(Le[Se.bucketInstanceId],q,Se.bucketIndex,Se.sourceLayerIndex,_e.filter,_e.layers,_e.availableImages,U);for(const We in Ge){const ht=Pe[We]=Pe[We]||[],ft=Ge[We];ft.sort((ut,St)=>{const bt=Se.featureSortOrder;if(bt){const zt=bt.indexOf(ut.featureIndex);return bt.indexOf(St.featureIndex)-zt}return St.featureIndex-ut.featureIndex});for(const ut of ft)ht.push(ut)}}for(const Se in Pe)Pe[Se].forEach(Ge=>{const We=Ge.feature,ht=H(U[Se]);if(!ht)return;const ft=ht.getFeatureState(We.layer["source-layer"],We.id);We.source=We.layer.source,We.layer["source-layer"]&&(We.sourceLayer=We.layer["source-layer"]),We.state=ft});return Pe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),B.screenGeometry,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(u,g){g&&g.filter&&this._validate(m.validateFilter,"querySourceFeatures.filter",g.filter,null,g);const C=this._getSourceCaches(u);let I=[];for(const P of C)I=I.concat(zo(P,g));return I}addSourceType(u,g,C){return ko.getSourceType(u)?C(new Error(`A source type called "${u}" already exists.`)):(ko.setSourceType(u,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:g.workerSourceURL},C):C(null,null))}getLight(){return this.light.getLight()}setLight(u,g={}){this._checkLoaded();const C=this.light.getLight();let I=!1;for(const N in u)if(!xe(u[N],C[N])){I=!0;break}if(!I)return;const P=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(u,g),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(u,g=1){if(this._checkLoaded(),!u)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let C=u;if(1===g){if("object"==typeof C.source){const I="terrain-dem-src";this.addSource(I,C.source),C=m.clone$1(C),C=m.extend(C,{source:I})}if(this._validate(m.validateTerrain,"terrain",C))return}if(!this.terrain||this.terrain&&g!==this.terrain.drapeRenderMode){if(!C)return;this._createTerrain(C,g)}else{const I=this.terrain,P=I.get();for(const N of Object.keys(m.spec.terrain))!C.hasOwnProperty(N)&&m.spec.terrain[N].default&&(C[N]=m.spec.terrain[N].default);for(const N in C)if(!xe(C[N],P[N])){I.set(C),this.stylesheet.terrain=C;const B=this._setTransitionParameters({duration:0});I.updateTransitions(B);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const g=this.fog=new dt(u,this.map.transform);this.stylesheet.fog=u;const C=this._setTransitionParameters({duration:0});g.updateTransitions(C)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const g=this.fog,C=g.get();0===Object.keys(u).length&&g.set(u);for(const I in u)if(!xe(u[I],C[I])){g.set(u),this.stylesheet.fog=u;const P=this._setTransitionParameters({duration:0});g.updateTransitions(P);break}}else this._createFog(u);this._markersNeedUpdate=!0}_setTransitionParameters(u){return{now:m.exported.now(),transition:m.extend(u,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const u=this._order.filter(C=>this.isLayerDraped(this._layers[C])),g=this._order.filter(C=>!this.isLayerDraped(this._layers[C]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...g)}_createTerrain(u,g){const C=this.terrain=new Me(u,g);this.stylesheet.terrain=u,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const I=this._setTransitionParameters({duration:0});C.updateTransitions(I)}_force3DLayerUpdate(){for(const u in this._layers){const g=this._layers[u];"fill-extrusion"===g.type&&this._updateLayer(g)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const g=this._layers[u];"symbol"===g.type&&this._updateLayer(g)}}_validate(u,g,C,I,P={}){return(!P||!1!==P.validate)&&bl(this,u.call(m.validateStyle,m.extend({key:g,style:this.serialize(),value:C,styleSpec:m.spec},I)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),m.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this._sourceCaches)this._sourceCaches[u].clearTiles(),this._sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(u){const g=this._getSourceCaches(u);for(const C of g)C.clearTiles()}_reloadSource(u){const g=this._getSourceCaches(u);for(const C of g)C.resume(),C.reload()}_reloadSources(){for(const u of this._getSources())u.reload&&u.reload()}_updateSources(u){for(const g in this._sourceCaches)this._sourceCaches[g].update(u)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const g=this._sourceCaches[u];g.resume(),g.reload()}}_updatePlacement(u,g,C,I,P=!1){let N=!1,B=!1;const U={};for(const q of this._order){const H=this._layers[q];if("symbol"!==H.type)continue;if(!U[H.source]){const _e=this._getLayerSourceCache(H);if(!_e)continue;U[H.source]=_e.getRenderableIds(!0).map(Ce=>_e.getTileByID(Ce)).sort((Ce,Te)=>Te.tileID.overscaledZ-Ce.tileID.overscaledZ||(Ce.tileID.isLessThan(Te.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(H,U[H.source],u.center.lng,u.projection);N=N||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),P=P||this._layerOrderChanged||0===C,this._layerOrderChanged&&this.fire(new m.Event("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(m.exported.now(),u.zoom))&&(this.pauseablePlacement=new Vo(u,this._order,P,g,C,I,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(m.exported.now()),B=!0),N&&this.pauseablePlacement.placement.setStale()),B||N)for(const q of this._order){const H=this._layers[q];"symbol"===H.type&&this.placement.updateLayerOpacities(H,U[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(m.exported.now())}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}getImages(u,g,C){this.imageManager.getImages(g.icons,C),this._updateTilesForChangedImages();const I=P=>{P&&P.setDependencies(g.tileID.key,g.type,g.icons)};I(this._otherSourceCaches[g.source]),I(this._symbolSourceCaches[g.source])}getGlyphs(u,g,C){this.glyphManager.getGlyphs(g.stacks,C)}getResource(u,g,C){return m.makeRequest(g,C)}_getSourceCache(u){return this._otherSourceCaches[u]}_getLayerSourceCache(u){return"symbol"===u.type?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}_getSourceCaches(u){const g=[];return this._otherSourceCaches[u]&&g.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&g.push(this._symbolSourceCaches[u]),g}_isSourceCacheLoaded(u){const g=this._getSourceCaches(u);return 0===g.length?(this.fire(new m.ErrorEvent(new Error(`There is no source with ID '${u}'`))),!1):g.every(C=>C.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ko.getSourceType=function(b){return ji[b]},ko.setSourceType=function(b,u){ji[b]=u},ko.registerForPluginStateChange=m.registerForPluginStateChange;var jd="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",kn="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Vl="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",wr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Ul="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let ha={},sl={};const Xs=[];ci(jd,Xs),ci(Vl,Xs),ci(wr,Xs),ci(Ul,Xs),ha=si("",Vl),sl=si(Ul,wr);const wc=si("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Na=jd,tu="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var jo={background:si("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:si("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:si("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:si("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:si("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:si("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:si("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:si("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:si("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:si("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:si("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:si("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:si("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:si("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:si("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:si("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:si("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:si("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:si("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:si("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:si("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:si("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:si("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:si("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:si("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:si("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",kn),skyboxGradient:si("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",kn),skyboxCapture:si("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:si("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:si("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ci(b,u){const g=b.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let C of g)if(C=C.trim(),"#"===C[0]&&C.includes("if")&&!C.includes("endif")){C=C.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const I=C.split(" ");for(const P of I)u.includes(P)||u.push(P)}}function si(b,u){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,C=u.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),I={},P=[...Xs];return ci(b,P),ci(u,P),{fragmentSource:b=b.replace(g,(N,B,U,q,H)=>(I[H]=!0,"define"===B?`\n#ifndef HAS_UNIFORM_u_${H}\nvarying ${U} ${q} ${H};\n#else\nuniform ${U} ${q} u_${H};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${H}\n    ${U} ${q} ${H} = u_${H};\n#endif\n`)),vertexSource:u=u.replace(g,(N,B,U,q,H)=>{const J="float"===q?"vec2":"vec4",_e=H.match(/color/)?"color":J;return I[H]?"define"===B?`\n#ifndef HAS_UNIFORM_u_${H}\nuniform lowp float u_${H}_t;\nattribute ${U} ${J} a_${H};\nvarying ${U} ${q} ${H};\n#else\nuniform ${U} ${q} u_${H};\n#endif\n`:"vec4"===_e?`\n#ifndef HAS_UNIFORM_u_${H}\n    ${H} = a_${H};\n#else\n    ${U} ${q} ${H} = u_${H};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${H}\n    ${H} = unpack_mix_${_e}(a_${H}, u_${H}_t);\n#else\n    ${U} ${q} ${H} = u_${H};\n#endif\n`:"define"===B?`\n#ifndef HAS_UNIFORM_u_${H}\nuniform lowp float u_${H}_t;\nattribute ${U} ${J} a_${H};\n#else\nuniform ${U} ${q} u_${H};\n#endif\n`:"vec4"===_e?`\n#ifndef HAS_UNIFORM_u_${H}\n    ${U} ${q} ${H} = a_${H};\n#else\n    ${U} ${q} ${H} = u_${H};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${H}\n    ${U} ${q} ${H} = unpack_mix_${_e}(a_${H}, u_${H}_t);\n#else\n    ${U} ${q} ${H} = u_${H};\n#endif\n`}),staticAttributes:C,usedDefines:P}}class Wu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,g,C,I,P,N,B){this.context=u;let U=this.boundPaintVertexBuffers.length!==I.length;for(let H=0;!U&&H<I.length;H++)this.boundPaintVertexBuffers[H]!==I[H]&&(U=!0);let q=this.boundDynamicVertexBuffers.length!==B.length;for(let H=0;!q&&H<B.length;H++)this.boundDynamicVertexBuffers[H]!==B[H]&&(q=!0);if(!u.extVertexArrayObject||!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==C||U||q||this.boundIndexBuffer!==P||this.boundVertexOffset!==N)this.freshBind(g,C,I,P,N,B);else{u.bindVertexArrayOES.set(this.vao);for(const H of B)H&&H.bind();P&&P.dynamicDraw&&P.bind()}}freshBind(u,g,C,I,P,N){let B;const U=u.numAttributes,q=this.context,H=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),B=0,this.boundProgram=u,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=C,this.boundIndexBuffer=I,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=N;else{B=q.currentNumAttributes||0;for(let J=U;J<B;J++)H.disableVertexAttribArray(J)}g.enableAttributes(H,u),g.bind(),g.setVertexAttribPointers(H,u,P);for(const J of C)J.enableAttributes(H,u),J.bind(),J.setVertexAttribPointers(H,u,P);for(const J of N)J&&(J.enableAttributes(H,u),J.bind(),J.setVertexAttribPointers(H,u,P));I&&I.bind(),q.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function wa(b,u){const g=Math.pow(2,u.canonical.z),C=u.canonical.y;return[new m.MercatorCoordinate(0,C/g).toLngLat().lat,new m.MercatorCoordinate(0,(C+1)/g).toLngLat().lat]}function os(b,u,g,C,I,P,N){const B=b.context,U=B.gl,q=g.fbo;if(!q)return;b.prepareDrawTile();const H=b.useProgram("hillshade");B.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,q.colorAttachment.get());const J=((Pe,Le,ee,Se)=>{const Ge=ee.paint.get("hillshade-shadow-color"),We=ee.paint.get("hillshade-highlight-color"),ht=ee.paint.get("hillshade-accent-color");let ft=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ee.paint.get("hillshade-illumination-anchor")&&(ft-=Pe.transform.angle);const ut=!Pe.options.moving;return{u_matrix:Se||Pe.transform.calculateProjMatrix(Le.tileID.toUnwrapped(),ut),u_image:0,u_latrange:wa(0,Le.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),ft],u_shadow:Ge,u_highlight:We,u_accent:ht}})(b,g,C,b.terrain?u.projMatrix:null);b.prepareDrawProgram(B,H,u.toUnwrapped());const{tileBoundsBuffer:_e,tileBoundsIndexBuffer:Ce,tileBoundsSegments:Te}=b.getTileBoundsBuffers(g);H.draw(B,U.TRIANGLES,I,P,N,m.CullFaceMode.disabled,J,C.id,_e,Ce,Te)}function Ec(b,u,g){if(!u.needsDEMTextureUpload)return;const C=b.context,I=C.gl;C.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||b.getTileTexture(g.stride);const P=g.getPixels();u.demTexture?u.demTexture.update(P,{premultiply:!1}):u.demTexture=new m.Texture(C,P,I.RGBA,{premultiply:!1}),u.needsDEMTextureUpload=!1}function Gd(b,u,g,C,I,P){const N=b.context,B=N.gl;if(!u.dem)return;const U=u.dem;if(N.activeTexture.set(B.TEXTURE1),Ec(b,u,U),!u.demTexture)return;u.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);const q=U.dim;N.activeTexture.set(B.TEXTURE0);let H=u.fbo;if(!H){const Te=new m.Texture(N,{width:q,height:q,data:null},B.RGBA);Te.bind(B.LINEAR,B.CLAMP_TO_EDGE),H=u.fbo=N.createFramebuffer(q,q,!0),H.colorAttachment.set(Te.texture)}N.bindFramebuffer.set(H.framebuffer),N.viewport.set([0,0,q,q]);const{tileBoundsBuffer:J,tileBoundsIndexBuffer:_e,tileBoundsSegments:Ce}=b.getMercatorTileBoundsBuffers();b.useProgram("hillshadePrepare").draw(N,B.TRIANGLES,C,I,P,m.CullFaceMode.disabled,((Te,Pe)=>{const Le=Pe.stride,ee=m.create();return m.ortho(ee,0,m.EXTENT,-m.EXTENT,0,0,1),m.translate(ee,ee,[0,-m.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[Le,Le],u_zoom:Te.overscaledZ,u_unpack:Pe.unpackVector}})(u.tileID,U),g.id,J,_e,Ce),u.needsHillshadePrepare=!1}const Do=b=>({u_matrix:new m.UniformMatrix4f(b),u_image0:new m.Uniform1i(b),u_skirt_height:new m.Uniform1f(b)}),md=(b,u)=>({u_matrix:b,u_image0:0,u_skirt_height:u}),Er=(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te)=>({u_proj_matrix:Float32Array.from(b),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(C),u_merc_matrix:g,u_zoom_transition:I,u_merc_center:P,u_image0:0,u_frustum_tl:N,u_frustum_tr:B,u_frustum_br:U,u_frustum_bl:q,u_globe_pos:H,u_globe_radius:J,u_viewport:_e,u_grid_matrix:Te?Float32Array.from(Te):new Float32Array(9),u_skirt_height:Ce});function Fa(b,u){return null!=b&&null!=u&&!(!b.hasData()||!u.hasData())&&null!=b.demTexture&&null!=u.demTexture&&b.tileID.key!==u.tileID.key}const Dr=new class{constructor(){this.operations={}}newMorphing(b,u,g,C,I){if(b in this.operations){const P=this.operations[b];P.to.tileID.key!==g.tileID.key&&(P.queued=g)}else this.operations[b]={startTime:C,phase:0,duration:I,from:u,to:g,queued:null}}getMorphValuesForProxy(b){if(!(b in this.operations))return null;const u=this.operations[b];return{from:u.from,to:u.to,phase:u.phase}}update(b){for(const u in this.operations){const g=this.operations[u];for(g.phase=(b-g.startTime)/g.duration;g.phase>=1||!this._validOp(g);)if(!this._nextOp(g,b)){delete this.operations[u];break}}}_nextOp(b,u){return!!b.queued&&(b.from=b.to,b.to=b.queued,b.queued=null,b.phase=0,b.startTime=u,!0)}_validOp(b){return b.from.hasData()&&b.to.hasData()}},oc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function fa(b){return 6*Math.pow(1.5,22-b)}function ff(b,u){const g=1<<b.z;return!u&&(0===b.x||b.x===g-1)||0===b.y||b.y===g-1}const Ki=b=>({u_matrix:b});function Du(b,u,g,C,I){if(I>0){const P=m.exported.now(),N=(P-b.timeAdded)/I,B=u?(P-u.timeAdded)/I:-1,U=g.getSource(),q=C.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),H=!u||Math.abs(u.tileID.overscaledZ-q)>Math.abs(b.tileID.overscaledZ-q),J=H&&b.refreshedUponExpiration?1:m.clamp(H?N:1-B,0,1);return b.refreshedUponExpiration&&N>=1&&(b.refreshedUponExpiration=!1),u?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class To extends m.SourceCache{constructor(u){const g={type:"raster-dem",maxzoom:u.transform.maxZoom},C=new Re(Ll(),null),I=Fi("mock-dem",g,C,u.style);super("mock-dem",I,!1),I.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,g){u.state="loaded",g(null)}}class Zu extends m.SourceCache{constructor(u){const g=Fi("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new Re(Ll(),null),u.style);super("proxy",g,!1),g.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,g,C){if(u.freezeTileCoverage)return;this.transform=u;const I=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,N)=>{if(P[N.key]="",!this._tiles[N.key]){const B=new m.Tile(N,this._source.tileSize*N.overscaleFactor(),u.tileZoom);B.state="loaded",this._tiles[N.key]=B}return P},{});for(const P in this._tiles)P in I||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(u){const g=this.proxyCachedFBO[u];if(void 0!==g){const C=Object.values(g);this.renderCachePool.push(...C),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ea extends m.OverscaledTileID{constructor(u,g,C){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=g,this.projMatrix=C}}class Tu extends m.Elevation{constructor(u,g){super(),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[C,I,P]=function(U){const q=new m.StructArrayLayout2i4,H=new m.StructArrayLayout3ui6,J=131;q.reserve(17161),H.reserve(33800);const _e=m.EXTENT/128,Ce=m.EXTENT+_e/2,Te=Ce+_e;for(let Le=-_e;Le<Te;Le+=_e)for(let ee=-_e;ee<Te;ee+=_e){const Se=ee<0||ee>Ce||Le<0||Le>Ce?24575:0,Ge=m.clamp(Math.round(ee),0,m.EXTENT),We=m.clamp(Math.round(Le),0,m.EXTENT);q.emplaceBack(Ge+Se,We)}const Pe=(Le,ee)=>{const Se=ee*J+Le;H.emplaceBack(Se+1,Se,Se+J),H.emplaceBack(Se+J,Se+J+1,Se+1)};for(let Le=1;Le<129;Le++)for(let ee=1;ee<129;ee++)Pe(ee,Le);return[0,129].forEach(Le=>{for(let ee=0;ee<130;ee++)Pe(ee,Le),Pe(Le,ee)}),[q,H,32768]}(),N=u.context;this.gridBuffer=N.createVertexBuffer(C,m.posAttributes.members),this.gridIndexBuffer=N.createIndexBuffer(I),this.gridSegments=m.SegmentVector.simpleSegment(0,0,C.length,I.length),this.gridNoSkirtSegments=m.SegmentVector.simpleSegment(0,0,C.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Zu(g.map),this.orthoMatrix=m.create(),m.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,m.EXTENT,0,m.EXTENT,0,1);const B=N.gl;this._overlapStencilMode=new m.StencilMode({func:B.GEQUAL,mask:255},0,255,B.KEEP,B.KEEP,B.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=g,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new To(g.map)}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),u.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=u,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,g,C){if(u&&u.terrain){this._style!==u&&(this.style=u),this.enabled=!0;const I=u.terrain.properties;this.sourceCache=0===u.terrain.drapeRenderMode?this._mockSourceCache:u._getSourceCache(I.get("source")),this._exaggeration=I.get("exaggeration");const P=()=>{this.sourceCache.used&&m.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const N=this.getScaledDemTileSize();this.sourceCache.update(g,N,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,P(),this._initializing=!0),P(),g.updateElevation(!0,C),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(g),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const u=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==u.efficiency&&m.warnOnce(`Terrain render cache efficiency is not optimal (${u.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${u.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(u){u.coord&&"source"===u.dataType?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):"style"===u.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._sourceCaches)this._style._sourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const g=this.proxySourceCache,C=this.painter.transform;this._initializing&&(this._initializing=0===C._centerAltitude&&-1===this.getAtPointOrZero(m.MercatorCoordinate.fromLngLat(C.center),-1),this._emptyDEMTextureDirty=!this._initializing);const I=this.proxyCoords=g.getIds().map(U=>{const q=g.getTileByID(U).tileID;return q.projMatrix=C.calculateProjMatrix(q.toUnwrapped()),q});(function(U,q){const H=q.transform.pointCoordinate(q.transform.getCameraPoint()),J=new m.Point(H.x,H.y);U.sort((_e,Ce)=>{if(Ce.overscaledZ-_e.overscaledZ)return Ce.overscaledZ-_e.overscaledZ;const Te=new m.Point(_e.canonical.x+(1<<_e.canonical.z)*_e.wrap,_e.canonical.y),Pe=new m.Point(Ce.canonical.x+(1<<Ce.canonical.z)*Ce.wrap,Ce.canonical.y),Le=J.mult(1<<_e.canonical.z);return Le.x-=.5,Le.y-=.5,Le.distSqr(Te)-Le.distSqr(Pe)})})(I,this.painter),this._previousZoom=C.zoom;const P=this.proxyToSource||{};this.proxyToSource={},I.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const N=this._style._sourceCaches;for(const U in N){const q=N[U];if(!q.used||(q!==this.sourceCache&&this.resetTileLookupCache(q.id),this._setupProxiedCoordsForOrtho(q,u[U],P),q.usedForTerrain))continue;const H=u[U];q.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[g.id]=I.map(U=>new Ea(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(I),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1,this._updateTimestamp=m.exported.now();const B={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const q=this.terrainTileForTile[U.key];if(!q)continue;const H=q.tileID.key;H in B||(this._visibleDemTiles.push(q),B[H]=H)}}_assignTerrainTiles(u){this._initializing||u.forEach(g=>{if(this.terrainTileForTile[g.key])return;const C=this._findTileCoveringTileID(g,this.sourceCache);C&&(this.terrainTileForTile[g.key]=C)})}_prepareDEMTextures(){const u=this.painter.context,g=u.gl;for(const C in this.terrainTileForTile){const I=this.terrainTileForTile[C],P=I.dem;!P||I.demTexture&&!I.needsDEMTextureUpload||(u.activeTexture.set(g.TEXTURE1),Ec(this.painter,I,P))}}_prepareDemTileUniforms(u,g,C,I){if(!g||null==g.demTexture)return!1;const P=u.tileID.canonical,N=Math.pow(2,g.tileID.canonical.z-P.z),B=I||"";return C[`u_dem_tl${B}`]=[P.x*N%1,P.y*N%1],C[`u_dem_scale${B}`]=N,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const u=this.painter.context,g=u.gl;if(!this._emptyDepthBufferTexture){const C=new m.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new m.Texture(u,C,g.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let u=0;const g=this._visibleDemTiles.reduce((C,I)=>{if(!I.dem)return C;const P=I.dem.tree.minimums[0];return P>0&&u++,C+P},0);return u?g/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,g=u.gl;u.activeTexture.set(g.TEXTURE2);const C=this._getLoadedAreaMinimum(),I=new m.RGBAImage({width:1,height:1},new Uint8Array(m.DEMData.pack(C,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(I,{premultiply:!1}):P=this._emptyDEMTexture=new m.Texture(u,I,g.RGBA,{premultiply:!1}),P}setupElevationDraw(u,g,C){const I=this.painter.context,P=I.gl,N=(B=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:m.DEMData.getUnpackVector(B),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var B;N.u_dem_size=this.sourceCache.getSource().tileSize,N.u_exaggeration=this.exaggeration();let U=null,q=null,H=1;if(C&&C.morphing&&this._useVertexMorphing){const J=C.morphing.srcDemTile,_e=C.morphing.dstDemTile;H=C.morphing.phase,J&&_e&&(this._prepareDemTileUniforms(u,J,N,"_prev")&&(q=J),this._prepareDemTileUniforms(u,_e,N)&&(U=_e))}if(q&&U?(I.activeTexture.set(P.TEXTURE2),U.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),I.activeTexture.set(P.TEXTURE4),q.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE,P.NEAREST),N.u_dem_lerp=H):(U=this.terrainTileForTile[u.tileID.key],I.activeTexture.set(P.TEXTURE2),(this._prepareDemTileUniforms(u,U,N)?U.demTexture:this.emptyDEMTexture).bind(P.NEAREST,P.CLAMP_TO_EDGE)),I.activeTexture.set(P.TEXTURE3),C&&C.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),this._depthFBO&&(N.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),N.u_depth_size_inv=[1,1]),C&&C.useMeterToDem&&U){const J=(1<<U.tileID.canonical.z)*m.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;N.u_meter_to_dem=J}if(C&&C.labelPlaneMatrixInv&&(N.u_label_plane_matrix_inv=C.labelPlaneMatrixInv),g.setTerrainUniformValues(I,N),"globe"===this.painter.transform.projection.name){const J=this.globeUniformValues(this.painter.transform,u.tileID.canonical,C&&C.useDenormalizedUpVectorScale);g.setGlobeUniformValues(I,J)}}globeUniformValues(u,g,C){const I=u.projection;return{u_tile_tl_up:I.upVector(g,0,0),u_tile_tr_up:I.upVector(g,m.EXTENT,0),u_tile_br_up:I.upVector(g,m.EXTENT,m.EXTENT),u_tile_bl_up:I.upVector(g,0,m.EXTENT),u_tile_up_scale:C?m.globeMetersToEcef(1):I.upVectorScale(g,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const g=this.painter,C=this.painter.context;0!==u.length&&(C.bindFramebuffer.set(null),C.viewport.set([0,0,g.width,g.height]),g.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(I,P,N,B,U){if("globe"===I.transform.projection.name)!function(q,H,J,_e,Ce){const Te=q.context,Pe=Te.gl;let Le,ee;const Se=q.options.showTerrainWireframe?2:0,Ge=q.transform,We=m.globeUseCustomAntiAliasing(q,Te,Ge),ht=(xn,Bt)=>{if(ee===xn)return;const rn=[oc[xn],"PROJECTION_GLOBE_VIEW"];We&&rn.push("CUSTOM_ANTIALIASING"),Bt&&rn.push(oc[Se]),Le=q.useProgram("globeRaster",null,rn),ee=xn},ft=q.colorModeForRenderPass(),ut=new m.DepthMode(Pe.LEQUAL,m.DepthMode.ReadWrite,q.depthRangeFor3D);Dr.update(Ce);const St=m.calculateGlobeMercatorMatrix(Ge),bt=[m.mercatorXfromLng(Ge.center.lng),m.mercatorYfromLat(Ge.center.lat)],zt=Se?[!1,!0]:[!1],En=q.globeSharedBuffers,Pt=[Ge.width*m.exported.devicePixelRatio,Ge.height*m.exported.devicePixelRatio],sn=Float32Array.from(Ge.globeMatrix),Ht={useDenormalizedUpVectorScale:!0};if(zt.forEach(xn=>{const Bt=q.transform,rn=fa(Bt.zoom)*H.exaggeration();ee=-1;const wn=xn?Pe.LINES:Pe.TRIANGLES;for(const hn of _e){const Sn=J.getTile(hn),yi=m.StencilMode.disabled,$i=H.prevTerrainTileForTile[hn.key],ei=H.terrainTileForTile[hn.key];Fa($i,ei)&&Dr.newMorphing(hn.key,$i,ei,Ce,250),Te.activeTexture.set(Pe.TEXTURE0),Sn.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE);const ii=Dr.getMorphValuesForProxy(hn.key),fr=ii?1:0;ii&&m.extend$1(Ht,{morphing:{srcDemTile:ii.from,dstDemTile:ii.to,phase:m.easeCubicInOut(ii.phase)}});const pr=m.tileCornersToBounds(hn.canonical),di=m.getLatitudinalLod(pr.getCenter().lat),_o=m.getGridMatrix(hn.canonical,pr,di,Bt.worldSize/Bt._pixelsPerMercatorPixel),No=m.globeNormalizeECEF(m.globeTileBounds(hn.canonical)),$o=Er(Bt.projMatrix,sn,St,No,m.globeToMercatorTransition(Bt.zoom),bt,Bt.frustumCorners.TL,Bt.frustumCorners.TR,Bt.frustumCorners.BR,Bt.frustumCorners.BL,Bt.globeCenterInViewSpace,Bt.globeRadius,Pt,rn,_o);if(ht(fr,xn),H.setupElevationDraw(Sn,Le,Ht),q.prepareDrawProgram(Te,Le,hn.toUnwrapped()),En){const[Ao,Dl,vs]=xn?En.getWirefameBuffers(q.context,di):En.getGridBuffers(di,0!==rn);Le.draw(Te,wn,ut,yi,ft,m.CullFaceMode.backCCW,$o,"globe_raster",Ao,Dl,vs)}}}),En){const xn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];We&&xn.push("CUSTOM_ANTIALIASING"),Le=q.useProgram("globeRaster",null,xn);for(const Bt of _e){const{x:rn,y:wn,z:hn}=Bt.canonical,Sn=0===wn,yi=wn===(1<<hn)-1,[$i,ei,ii,fr]=En.getPoleBuffers(hn);if(fr&&(Sn||yi)){const pr=J.getTile(Bt);Te.activeTexture.set(Pe.TEXTURE0),pr.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE);let di=m.globePoleMatrixForTile(hn,rn,Ge);const _o=m.globeNormalizeECEF(m.globeTileBounds(Bt.canonical)),No=($o,Ao)=>$o.draw(Te,Pe.TRIANGLES,ut,m.StencilMode.disabled,ft,m.CullFaceMode.disabled,Er(Ge.projMatrix,di,di,_o,0,bt,Ge.frustumCorners.TL,Ge.frustumCorners.TR,Ge.frustumCorners.BR,Ge.frustumCorners.BL,Ge.globeCenterInViewSpace,Ge.globeRadius,Pt,0),"globe_pole_raster",Ao,ii,fr);H.setupElevationDraw(pr,Le,Ht),q.prepareDrawProgram(Te,Le,Bt.toUnwrapped()),Sn&&No(Le,$i),yi&&(di=m.scale(m.create(),di,[1,-1,1]),No(Le,ei))}}}}(I,P,N,B,U);else{const q=I.context,H=q.gl;let J,_e;const Ce=I.options.showTerrainWireframe?2:0,Te=(Ge,We)=>{if(_e===Ge)return;const ht=[oc[Ge]];We&&ht.push(oc[Ce]),J=I.useProgram("terrainRaster",null,ht),_e=Ge},Pe=I.colorModeForRenderPass(),Le=new m.DepthMode(H.LEQUAL,m.DepthMode.ReadWrite,I.depthRangeFor3D);Dr.update(U);const ee=I.transform,Se=fa(ee.zoom)*P.exaggeration();(Ce?[!1,!0]:[!1]).forEach(Ge=>{_e=-1;const We=Ge?H.LINES:H.TRIANGLES,[ht,ft]=Ge?P.getWirefameBuffer():[P.gridIndexBuffer,P.gridSegments];for(const ut of B){const St=N.getTile(ut),bt=m.StencilMode.disabled,zt=P.prevTerrainTileForTile[ut.key],En=P.terrainTileForTile[ut.key];Fa(zt,En)&&Dr.newMorphing(ut.key,zt,En,U,250),q.activeTexture.set(H.TEXTURE0),St.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);const Pt=Dr.getMorphValuesForProxy(ut.key),sn=Pt?1:0;let Ht;Pt&&(Ht={morphing:{srcDemTile:Pt.from,dstDemTile:Pt.to,phase:m.easeCubicInOut(Pt.phase)}});const xn=md(ut.projMatrix,ff(ut.canonical,ee.renderWorldCopies)?Se/10:Se);Te(sn,Ge),P.setupElevationDraw(St,J,Ht),I.prepareDrawProgram(q,J,ut.toUnwrapped()),J.draw(q,We,Le,bt,Pe,m.CullFaceMode.backCCW,xn,"terrain_raster",P.gridBuffer,ht,ft)}})}}(g,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,g.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(0===this._drapedRenderBatches.length)return u+1;this.renderingToTexture=!0;const g=this.painter,C=this.painter.context,I=this.proxySourceCache,P=this.proxiedCoords[I.id],N=this._drapedRenderBatches.shift(),B=[],U=g.style.order;let q=0;for(const H of P){const J=I.getTileByID(H.proxyTileKey),_e=I.proxyCachedFBO[H.key]?I.proxyCachedFBO[H.key][u]:void 0,Ce=void 0!==_e?I.renderCache[_e]:this.pool[q++],Te=void 0!==_e;if(J.texture=Ce.tex,Te&&!Ce.dirty){B.push(J.tileID);continue}let Pe;C.bindFramebuffer.set(Ce.fb.framebuffer),this.renderedToTile=!1,Ce.dirty&&(C.clear({color:m.Color.transparent,stencil:0}),Ce.dirty=!1);for(let Le=N.start;Le<=N.end;++Le){const ee=g.style._layers[U[Le]];if(ee.isHidden(g.transform.zoom))continue;const Se=g.style._getLayerSourceCache(ee),Ge=Se?this.proxyToSource[H.key][Se.id]:[H];if(!Ge)continue;const We=Ge;C.viewport.set([0,0,Ce.fb.width,Ce.fb.height]),Pe!==(Se?Se.id:null)&&(this._setupStencil(Ce,Ge,ee,Se),Pe=Se?Se.id:null),g.renderLayer(g,Se,ee,We)}this.renderedToTile?(Ce.dirty=!0,B.push(J.tileID)):Te||--q,5===q&&(q=0,this.renderToBackBuffer(B))}return this.renderToBackBuffer(B),this.renderingToTexture=!1,C.bindFramebuffer.set(null),C.viewport.set([0,0,g.width,g.height]),N.end+1}postRender(){}renderCacheEfficiency(u){const g=u.order.length;if(0===g)return{efficiency:100};let C,I=0,P=0,N=!1;for(let B=0;B<g;++B){const U=u._layers[u.order[B]];this._style.isLayerDraped(U)?(N&&++I,++P):N||(N=!0,C=U.id)}return 0===P?{efficiency:100}:{efficiency:100*(1-I/P),firstUndrapedLayer:C}}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(g=>g.dem).forEach(g=>{u=Math.min(u,g.dem.tree.minimums[0])}),0===u?u:(u-30)*this._exaggeration}raycast(u,g,C){if(!this._visibleDemTiles)return null;const I=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const N=P.tileID,B=1<<N.overscaledZ,{x:U,y:q}=N.canonical,H=U/B,J=(U+1)/B,_e=q/B,Ce=(q+1)/B;return{minx:H,miny:_e,maxx:J,maxy:Ce,t:P.dem.tree.raycastRoot(H,_e,J,Ce,u,g,C),tile:P}});I.sort((P,N)=>(null!==P.t?P.t:Number.MAX_VALUE)-(null!==N.t?N.t:Number.MAX_VALUE));for(const P of I){if(null==P.t)return null;const N=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,u,g,C);if(null!=N)return N}return null}_createFBO(){const u=this.painter.context,g=u.gl,C=this.drapeBufferSize;u.activeTexture.set(g.TEXTURE0);const I=new m.Texture(u,{width:C[0],height:C[1],data:null},g.RGBA);I.bind(g.LINEAR,g.CLAMP_TO_EDGE);const P=u.createFramebuffer(C[0],C[1],!1);return P.colorAttachment.set(I.texture),P.depthAttachment=new Ye(u,P.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,C[0],C[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&!u.extTextureFilterAnisotropicForceOff&&g.texParameterf(g.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:P,tex:I,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const g=this._style._layers[u],C=g.isHidden(this.painter.transform.zoom);return"custom"===g.type?!C&&g.shouldRedrape():!C&&g.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const C of this._style._getSources())if(C instanceof Dn){u=!0;break}if(!u)return;const g={};for(let C=0;C<this._style.order.length;++C){const I=this._style._layers[this._style.order[C]],P=this._style._getLayerSourceCache(I);if(P&&!g[P.id]&&!I.isHidden(this.painter.transform.zoom)&&"line"===I.type&&I.widthExpression()instanceof m.ZoomDependentExpression){g[P.id]=!0;for(const N of this.proxyCoords){const B=this.proxyToSource[N.key][P.id];if(B)for(const U of B)this._clearRenderCacheForTile(P.id,U)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const C in this._style._sourceCaches)if(this._style._sourceCaches[C]._source instanceof yn){u=!0;break}if(!u)return;const g={};for(let C=0;C<this._style.order.length;++C){const I=this._style._layers[this._style.order[C]],P=this._style._getLayerSourceCache(I);if(!P||g[P.id]||I.isHidden(this.painter.transform.zoom)||"raster"!==I.type)continue;const N=I.paint.get("raster-fade-duration");for(const B of this.proxyCoords){const U=this.proxyToSource[B.key][P.id];if(U)for(const q of U){const H=Du(P.getTile(q),P.findLoadedParent(q,0),P,this.painter.transform,N);(1!==H.opacity||0!==H.mix)&&this._clearRenderCacheForTile(P.id,q)}}}}_setupDrapedRenderBatches(){const u=this._style.order,g=u.length;if(0===g)return;const C=[];let I,P=0,N=this._style._layers[u[P]];for(;!this._style.isLayerDraped(N)&&N.isHidden(this.painter.transform.zoom)&&++P<g;)N=this._style._layers[u[P]];for(;P<g;++P){const B=this._style._layers[u[P]];B.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(B)?void 0===I&&(I=P):void 0!==I&&(C.push({start:I,end:P-1}),I=void 0))}void 0!==I&&C.push({start:I,end:P-1}),this._drapedRenderBatches=C}_setupRenderCache(u){const g=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,g.renderCache.length>g.renderCachePool.length){const N=Object.values(g.proxyCachedFBO);g.proxyCachedFBO={};for(let B=0;B<N.length;++B){const U=Object.values(N[B]);g.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const C=this.proxyCoords,I=this._tilesDirty;for(let N=C.length-1;N>=0;N--){const B=C[N];if(g.getTileByID(B.key),void 0!==g.proxyCachedFBO[B.key]){const U=u[B.key],q=this.proxyToSource[B.key];let H=0;for(const J in q){const _e=q[J],Ce=U[J];if(!Ce||Ce.length!==_e.length||_e.some((Te,Pe)=>Te!==Ce[Pe]||I[J]&&I[J].hasOwnProperty(Te.key))){H=-1;break}++H}for(const J in g.proxyCachedFBO[B.key])g.renderCache[g.proxyCachedFBO[B.key][J]].dirty=H<0||H!==Object.values(U).length}}const P=[...this._drapedRenderBatches];P.sort((N,B)=>B.end-B.start-(N.end-N.start));for(const N of P)for(const B of C){if(g.proxyCachedFBO[B.key])continue;let U=g.renderCachePool.pop();void 0===U&&g.renderCache.length<50&&(U=g.renderCache.length,g.renderCache.push(this._createFBO())),void 0!==U&&(g.proxyCachedFBO[B.key]={},g.proxyCachedFBO[B.key][N.start]=U,g.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(u,g,C,I){if(!I||!this._sourceTilesOverlap[I.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,N=P.gl;if(g.length<=1)return void(this._overlapStencilType=!1);let B;if(C.isTileClipped())B=g.length,this._overlapStencilMode.test={func:N.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(g[0].overscaledZ>g[g.length-1].overscaledZ))return void(this._overlapStencilType=!1);B=1,this._overlapStencilMode.test={func:N.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+B>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=B,this._overlapStencilMode.ref=this._stencilRef,C.isTileClipped()&&this._renderTileClippingMasks(g,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):m.StencilMode.disabled}_renderTileClippingMasks(u,g){const C=this.painter,I=this.painter.context,P=I.gl;C._tileClippingMaskIDs={},I.setColorMode(m.ColorMode.disabled),I.setDepthMode(m.DepthMode.disabled);const N=C.useProgram("clippingMask");for(const B of u){const U=C._tileClippingMaskIDs[B.key]=--g;N.draw(I,P.TRIANGLES,m.DepthMode.disabled,new m.StencilMode({func:P.ALWAYS,mask:0},U,255,P.KEEP,P.KEEP,P.REPLACE),m.ColorMode.disabled,m.CullFaceMode.disabled,Ki(B.projMatrix),"$clipping",C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}pointCoordinate(u){const g=this.painter.transform;if(u.x<0||u.x>g.width||u.y<0||u.y>g.height)return null;const C=[u.x,u.y,1,1];m.transformMat4$1(C,C,g.pixelMatrixInverse),m.scale$1(C,C,1/C[3]),C[0]/=g.worldSize,C[1]/=g.worldSize;const I=g._camera.position,P=m.mercatorZfromAltitude(1,g.center.lat),N=[I[0],I[1],I[2]/P,0],B=m.subtract([],C.slice(0,3),N);m.normalize(B,B);const U=this.raycast(N,B,this._exaggeration);return null!==U&&U?(m.scaleAndAdd(N,N,B,U),N[3]=N[2],N[2]*=P,N):null}drawDepth(){const u=this.painter,g=u.context,C=this.proxySourceCache,I=Math.ceil(u.width),P=Math.ceil(u.height);if(!this._depthFBO||this._depthFBO.width===I&&this._depthFBO.height===P||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const N=g.gl,B=g.createFramebuffer(I,P,!0);g.activeTexture.set(N.TEXTURE0);const U=new m.Texture(g,{width:I,height:P,data:null},N.RGBA);U.bind(N.NEAREST,N.CLAMP_TO_EDGE),B.colorAttachment.set(U.texture);const q=g.createRenderbuffer(g.gl.DEPTH_COMPONENT16,I,P);B.depthAttachment.set(q),this._depthFBO=B,this._depthTexture=U}g.bindFramebuffer.set(this._depthFBO.framebuffer),g.viewport.set([0,0,I,P]),function(N,B,U,q){if("globe"===N.transform.projection.name)return;const H=N.context,J=H.gl;H.clear({depth:1});const _e=N.useProgram("terrainDepth"),Ce=new m.DepthMode(J.LESS,m.DepthMode.ReadWrite,N.depthRangeFor3D);for(const Te of q){const Pe=U.getTile(Te),Le=md(Te.projMatrix,0);B.setupElevationDraw(Pe,_e),_e.draw(H,J.TRIANGLES,Ce,m.StencilMode.disabled,m.ColorMode.unblended,m.CullFaceMode.backCCW,Le,"terrain_depth",B.gridBuffer,B.gridIndexBuffer,B.gridNoSkirtSegments)}}(u,this,C,this.proxyCoords)}_setupProxiedCoordsForOrtho(u,g,C){if(u.getSource()instanceof Yi)return this._setupProxiedCoordsForImageSource(u,g,C);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const I=this.proxiedCoords[u.id]=[],P=this.proxyCoords;for(let B=0;B<P.length;B++){const U=P[B],q=this._findTileCoveringTileID(U,u);if(q){const H=this._createProxiedId(U,q,C[U.key]&&C[U.key][u.id]);I.push(H),this.proxyToSource[U.key][u.id]=[H]}}let N=!1;for(let B=0;B<g.length;B++){const U=u.getTile(g[B]);if(!U||!U.hasData())continue;const q=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(q&&q.tileID.canonical.z!==U.tileID.canonical.z){const H=this.proxyToSource[q.tileID.key][u.id],J=this._createProxiedId(q.tileID,U,C[q.tileID.key]&&C[q.tileID.key][u.id]);H?H.splice(H.length-1,0,J):this.proxyToSource[q.tileID.key][u.id]=[J],I.push(J),N=!0}}this._sourceTilesOverlap[u.id]=N}_setupProxiedCoordsForImageSource(u,g,C){if(!u.getSource().loaded())return;const I=this.proxiedCoords[u.id]=[],P=this.proxyCoords,N=u.getSource(),B=new m.Point(N.tileID.x,N.tileID.y)._div(1<<N.tileID.z),U=N.coordinates.map(m.MercatorCoordinate.fromLngLat).reduce((H,J)=>(H.min.x=Math.min(H.min.x,J.x-B.x),H.min.y=Math.min(H.min.y,J.y-B.y),H.max.x=Math.max(H.max.x,J.x-B.x),H.max.y=Math.max(H.max.y,J.y-B.y),H),{min:new m.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new m.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),q=(H,J)=>{const _e=H.wrap+H.canonical.x/(1<<H.canonical.z),Ce=H.canonical.y/(1<<H.canonical.z),Te=m.EXTENT/(1<<H.canonical.z),Pe=J.wrap+J.canonical.x/(1<<J.canonical.z),Le=J.canonical.y/(1<<J.canonical.z);return _e+Te<Pe+U.min.x||_e>Pe+U.max.x||Ce+Te<Le+U.min.y||Ce>Le+U.max.y};for(let H=0;H<P.length;H++){const J=P[H];for(let _e=0;_e<g.length;_e++){const Ce=u.getTile(g[_e]);if(!Ce||!Ce.hasData()||q(J,Ce.tileID))continue;const Te=this._createProxiedId(J,Ce,C[J.key]&&C[J.key][u.id]),Pe=this.proxyToSource[J.key][u.id];Pe?Pe.push(Te):this.proxyToSource[J.key][u.id]=[Te],I.push(Te)}}}_createProxiedId(u,g,C){let I=this.orthoMatrix;if(C){const P=C.find(N=>N.key===g.tileID.key);if(P)return P}if(g.tileID.key!==u.key){const P=u.canonical.z-g.tileID.canonical.z;let N,B,U;I=m.create();const q=g.tileID.wrap-u.wrap<<u.overscaledZ;P>0?(N=m.EXTENT>>P,B=N*((g.tileID.canonical.x<<P)-u.canonical.x+q),U=N*((g.tileID.canonical.y<<P)-u.canonical.y)):(N=m.EXTENT<<-P,B=m.EXTENT*(g.tileID.canonical.x-(u.canonical.x+q<<-P)),U=m.EXTENT*(g.tileID.canonical.y-(u.canonical.y<<-P))),m.ortho(I,0,N,0,N,0,1),m.translate(I,I,[B,U,0])}return new Ea(g.tileID,u.key,I)}_findTileCoveringTileID(u,g){let C=g.getTile(u);if(C&&C.hasData())return C;const I=this._findCoveringTileCache[g.id],P=I[u.key];if(C=P?g.getTileByID(P):null,C&&C.hasData()||null===P)return C;let N=C?C.tileID:u,B=N.overscaledZ;const U=g.getSource().minzoom,q=[];if(!P){const J=g.getSource().maxzoom;if(u.canonical.z>=J){const _e=u.canonical.z-J;g.getSource().reparseOverscaled?(B=Math.max(u.canonical.z+2,g.transform.tileZoom),N=new m.OverscaledTileID(B,u.wrap,J,u.canonical.x>>_e,u.canonical.y>>_e)):0!==_e&&(B=J,N=new m.OverscaledTileID(B,u.wrap,J,u.canonical.x>>_e,u.canonical.y>>_e))}N.key!==u.key&&(q.push(N.key),C=g.getTile(N))}const H=J=>{q.forEach(_e=>{I[_e]=J}),q.length=0};for(B-=1;B>=U&&(!C||!C.hasData());B--){C&&H(C.tileID.key);const J=N.calculateScaledKey(B);if(C=g.getTileByID(J),C&&C.hasData())break;const _e=I[J];if(null===_e)break;void 0===_e?q.push(J):C=g.getTileByID(_e)}return H(C?C.tileID.key:null),C&&C.hasData()?C:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,g){let C=this._tilesDirty[u];C||(C=this._tilesDirty[u]={}),C[g.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const u=function(g){let C=0;const I=new m.StructArrayLayout2ui4,P=131;for(let N=1;N<129;N++){for(let B=1;B<129;B++)C=N*P+B,I.emplaceBack(C,C+1),I.emplaceBack(C,C+P),I.emplaceBack(C+1,C+P),128===N&&I.emplaceBack(C+P,C+P+1);I.emplaceBack(C+1,C+1+P)}return I}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(u),this.wireframeSegments=m.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,u.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class hr{static cacheKey(u,g,C,I){let P=`${g}${I?I.cacheKey:""}`;for(const N of C)u.usedDefines.includes(N)&&(P+=`/${N}`);return P}constructor(u,g,C,I,P,N){const B=u.gl;this.program=B.createProgram();const U=function(ee){const Se=[];for(let Ge=0;Ge<ee.length;Ge++){if(null===ee[Ge])continue;const We=ee[Ge].split(" ");Se.push(We.pop())}return Se}(C.staticAttributes),q=I?I.getBinderAttributes():[],H=U.concat(q);let J=I?I.defines():[];J=J.concat(N.map(ee=>`#define ${ee}`));const _e=u.isWebGL2?"#version 300 es\n":"",Ce=_e+J.concat(u.extStandardDerivatives&&0===_e.length?"#extension GL_OES_standard_derivatives : enable\n".concat(tu):tu,tu,Na,wc.fragmentSource,sl.fragmentSource,C.fragmentSource).join("\n"),Te=_e+J.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Na,wc.vertexSource,sl.vertexSource,ha.vertexSource,C.vertexSource).join("\n"),Pe=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(Pe,Ce),B.compileShader(Pe),B.attachShader(this.program,Pe);const Le=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(Le,Te),B.compileShader(Le),B.attachShader(this.program,Le),this.attributes={},this.numAttributes=H.length;for(let ee=0;ee<this.numAttributes;ee++)H[ee]&&(B.bindAttribLocation(this.program,ee,H[ee]),this.attributes[H[ee]]=ee);B.linkProgram(this.program),B.deleteShader(Le),B.deleteShader(Pe),this.fixedUniforms=P(u),this.binderUniforms=I?I.getUniforms(u):[],N.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new m.Uniform1i(ee=u),u_dem_prev:new m.Uniform1i(ee),u_dem_unpack:new m.Uniform4f(ee),u_dem_tl:new m.Uniform2f(ee),u_dem_scale:new m.Uniform1f(ee),u_dem_tl_prev:new m.Uniform2f(ee),u_dem_scale_prev:new m.Uniform1f(ee),u_dem_size:new m.Uniform1f(ee),u_dem_lerp:new m.Uniform1f(ee),u_exaggeration:new m.Uniform1f(ee),u_depth:new m.Uniform1i(ee),u_depth_size_inv:new m.Uniform2f(ee),u_meter_to_dem:new m.Uniform1f(ee),u_label_plane_matrix_inv:new m.UniformMatrix4f(ee)}),N.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new m.Uniform3f(ee),u_tile_tr_up:new m.Uniform3f(ee),u_tile_br_up:new m.Uniform3f(ee),u_tile_bl_up:new m.Uniform3f(ee),u_tile_up_scale:new m.Uniform1f(ee)}))(u)),N.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new m.UniformMatrix4f(ee),u_fog_range:new m.Uniform2f(ee),u_fog_color:new m.Uniform4f(ee),u_fog_horizon_blend:new m.Uniform1f(ee),u_fog_temporal_offset:new m.Uniform1f(ee),u_frustum_tl:new m.Uniform3f(ee),u_frustum_tr:new m.Uniform3f(ee),u_frustum_br:new m.Uniform3f(ee),u_frustum_bl:new m.Uniform3f(ee),u_globe_pos:new m.Uniform3f(ee),u_globe_radius:new m.Uniform1f(ee),u_globe_transition:new m.Uniform1f(ee),u_is_globe:new m.Uniform1i(ee),u_viewport:new m.Uniform2f(ee)}))(u))}var ee}setTerrainUniformValues(u,g){if(!this.terrainUniforms)return;const C=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in g)C[I]&&C[I].set(this.program,I,g[I])}}setGlobeUniformValues(u,g){if(!this.globeUniforms)return;const C=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in g)C[I]&&C[I].set(this.program,I,g[I])}}setFogUniformValues(u,g){if(!this.fogUniforms)return;const C=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in g)C[I].set(this.program,I,g[I])}}draw(u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe){const Le=u.gl;if(this.failedToCreate)return;u.program.set(this.program),u.setDepthMode(C),u.setStencilMode(I),u.setColorMode(P),u.setCullFace(N);for(const Se of Object.keys(this.fixedUniforms))this.fixedUniforms[Se].set(this.program,Se,B[Se]);Te&&Te.setUniforms(this.program,u,this.binderUniforms,_e,{zoom:Ce});const ee={[Le.LINES]:2,[Le.TRIANGLES]:3,[Le.LINE_STRIP]:1}[g];for(const Se of J.get()){const Ge=Se.vaos||(Se.vaos={});(Ge[U]||(Ge[U]=new Wu)).bind(u,this,q,Te?Te.getPaintVertexBuffers():[],H,Se.vertexOffset,Pe||[]),Le.drawElements(g,Se.primitiveLength*ee,Le.UNSIGNED_SHORT,Se.primitiveOffset*ee*2)}}}function wl(b,u){const g=Math.pow(2,u.tileID.overscaledZ),C=u.tileSize*Math.pow(2,b.transform.tileZoom)/g,I=C*(u.tileID.canonical.x+u.tileID.wrap*g),P=C*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_tile_units_to_pixels:1/it(u,1,b.transform.tileZoom),u_pixel_coord_upper:[I>>16,P>>16],u_pixel_coord_lower:[65535&I,65535&P]}}const gr=m.create(),Ya=(b,u,g,C,I,P,N,B,U,q,H)=>{const J=u.style.light,_e=J.properties.get("position"),Ce=[_e.x,_e.y,_e.z],Te=m.create$1();"viewport"===J.properties.get("anchor")&&(m.fromRotation(Te,-u.transform.angle),m.transformMat3(Ce,Ce,Te));const Pe=J.properties.get("color"),Le=u.transform,ee={u_matrix:b,u_lightpos:Ce,u_lightintensity:J.properties.get("intensity"),u_lightcolor:[Pe.r,Pe.g,Pe.b],u_vertical_gradient:+g,u_opacity:C,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gr,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:I,u_edge_radius:P};return"globe"===Le.projection.name&&(ee.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],ee.u_zoom_transition=U,ee.u_inv_rot_matrix=H,ee.u_merc_center=q,ee.u_up_dir=Le.projection.upVector(new m.CanonicalTileID(0,0,0),q[0]*m.EXTENT,q[1]*m.EXTENT),ee.u_height_lift=B),ee},Xu=(b,u,g,C,I,P,N,B,U,q,H,J)=>{const _e=Ya(b,u,g,C,I,P,N,U,q,H,J),Ce={u_height_factor:-Math.pow(2,N.overscaledZ)/B.tileSize/8};return m.extend(_e,wl(u,B),Ce)},Ba=b=>({u_matrix:b}),Da=(b,u,g)=>m.extend(Ba(b),wl(u,g)),Ss=(b,u)=>({u_matrix:b,u_world:u}),dm=(b,u,g,C)=>m.extend(Da(b,u,g),{u_world:C}),nu=m.create(),Cc=(b,u,g,C,I,P)=>{const N=b.transform,B="globe"===N.projection.name;let U;if("map"===P.paint.get("circle-pitch-alignment"))if(B){const H=m.globePixelsToTileUnits(N.zoom,u.canonical)*N._pixelsPerMercatorPixel;U=Float32Array.from([H,0,0,H])}else U=N.calculatePixelsToTileUnitsMatrix(g);else U=new Float32Array([N.pixelsToGLUnits[0],0,0,N.pixelsToGLUnits[1]]);const q={u_camera_to_center_distance:N.cameraToCenterDistance,u_matrix:b.translatePosMatrix(u.projMatrix,g,P.paint.get("circle-translate"),P.paint.get("circle-translate-anchor")),u_device_pixel_ratio:m.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:nu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){q.u_inv_rot_matrix=C,q.u_merc_center=I,q.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],q.u_zoom_transition=m.globeToMercatorTransition(N.zoom);const H=I[0]*m.EXTENT,J=I[1]*m.EXTENT;q.u_up_dir=N.projection.upVector(new m.CanonicalTileID(0,0,0),H,J)}return q},Dt=b=>{const u=[];return"map"===b.paint.get("circle-pitch-alignment")&&u.push("PITCH_WITH_MAP"),"map"===b.paint.get("circle-pitch-scale")&&u.push("SCALE_WITH_MAP"),u},Sc=(b,u,g,C)=>{const I=m.EXTENT/g.tileSize;return{u_matrix:b,u_camera_to_center_distance:u.getCameraToCenterDistance(C),u_extrude_scale:[u.pixelsToGLUnits[0]/I,u.pixelsToGLUnits[1]/I]}},Rn=(b,u,g=1)=>({u_matrix:b,u_color:u,u_overlay:0,u_overlay_scale:g}),Ka=m.create(),El=(b,u,g,C,I,P,N)=>{const B=b.transform,U="globe"===B.projection.name,q=U?m.globePixelsToTileUnits(B.zoom,u.canonical)*B._pixelsPerMercatorPixel:it(g,1,P),H={u_matrix:u.projMatrix,u_extrude_scale:q,u_intensity:N,u_inv_rot_matrix:Ka,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){H.u_inv_rot_matrix=C,H.u_merc_center=I,H.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],H.u_zoom_transition=m.globeToMercatorTransition(B.zoom);const J=I[0]*m.EXTENT,_e=I[1]*m.EXTENT;H.u_up_dir=B.projection.upVector(new m.CanonicalTileID(0,0,0),J,_e)}return H},sc=(b,u,g,C,I,P,N)=>{const B=b.transform,U=B.calculatePixelsToTileUnitsMatrix(u);return{u_matrix:vh(b,u,g,C),u_pixels_to_tile_units:U,u_device_pixel_ratio:P,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:I,u_texsize:Qa(g)?u.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ms(u,b.transform),u_alpha_discard_threshold:0,u_trim_offset:N}},Cl=(b,u,g,C,I)=>{const P=b.transform;return{u_matrix:vh(b,u,g,C),u_texsize:u.imageAtlasTexture.size,u_pixels_to_tile_units:P.calculatePixelsToTileUnitsMatrix(u),u_device_pixel_ratio:I,u_image:0,u_tile_units_to_pixels:ms(u,P),u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ms(b,u){return 1/it(b,1,u.tileZoom)}function vh(b,u,g,C){return b.translatePosMatrix(C||u.tileID.projMatrix,u,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}function Qa(b){const u=b.paint.get("line-dasharray").value;return u.value||"constant"!==u.kind}const Ps=(b,u,g,C,I,P)=>{return{u_matrix:b,u_tl_parent:u,u_scale_parent:g,u_fade_t:C.mix,u_opacity:C.opacity*I.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:I.paint.get("raster-brightness-min"),u_brightness_high:I.paint.get("raster-brightness-max"),u_saturation_factor:(B=I.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(N=I.paint.get("raster-contrast"),N>0?1/(1-N):1+N),u_spin_weights:Lo(I.paint.get("raster-hue-rotate")),u_perspective_transform:P};var N,B};function Lo(b){b*=Math.PI/180;const u=Math.sin(b),g=Math.cos(b);return[(2*g+1)/3,(-Math.sqrt(3)*u-g+1)/3,(Math.sqrt(3)*u-g+1)/3]}const Ms=m.create(),Rr=(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe)=>{const Le=I.transform,ee={u_is_size_zoom_constant:+("constant"===b||"source"===b),u_is_size_feature_constant:+("constant"===b||"camera"===b),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:Le.cameraToCenterDistance,u_rotate_symbol:+g,u_aspect_ratio:Le.width/Le.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:N,u_coord_matrix:B,u_is_text:+U,u_pitch_with_map:+C,u_texsize:q,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ms,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ms,u_up_vector:[0,-1,0]};return"globe"===Pe.name&&(ee.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],ee.u_zoom_transition=J,ee.u_inv_rot_matrix=Ce,ee.u_merc_center=_e,ee.u_camera_forward=Le._camera.forward(),ee.u_ecef_origin=m.globeECEFOrigin(Le.globeMatrix,H.toUnwrapped()),ee.u_tile_matrix=Float32Array.from(Le.globeMatrix),ee.u_up_vector=Te),ee},Rs=(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe,Le)=>m.extend(Rr(b,u,g,C,I,P,N,B,U,q,J,_e,Ce,Te,Pe,Le),{u_gamma_scale:C?I.transform.cameraToCenterDistance*Math.cos(I.terrain?0:I.transform._pitch):1,u_device_pixel_ratio:m.exported.devicePixelRatio,u_is_halo:+H}),$d=(b,u,g,C,I,P,N,B,U,q,H,J,_e,Ce,Te,Pe)=>m.extend(Rs(b,u,g,C,I,P,N,B,!0,U,!0,H,J,_e,Ce,Te,Pe),{u_texsize_icon:q,u_texture_icon:1}),iu=(b,u,g)=>({u_matrix:b,u_opacity:u,u_color:g}),Yu=(b,u,g,C,I)=>m.extend(function(P,N,B){const U=N.imageManager.getPattern(P.toString()),{width:q,height:H}=N.imageManager.getPixelSize(),J=Math.pow(2,B.tileID.overscaledZ),_e=B.tileSize*Math.pow(2,N.transform.tileZoom)/J,Ce=_e*(B.tileID.canonical.x+B.tileID.wrap*J),Te=_e*B.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[q,H],u_pattern_size:U.displaySize,u_tile_units_to_pixels:1/it(B,1,N.transform.tileZoom),u_pixel_coord_upper:[Ce>>16,Te>>16],u_pixel_coord_lower:[65535&Ce,65535&Te]}}(C,g,I),{u_matrix:b,u_opacity:u}),ac={fillExtrusion:b=>({u_matrix:new m.UniformMatrix4f(b),u_lightpos:new m.Uniform3f(b),u_lightintensity:new m.Uniform1f(b),u_lightcolor:new m.Uniform3f(b),u_vertical_gradient:new m.Uniform1f(b),u_opacity:new m.Uniform1f(b),u_edge_radius:new m.Uniform1f(b),u_ao:new m.Uniform2f(b),u_tile_id:new m.Uniform3f(b),u_zoom_transition:new m.Uniform1f(b),u_inv_rot_matrix:new m.UniformMatrix4f(b),u_merc_center:new m.Uniform2f(b),u_up_dir:new m.Uniform3f(b),u_height_lift:new m.Uniform1f(b)}),fillExtrusionPattern:b=>({u_matrix:new m.UniformMatrix4f(b),u_lightpos:new m.Uniform3f(b),u_lightintensity:new m.Uniform1f(b),u_lightcolor:new m.Uniform3f(b),u_vertical_gradient:new m.Uniform1f(b),u_height_factor:new m.Uniform1f(b),u_edge_radius:new m.Uniform1f(b),u_ao:new m.Uniform2f(b),u_tile_id:new m.Uniform3f(b),u_zoom_transition:new m.Uniform1f(b),u_inv_rot_matrix:new m.UniformMatrix4f(b),u_merc_center:new m.Uniform2f(b),u_up_dir:new m.Uniform3f(b),u_height_lift:new m.Uniform1f(b),u_image:new m.Uniform1i(b),u_texsize:new m.Uniform2f(b),u_pixel_coord_upper:new m.Uniform2f(b),u_pixel_coord_lower:new m.Uniform2f(b),u_tile_units_to_pixels:new m.Uniform1f(b),u_opacity:new m.Uniform1f(b)}),fill:b=>({u_matrix:new m.UniformMatrix4f(b)}),fillPattern:b=>({u_matrix:new m.UniformMatrix4f(b),u_image:new m.Uniform1i(b),u_texsize:new m.Uniform2f(b),u_pixel_coord_upper:new m.Uniform2f(b),u_pixel_coord_lower:new m.Uniform2f(b),u_tile_units_to_pixels:new m.Uniform1f(b)}),fillOutline:b=>({u_matrix:new m.UniformMatrix4f(b),u_world:new m.Uniform2f(b)}),fillOutlinePattern:b=>({u_matrix:new m.UniformMatrix4f(b),u_world:new m.Uniform2f(b),u_image:new m.Uniform1i(b),u_texsize:new m.Uniform2f(b),u_pixel_coord_upper:new m.Uniform2f(b),u_pixel_coord_lower:new m.Uniform2f(b),u_tile_units_to_pixels:new m.Uniform1f(b)}),circle:b=>({u_camera_to_center_distance:new m.Uniform1f(b),u_extrude_scale:new m.UniformMatrix2f(b),u_device_pixel_ratio:new m.Uniform1f(b),u_matrix:new m.UniformMatrix4f(b),u_inv_rot_matrix:new m.UniformMatrix4f(b),u_merc_center:new m.Uniform2f(b),u_tile_id:new m.Uniform3f(b),u_zoom_transition:new m.Uniform1f(b),u_up_dir:new m.Uniform3f(b)}),collisionBox:b=>({u_matrix:new m.UniformMatrix4f(b),u_camera_to_center_distance:new m.Uniform1f(b),u_extrude_scale:new m.Uniform2f(b)}),collisionCircle:b=>({u_matrix:new m.UniformMatrix4f(b),u_inv_matrix:new m.UniformMatrix4f(b),u_camera_to_center_distance:new m.Uniform1f(b),u_viewport_size:new m.Uniform2f(b)}),debug:b=>({u_color:new m.UniformColor(b),u_matrix:new m.UniformMatrix4f(b),u_overlay:new m.Uniform1i(b),u_overlay_scale:new m.Uniform1f(b)}),clippingMask:b=>({u_matrix:new m.UniformMatrix4f(b)}),heatmap:b=>({u_extrude_scale:new m.Uniform1f(b),u_intensity:new m.Uniform1f(b),u_matrix:new m.UniformMatrix4f(b),u_inv_rot_matrix:new m.UniformMatrix4f(b),u_merc_center:new m.Uniform2f(b),u_tile_id:new m.Uniform3f(b),u_zoom_transition:new m.Uniform1f(b),u_up_dir:new m.Uniform3f(b)}),heatmapTexture:b=>({u_image:new m.Uniform1i(b),u_color_ramp:new m.Uniform1i(b),u_opacity:new m.Uniform1f(b)}),hillshade:b=>({u_matrix:new m.UniformMatrix4f(b),u_image:new m.Uniform1i(b),u_latrange:new m.Uniform2f(b),u_light:new m.Uniform2f(b),u_shadow:new m.UniformColor(b),u_highlight:new m.UniformColor(b),u_accent:new m.UniformColor(b)}),hillshadePrepare:b=>({u_matrix:new m.UniformMatrix4f(b),u_image:new m.Uniform1i(b),u_dimension:new m.Uniform2f(b),u_zoom:new m.Uniform1f(b),u_unpack:new m.Uniform4f(b)}),line:b=>({u_matrix:new m.UniformMatrix4f(b),u_pixels_to_tile_units:new m.UniformMatrix2f(b),u_device_pixel_ratio:new m.Uniform1f(b),u_units_to_pixels:new m.Uniform2f(b),u_dash_image:new m.Uniform1i(b),u_gradient_image:new m.Uniform1i(b),u_image_height:new m.Uniform1f(b),u_texsize:new m.Uniform2f(b),u_tile_units_to_pixels:new m.Uniform1f(b),u_alpha_discard_threshold:new m.Uniform1f(b),u_trim_offset:new m.Uniform2f(b)}),linePattern:b=>({u_matrix:new m.UniformMatrix4f(b),u_texsize:new m.Uniform2f(b),u_pixels_to_tile_units:new m.UniformMatrix2f(b),u_device_pixel_ratio:new m.Uniform1f(b),u_image:new m.Uniform1i(b),u_units_to_pixels:new m.Uniform2f(b),u_tile_units_to_pixels:new m.Uniform1f(b),u_alpha_discard_threshold:new m.Uniform1f(b)}),raster:b=>({u_matrix:new m.UniformMatrix4f(b),u_tl_parent:new m.Uniform2f(b),u_scale_parent:new m.Uniform1f(b),u_fade_t:new m.Uniform1f(b),u_opacity:new m.Uniform1f(b),u_image0:new m.Uniform1i(b),u_image1:new m.Uniform1i(b),u_brightness_low:new m.Uniform1f(b),u_brightness_high:new m.Uniform1f(b),u_saturation_factor:new m.Uniform1f(b),u_contrast_factor:new m.Uniform1f(b),u_spin_weights:new m.Uniform3f(b),u_perspective_transform:new m.Uniform2f(b)}),symbolIcon:b=>({u_is_size_zoom_constant:new m.Uniform1i(b),u_is_size_feature_constant:new m.Uniform1i(b),u_size_t:new m.Uniform1f(b),u_size:new m.Uniform1f(b),u_camera_to_center_distance:new m.Uniform1f(b),u_rotate_symbol:new m.Uniform1i(b),u_aspect_ratio:new m.Uniform1f(b),u_fade_change:new m.Uniform1f(b),u_matrix:new m.UniformMatrix4f(b),u_label_plane_matrix:new m.UniformMatrix4f(b),u_coord_matrix:new m.UniformMatrix4f(b),u_is_text:new m.Uniform1i(b),u_pitch_with_map:new m.Uniform1i(b),u_texsize:new m.Uniform2f(b),u_tile_id:new m.Uniform3f(b),u_zoom_transition:new m.Uniform1f(b),u_inv_rot_matrix:new m.UniformMatrix4f(b),u_merc_center:new m.Uniform2f(b),u_camera_forward:new m.Uniform3f(b),u_tile_matrix:new m.UniformMatrix4f(b),u_up_vector:new m.Uniform3f(b),u_ecef_origin:new m.Uniform3f(b),u_texture:new m.Uniform1i(b)}),symbolSDF:b=>({u_is_size_zoom_constant:new m.Uniform1i(b),u_is_size_feature_constant:new m.Uniform1i(b),u_size_t:new m.Uniform1f(b),u_size:new m.Uniform1f(b),u_camera_to_center_distance:new m.Uniform1f(b),u_rotate_symbol:new m.Uniform1i(b),u_aspect_ratio:new m.Uniform1f(b),u_fade_change:new m.Uniform1f(b),u_matrix:new m.UniformMatrix4f(b),u_label_plane_matrix:new m.UniformMatrix4f(b),u_coord_matrix:new m.UniformMatrix4f(b),u_is_text:new m.Uniform1i(b),u_pitch_with_map:new m.Uniform1i(b),u_texsize:new m.Uniform2f(b),u_texture:new m.Uniform1i(b),u_gamma_scale:new m.Uniform1f(b),u_device_pixel_ratio:new m.Uniform1f(b),u_tile_id:new m.Uniform3f(b),u_zoom_transition:new m.Uniform1f(b),u_inv_rot_matrix:new m.UniformMatrix4f(b),u_merc_center:new m.Uniform2f(b),u_camera_forward:new m.Uniform3f(b),u_tile_matrix:new m.UniformMatrix4f(b),u_up_vector:new m.Uniform3f(b),u_ecef_origin:new m.Uniform3f(b),u_is_halo:new m.Uniform1i(b)}),symbolTextAndIcon:b=>({u_is_size_zoom_constant:new m.Uniform1i(b),u_is_size_feature_constant:new m.Uniform1i(b),u_size_t:new m.Uniform1f(b),u_size:new m.Uniform1f(b),u_camera_to_center_distance:new m.Uniform1f(b),u_rotate_symbol:new m.Uniform1i(b),u_aspect_ratio:new m.Uniform1f(b),u_fade_change:new m.Uniform1f(b),u_matrix:new m.UniformMatrix4f(b),u_label_plane_matrix:new m.UniformMatrix4f(b),u_coord_matrix:new m.UniformMatrix4f(b),u_is_text:new m.Uniform1i(b),u_pitch_with_map:new m.Uniform1i(b),u_texsize:new m.Uniform2f(b),u_texsize_icon:new m.Uniform2f(b),u_texture:new m.Uniform1i(b),u_texture_icon:new m.Uniform1i(b),u_gamma_scale:new m.Uniform1f(b),u_device_pixel_ratio:new m.Uniform1f(b),u_is_halo:new m.Uniform1i(b)}),background:b=>({u_matrix:new m.UniformMatrix4f(b),u_opacity:new m.Uniform1f(b),u_color:new m.UniformColor(b)}),backgroundPattern:b=>({u_matrix:new m.UniformMatrix4f(b),u_opacity:new m.Uniform1f(b),u_image:new m.Uniform1i(b),u_pattern_tl:new m.Uniform2f(b),u_pattern_br:new m.Uniform2f(b),u_texsize:new m.Uniform2f(b),u_pattern_size:new m.Uniform2f(b),u_pixel_coord_upper:new m.Uniform2f(b),u_pixel_coord_lower:new m.Uniform2f(b),u_tile_units_to_pixels:new m.Uniform1f(b)}),terrainRaster:Do,terrainDepth:Do,skybox:b=>({u_matrix:new m.UniformMatrix4f(b),u_sun_direction:new m.Uniform3f(b),u_cubemap:new m.Uniform1i(b),u_opacity:new m.Uniform1f(b),u_temporal_offset:new m.Uniform1f(b)}),skyboxGradient:b=>({u_matrix:new m.UniformMatrix4f(b),u_color_ramp:new m.Uniform1i(b),u_center_direction:new m.Uniform3f(b),u_radius:new m.Uniform1f(b),u_opacity:new m.Uniform1f(b),u_temporal_offset:new m.Uniform1f(b)}),skyboxCapture:b=>({u_matrix_3f:new m.UniformMatrix3f(b),u_sun_direction:new m.Uniform3f(b),u_sun_intensity:new m.Uniform1f(b),u_color_tint_r:new m.Uniform4f(b),u_color_tint_m:new m.Uniform4f(b),u_luminance:new m.Uniform1f(b)}),globeRaster:b=>({u_proj_matrix:new m.UniformMatrix4f(b),u_globe_matrix:new m.UniformMatrix4f(b),u_normalize_matrix:new m.UniformMatrix4f(b),u_merc_matrix:new m.UniformMatrix4f(b),u_zoom_transition:new m.Uniform1f(b),u_merc_center:new m.Uniform2f(b),u_image0:new m.Uniform1i(b),u_grid_matrix:new m.UniformMatrix3f(b),u_skirt_height:new m.Uniform1f(b),u_frustum_tl:new m.Uniform3f(b),u_frustum_tr:new m.Uniform3f(b),u_frustum_br:new m.Uniform3f(b),u_frustum_bl:new m.Uniform3f(b),u_globe_pos:new m.Uniform3f(b),u_globe_radius:new m.Uniform1f(b),u_viewport:new m.Uniform2f(b)}),globeAtmosphere:b=>({u_frustum_tl:new m.Uniform3f(b),u_frustum_tr:new m.Uniform3f(b),u_frustum_br:new m.Uniform3f(b),u_frustum_bl:new m.Uniform3f(b),u_horizon:new m.Uniform1f(b),u_transition:new m.Uniform1f(b),u_fadeout_range:new m.Uniform1f(b),u_color:new m.Uniform4f(b),u_high_color:new m.Uniform4f(b),u_space_color:new m.Uniform4f(b),u_star_intensity:new m.Uniform1f(b),u_star_density:new m.Uniform1f(b),u_star_size:new m.Uniform1f(b),u_temporal_offset:new m.Uniform1f(b),u_horizon_angle:new m.Uniform1f(b),u_rotation_matrix:new m.UniformMatrix4f(b)})};let ru;function lc(b,u,g,C,I,P,N){const B=b.context,U=B.gl,q=b.transform,H=b.useProgram("collisionBox"),J=[];let _e=0,Ce=0;for(let We=0;We<C.length;We++){const ht=C[We],ft=u.getTile(ht),ut=ft.getBucket(g);if(!ut)continue;const St=br(ht,ut,q);let bt=St;0===I[0]&&0===I[1]||(bt=b.translatePosMatrix(St,ft,I,P));const zt=N?ut.textCollisionBox:ut.iconCollisionBox,En=ut.collisionCircleArray;if(En.length>0){const Pt=m.create(),sn=bt;m.mul(Pt,ut.placementInvProjMatrix,q.glCoordMatrix),m.mul(Pt,Pt,ut.placementViewportMatrix),J.push({circleArray:En,circleOffset:Ce,transform:sn,invTransform:Pt,projection:ut.getProjection()}),_e+=En.length/4,Ce=_e}zt&&(b.terrain&&b.terrain.setupElevationDraw(ft,H),H.draw(B,U.LINES,m.DepthMode.disabled,m.StencilMode.disabled,b.colorModeForRenderPass(),m.CullFaceMode.disabled,Sc(bt,q,ft,ut.getProjection()),g.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,null,q.zoom,null,[zt.collisionVertexBuffer,zt.collisionVertexBufferExt]))}if(!N||!J.length)return;const Te=b.useProgram("collisionCircle"),Pe=new m.StructArrayLayout2f1f2i16;Pe.resize(4*_e),Pe._trim();let Le=0;for(const We of J)for(let ht=0;ht<We.circleArray.length/4;ht++){const ft=4*ht,ut=We.circleArray[ft+0],St=We.circleArray[ft+1],bt=We.circleArray[ft+2],zt=We.circleArray[ft+3];Pe.emplace(Le++,ut,St,bt,zt,0),Pe.emplace(Le++,ut,St,bt,zt,1),Pe.emplace(Le++,ut,St,bt,zt,2),Pe.emplace(Le++,ut,St,bt,zt,3)}(!ru||ru.length<2*_e)&&(ru=function(We){const ht=2*We,ft=new m.StructArrayLayout3ui6;ft.resize(ht),ft._trim();for(let ut=0;ut<ht;ut++){const St=6*ut;ft.uint16[St+0]=4*ut+0,ft.uint16[St+1]=4*ut+1,ft.uint16[St+2]=4*ut+2,ft.uint16[St+3]=4*ut+2,ft.uint16[St+4]=4*ut+3,ft.uint16[St+5]=4*ut+0}return ft}(_e));const ee=B.createIndexBuffer(ru,!0),Se=B.createVertexBuffer(Pe,m.collisionCircleLayout.members,!0);for(const We of J){const ht={u_matrix:We.transform,u_inv_matrix:We.invTransform,u_camera_to_center_distance:(Ge=q).getCameraToCenterDistance(We.projection),u_viewport_size:[Ge.width,Ge.height]};Te.draw(B,U.TRIANGLES,m.DepthMode.disabled,m.StencilMode.disabled,b.colorModeForRenderPass(),m.CullFaceMode.disabled,ht,g.id,Se,ee,m.SegmentVector.simpleSegment(0,2*We.circleOffset,We.circleArray.length,We.circleArray.length/2),null,q.zoom)}var Ge;Se.destroy(),ee.destroy()}const jl=m.create();function Is({width:b,height:u,anchor:g,textOffset:C,textScale:I},P){const{horizontalAlign:N,verticalAlign:B}=m.getAnchorAlignment(g),U=-(N-.5)*b,q=-(B-.5)*u,H=m.evaluateVariableOffset(g,C);return new m.Point((U/I+H[0])*P,(q/I+H[1])*P)}function Ku(b,u,g,C,I,P,N,B,U,q,H){const J=b.text.placedSymbolArray,_e=b.text.dynamicLayoutVertexArray,Ce=b.icon.dynamicLayoutVertexArray,Te={},Pe=b.getProjection(),Le=Io(B,Pe,P),ee=P.elevation,Se=Pe.upVectorScale(B.canonical,P.center.lat,P.worldSize).metersToTile;_e.clear();for(let Ge=0;Ge<J.length;Ge++){const We=J.get(Ge),{tileAnchorX:ht,tileAnchorY:ft,numGlyphs:ut}=We,St=We.hidden||!We.crossTileID||b.allowVerticalPlacement&&!We.placedOrientation?null:C[We.crossTileID];if(St){let bt=0,zt=0,En=0;if(ee){const Sn=ee?ee.getAtTileOffset(B,ht,ft):0,[yi,$i,ei]=Pe.upVector(B.canonical,ht,ft);bt=Sn*yi*Se,zt=Sn*$i*Se,En=Sn*ei*Se}let[Pt,sn,Ht,xn]=qs(We.projectedAnchorX+bt,We.projectedAnchorY+zt,We.projectedAnchorZ+En,g?Le:N);const Bt=Ko(P.getCameraToCenterDistance(Pe),xn);let rn=I.evaluateSizeForFeature(b.textSizeData,q,We)*Bt/m.ONE_EM;g&&(rn*=b.tilePixelRatio/U);const wn=Is(St,rn);g?(({x:Pt,y:sn,z:Ht}=Pe.projectTilePoint(ht+wn.x,ft+wn.y,B.canonical)),[Pt,sn,Ht]=qs(Pt+bt,sn+zt,Ht+En,N)):(u&&wn._rotate(-P.angle),Pt+=wn.x,sn+=wn.y,Ht=0);const hn=b.allowVerticalPlacement&&We.placedOrientation===m.WritingMode.vertical?Math.PI/2:0;for(let Sn=0;Sn<ut;Sn++)m.addDynamicAttributes(_e,Pt,sn,Ht,hn);H&&We.associatedIconIndex>=0&&(Te[We.associatedIconIndex]={x:Pt,y:sn,z:Ht,angle:hn})}else gi(ut,_e)}if(H){Ce.clear();const Ge=b.icon.placedSymbolArray;for(let We=0;We<Ge.length;We++){const ht=Ge.get(We),{numGlyphs:ft}=ht,ut=Te[We];if(ht.hidden||!ut)gi(ft,Ce);else{const{x:St,y:bt,z:zt,angle:En}=ut;for(let Pt=0;Pt<ft;Pt++)m.addDynamicAttributes(Ce,St,bt,zt,En)}}b.icon.dynamicLayoutVertexBuffer.updateData(Ce)}b.text.dynamicLayoutVertexBuffer.updateData(_e)}function oa(b,u,g){return g.iconsInText&&u?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Ja(b,u,g,C,I,P,N,B,U,q,H,J){const _e=b.context,Ce=_e.gl,Te=b.transform,Pe="map"===B,Le="map"===U,ee=Pe&&"point"!==g.layout.get("symbol-placement"),Se=Pe&&!Le&&!ee,Ge=void 0!==g.layout.get("symbol-sort-key").constantOr(1);let We=!1;const ht=b.depthModeForSublayer(0,m.DepthMode.ReadOnly),ft=[m.mercatorXfromLng(Te.center.lng),m.mercatorYfromLat(Te.center.lat)],ut=g.layout.get("text-variable-anchor"),St="globe"===Te.projection.name,bt=[],zt=[0,-1,0];let En=zt;!St&&!Te.mercatorFromTransition||Pe||(En=function(Pt){const sn=Pt._camera.getWorldToCamera(Pt.worldSize,1),Ht=m.multiply([],sn,Pt.globeMatrix);m.invert(Ht,Ht);const xn=[0,0,0],Bt=[0,1,0,0];return m.transformMat4$1(Bt,Bt,Ht),xn[0]=Bt[0],xn[1]=Bt[1],xn[2]=Bt[2],m.normalize(xn,xn),xn}(Te));for(const Pt of C){const sn=u.getTile(Pt),Ht=sn.getBucket(g);if(!Ht||"mercator"===Ht.projection.name&&St)continue;const xn=I?Ht.text:Ht.icon;if(!xn||Ht.fullyClipped||!xn.segments.get().length)continue;const Bt=xn.programConfigurations.get(g.id),rn=I||Ht.sdfIcons,wn=I?Ht.textSizeData:Ht.iconSizeData,hn=Le||0!==Te.pitch,Sn=m.evaluateSizeForZoom(wn,Te.zoom);let yi,$i,ei,ii,fr=[0,0],pr=null;if(I)$i=sn.glyphAtlasTexture,ei=Ce.LINEAR,yi=sn.glyphAtlasTexture.size,Ht.iconsInText&&(fr=sn.imageAtlasTexture.size,pr=sn.imageAtlasTexture,ii=hn||b.options.rotating||b.options.zooming||"composite"===wn.kind||"camera"===wn.kind?Ce.LINEAR:Ce.NEAREST);else{const td=1!==g.layout.get("icon-size").constantOr(0)||Ht.iconsNeedLinear;$i=sn.imageAtlasTexture,ei=rn||b.options.rotating||b.options.zooming||td||hn?Ce.LINEAR:Ce.NEAREST,yi=sn.imageAtlasTexture.size}const di="globe"===Ht.projection.name,_o=di?En:zt,No=di?m.globeToMercatorTransition(Te.zoom):0,$o=Io(Pt,Ht.getProjection(),Te),Ao=Te.calculatePixelsToTileUnitsMatrix(sn),Dl=Qt($o,sn.tileID.canonical,Le,Pe,Te,Ht.getProjection(),Ao),vs=b.terrain&&Le&&ee?m.invert(m.create(),Dl):jl,Tc=fs($o,sn.tileID.canonical,Le,Pe,Te,Ht.getProjection(),Ao),cu=ut&&Ht.hasTextData(),Hi="none"!==g.layout.get("icon-text-fit")&&cu&&Ht.hasIconData();if(ee){const td=Te.elevation,ql=td?td.getAtTileOffsetFunc(Pt,Te.center.lat,Te.worldSize,Ht.getProjection()):null,_d=Nl($o,sn.tileID.canonical,Le,Pe,Te,Ht.getProjection(),Ao);Fl(Ht,$o,b,I,_d,Tc,Le,q,ql,Pt)}const Po=ee||I&&ut||Hi,Tr=b.translatePosMatrix($o,sn,P,N),yo=Po?jl:Dl,Hl=b.translatePosMatrix(Tc,sn,P,N,!0),us=Ht.getProjection().createInversionMatrix(Te,Pt.canonical),Ua=[];b.terrainRenderModeElevated()&&Le&&Ua.push("PITCH_WITH_MAP_TERRAIN"),di&&Ua.push("PROJECTION_GLOBE_VIEW"),Po&&Ua.push("PROJECTED_POS_ON_VIEWPORT");const Tl=rn&&0!==g.paint.get(I?"text-halo-width":"icon-halo-width").constantOr(1);let Zd;Zd=rn?Ht.iconsInText?$d(wn.kind,Sn,Se,Le,b,Tr,yo,Hl,yi,fr,Pt,No,ft,us,_o,Ht.getProjection()):Rs(wn.kind,Sn,Se,Le,b,Tr,yo,Hl,I,yi,!0,Pt,No,ft,us,_o,Ht.getProjection()):Rr(wn.kind,Sn,Se,Le,b,Tr,yo,Hl,I,yi,Pt,No,ft,us,_o,Ht.getProjection());const mf={program:b.useProgram(oa(rn,I,Ht),Bt,Ua),buffers:xn,uniformValues:Zd,atlasTexture:$i,atlasTextureIcon:pr,atlasInterpolation:ei,atlasInterpolationIcon:ii,isSDF:rn,hasHalo:Tl,tile:sn,labelPlaneMatrixInv:vs};if(Ge&&Ht.canOverlap){We=!0;const td=xn.segments.get();for(const ql of td)bt.push({segments:new m.SegmentVector([ql]),sortKey:ql.sortKey,state:mf})}else bt.push({segments:xn.segments,sortKey:0,state:mf})}We&&bt.sort((Pt,sn)=>Pt.sortKey-sn.sortKey);for(const Pt of bt){const sn=Pt.state;if(b.terrain&&b.terrain.setupElevationDraw(sn.tile,sn.program,{useDepthForOcclusion:!St,labelPlaneMatrixInv:sn.labelPlaneMatrixInv}),_e.activeTexture.set(Ce.TEXTURE0),sn.atlasTexture.bind(sn.atlasInterpolation,Ce.CLAMP_TO_EDGE),sn.atlasTextureIcon&&(_e.activeTexture.set(Ce.TEXTURE1),sn.atlasTextureIcon&&sn.atlasTextureIcon.bind(sn.atlasInterpolationIcon,Ce.CLAMP_TO_EDGE)),sn.isSDF){const Ht=sn.uniformValues;sn.hasHalo&&(Ht.u_is_halo=1,Gl(sn.buffers,Pt.segments,g,b,sn.program,ht,H,J,Ht)),Ht.u_is_halo=0}Gl(sn.buffers,Pt.segments,g,b,sn.program,ht,H,J,sn.uniformValues)}}function Gl(b,u,g,C,I,P,N,B,U){const q=C.context,H=[b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer,b.globeExtVertexBuffer];I.draw(q,q.gl.TRIANGLES,P,N,B,m.CullFaceMode.disabled,U,g.id,b.layoutVertexBuffer,b.indexBuffer,u,g.paint,C.transform.zoom,b.programConfigurations.get(g.id),H)}function Hd(b,u,g,C,I,P,N){const B=b.context.gl,U=g.paint.get("fill-pattern"),q=U&&U.constantOr(1);let H,J,_e,Ce,Te;N?(J=q&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=B.LINES):(J=q?"fillPattern":"fill",H=B.TRIANGLES);for(const Pe of C){const Le=u.getTile(Pe);if(q&&!Le.patternsLoaded())continue;const ee=Le.getBucket(g);if(!ee)continue;b.prepareDrawTile();const Se=ee.programConfigurations.get(g.id),Ge=b.useProgram(J,Se);q&&(b.context.activeTexture.set(B.TEXTURE0),Le.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Se.updatePaintBuffers());const We=U.constantOr(null);if(We&&Le.imageAtlas){const ft=Le.imageAtlas.patternPositions[We.toString()];ft&&Se.setConstantPatternPositions(ft)}const ht=b.translatePosMatrix(Pe.projMatrix,Le,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor"));if(N){Ce=ee.indexBuffer2,Te=ee.segments2;const ft=b.terrain&&b.terrain.renderingToTexture?b.terrain.drapeBufferSize:[B.drawingBufferWidth,B.drawingBufferHeight];_e="fillOutlinePattern"===J&&q?dm(ht,b,Le,ft):Ss(ht,ft)}else Ce=ee.indexBuffer,Te=ee.segments,_e=q?Da(ht,b,Le):Ba(ht);b.prepareDrawProgram(b.context,Ge,Pe.toUnwrapped()),Ge.draw(b.context,H,I,b.stencilModeForClipping(Pe),P,m.CullFaceMode.disabled,_e,g.id,ee.layoutVertexBuffer,Ce,Te,g.paint,b.transform.zoom,Se)}}function Lc(b,u,g,C,I,P,N){const B=b.context,U=B.gl,q=b.transform,H=g.paint.get("fill-extrusion-pattern"),J=H.constantOr(1),_e=g.paint.get("fill-extrusion-opacity"),Ce=[g.paint.get("fill-extrusion-ambient-occlusion-intensity"),g.paint.get("fill-extrusion-ambient-occlusion-radius")],Te=g.layout.get("fill-extrusion-edge-radius"),Pe=Te>0&&!g.paint.get("fill-extrusion-rounded-roof"),Le=Pe?0:Te,ee="globe"===q.projection.name?m.fillExtrusionHeightLift():0,Se="globe"===q.projection.name,Ge=Se?m.globeToMercatorTransition(q.zoom):0,We=[m.mercatorXfromLng(q.center.lng),m.mercatorYfromLat(q.center.lat)],ht=[];Se&&ht.push("PROJECTION_GLOBE_VIEW"),Ce[0]>0&&ht.push("FAUX_AO"),Pe&&ht.push("ZERO_ROOF_RADIUS");for(const ft of C){const ut=u.getTile(ft),St=ut.getBucket(g);if(!St||St.projection.name!==q.projection.name)continue;const bt=St.programConfigurations.get(g.id),zt=b.useProgram(J?"fillExtrusionPattern":"fillExtrusion",bt,ht);if(b.terrain){const rn=b.terrain;if(b.style.terrainSetForDrapingOnly())rn.setupElevationDraw(ut,zt,{useMeterToDem:!0});else{if(!St.enableTerrain)continue;if(rn.setupElevationDraw(ut,zt,{useMeterToDem:!0}),Mc(B,u,ft,St,g,rn),!St.centroidVertexBuffer){const wn=zt.attributes.a_centroid_pos;void 0!==wn&&U.vertexAttrib2f(wn,0,0)}}}J&&(b.context.activeTexture.set(U.TEXTURE0),ut.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),bt.updatePaintBuffers());const En=H.constantOr(null);if(En&&ut.imageAtlas){const rn=ut.imageAtlas.patternPositions[En.toString()];rn&&bt.setConstantPatternPositions(rn)}const Pt=b.translatePosMatrix(ft.projMatrix,ut,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),sn=q.projection.createInversionMatrix(q,ft.canonical),Ht=g.paint.get("fill-extrusion-vertical-gradient"),xn=J?Xu(Pt,b,Ht,_e,Ce,Le,ft,ut,ee,Ge,We,sn):Ya(Pt,b,Ht,_e,Ce,Le,ft,ee,Ge,We,sn);b.prepareDrawProgram(B,zt,ft.toUnwrapped());const Bt=[];b.terrain&&Bt.push(St.centroidVertexBuffer),Se&&Bt.push(St.layoutVertexExtBuffer),zt.draw(B,B.gl.TRIANGLES,I,P,N,m.CullFaceMode.backCCW,xn,g.id,St.layoutVertexBuffer,St.indexBuffer,St.segments,g.paint,b.transform.zoom,bt,Bt)}}function Mc(b,u,g,C,I,P){const N=[ee=>{let Se=ee.canonical.x-1,Ge=ee.wrap;return Se<0&&(Se=(1<<ee.canonical.z)-1,Ge--),new m.OverscaledTileID(ee.overscaledZ,Ge,ee.canonical.z,Se,ee.canonical.y)},ee=>{let Se=ee.canonical.x+1,Ge=ee.wrap;return Se===1<<ee.canonical.z&&(Se=0,Ge++),new m.OverscaledTileID(ee.overscaledZ,Ge,ee.canonical.z,Se,ee.canonical.y)},ee=>new m.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,(0===ee.canonical.y?1<<ee.canonical.z:ee.canonical.y)-1),ee=>new m.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y===(1<<ee.canonical.z)-1?0:ee.canonical.y+1)],B=ee=>{const Se=u.getSource().minzoom,Ge=ht=>{const ft=u.getTileByID(ht);if(ft&&ft.hasData())return ft.getBucket(I)},We=[0,-1,1];for(const ht of We){if(ee.overscaledZ+ht<Se)continue;const ft=Ge(ee.calculateScaledKey(ee.overscaledZ+ht));if(ft)return ft}},U=[0,0,0],q=(ee,Se)=>(U[0]=Math.min(ee.min.y,Se.min.y),U[1]=Math.max(ee.max.y,Se.max.y),U[2]=m.EXTENT-Se.min.x>ee.max.x?Se.min.x-m.EXTENT:ee.max.x,U),H=(ee,Se)=>(U[0]=Math.min(ee.min.x,Se.min.x),U[1]=Math.max(ee.max.x,Se.max.x),U[2]=m.EXTENT-Se.min.y>ee.max.y?Se.min.y-m.EXTENT:ee.max.y,U),J=[(ee,Se)=>q(ee,Se),(ee,Se)=>q(Se,ee),(ee,Se)=>H(ee,Se),(ee,Se)=>H(Se,ee)],_e=new m.Point(0,0);let Ce,Te,Pe;const Le=(ee,Se,Ge,We,ht)=>{const ft=[[We?Ge:ee,We?ee:Ge,0],[We?Ge:Se,We?Se:Ge,0]],ut=ht<0?m.EXTENT+ht:ht,St=[We?ut:(ee+Se)/2,We?(ee+Se)/2:ut,0];return 0===Ge&&ht<0||0!==Ge&&ht>0?P.getForTilePoints(Pe,[St],!0,Te):ft.push(St),P.getForTilePoints(g,ft,!0,Ce),Math.max(ft[0][2],ft[1][2],St[2])/P.exaggeration()};for(let ee=0;ee<4;ee++){const Se=(ee<2?1:5)-ee,Ge=C.borders[ee];if(0===Ge.length)continue;const We=Pe=N[ee](g),ht=B(We);if(!(ht&&ht instanceof m.FillExtrusionBucket&&ht.enableTerrain)||C.borderDoneWithNeighborZ[ee]===ht.canonical.z&&ht.borderDoneWithNeighborZ[Se]===C.canonical.z||(Te=P.findDEMTileFor(We),!Te||!Te.dem))continue;if(!Ce){const bt=P.findDEMTileFor(g);if(!bt||!bt.dem)return;Ce=bt}const ft=ht.borders[Se];let ut=0;const St=ht.borderDoneWithNeighborZ[Se]!==C.canonical.z;if(C.canonical.z===ht.canonical.z){for(let bt=0;bt<Ge.length;bt++){const zt=C.featuresOnBorder[Ge[bt]],En=zt.borders[ee];let Pt;for(;ut<ft.length&&(Pt=ht.featuresOnBorder[ft[ut]],!(Pt.borders[Se][1]>En[0]+3));)St&&ht.encodeCentroid(void 0,Pt,!1),ut++;if(Pt&&ut<ft.length){const sn=ut;let Ht=0;for(;!(Pt.borders[Se][0]>En[1]-3)&&(Ht++,++ut!==ft.length);)Pt=ht.featuresOnBorder[ft[ut]];if(Pt=ht.featuresOnBorder[ft[sn]],zt.intersectsCount()>1||Pt.intersectsCount()>1||1!==Ht){1!==Ht&&(ut=sn),C.encodeCentroid(void 0,zt,!1),St&&ht.encodeCentroid(void 0,Pt,!1);continue}const xn=J[ee](zt,Pt),Bt=ee%2?m.EXTENT-1:0;_e.x=Le(xn[0],Math.min(m.EXTENT-1,xn[1]),Bt,ee<2,xn[2]),_e.y=0,C.encodeCentroid(_e,zt,!1),St&&ht.encodeCentroid(_e,Pt,!1)}else C.encodeCentroid(void 0,zt,!1)}C.borderDoneWithNeighborZ[ee]=ht.canonical.z,C.needsCentroidUpdate=!0,St&&(ht.borderDoneWithNeighborZ[Se]=C.canonical.z,ht.needsCentroidUpdate=!0)}else{for(const bt of Ge)C.encodeCentroid(void 0,C.featuresOnBorder[bt],!1);if(St){for(const bt of ft)ht.encodeCentroid(void 0,ht.featuresOnBorder[bt],!1);ht.borderDoneWithNeighborZ[Se]=C.canonical.z,ht.needsCentroidUpdate=!0}C.borderDoneWithNeighborZ[ee]=ht.canonical.z,C.needsCentroidUpdate=!0}}(C.needsCentroidUpdate||!C.centroidVertexBuffer&&0!==C.centroidVertexArray.length)&&C.uploadCentroid(b)}const al=new m.Color(1,0,0,1),pa=new m.Color(0,1,0,1),Os=new m.Color(0,0,1,1),Ta=new m.Color(1,0,1,1),pf=new m.Color(0,1,1,1);function ou(b,u,g){const C=b.context,I=b.transform,P=C.gl,N="globe"===I.projection.name,B=N?["PROJECTION_GLOBE_VIEW"]:null;let U=g.projMatrix;if(N&&m.globeToMercatorTransition(I.zoom)>0){const zt=m.transitionTileAABBinECEF(g.canonical,I),En=m.globeDenormalizeECEF(zt);U=m.multiply(new Float32Array(16),I.globeMatrix,En),m.multiply(U,I.projMatrix,U)}const q=b.useProgram("debug",null,B),H=u.getTileByID(g.key);b.terrain&&b.terrain.setupElevationDraw(H,q);const J=m.DepthMode.disabled,_e=m.StencilMode.disabled,Ce=b.colorModeForRenderPass();C.activeTexture.set(P.TEXTURE0),b.emptyTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),N?H._makeGlobeTileDebugBuffers(b.context,I):H._makeDebugTileBoundsBuffers(b.context,I.projection);const Pe=H._tileDebugBuffer||b.debugBuffer,Le=H._tileDebugIndexBuffer||b.debugIndexBuffer,ee=H._tileDebugSegments||b.debugSegments;q.draw(C,P.LINE_STRIP,J,_e,Ce,m.CullFaceMode.disabled,Rn(U,m.Color.red),"$debug",Pe,Le,ee,null,null,null,[H._globeTileDebugBorderBuffer]);const Se=H.latestRawTileData,Ge=Math.floor((Se&&Se.byteLength||0)/1024),We=u.getTile(g).tileSize,ht=512/Math.min(We,512)*(g.overscaledZ/I.zoom)*.5;let ft=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(ft+=` => ${g.overscaledZ}`),ft+=` ${Ge}kb`,function(zt,En){zt.initDebugOverlayCanvas();const Pt=zt.debugOverlayCanvas,sn=zt.context.gl,Ht=zt.debugOverlayCanvas.getContext("2d");Ht.clearRect(0,0,Pt.width,Pt.height),Ht.shadowColor="white",Ht.shadowBlur=2,Ht.lineWidth=1.5,Ht.strokeStyle="white",Ht.textBaseline="top",Ht.font="bold 36px Open Sans, sans-serif",Ht.fillText(En,5,5),Ht.strokeText(En,5,5),zt.debugOverlayTexture.update(Pt),zt.debugOverlayTexture.bind(sn.LINEAR,sn.CLAMP_TO_EDGE)}(b,ft);const ut=H._tileDebugTextBuffer||b.debugBuffer,St=H._tileDebugTextIndexBuffer||b.quadTriangleIndexBuffer,bt=H._tileDebugTextSegments||b.debugSegments;q.draw(C,P.TRIANGLES,J,_e,m.ColorMode.alphaBlended,m.CullFaceMode.disabled,Rn(U,m.Color.transparent,ht),"$debug",ut,St,bt,null,null,null,[H._globeTileDebugTextBuffer])}function Au(b,u,g,C){Ds(b,0,u+g/2,b.transform.width,g,C)}function ks(b,u,g,C){Ds(b,u-g/2,0,g,b.transform.height,C)}function Ds(b,u,g,C,I,P){const N=b.context,B=N.gl;B.enable(B.SCISSOR_TEST),B.scissor(u*m.exported.devicePixelRatio,g*m.exported.devicePixelRatio,C*m.exported.devicePixelRatio,I*m.exported.devicePixelRatio),N.clear({color:P}),B.disable(B.SCISSOR_TEST)}const Sl=m.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ll}=Sl;function Ic(b,u,g,C){b.emplaceBack(u,g,C)}class Nc{constructor(u){this.vertexArray=new m.StructArrayLayout3f12,this.indices=new m.StructArrayLayout3ui6,Ic(this.vertexArray,-1,-1,1),Ic(this.vertexArray,1,-1,1),Ic(this.vertexArray,-1,1,1),Ic(this.vertexArray,1,1,1),Ic(this.vertexArray,-1,-1,-1),Ic(this.vertexArray,1,-1,-1),Ic(this.vertexArray,-1,1,-1),Ic(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,ll),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=m.SegmentVector.simpleSegment(0,0,36,12)}}function Gi(b,u,g,C,I,P){const N=b.gl,B=u.paint.get("sky-atmosphere-color"),U=u.paint.get("sky-atmosphere-halo-color"),q=u.paint.get("sky-atmosphere-sun-intensity"),H={u_matrix_3f:m.fromMat4(m.create$1(),C),u_sun_direction:I,u_sun_intensity:q,u_color_tint_r:[(Te=B).r,Te.g,Te.b,Te.a],u_color_tint_m:[(Pe=U).r,Pe.g,Pe.b,Pe.a],u_luminance:5e-5};var Te,Pe;N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+P,u.skyboxTexture,0),g.draw(b,N.TRIANGLES,m.DepthMode.disabled,m.StencilMode.disabled,m.ColorMode.unblended,m.CullFaceMode.frontCW,H,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const ma=m.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class xh{constructor(u){const g=new m.StructArrayLayout5f20;g.emplaceBack(-1,1,1,0,0),g.emplaceBack(1,1,1,1,0),g.emplaceBack(1,-1,1,1,1),g.emplaceBack(-1,-1,1,0,1);const C=new m.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(g,ma.members),this.indexBuffer=u.createIndexBuffer(C),this.segments=m.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ss={symbol:function(b,u,g,C,I){if("translucent"!==b.renderPass)return;const P=m.StencilMode.disabled,N=b.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(B,U,q,H,J,_e,Ce){const Te=U.transform,Pe="map"===J,Le="map"===_e;for(const ee of B){const Se=H.getTile(ee),Ge=Se.getBucket(q);if(!Ge||!Ge.text||!Ge.text.segments.get().length)continue;const We=m.evaluateSizeForZoom(Ge.textSizeData,Te.zoom),ht=Io(ee,Ge.getProjection(),Te),ft=Te.calculatePixelsToTileUnitsMatrix(Se),ut=Qt(ht,Se.tileID.canonical,Le,Pe,Te,Ge.getProjection(),ft),St="none"!==q.layout.get("icon-text-fit")&&Ge.hasIconData();if(We){const bt=Math.pow(2,Te.zoom-Se.tileID.overscaledZ);Ku(Ge,Pe,Le,Ce,m.symbolSize,Te,ut,ee,bt,We,St)}}}(C,b,g,u,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),I),0!==g.paint.get("icon-opacity").constantOr(1)&&Ja(b,u,g,C,!1,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),g.layout.get("icon-rotation-alignment"),g.layout.get("icon-pitch-alignment"),g.layout.get("icon-keep-upright"),P,N),0!==g.paint.get("text-opacity").constantOr(1)&&Ja(b,u,g,C,!0,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.layout.get("text-keep-upright"),P,N),u.map.showCollisionBoxes&&(lc(b,u,g,C,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),lc(b,u,g,C,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(b,u,g,C){if("translucent"!==b.renderPass)return;const I=g.paint.get("circle-opacity"),P=g.paint.get("circle-stroke-width"),N=g.paint.get("circle-stroke-opacity"),B=void 0!==g.layout.get("circle-sort-key").constantOr(1);if(0===I.constantOr(1)&&(0===P.constantOr(1)||0===N.constantOr(1)))return;const U=b.context,q=U.gl,H=b.transform,J=b.depthModeForSublayer(0,m.DepthMode.ReadOnly),_e=m.StencilMode.disabled,Ce=b.colorModeForRenderPass(),Te="globe"===H.projection.name,Pe=[m.mercatorXfromLng(H.center.lng),m.mercatorYfromLat(H.center.lat)],Le=[];for(let Se=0;Se<C.length;Se++){const Ge=C[Se],We=u.getTile(Ge),ht=We.getBucket(g);if(!ht||ht.projection.name!==H.projection.name)continue;const ft=ht.programConfigurations.get(g.id),ut=Dt(g);Te&&ut.push("PROJECTION_GLOBE_VIEW");const St=b.useProgram("circle",ft,ut),bt=ht.layoutVertexBuffer,zt=ht.globeExtVertexBuffer,En=ht.indexBuffer,Pt=H.projection.createInversionMatrix(H,Ge.canonical),sn={programConfiguration:ft,program:St,layoutVertexBuffer:bt,globeExtVertexBuffer:zt,indexBuffer:En,uniformValues:Cc(b,Ge,We,Pt,Pe,g),tile:We};if(B){const Ht=ht.segments.get();for(const xn of Ht)Le.push({segments:new m.SegmentVector([xn]),sortKey:xn.sortKey,state:sn})}else Le.push({segments:ht.segments,sortKey:0,state:sn})}B&&Le.sort((Se,Ge)=>Se.sortKey-Ge.sortKey);const ee={useDepthForOcclusion:!Te};for(const Se of Le){const{programConfiguration:Ge,program:We,layoutVertexBuffer:ht,globeExtVertexBuffer:ft,indexBuffer:ut,uniformValues:St,tile:bt}=Se.state,zt=Se.segments;b.terrain&&b.terrain.setupElevationDraw(bt,We,ee),b.prepareDrawProgram(U,We,bt.tileID.toUnwrapped()),We.draw(U,q.TRIANGLES,J,_e,Ce,m.CullFaceMode.disabled,St,g.id,ht,ut,zt,g.paint,H.zoom,Ge,[ft])}},heatmap:function(b,u,g,C){if(0!==g.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){const I=b.context,P=I.gl,N=m.StencilMode.disabled,B=new m.ColorMode([P.ONE,P.ONE],m.Color.transparent,[!0,!0,!0,!0]);(function(Ce,Te,Pe,Le){const ee=Ce.gl,Se=Te.width*Le,Ge=Te.height*Le;Ce.activeTexture.set(ee.TEXTURE1),Ce.viewport.set([0,0,Se,Ge]);let We=Pe.heatmapFbo;if(!We||We&&(We.width!==Se||We.height!==Ge)){We&&We.destroy();const ht=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,ht),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),We=Pe.heatmapFbo=Ce.createFramebuffer(Se,Ge,!1),function(ft,ut,St,bt,zt,En){const Pt=ft.gl;Pt.texImage2D(Pt.TEXTURE_2D,0,ft.isWebGL2&&ft.extRenderToTextureHalfFloat?Pt.RGBA16F:Pt.RGBA,zt,En,0,Pt.RGBA,ft.extRenderToTextureHalfFloat?ft.isWebGL2?Pt.HALF_FLOAT:ft.extTextureHalfFloat.HALF_FLOAT_OES:Pt.UNSIGNED_BYTE,null),bt.colorAttachment.set(St)}(Ce,0,ht,We,Se,Ge)}else ee.bindTexture(ee.TEXTURE_2D,We.colorAttachment.get()),Ce.bindFramebuffer.set(We.framebuffer)})(I,b,g,"globe"===b.transform.projection.name?.5:.25),I.clear({color:m.Color.transparent});const U=b.transform,q="globe"===U.projection.name,H=q?["PROJECTION_GLOBE_VIEW"]:null,J=q?m.CullFaceMode.frontCCW:m.CullFaceMode.disabled,_e=[m.mercatorXfromLng(U.center.lng),m.mercatorYfromLat(U.center.lat)];for(let Ce=0;Ce<C.length;Ce++){const Te=C[Ce];if(u.hasRenderableParent(Te))continue;const Pe=u.getTile(Te),Le=Pe.getBucket(g);if(!Le||Le.projection.name!==U.projection.name)continue;const ee=Le.programConfigurations.get(g.id),Se=b.useProgram("heatmap",ee,H),{zoom:Ge}=b.transform;b.terrain&&b.terrain.setupElevationDraw(Pe,Se),b.prepareDrawProgram(I,Se,Te.toUnwrapped());const We=U.projection.createInversionMatrix(U,Te.canonical);Se.draw(I,P.TRIANGLES,m.DepthMode.disabled,N,B,J,El(b,Te,Pe,We,_e,Ge,g.paint.get("heatmap-intensity")),g.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,g.paint,b.transform.zoom,ee,q?[Le.globeExtVertexBuffer]:null)}I.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(I,P){const N=I.context,B=N.gl,U=P.heatmapFbo;if(!U)return;N.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,U.colorAttachment.get()),N.activeTexture.set(B.TEXTURE1);let q=P.colorRampTexture;q||(q=P.colorRampTexture=new m.Texture(N,P.colorRamp,B.RGBA)),q.bind(B.LINEAR,B.CLAMP_TO_EDGE),I.useProgram("heatmapTexture").draw(N,B.TRIANGLES,m.DepthMode.disabled,m.StencilMode.disabled,I.colorModeForRenderPass(),m.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:P.paint.get("heatmap-opacity")},P.id,I.viewportBuffer,I.quadTriangleIndexBuffer,I.viewportSegments,P.paint,I.transform.zoom)}(b,g))},line:function(b,u,g,C){if("translucent"!==b.renderPass)return;const I=g.paint.get("line-opacity"),P=g.paint.get("line-width");if(0===I.constantOr(1)||0===P.constantOr(1))return;const N=b.depthModeForSublayer(0,m.DepthMode.ReadOnly),B=b.colorModeForRenderPass(),U=b.terrain&&b.terrain.renderingToTexture?1:m.exported.devicePixelRatio,q=g.paint.get("line-dasharray"),H=q.constantOr(1),J=g.layout.get("line-cap"),_e=g.paint.get("line-pattern"),Ce=_e.constantOr(1),Te=g.paint.get("line-gradient"),Pe=Ce?"linePattern":"line",Le=b.context,ee=Le.gl,Se=(We=>{const ht=[];Qa(We)&&ht.push("RENDER_LINE_DASH"),We.paint.get("line-gradient")&&ht.push("RENDER_LINE_GRADIENT");const ft=We.paint.get("line-trim-offset");0===ft[0]&&0===ft[1]||ht.push("RENDER_LINE_TRIM_OFFSET");const ut=We.paint.get("line-pattern").constantOr(1),St=1!==We.paint.get("line-opacity").constantOr(1);return!ut&&St&&ht.push("RENDER_LINE_ALPHA_DISCARD"),ht})(g);let Ge=Se.includes("RENDER_LINE_ALPHA_DISCARD");b.terrain&&b.terrain.clipOrMaskOverlapStencilType()&&(Ge=!1);for(const We of C){const ht=u.getTile(We);if(Ce&&!ht.patternsLoaded())continue;const ft=ht.getBucket(g);if(!ft)continue;b.prepareDrawTile();const ut=ft.programConfigurations.get(g.id),St=b.useProgram(Pe,ut,Se),bt=_e.constantOr(null);if(bt&&ht.imageAtlas){const rn=ht.imageAtlas.patternPositions[bt.toString()];rn&&ut.setConstantPatternPositions(rn)}const zt=q.constantOr(null),En=J.constantOr(null);if(!Ce&&zt&&En&&ht.lineAtlas){const rn=ht.lineAtlas.getDash(zt,En);rn&&ut.setConstantPatternPositions(rn)}let[Pt,sn]=g.paint.get("line-trim-offset");("round"===En||"square"===En)&&Pt!==sn&&(0===Pt&&(Pt-=1),1===sn&&(sn+=1));const Ht=b.terrain?We.projMatrix:null,xn=Ce?Cl(b,ht,g,Ht,U):sc(b,ht,g,Ht,ft.lineClipsArray.length,U,[Pt,sn]);if(Te){const rn=ft.gradients[g.id];let wn=rn.texture;if(g.gradientVersion!==rn.version){let hn=256;if(g.stepInterpolant){const Sn=u.getSource().maxzoom,yi=We.canonical.z===Sn?Math.ceil(1<<b.transform.maxZoom-We.canonical.z):1;hn=m.clamp(m.nextPowerOfTwo(ft.maxLineLength/m.EXTENT*1024*yi),256,Le.maxTextureSize)}rn.gradient=m.renderColorRamp({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:hn,image:rn.gradient||void 0,clips:ft.lineClipsArray}),rn.texture?rn.texture.update(rn.gradient):rn.texture=new m.Texture(Le,rn.gradient,ee.RGBA),rn.version=g.gradientVersion,wn=rn.texture}Le.activeTexture.set(ee.TEXTURE1),wn.bind(g.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}H&&(Le.activeTexture.set(ee.TEXTURE0),ht.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),ut.updatePaintBuffers()),Ce&&(Le.activeTexture.set(ee.TEXTURE0),ht.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),ut.updatePaintBuffers()),b.prepareDrawProgram(Le,St,We.toUnwrapped());const Bt=rn=>{St.draw(Le,ee.TRIANGLES,N,rn,B,m.CullFaceMode.disabled,xn,g.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,g.paint,b.transform.zoom,ut,[ft.layoutVertexBuffer2])};if(Ge){const rn=b.stencilModeForClipping(We).ref;0===rn&&b.terrain&&Le.clear({stencil:0});const wn={func:ee.EQUAL,mask:255};xn.u_alpha_discard_threshold=.8,Bt(new m.StencilMode(wn,rn,255,ee.KEEP,ee.KEEP,ee.INVERT)),xn.u_alpha_discard_threshold=0,Bt(new m.StencilMode(wn,rn,255,ee.KEEP,ee.KEEP,ee.KEEP))}else Bt(b.stencilModeForClipping(We))}Ge&&(b.resetStencilClippingMasks(),b.terrain&&Le.clear({stencil:0}))},fill:function(b,u,g,C){const I=g.paint.get("fill-color"),P=g.paint.get("fill-opacity");if(0===P.constantOr(1))return;const N=b.colorModeForRenderPass(),B=g.paint.get("fill-pattern"),U=b.opaquePassEnabledForLayer()&&!B.constantOr(1)&&1===I.constantOr(m.Color.transparent).a&&1===P.constantOr(0)?"opaque":"translucent";if(b.renderPass===U){const q=b.depthModeForSublayer(1,"opaque"===b.renderPass?m.DepthMode.ReadWrite:m.DepthMode.ReadOnly);Hd(b,u,g,C,q,N,!1)}if("translucent"===b.renderPass&&g.paint.get("fill-antialias")){const q=b.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,m.DepthMode.ReadOnly);Hd(b,u,g,C,q,N,!0)}},"fill-extrusion":function(b,u,g,C){const I=g.paint.get("fill-extrusion-opacity");if(0!==I&&"translucent"===b.renderPass){const P=new m.DepthMode(b.context.gl.LEQUAL,m.DepthMode.ReadWrite,b.depthRangeFor3D);if(1!==I||g.paint.get("fill-extrusion-pattern").constantOr(1))Lc(b,u,g,C,P,m.StencilMode.disabled,m.ColorMode.disabled),Lc(b,u,g,C,P,b.stencilModeFor3D(),b.colorModeForRenderPass()),b.resetStencilClippingMasks();else{const N=b.colorModeForRenderPass();Lc(b,u,g,C,P,m.StencilMode.disabled,N)}}},hillshade:function(b,u,g,C){if("offscreen"!==b.renderPass&&"translucent"!==b.renderPass)return;const I=b.context,P=b.depthModeForSublayer(0,m.DepthMode.ReadOnly),N=b.colorModeForRenderPass(),B=b.terrain&&b.terrain.renderingToTexture,[U,q]="translucent"!==b.renderPass||B?[{},C]:b.stencilConfigForOverlap(C);for(const H of q){const J=u.getTile(H);if(J.needsHillshadePrepare&&"offscreen"===b.renderPass)Gd(b,J,g,P,m.StencilMode.disabled,N);else if("translucent"===b.renderPass){const _e=B&&b.terrain?b.terrain.stencilModeForRTTOverlap(H):U[H.overscaledZ];os(b,H,J,g,P,_e,N)}}I.viewport.set([0,0,b.width,b.height]),b.resetStencilClippingMasks()},raster:function(b,u,g,C,I,P){if("translucent"!==b.renderPass||0===g.paint.get("raster-opacity")||!C.length)return;const N=b.context,B=N.gl,U=u.getSource(),q=b.useProgram("raster"),H=b.colorModeForRenderPass(),J=b.terrain&&b.terrain.renderingToTexture,[_e,Ce]=U instanceof Yi||J?[{},C]:b.stencilConfigForOverlap(C),Te=Ce[Ce.length-1].overscaledZ,Pe=!b.options.moving;for(const Le of Ce){const ee=J?m.DepthMode.disabled:b.depthModeForSublayer(Le.overscaledZ-Te,1===g.paint.get("raster-opacity")?m.DepthMode.ReadWrite:m.DepthMode.ReadOnly,B.LESS),Se=Le.toUnwrapped(),Ge=u.getTile(Le);if(J&&(!Ge||!Ge.hasData()))continue;const We=J?Le.projMatrix:b.transform.calculateProjMatrix(Se,Pe),ht=b.terrain&&J?b.terrain.stencilModeForRTTOverlap(Le):_e[Le.overscaledZ],ft=P?0:g.paint.get("raster-fade-duration");Ge.registerFadeDuration(ft);const ut=u.findLoadedParent(Le,0),St=Du(Ge,ut,u,b.transform,ft);let bt,zt;b.terrain&&b.terrain.prepareDrawTile();const En="nearest"===g.paint.get("raster-resampling")?B.NEAREST:B.LINEAR;N.activeTexture.set(B.TEXTURE0),Ge.texture.bind(En,B.CLAMP_TO_EDGE),N.activeTexture.set(B.TEXTURE1),ut?(ut.texture.bind(En,B.CLAMP_TO_EDGE),bt=Math.pow(2,ut.tileID.overscaledZ-Ge.tileID.overscaledZ),zt=[Ge.tileID.canonical.x*bt%1,Ge.tileID.canonical.y*bt%1]):Ge.texture.bind(En,B.CLAMP_TO_EDGE),Ge.texture.useMipmap&&N.extTextureFilterAnisotropic&&b.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const Pt=Ps(We,zt||[0,0],bt||1,St,g,U instanceof Yi?U.perspectiveTransform:[0,0]);if(b.prepareDrawProgram(N,q,Se),U instanceof Yi)U.boundsBuffer&&U.boundsSegments&&q.draw(N,B.TRIANGLES,ee,m.StencilMode.disabled,H,m.CullFaceMode.disabled,Pt,g.id,U.boundsBuffer,b.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:sn,tileBoundsIndexBuffer:Ht,tileBoundsSegments:xn}=b.getTileBoundsBuffers(Ge);q.draw(N,B.TRIANGLES,ee,ht,H,m.CullFaceMode.disabled,Pt,g.id,sn,Ht,xn)}}b.resetStencilClippingMasks()},background:function(b,u,g,C){const I=g.paint.get("background-color"),P=g.paint.get("background-opacity");if(0===P)return;const N=b.context,B=N.gl,U=b.transform,q=U.tileSize,H=g.paint.get("background-pattern");if(b.isPatternMissing(H))return;const J=!H&&1===I.a&&1===P&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==J)return;const _e=m.StencilMode.disabled,Ce=b.depthModeForSublayer(0,"opaque"===J?m.DepthMode.ReadWrite:m.DepthMode.ReadOnly),Te=b.colorModeForRenderPass(),Pe=b.useProgram(H?"backgroundPattern":"background");let Le,ee=C;ee||(Le=b.getBackgroundTiles(),ee=Object.values(Le).map(Se=>Se.tileID)),H&&(N.activeTexture.set(B.TEXTURE0),b.imageManager.bind(b.context));for(const Se of ee){const Ge=Se.toUnwrapped(),We=C?Se.projMatrix:b.transform.calculateProjMatrix(Ge);b.prepareDrawTile();const ht=u?u.getTile(Se):Le?Le[Se.key]:new m.Tile(Se,q,U.zoom,b),ft=H?Yu(We,P,b,H,{tileID:Se,tileSize:q}):iu(We,P,I);b.prepareDrawProgram(N,Pe,Ge);const{tileBoundsBuffer:ut,tileBoundsIndexBuffer:St,tileBoundsSegments:bt}=b.getTileBoundsBuffers(ht);Pe.draw(N,B.TRIANGLES,Ce,_e,Te,m.CullFaceMode.disabled,ft,g.id,ut,St,bt)}},sky:function(b,u,g){const C=b.transform,I="mercator"===C.projection.name||"globe"===C.projection.name?1:m.smoothstep(7,8,C.zoom),P=g.paint.get("sky-opacity")*I;if(0===P)return;const N=b.context,B=g.paint.get("sky-type"),U=new m.DepthMode(N.gl.LEQUAL,m.DepthMode.ReadOnly,[0,1]),q=b.frameCounter/1e3%1;"atmosphere"===B?"offscreen"===b.renderPass?g.needsSkyboxCapture(b)&&(function(H,J,_e,Ce){const Te=H.context,Pe=Te.gl;let Le=J.skyboxFbo;if(!Le){Le=J.skyboxFbo=Te.createFramebuffer(32,32,!1),J.skyboxGeometry=new Nc(Te),J.skyboxTexture=Te.gl.createTexture(),Pe.bindTexture(Pe.TEXTURE_CUBE_MAP,J.skyboxTexture),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_WRAP_S,Pe.CLAMP_TO_EDGE),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_WRAP_T,Pe.CLAMP_TO_EDGE),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_MIN_FILTER,Pe.LINEAR),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_MAG_FILTER,Pe.LINEAR);for(let We=0;We<6;++We)Pe.texImage2D(Pe.TEXTURE_CUBE_MAP_POSITIVE_X+We,0,Pe.RGBA,32,32,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null)}Te.bindFramebuffer.set(Le.framebuffer),Te.viewport.set([0,0,32,32]);const ee=J.getCenter(H,!0),Se=H.useProgram("skyboxCapture"),Ge=new Float64Array(16);m.identity(Ge),m.rotateY(Ge,Ge,.5*-Math.PI),Gi(Te,J,Se,Ge,ee,0),m.identity(Ge),m.rotateY(Ge,Ge,.5*Math.PI),Gi(Te,J,Se,Ge,ee,1),m.identity(Ge),m.rotateX(Ge,Ge,.5*-Math.PI),Gi(Te,J,Se,Ge,ee,2),m.identity(Ge),m.rotateX(Ge,Ge,.5*Math.PI),Gi(Te,J,Se,Ge,ee,3),m.identity(Ge),Gi(Te,J,Se,Ge,ee,4),m.identity(Ge),m.rotateY(Ge,Ge,Math.PI),Gi(Te,J,Se,Ge,ee,5),Te.viewport.set([0,0,H.width,H.height])}(b,g),g.markSkyboxValid(b)):"sky"===b.renderPass&&function(H,J,_e,Ce,Te){const Pe=H.context,Le=Pe.gl,ee=H.transform,Se=H.useProgram("skybox");Pe.activeTexture.set(Le.TEXTURE0),Le.bindTexture(Le.TEXTURE_CUBE_MAP,J.skyboxTexture);const Ge={u_matrix:ee.skyboxMatrix,u_sun_direction:J.getCenter(H,!1),u_cubemap:0,u_opacity:Ce,u_temporal_offset:Te};H.prepareDrawProgram(Pe,Se),Se.draw(Pe,Le.TRIANGLES,_e,m.StencilMode.disabled,H.colorModeForRenderPass(),m.CullFaceMode.backCW,Ge,"skybox",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)}(b,g,U,P,q):"gradient"===B&&"sky"===b.renderPass&&function(H,J,_e,Ce,Te){const Pe=H.context,Le=Pe.gl,ee=H.transform,Se=H.useProgram("skyboxGradient");J.skyboxGeometry||(J.skyboxGeometry=new Nc(Pe)),Pe.activeTexture.set(Le.TEXTURE0);let Ge=J.colorRampTexture;Ge||(Ge=J.colorRampTexture=new m.Texture(Pe,J.colorRamp,Le.RGBA)),Ge.bind(Le.LINEAR,Le.CLAMP_TO_EDGE);const We=(ht=ee.skyboxMatrix,ft=J.getCenter(H,!1),ut=J.paint.get("sky-gradient-radius"),St=Ce,bt=Te,{u_matrix:ht,u_color_ramp:0,u_center_direction:ft,u_radius:m.degToRad(ut),u_opacity:St,u_temporal_offset:bt});var ht,ft,ut,St,bt;H.prepareDrawProgram(Pe,Se),Se.draw(Pe,Le.TRIANGLES,_e,m.StencilMode.disabled,H.colorModeForRenderPass(),m.CullFaceMode.backCW,We,"skyboxGradient",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)}(b,g,U,P,q)},debug:function(b,u,g){for(let C=0;C<g.length;C++)ou(b,u,g[C])},custom:function(b,u,g,C){const I=b.context,P=g.implementation;if(!b.transform.projection.unsupportedLayers||!b.transform.projection.unsupportedLayers.includes("custom")||b.terrain&&(b.terrain.renderingToTexture||"offscreen"===b.renderPass)&&g.isLayerDraped()){if("offscreen"===b.renderPass){const N=P.prerender;if(N){if(b.setCustomLayerDefaults(),I.setColorMode(b.colorModeForRenderPass()),"globe"===b.transform.projection.name){const B=b.transform.pointMerc;N.call(P,I.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),m.globeToMercatorTransition(b.transform.zoom),[B.x,B.y],b.transform.pixelsPerMeterRatio)}else N.call(P,I.gl,b.transform.customLayerMatrix());I.setDirty(),b.setBaseState()}}else if("translucent"===b.renderPass){if(b.terrain&&b.terrain.renderingToTexture){const B=P.renderToTile;if(B){const U=C[0].canonical,q=new m.MercatorCoordinate(U.x+C[0].wrap*(1<<U.z),U.y,U.z);I.setDepthMode(m.DepthMode.disabled),I.setStencilMode(m.StencilMode.disabled),I.setColorMode(b.colorModeForRenderPass()),b.setCustomLayerDefaults(),B.call(P,I.gl,q),I.setDirty(),b.setBaseState()}return}b.setCustomLayerDefaults(),I.setColorMode(b.colorModeForRenderPass()),I.setStencilMode(m.StencilMode.disabled);const N="3d"===P.renderingMode?new m.DepthMode(b.context.gl.LEQUAL,m.DepthMode.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,m.DepthMode.ReadOnly);if(I.setDepthMode(N),"globe"===b.transform.projection.name){const B=b.transform.pointMerc;P.render(I.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),m.globeToMercatorTransition(b.transform.zoom),[B.x,B.y],b.transform.pixelsPerMeterRatio)}else P.render(I.gl,b.transform.customLayerMatrix());I.setDirty(),b.setBaseState(),I.bindFramebuffer.set(null)}}else m.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class xr{constructor(u,g,C=!1){this.context=new _n(u,C),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=m.SourceCache.maxUnderzooming+m.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(u,g){const C=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(C||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Tu(this,u));const I=this._terrain;this.transform.elevation=C?I:null,I.update(u,this.transform,g)}_updateFog(u){const g=u.fog;if(!g||"globe"===this.transform.projection.name||g.getOpacity(this.transform.pitch)<1||g.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[C,I]=g.getFovAdjustedRange(this.transform._fov);if(C>I)return void(this.transform.fogCullDistSq=null);const P=C+.78*(I-C);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(u,g){if(this.width=u*m.exported.devicePixelRatio,this.height=g*m.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style.order)this.style._layers[C].resize()}setup(){const u=this.context,g=new m.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(m.EXTENT,0),g.emplaceBack(0,m.EXTENT),g.emplaceBack(m.EXTENT,m.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(g,m.posAttributes.members),this.tileExtentSegments=m.SegmentVector.simpleSegment(0,0,4,2);const C=new m.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(m.EXTENT,0),C.emplaceBack(0,m.EXTENT),C.emplaceBack(m.EXTENT,m.EXTENT),this.debugBuffer=u.createVertexBuffer(C,m.posAttributes.members),this.debugSegments=m.SegmentVector.simpleSegment(0,0,4,5);const I=new m.StructArrayLayout2i4;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(-1,1),I.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(I,m.posAttributes.members),this.viewportSegments=m.SegmentVector.simpleSegment(0,0,4,2);const P=new m.StructArrayLayout4i8;P.emplaceBack(0,0,0,0),P.emplaceBack(m.EXTENT,0,m.EXTENT,0),P.emplaceBack(0,m.EXTENT,0,m.EXTENT),P.emplaceBack(m.EXTENT,m.EXTENT,m.EXTENT,m.EXTENT),this.mercatorBoundsBuffer=u.createVertexBuffer(P,m.boundsAttributes.members),this.mercatorBoundsSegments=m.SegmentVector.simpleSegment(0,0,4,2);const N=new m.StructArrayLayout3ui6;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(N);const B=new m.StructArrayLayout1ui2;for(const q of[0,1,3,2,0])B.emplaceBack(q);this.debugIndexBuffer=u.createIndexBuffer(B),this.emptyTexture=new m.Texture(u,new m.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA),this.identityMat=m.create();const U=this.context.gl;this.stencilClearMode=new m.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(m.window.performance.now()),this.atmosphereBuffer=new xh(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context,g=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(u,g.TRIANGLES,m.DepthMode.disabled,this.stencilClearMode,m.ColorMode.disabled,m.CullFaceMode.disabled,Ki(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,g,C){if(!g||this.currentStencilSource===g.id||!u.isTileClipped()||!C||0===C.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let B=!1;for(const U of C)if(void 0===this._tileClippingMaskIDs[U.key]){B=!0;break}if(!B)return}this.currentStencilSource=g.id;const I=this.context,P=I.gl;this.nextStencilID+C.length>256&&this.clearStencil(),I.setColorMode(m.ColorMode.disabled),I.setDepthMode(m.DepthMode.disabled);const N=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const B of C){const U=g.getTile(B),q=this._tileClippingMaskIDs[B.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:J,tileBoundsSegments:_e}=this.getTileBoundsBuffers(U);N.draw(I,P.TRIANGLES,m.DepthMode.disabled,new m.StencilMode({func:P.ALWAYS,mask:0},q,255,P.KEEP,P.KEEP,P.REPLACE),m.ColorMode.disabled,m.CullFaceMode.disabled,Ki(B.projMatrix),"$clipping",H,J,_e)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,g=this.context.gl;return new m.StencilMode({func:g.NOTEQUAL,mask:255},u,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const g=this.context.gl;return new m.StencilMode({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(u){const g=this.context.gl,C=u.sort((N,B)=>B.overscaledZ-N.overscaledZ),I=C[C.length-1].overscaledZ,P=C[0].overscaledZ-I+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const N={};for(let B=0;B<P;B++)N[B+I]=new m.StencilMode({func:g.GEQUAL,mask:255},B+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=P,[N,C]}return[{[I]:m.StencilMode.disabled},C]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new m.ColorMode([u.CONSTANT_COLOR,u.ONE],new m.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?m.ColorMode.unblended:m.ColorMode.alphaBlended}depthModeForSublayer(u,g,C){if(!this.opaquePassEnabledForLayer())return m.DepthMode.disabled;const I=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new m.DepthMode(C||this.context.gl.LEQUAL,g,[I,I])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,g){this.style=u,this.options=g,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(m.exported.now()),this.imageManager.beginFrame();const C=this.style.order,I=this.style._sourceCaches;for(const q in I){const H=I[q];H.used&&H.prepare(this.context)}const P={},N={},B={};for(const q in I){const H=I[q];P[q]=H.getVisibleCoordinates(),N[q]=P[q].slice().reverse(),B[q]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let q=0;q<C.length;q++)if(this.style._layers[C[q]].is3D()){this.opaquePassCutoff=q;break}if(this.terrain&&(this.terrain.updateTileBinding(B),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new m.GlobeSharedBuffers(this.context)),!m.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const q of C){const H=this.style._layers[q],J=u._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const _e=J?N[J.id]:void 0;("custom"===H.type||H.isSky()||_e&&_e.length)&&this.renderLayer(this,J,H,_e)}this.depthRangeFor3D=[0,1-(u.order.length+2)*this.numSublayers*this.depthEpsilon];const U=this.terrain;if(U&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&U.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:g.showOverdrawInspector?m.Color.black:m.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){const q=this.style._layers[C[this.currentLayer]],H=u._getLayerSourceCache(q);if(q.isSky())continue;const J=H?N[H.id]:void 0;this._renderTileClippingMasks(q,H,J),this.renderLayer(this,H,q,J)}if(this.style.fog&&this.transform.projection.supportsFog&&function(q,H){const J=q.context,_e=J.gl,Ce=q.transform,Te=new m.DepthMode(_e.LEQUAL,m.DepthMode.ReadOnly,[0,1]),Pe=q.useProgram("globeAtmosphere",null,"globe"===Ce.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Le=m.globeToMercatorTransition(Ce.zoom),ee=H.properties.get("color").toArray01(),Se=H.properties.get("high-color").toArray01(),Ge=H.properties.get("space-color").toArray01PremultipliedAlpha(),We=m.identity$1([]);m.rotateY$1(We,We,-m.degToRad(Ce._center.lng)),m.rotateX$1(We,We,m.degToRad(Ce._center.lat)),m.rotateZ$1(We,We,Ce.angle),m.rotateX$1(We,We,-Ce._pitch);const ht=m.fromQuat(new Float32Array(16),We),ft=m.mapValue(H.properties.get("star-intensity"),0,1,0,.25),St=m.mapValue(H.properties.get("horizon-blend"),0,1,5e-4,.25),bt=m.globeUseCustomAntiAliasing(q,J,Ce)&&5e-4===St?Ce.worldSize/(2*Math.PI*1.025)-1:Ce.globeRadius,zt=q.frameCounter/1e3%1,En=m.length(Ce.globeCenterInViewSpace),Pt=Math.sqrt(Math.pow(En,2)-Math.pow(bt,2)),sn=Math.acos(Pt/En),Ht={u_frustum_tl:Ce.frustumCorners.TL,u_frustum_tr:Ce.frustumCorners.TR,u_frustum_br:Ce.frustumCorners.BR,u_frustum_bl:Ce.frustumCorners.BL,u_horizon:Ce.frustumCorners.horizon,u_transition:Le,u_fadeout_range:St,u_color:ee,u_high_color:Se,u_space_color:Ge,u_star_intensity:ft,u_star_size:5*m.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:zt,u_horizon_angle:sn,u_rotation_matrix:ht};q.prepareDrawProgram(J,Pe);const xn=q.atmosphereBuffer;xn&&Pe.draw(J,_e.TRIANGLES,Te,m.StencilMode.disabled,m.ColorMode.alphaBlended,m.CullFaceMode.backCW,Ht,"skybox",xn.vertexBuffer,xn.indexBuffer,xn.segments)}(this,this.style.fog),this.renderPass="sky",(m.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){const q=this.style._layers[C[this.currentLayer]],H=u._getLayerSourceCache(q);q.isSky()&&this.renderLayer(this,H,q,H?N[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<C.length;){const q=this.style._layers[C[this.currentLayer]],H=u._getLayerSourceCache(q);if(q.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(q)){if(q.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const J=H?("symbol"===q.type?B:N)[H.id]:void 0;this._renderTileClippingMasks(q,H,H?P[H.id]:void 0),this.renderLayer(this,H,q,J),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let q=null;m.values(this.style._layers).forEach(H=>{const J=u._getLayerSourceCache(H);J&&!H.isHidden(this.transform.zoom)&&(!q||q.getSource().maxzoom<J.getSource().maxzoom)&&(q=J)}),q&&this.options.showTileBoundaries&&ss.debug(this,q,q.getVisibleCoordinates())}this.options.showPadding&&function(q){const H=q.transform.padding;Au(q,q.transform.height-(H.top||0),3,al),Au(q,H.bottom||0,3,pa),ks(q,H.left||0,3,Os),ks(q,q.transform.width-(H.right||0),3,Ta);const J=q.transform.centerPoint;var _e,Ce,Te,Pe;Ds(_e=q,(Ce=J.x)-1,(Te=q.transform.height-J.y)-10,2,20,Pe=pf),Ds(_e,Ce-10,Te-1,20,2,Pe)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(m.window.performance.now()),this.saveCanvasCopy())}renderLayer(u,g,C,I){C.isHidden(this.transform.zoom)||("background"===C.type||"sky"===C.type||"custom"===C.type||I&&I.length)&&(this.id=C.id,this.gpuTimingStart(C),(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes(C.type)||u.terrain&&"custom"===C.type)&&ss[C.type](u,g,C,I,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery;let C=this.gpuTimers[u.id];C||(C=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:g.createQueryEXT()}),C.calls++,g.beginQueryEXT(g.TIME_ELAPSED_EXT,C.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,g=u.createQueryEXT();this.deferredRenderGpuTimeQueries.push(g),u.beginQueryEXT(u.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const g={};for(const C in u){const I=u[C],P=this.context.extTimerQuery,N=P.getQueryObjectEXT(I.query,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(I.query),g[C]=N}return g}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const g=this.context.extTimerQuery;let C=0;for(const I of u)C+=g.getQueryObjectEXT(I,g.QUERY_RESULT_EXT)/1e6,g.deleteQueryEXT(I);return C}translatePosMatrix(u,g,C,I,P){if(!C[0]&&!C[1])return u;const N=P?"map"===I?this.transform.angle:0:"viewport"===I?-this.transform.angle:0;if(N){const q=Math.sin(N),H=Math.cos(N);C=[C[0]*H-C[1]*q,C[0]*q+C[1]*H]}const B=[P?C[0]:it(g,C[0],this.transform.zoom),P?C[1]:it(g,C[1],this.transform.zoom),0],U=new Float32Array(16);return m.translate(U,u,B),U}saveTileTexture(u){const g=this._tileTextures[u.size[0]];g?g.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const g=this._tileTextures[u];return g&&g.length>0?g.pop():null}isPatternMissing(u){return null===u||void 0!==u&&!this.imageManager.getPattern(u.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const u=this.terrain&&this.terrain.renderingToTexture,g=this.terrain&&0===this.terrain.exaggeration(),C=this.style&&this.style.fog,I=[];return this.terrainRenderModeElevated()&&I.push("TERRAIN"),"globe"===this.transform.projection.name&&I.push("GLOBE"),g&&I.push("ZERO_EXAGGERATION"),C&&!u&&0!==C.getOpacity(this.transform.pitch)&&I.push("FOG"),u&&I.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&I.push("OVERDRAW_INSPECTOR"),I}useProgram(u,g,C){this.cache=this.cache||{};const I=C||[],P=this.currentGlobalDefines().concat(I),N=hr.cacheKey(jo[u],u,P,g);return this.cache[N]||(this.cache[N]=new hr(this.context,u,jo[u],g,ac[u],P)),this.cache[N]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=m.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new m.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(u,g,C){if(this.terrain&&this.terrain.renderingToTexture)return;const I=this.style.fog;if(I){const P=I.getOpacity(this.transform.pitch),N=((B,U,q,H,J,_e,Ce,Te,Pe,Le,ee)=>{const Se=B.transform,Ge=U.properties.get("color").toArray01();Ge[3]=H;const We=B.frameCounter/1e3%1;return{u_fog_matrix:q?Se.calculateFogTileMatrix(q):B.identityMat,u_fog_range:U.getFovAdjustedRange(Se._fov),u_fog_color:Ge,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:We,u_frustum_tl:J,u_frustum_tr:_e,u_frustum_br:Ce,u_frustum_bl:Te,u_globe_pos:Pe,u_globe_radius:Le,u_viewport:ee,u_globe_transition:m.globeToMercatorTransition(Se.zoom),u_is_globe:+("globe"===Se.projection.name)}})(this,I,C,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*m.exported.devicePixelRatio,this.transform.height*m.exported.devicePixelRatio]);g.setFogUniformValues(u,N)}}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,g=u.createTexture();return u.bindTexture(u.TEXTURE_2D,g),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),g}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&0!==u.getOpacity(this.transform.pitch)}getBackgroundTiles(){const u=this._backgroundTiles,g=this._backgroundTiles={},C=this.transform.coveringTiles({tileSize:512});for(const I of C)g[I.key]=u[I.key]||new m.Tile(I,512,this.transform.tileZoom,this);return g}clearBackgroundTiles(){this._backgroundTiles={}}}class cl{constructor(u=0,g=0,C=0,I=0){if(isNaN(u)||u<0||isNaN(g)||g<0||isNaN(C)||C<0||isNaN(I)||I<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=g,this.left=C,this.right=I}interpolate(u,g,C){return null!=g.top&&null!=u.top&&(this.top=m.number(u.top,g.top,C)),null!=g.bottom&&null!=u.bottom&&(this.bottom=m.number(u.bottom,g.bottom,C)),null!=g.left&&null!=u.left&&(this.left=m.number(u.left,g.left,C)),null!=g.right&&null!=u.right&&(this.right=m.number(u.right,g.right,C)),this}getCenter(u,g){const C=m.clamp((this.left+u-this.right)/2,0,u),I=m.clamp((this.top+g-this.bottom)/2,0,g);return new m.Point(C,I)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new cl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gs(b,u){const g=m.getColumn(b,3);m.fromQuat(b,u),m.setColumn(b,3,g)}function vn(b,u){const g=m.identity$1([]);return m.rotateZ$1(g,g,-u),m.rotateX$1(g,g,-b),g}function _s(b,u){const g=[b[0],b[1],0],C=[u[0],u[1],0];if(m.length(g)>=1e-15){const N=m.normalize([],g);m.scale$2(C,N,m.dot(C,N)),u[0]=C[0],u[1]=C[1]}const I=m.cross([],u,b);if(m.len(I)<1e-15)return null;const P=Math.atan2(-I[1],I[0]);return vn(Math.atan2(Math.sqrt(b[0]*b[0]+b[1]*b[1]),-b[2]),P)}class _r{constructor(u,g){this.position=u,this.orientation=g}get position(){return this._position}set position(u){if(u){const g=u instanceof m.MercatorCoordinate?u:new m.MercatorCoordinate(u[0],u[1],u[2]);this._renderWorldCopies&&(g.x=m.wrap(g.x,0,1)),this._position=g}else this._position=null}lookAtPoint(u,g){if(this.orientation=null,!this.position)return;const C=this.position,I=this._elevation?this._elevation.getAtPointOrZero(m.MercatorCoordinate.fromLngLat(u)):0,P=m.MercatorCoordinate.fromLngLat(u,I),N=[P.x-C.x,P.y-C.y,P.z-C.z];g||(g=[0,0,1]),g[2]=Math.abs(g[2]),this.orientation=_s(N,g)}setPitchBearing(u,g){this.orientation=vn(m.degToRad(u),m.degToRad(-g))}}class Eo{constructor(u,g){this._transform=m.identity([]),this.orientation=g,this.position=u}get mercatorPosition(){const u=this.position;return new m.MercatorCoordinate(u[0],u[1],u[2])}get position(){const u=m.getColumn(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var g;u&&m.setColumn(this._transform,3,[(g=u)[0],g[1],g[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||m.identity$1([]),u&&gs(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),g=this.right();return{bearing:Math.atan2(-g[1],g[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,g){this._orientation=vn(u,g),gs(this._transform,this._orientation)}forward(){const u=m.getColumn(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=m.getColumn(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=m.getColumn(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,g){const C=new Float64Array(16);return m.invert(C,this.getWorldToCamera(u,g)),C}getWorldToCameraPosition(u,g,C){const I=this.position;m.scale$2(I,I,-u);const P=new Float64Array(16);return m.fromScaling(P,[C,C,C]),m.translate(P,P,I),P[10]*=g,P}getWorldToCamera(u,g){const C=new Float64Array(16),I=new Float64Array(4),P=this.position;return m.conjugate(I,this._orientation),m.scale$2(P,P,-u),m.fromQuat(C,I),m.translate(C,C,P),C[1]*=-1,C[5]*=-1,C[9]*=-1,C[13]*=-1,C[8]*=g,C[9]*=g,C[10]*=g,C[11]*=g,C}getCameraToClipPerspective(u,g,C,I){const P=new Float64Array(16);return m.perspective(P,u,g,C,I),P}getDistanceToElevation(u,g=!1){const C=0===u?0:m.mercatorZfromAltitude(u,g?m.latFromMercatorY(this.position[1]):this.position[1]),I=this.forward();return(C-this.position[2])/I[2]}clone(){return new Eo([...this.position],[...this.orientation])}}function as(b,u){const g=ls(b.projection,b.zoom,b.width,b.height),C=function(P,N,B,U,q){const H=new m.LngLat(B.lng-180*Fr,B.lat),J=new m.LngLat(B.lng+180*Fr,B.lat),_e=P.project(H.lng,H.lat),Ce=P.project(J.lng,J.lat),Te=-Math.atan2(Ce.y-_e.y,Ce.x-_e.x),Pe=m.MercatorCoordinate.fromLngLat(B);Pe.y=m.clamp(Pe.y,-1+Fr,1-Fr);const Le=Pe.toLngLat(),ee=P.project(Le.lng,Le.lat),Se=m.MercatorCoordinate.fromLngLat(Le);Se.x+=Fr;const Ge=Se.toLngLat(),We=P.project(Ge.lng,Ge.lat),ht=Pu(We.x-ee.x,We.y-ee.y,Te),ft=m.MercatorCoordinate.fromLngLat(Le);ft.y+=Fr;const ut=ft.toLngLat(),St=P.project(ut.lng,ut.lat),bt=Pu(St.x-ee.x,St.y-ee.y,Te),zt=Math.abs(ht.x)/Math.abs(bt.y),En=m.identity([]);m.rotateZ(En,En,-Te*(1-(q?0:U)));const Pt=m.identity([]);return m.scale(Pt,Pt,[1,1-(1-zt)*U,1]),Pt[4]=-bt.x/bt.y*U,m.rotateZ(Pt,Pt,Te),m.multiply(Pt,En,Pt),Pt}(b.projection,0,b.center,g,u),I=Ls(b);return m.scale(C,C,[I,I,1]),C}function Ls(b){const u=b.projection,g=ls(b.projection,b.zoom,b.width,b.height),C=bh(u,b.center),I=bh(u,m.LngLat.convert(u.center));return Math.pow(2,C*g+(1-g)*I)}function ls(b,u,g,C,I=1/0){const P=b.range;if(!P)return 0;const N=Math.min(I,Math.max(g,C)),B=Math.log(N/1024)/Math.LN2;return m.smoothstep(P[0]+B,P[1]+B,u)}const Fr=1/4e4;function bh(b,u){const g=m.clamp(u.lat,-m.MAX_MERCATOR_LATITUDE,m.MAX_MERCATOR_LATITUDE),C=new m.LngLat(u.lng-180*Fr,g),I=new m.LngLat(u.lng+180*Fr,g),P=b.project(C.lng,g),N=b.project(I.lng,g),B=m.MercatorCoordinate.fromLngLat(C),U=m.MercatorCoordinate.fromLngLat(I),q=N.x-P.x,H=N.y-P.y,J=U.x-B.x,_e=U.y-B.y,Ce=Math.sqrt((J*J+_e*_e)/(q*q+H*H));return Math.log(Ce)/Math.LN2}function Pu(b,u,g){const C=Math.cos(g),I=Math.sin(g);return{x:b*C-u*I,y:b*I+u*C}}class Ns{constructor(u,g,C,I,P,N,B){this.tileSize=512,this._renderWorldCopies=void 0===P||P,this._minZoom=u||0,this._maxZoom=g||22,this._minPitch=C??0,this._maxPitch=I??60,this.setProjection(N),this.setMaxBounds(B),this.width=0,this.height=0,this._center=new m.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new cl,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Eo,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const u=new Ns(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(u,g=!1){const C=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||C)&&this._updateCameraOnTerrain(),(u||C)&&this._constrainCamera(g),this._calcMatrices()}getProjection(){return m.pick(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const g=this.projection?this.getProjection():void 0;this.projection=m.getProjection(this.projectionOptions);const C=!xe(g,this.getProjection());return C&&this._calcMatrices(),this.mercatorFromTransition=!1,C}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=m.getProjection({name:"mercator"});const g=u!==this.projection.name;return g&&this._calcMatrices(),g}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(u){void 0===u?u=!0:null===u&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return m.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new m.Point(this.width,this.height)}get bearing(){return m.wrap(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const g=-u*Math.PI/180;var C,I,P,N,B,U,q,H,J,_e;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=(C=new m.ARRAY_TYPE(4),m.ARRAY_TYPE!=Float32Array&&(C[1]=0,C[2]=0),C[0]=1,C[3]=1,C),I=this.rotationMatrix,N=this.angle,B=(P=this.rotationMatrix)[0],U=P[1],q=P[2],H=P[3],J=Math.sin(N),_e=Math.cos(N),I[0]=B*_e+q*J,I[1]=U*_e+H*J,I[2]=B*-J+q*_e,I[3]=U*-J+H*_e)}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const g=m.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=m.degToRad(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const g=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._setZoom(g),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const u=this._elevation;this._centerAltitude=u.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=u.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,g=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],C=this.horizonLineFromTop();let I=0,P=0;for(let N=0;N<g.length;N++){const B=new m.Point(g[N][0]*this.width,C+g[N][1]*(this.height-C)),U=u.pointCoordinate(B);if(!U)continue;const q=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);I+=U[3]*q,P+=q}return 0===P?NaN:I/P}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const u=this._seaLevelZoom,g=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),C=this.pixelsPerMeter/this.worldSize*g,I=this._mercatorZfromZoom(u),P=this._mercatorZfromZoom(this._maxZoom),N=Math.max(I-C,P);this._setZoom(this._zoomFromMercatorZ(N))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const g=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let C;C=u.z<this._camera.position[2]?[g.x,g.y,g.z]:[u.x,u.y,u.z];const I=m.length(m.sub([],this._camera.position,C));return m.clamp(this._zoomFromMercatorZ(I),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let g=!1;if(u.orientation&&!m.exactEquals(u.orientation,this._camera.orientation)&&(g=this._setCameraOrientation(u.orientation)),u.position){const C=[u.position.x,u.position.y,u.position.z];m.exactEquals$1(C,this._camera.position)||(this._setCameraPosition(C),g=!0)}g&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,g=new _r;return g.position=new m.MercatorCoordinate(u[0],u[1],u[2]),g.orientation=this._camera.orientation,g._elevation=this.elevation,g._renderWorldCopies=this.renderWorldCopies,g}_setCameraOrientation(u){if(!m.length$1(u))return!1;m.normalize$1(u,u);const g=m.transformQuat([],[0,0,-1],u),C=m.transformQuat([],[0,-1,0],u);if(C[2]<0)return!1;const I=_s(g,C);return!!I&&(this._camera.orientation=I,!0)}_setCameraPosition(u){const g=this.zoomScale(this.minZoom)*this.tileSize,C=this.zoomScale(this.maxZoom)*this.tileSize,I=this.cameraToCenterDistance;u[2]=m.clamp(u[2],I/C,I/g),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,g,C){this._unmodified=!1,this._edgeInsets.interpolate(u,g,C),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const g=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(u){const g=[new m.UnwrappedTileID(0,u)];if(this.renderWorldCopies){const C=this.pointCoordinate(new m.Point(0,0)),I=this.pointCoordinate(new m.Point(this.width,0)),P=this.pointCoordinate(new m.Point(this.width,this.height)),N=this.pointCoordinate(new m.Point(0,this.height)),B=Math.floor(Math.min(C.x,I.x,P.x,N.x)),U=Math.floor(Math.max(C.x,I.x,P.x,N.x)),q=1;for(let H=B-q;H<=U+q;H++)0!==H&&g.push(new m.UnwrappedTileID(H,u))}return g}coveringTiles(u){let g=this.coveringZoomLevel(u);const C=g,I=this.elevation&&!u.isTerrainDEM,P="mercator"===this.projection.name;if(void 0!==u.minzoom&&g<u.minzoom)return[];void 0!==u.maxzoom&&g>u.maxzoom&&(g=u.maxzoom);const N=this.locationCoordinate(this.center),B=this.center.lat,U=1<<g,q=[U*N.x,U*N.y,0],H="globe"===this.projection.name,J=!H,_e=m.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g,J),Ce=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Te=U*m.mercatorZfromAltitude(1,this.center.lat),Pe=this._camera.position[2]/m.mercatorZfromAltitude(1,this.center.lat),Le=[U*Ce.x,U*Ce.y,Pe*(J?1:Te)],ee=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),Se=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?g:0,Ge=u.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,We=u.isTerrainDEM?-Ge:this._elevation?this._elevation.getMinElevationBelowMSL():0,ht=this.projection.isReprojectedInTileSpace?Ls(this):1,ft=Bt=>{const wn=new m.MercatorCoordinate(Bt.x+25e-6,Bt.y,Bt.z),hn=new m.MercatorCoordinate(Bt.x,Bt.y+25e-6,Bt.z),Sn=Bt.toLngLat(),yi=wn.toLngLat(),$i=hn.toLngLat(),ei=this.locationCoordinate(Sn),ii=this.locationCoordinate(yi),fr=this.locationCoordinate($i),pr=Math.hypot(ii.x-ei.x,ii.y-ei.y),di=Math.hypot(fr.x-ei.x,fr.y-ei.y);return Math.sqrt(pr*di)*ht/25e-6},ut=Bt=>{const rn=Ge,wn=We;return{aabb:m.tileAABB(this,U,0,0,0,Bt,wn,rn,this.projection),zoom:0,x:0,y:0,minZ:wn,maxZ:rn,wrap:Bt,fullyVisible:!1}},St=[];let bt=[];const zt=g,En=u.reparseOverscaled?C:g,Pt=Bt=>Bt*Bt,sn=Pt((Pe-this._centerAltitude)*Te),Ht=Bt=>{if(!this._elevation||!Bt.tileID||!P)return;const rn=this._elevation.getMinMaxForTile(Bt.tileID),wn=Bt.aabb;rn?(wn.min[2]=rn.min,wn.max[2]=rn.max,wn.center[2]=(wn.min[2]+wn.max[2])/2):(Bt.shouldSplit=xn(Bt),Bt.shouldSplit||(wn.min[2]=wn.max[2]=wn.center[2]=this._centerAltitude))},xn=Bt=>{if(Bt.zoom<Se)return!0;if(Bt.zoom===zt)return!1;if(null!=Bt.shouldSplit)return Bt.shouldSplit;const rn=Bt.aabb.distanceX(Le),wn=Bt.aabb.distanceY(Le);let hn=sn,Sn=1;if(H){hn=Pt(Bt.aabb.distanceZ(Le));const ei=Math.pow(2,Bt.zoom),ii=m.latFromMercatorY((Bt.y+1)/ei),fr=m.latFromMercatorY(Bt.y/ei),pr=Math.min(Math.max(B,ii),fr),di=m.circumferenceAtLatitude(pr)/m.circumferenceAtLatitude(B);if(Sn=pr===B?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,di/this._mercatorScaleRatio),this.zoom<=m.GLOBE_ZOOM_THRESHOLD_MIN&&Bt.zoom===zt-1&&di>=.9)return!0}else if(I&&(hn=Pt(Bt.aabb.distanceZ(Le)*Te)),this.projection.isReprojectedInTileSpace&&C<=5){const ei=Math.pow(2,Bt.zoom),ii=ft(new m.MercatorCoordinate((Bt.x+.5)/ei,(Bt.y+.5)/ei));Sn=ii>.85?1:ii}const yi=rn*rn+wn*wn+hn;return yi<Pt((1<<zt-Bt.zoom)*ee*Sn*((ei,ii)=>{if(ii*Pt(.707)<ei)return 1;const fr=Math.sqrt(ii/ei);return fr/(1.4144271570014144+(Math.pow(1.1,fr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(hn,sn),yi))};if(this.renderWorldCopies)for(let Bt=1;Bt<=3;Bt++)St.push(ut(-Bt)),St.push(ut(Bt));for(St.push(ut(0));St.length>0;){const Bt=St.pop(),rn=Bt.x,wn=Bt.y;let hn=Bt.fullyVisible;if(!hn){const Sn=Bt.aabb.intersects(_e);if(0===Sn)continue;hn=2===Sn}if(Bt.zoom!==zt&&xn(Bt))for(let Sn=0;Sn<4;Sn++){const yi=(rn<<1)+Sn%2,$i=(wn<<1)+(Sn>>1),ei={aabb:P?Bt.aabb.quadrant(Sn):m.tileAABB(this,U,Bt.zoom+1,yi,$i,Bt.wrap,Bt.minZ,Bt.maxZ,this.projection),zoom:Bt.zoom+1,x:yi,y:$i,wrap:Bt.wrap,fullyVisible:hn,tileID:void 0,shouldSplit:void 0,minZ:Bt.minZ,maxZ:Bt.maxZ};I&&!H&&(ei.tileID=new m.OverscaledTileID(Bt.zoom+1===zt?En:Bt.zoom+1,Bt.wrap,Bt.zoom+1,yi,$i),Ht(ei)),St.push(ei)}else{const Sn=Bt.zoom===zt?En:Bt.zoom;if(u.minzoom&&u.minzoom>Sn)continue;const yi=q[0]-(.5+rn+(Bt.wrap<<Bt.zoom))*(1<<g-Bt.zoom),$i=q[1]-.5-wn,ei=Bt.tileID?Bt.tileID:new m.OverscaledTileID(Sn,Bt.wrap,Bt.zoom,rn,wn);bt.push({tileID:ei,distanceSq:yi*yi+$i*$i})}}if(this.fogCullDistSq){const Bt=this.fogCullDistSq,rn=this.horizonLineFromTop();bt=bt.filter(wn=>{const hn=[0,0,0,1],Sn=[m.EXTENT,m.EXTENT,0,1],yi=this.calculateFogTileMatrix(wn.tileID.toUnwrapped());m.transformMat4$1(hn,hn,yi),m.transformMat4$1(Sn,Sn,yi);const $i=m.getAABBPointSquareDist(hn,Sn);if(0===$i)return!0;let ei=!1;const ii=this._elevation;if(ii&&$i>Bt&&0!==rn){const fr=this.calculateProjMatrix(wn.tileID.toUnwrapped());let pr;u.isTerrainDEM||(pr=ii.getMinMaxForTile(wn.tileID)),pr||(pr={min:We,max:Ge});const di=m.furthestTileCorner(this.rotation),_o=[di[0]*m.EXTENT,di[1]*m.EXTENT,pr.max];m.transformMat4(_o,_o,fr),ei=(1-_o[1])*this.height*.5<rn}return $i<Bt||ei})}return bt.sort((Bt,rn)=>Bt.distanceSq-rn.distanceSq).map(Bt=>Bt.tileID)}resize(u,g){this.width=u,this.height=g,this.pixelsToGLUnits=[2/u,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const g=m.clamp(u.lat,-m.MAX_MERCATOR_LATITUDE,m.MAX_MERCATOR_LATITUDE),C=this.projection.project(u.lng,g);return new m.Point(C.x*this.worldSize,C.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/m.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,g){let C,I;const P=this.centerPoint;if("globe"===this.projection.name){const B=this.worldSize;C=(g.x-P.x)/B,I=(g.y-P.y)/B}else{const B=this.pointCoordinate(g),U=this.pointCoordinate(P);C=B.x-U.x,I=B.y-U.y}const N=this.locationCoordinate(u);this.setLocation(new m.MercatorCoordinate(N.x-C,N.y-I))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,g){const C=g?m.mercatorZfromAltitude(g,u.lat):void 0,I=this.projection.project(u.lng,u.lat);return new m.MercatorCoordinate(I.x,I.y,C)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,g){const C=g??this._centerAltitude,I=[u.x,u.y,0,1],P=[u.x,u.y,1,1];m.transformMat4$1(I,I,this.pixelMatrixInverse),m.transformMat4$1(P,P,this.pixelMatrixInverse);const N=P[3];m.scale$1(I,I,1/I[3]),m.scale$1(P,P,1/N);const B=I[2],U=P[2];return{p0:I,p1:P,t:B===U?0:(C-B)/(U-B)}}screenPointToMercatorRay(u){const g=[u.x,u.y,0,1],C=[u.x,u.y,1,1];return m.transformMat4$1(g,g,this.pixelMatrixInverse),m.transformMat4$1(C,C,this.pixelMatrixInverse),m.scale$1(g,g,1/g[3]),m.scale$1(C,C,1/C[3]),g[2]=m.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,C[2]=m.mercatorZfromAltitude(C[2],this._center.lat)*this.worldSize,m.scale$1(g,g,1/this.worldSize),m.scale$1(C,C,1/this.worldSize),new m.Ray([g[0],g[1],g[2]],m.normalize([],m.sub([],C,g)))}rayIntersectionCoordinate(u){const{p0:g,p1:C,t:I}=u,P=m.mercatorZfromAltitude(g[2],this._center.lat),N=m.mercatorZfromAltitude(C[2],this._center.lat);return new m.MercatorCoordinate(m.number(g[0],C[0],I)/this.worldSize,m.number(g[1],C[1],I)/this.worldSize,m.number(P,N,I))}pointCoordinate(u,g=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,g)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let g=this.projection.pointCoordinate3D(this,u.x,u.y);if(g)return new m.MercatorCoordinate(g[0],g[1],g[2]);let C=0,I=this.horizonLineFromTop();if(u.y>I)return this.pointCoordinate(u);const P=.02*I,N=u.clone();for(let B=0;B<10&&I-C>P;B++){N.y=m.number(C,I,.66);const U=this.projection.pointCoordinate3D(this,N.x,N.y);U?(I=N.y,g=U):C=N.y}return g?new m.MercatorCoordinate(g[0],g[1],g[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=m.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(u);const g=this.pointCoordinate(u);return g.y>=0&&g.y<=1}_coordinatePoint(u,g){const C=g&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,I=[u.x*this.worldSize,u.y*this.worldSize,C+u.toAltitude(),1];return m.transformMat4$1(I,I,this.pixelMatrix),I[3]>0?new m.Point(I[0]/I[3],I[1]/I[3]):new m.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:g}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,P=this.pointLocation3D(new m.Point(g,u)),N=this.pointLocation3D(new m.Point(I,u)),B=this.pointLocation3D(new m.Point(I,C)),U=this.pointLocation3D(new m.Point(g,C));let q=Math.min(P.lng,N.lng,B.lng,U.lng),H=Math.max(P.lng,N.lng,B.lng,U.lng),J=Math.min(P.lat,N.lat,B.lat,U.lat),_e=Math.max(P.lat,N.lat,B.lat,U.lat);const Ce=Math.pow(2,-this.zoom)/16*270,Te="globe"===this.projection.name?1:4,Pe=(Le,ee,Se,Ge,We)=>{const ht=(Le+Se)/2,ft=(ee+Ge)/2,ut=new m.Point(ht,ft),{lng:St,lat:bt}=this.pointLocation3D(ut),zt=Math.max(0,q-St,J-bt,St-H,bt-_e);q=Math.min(q,St),H=Math.max(H,St),J=Math.min(J,bt),_e=Math.max(_e,bt),(We<Te||zt>Ce)&&(Pe(Le,ee,ht,ft,We+1),Pe(ht,ft,Se,Ge,We+1))};if(Pe(g,u,I,u,1),Pe(I,u,I,C,1),Pe(I,C,g,C,1),Pe(g,C,g,u,1),"globe"===this.projection.name){const[Le,ee]=m.polesInViewport(this);Le?(_e=90,H=180,q=-180):ee&&(J=-90,H=180,q=-180)}return new m.LngLatBounds(new m.LngLat(q,J),new m.LngLat(H,_e))}_getBoundsRectangular(u,g){const{top:C,left:I}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,N=this.width-this._edgeInsets.right,B=new m.Point(I,C),U=new m.Point(N,C),q=new m.Point(N,P),H=new m.Point(I,P);let J=this.pointCoordinate(B,u),_e=this.pointCoordinate(U,u);const Ce=this.pointCoordinate(q,g),Te=this.pointCoordinate(H,g),Pe=(Le,ee)=>(ee.y-Le.y)/(ee.x-Le.x);return J.y>1&&_e.y>=0?J=new m.MercatorCoordinate((1-Te.y)/Pe(Te,J)+Te.x,1):J.y<0&&_e.y<=1&&(J=new m.MercatorCoordinate(-Te.y/Pe(Te,J)+Te.x,0)),_e.y>1&&J.y>=0?_e=new m.MercatorCoordinate((1-Ce.y)/Pe(Ce,_e)+Ce.x,1):_e.y<0&&J.y<=1&&(_e=new m.MercatorCoordinate(-Ce.y/Pe(Ce,_e)+Ce.x,0)),(new m.LngLatBounds).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(_e)).extend(this.coordinateLocation(Te)).extend(this.coordinateLocation(Ce))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const g=u.visibleDemTiles.reduce((C,I)=>{if(I.dem){const P=I.dem.tree;C.min=Math.min(C.min,P.minimums[0]),C.max=Math.max(C.max,P.maximums[0])}return C},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(g.min*u.exaggeration(),g.max*u.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const g=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,C=this.height/2-g*(1-this._horizonShift);return u?Math.max(0,C):C}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-m.MAX_MERCATOR_LATITUDE,this.maxLat=m.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=m.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=m.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=m.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=m.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,g){return this.projection.createTileMatrix(this,g,u)}calculateDistanceTileData(u){const g=u.key,C=this._distanceTileDataCache;if(C[g])return C[g];const I=u.canonical,P=1/this.height,N=this.cameraWorldSize,B=N/this.zoomScale(I.z),U=(I.x+Math.pow(2,I.z)*u.wrap)*B,q=I.y*B,H=this.point;H.x*=N/this.worldSize,H.y*=N/this.worldSize;const J=this.angle,_e=Math.sin(-J),Ce=-Math.cos(-J);return C[g]={bearing:[_e,Ce],center:[(H.x-U)*P,(H.y-q)*P],scale:B/m.EXTENT*P},C[g]}calculateFogTileMatrix(u){const g=u.key,C=this._fogTileMatrixCache;if(C[g])return C[g];const I=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return m.multiply(I,this.worldToFogMatrix,I),C[g]=new Float32Array(I),C[g]}calculateProjMatrix(u,g=!1){const C=u.key,I=g?this._alignedProjMatrixCache:this._projMatrixCache;if(I[C])return I[C];const P=this.calculatePosMatrix(u,this.worldSize);return m.multiply(P,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.alignedProjMatrix:this.projMatrix,P),I[C]=new Float32Array(P),I[C]}calculatePixelsToTileUnitsMatrix(u){const g=u.tileID.key,C=this._pixelsToTileUnitsCache;if(C[g])return C[g];const I=function(P,N){const{scale:B}=P.tileTransform,U=B*m.EXTENT/(P.tileSize*Math.pow(2,N.zoom-P.tileID.overscaledZ+P.tileID.canonical.z));return q=new Float32Array(4),_e=(H=N.inverseAdjustmentMatrix)[1],Ce=H[2],Te=H[3],Le=(J=[U,U])[1],q[0]=H[0]*(Pe=J[0]),q[1]=_e*Pe,q[2]=Ce*Le,q[3]=Te*Le,q;var q,H,J,_e,Ce,Te,Pe,Le}(u,this);return C[g]=I,C[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const u=1/this.worldSize,g=m.fromScaling([],[u,u,u]);return m.multiply(g,g,this.globeMatrix),g}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const u=this._elevation;this._updateCameraState();const g=m.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(g),I=this._camera.forward(),P=m.mercatorZfromAltitude(1,this._center.lat);C[2]/=P,I[2]/=P,m.normalize(I,I);const N=u.raycast(C,I,u.exaggeration());if(N){const B=m.scaleAndAdd([],C,I,N),U=new m.MercatorCoordinate(B[0],B[1],m.mercatorZfromAltitude(B[2],m.latFromMercatorY(B[1]))),q=(U.z+m.length([U.x-C[0],U.y-C[1],U.z-C[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(q),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const g=this._elevation,C=m.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,I=this._computeCameraPosition(C),P=g.getAtPointOrZero(new m.MercatorCoordinate(...I)),N=this.pixelsPerMeter/this.worldSize*P,B=this._minimumHeightOverTerrain(),U=I[2]-N;if(U<=B)if(U<0||u){const q=this.locationCoordinate(this._center,this._centerAltitude),H=[I[0],I[1],q.z-I[2]],J=m.length(H);H[2]-=(B-U)/this._pixelsPerMercatorPixel;const _e=m.length(H);if(0===_e)return;m.scale$2(H,H,J/_e*this._pixelsPerMercatorPixel),this._camera.position=[I[0],I[1],q.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const _e=this.center;return _e.lat=m.clamp(_e.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(_e.lng=m.clamp(_e.lng,this.minLng,this.maxLng)),this.center=_e,void(this._constraining=!1)}const g=this._unmodified,{x:C,y:I}=this.point;let P=0,N=C,B=I;const U=this.width/2,q=this.height/2,H=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(I-q<H&&(B=H+q),I+q>J&&(B=J-q),J-H<this.height&&(P=Math.max(P,this.height/(J-H)),B=(J+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const _e=this.worldMinX*this.scale,Ce=this.worldMaxX*this.scale,Te=this.worldSize/2-(_e+Ce)/2;N=(C+Te+this.worldSize)%this.worldSize-Te,N-U<_e&&(N=_e+U),N+U>Ce&&(N=Ce-U),Ce-_e<this.width&&(P=Math.max(P,this.width/(Ce-_e)),N=(Ce+_e)/2)}N===C&&B===I||(this.center=this.unproject(new m.Point(N,B))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=g,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,g=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=m.mercatorZfromAltitude(1,this.center.lat)/m.mercatorZfromAltitude(1,m.GLOBE_SCALE_MATCH_LATITUDE));const C=ls(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,C),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const I="meters"===this.projection.zAxisUnit?g:1,P=this._camera.getWorldToCamera(this.worldSize,I),N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);N[8]=2*-u.x/this.width,N[9]=2*u.y/this.height;let B=m.mul([],N,P);if(this.projection.isReprojectedInTileSpace){const ft=this.locationCoordinate(this.center),ut=m.identity([]);m.translate(ut,ut,[ft.x*this.worldSize,ft.y*this.worldSize,0]),m.multiply(ut,ut,as(this)),m.translate(ut,ut,[-ft.x*this.worldSize,-ft.y*this.worldSize,0]),m.multiply(B,B,ut),this.inverseAdjustmentMatrix=function(St){const bt=as(St,!0);return re([],[bt[0],bt[1],bt[4],bt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=m.scale([],B,[this.worldSize,this.worldSize,this.worldSize/I,1]),this.projMatrix=B,this.invProjMatrix=m.invert(new Float64Array(16),this.projMatrix);const U=m.invert([],N);this.frustumCorners=m.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const q=new Float32Array(16);m.identity(q),m.scale(q,q,[1,-1,1]),m.rotateX(q,q,this._pitch),m.rotateZ(q,q,this.angle);const H=m.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),J=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-u.x/this.width,H[9]=2*(u.y+J)/this.height,this.skyboxMatrix=m.multiply(q,H,q);const _e=this.point,Ce=_e.x,Te=_e.y,Pe=this.width%2/2,Le=this.height%2/2,ee=Math.cos(this.angle),Se=Math.sin(this.angle),Ge=Ce-Math.round(Ce)+ee*Pe+Se*Le,We=Te-Math.round(Te)+ee*Le+Se*Pe,ht=new Float64Array(B);if(m.translate(ht,ht,[Ge>.5?Ge-1:Ge,We>.5?We-1:We,0]),this.alignedProjMatrix=ht,B=m.create(),m.scale(B,B,[this.width/2,-this.height/2,1]),m.translate(B,B,[1,-1,0]),this.labelPlaneMatrix=B,B=m.create(),m.scale(B,B,[1,-1,1]),m.translate(B,B,[-1,-1,0]),m.scale(B,B,[2/this.width,2/this.height,1]),this.glCoordMatrix=B,this.pixelMatrix=m.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},B=m.invert(new Float64Array(16),this.pixelMatrix),!B)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=B,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=m.calculateGlobeMatrix(this);const ft=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=m.transformMat4(ft,ft,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=B;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,g=this.cameraPixelsPerMeter,C=this._camera.position,I=1/this.height/this._pixelsPerMercatorPixel,P=[u,u,g];m.scale$2(P,P,I),m.scale$2(C,C,-1),m.multiply$2(C,C,P);const N=m.create();m.translate(N,N,C),m.scale(N,N,P),this.mercatorFogMatrix=N,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,g,I)}_computeCameraPosition(u){const g=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,C=this._camera.forward(),I=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*g-u/this.worldSize*this._centerAltitude;return[I.x/this.worldSize-C[0]*P,I.y/this.worldSize-C[1]*P,u/this.worldSize*this._centerAltitude-C[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const g=this._maxCameraBoundsDistance()*Math.cos(this._pitch),C=this._camera.position[2],I=u[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),I>0&&(P=Math.min((g-C)/I,1)),this._camera.position=m.scaleAndAdd([],this._camera.position,u,P),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,g=this._camera.forward(),{pitch:C,bearing:I}=this._camera.getPitchBearing(),P=m.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,N=this._mercatorZfromZoom(this._maxZoom)*Math.cos(m.degToRad(this._maxPitch)),B=Math.max((u[2]-P)/Math.cos(C),N),U=this._zoomFromMercatorZ(B);m.scaleAndAdd(u,u,g,B),this._pitch=m.clamp(C,m.degToRad(this.minPitch),m.degToRad(this.maxPitch)),this.angle=m.wrap(I,-Math.PI,Math.PI),this._setZoom(m.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new m.MercatorCoordinate(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let g=0,C=m.GLOBE_ZOOM_THRESHOLD_MAX,I=0,P=1/0;for(;C-g>1e-6&&C>g;){const N=g+.5*(C-g),B=this.tileSize*Math.pow(2,N),U=this.getCameraToCenterDistance(this.projection,N,B),q=this.scaleZoom(U/(u*this.tileSize)),H=Math.abs(N-q);H<P&&(P=H,I=N),N<q?g=N:C=N}return I}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(m.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,g){const C=Math.min(u.x,g.x),I=Math.max(u.x,g.x),P=Math.min(u.y,g.y),N=Math.max(u.y,g.y);if(P<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const B=[new m.Point(C,P),new m.Point(I,N),new m.Point(C,N),new m.Point(I,P)],U=this.renderWorldCopies?-3:0,q=this.renderWorldCopies?4:1;for(const H of B){const J=this.pointRayIntersection(H);if(J.t<0)return!0;const _e=this.rayIntersectionCoordinate(J);if(_e.x<U||_e.y<0||_e.x>q||_e.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+m.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new m.Point(0,0),new m.Point(this.width,this.height))}zoomDeltaToMovement(u,g){const C=m.length(m.sub([],this._camera.position,u)),I=this._zoomFromMercatorZ(C)+g;return C-this._mercatorZfromZoom(I)}getCameraPoint(){if("globe"===this.projection.name){const u=function([g,C,I],P){const N=[g,C,I,1];m.transformMat4$1(N,N,P);const B=N[3]=Math.max(N[3],1e-6);return N[0]/=B,N[1]/=B,N[2]/=B,N}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new m.Point(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new m.Point(0,u))}}getCameraToCenterDistance(u,g=this.zoom,C=this.worldSize){const I=ls(u,g,this.width,this.height,1024),P=u.pixelSpaceConversion(this.center.lat,C,I);return.5/Math.tan(.5*this._fov)*this.height*P}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&m.multiply(u,u,this.globeMatrix),u}}function Ml(b,u){let g=!1,C=null;const I=()=>{C=null,g&&(b(),C=setTimeout(I,u),g=!1)};return()=>(g=!0,C||I(),C)}class cs{constructor(u){this._hashName=u&&encodeURIComponent(u),m.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ml(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,m.window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),m.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const g=Zn(u);if(this._hashName){const C=this._hashName;let I=!1;const P=m.window.location.hash.slice(1).split("&").map(N=>{const B=N.split("=")[0];return B===C?(I=!0,`${B}=${g}`):N}).filter(N=>N);return I||P.push(`${C}=${g}`),`#${P.join("&")}`}return`#${g}`}_getCurrentHash(){const u=m.window.location.hash.replace("#","");if(this._hashName){let g;return u.split("&").map(C=>C.split("=")).forEach(C=>{C[0]===this._hashName&&(g=C)}),(g&&g[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const g=this._getCurrentHash();if(g.length>=3&&!g.some(C=>isNaN(C))){const C=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(g[3]||0):u.getBearing();return u.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:C,pitch:+(g[4]||0)}),!0}return!1}_updateHashUnthrottled(){const u=m.window.location.href.replace(/(#.+)?$/,this.getHashString());m.window.history.replaceState(m.window.history.state,null,u)}}function Zn(b,u){const g=b.getCenter(),C=Math.round(100*b.getZoom())/100,I=Math.ceil((C*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,I),N=Math.round(g.lng*P)/P,B=Math.round(g.lat*P)/P,U=b.getBearing(),q=b.getPitch();let H=u?`/${N}/${B}/${C}`:`${C}/${B}/${N}`;return(U||q)&&(H+="/"+Math.round(10*U)/10),q&&(H+=`/${Math.round(q)}`),H}const ki={linearity:.3,easing:m.bezier(0,0,.3,1)},Qi=m.extend({deceleration:2500,maxSpeed:1400},ki),Co=m.extend({deceleration:20,maxSpeed:1400},ki),Vn=m.extend({deceleration:1e3,maxSpeed:360},ki),yr=m.extend({deceleration:1e3,maxSpeed:90},ki);class su{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:m.exported.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,g=m.exported.now();for(;u.length>0&&g-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const g={zoom:0,bearing:0,pitch:0,pan:new m.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)g.zoom+=P.zoomDelta||0,g.bearing+=P.bearingDelta||0,g.pitch+=P.pitchDelta||0,P.panDelta&&g.pan._add(P.panDelta),P.around&&(g.around=P.around),P.pinchAround&&(g.pinchAround=P.pinchAround);const C=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,I={};if(g.pan.mag()){const P=So(g.pan.mag(),C,m.extend({},Qi,u||{}));I.offset=g.pan.mult(P.amount/g.pan.mag()),I.center=this._map.transform.center,Go(I,P)}if(g.zoom){const P=So(g.zoom,C,Co);I.zoom=this._map.transform.zoom+P.amount,Go(I,P)}if(g.bearing){const P=So(g.bearing,C,Vn);I.bearing=this._map.transform.bearing+m.clamp(P.amount,-179,179),Go(I,P)}if(g.pitch){const P=So(g.pitch,C,yr);I.pitch=this._map.transform.pitch+P.amount,Go(I,P)}if(I.zoom||I.bearing){const P=void 0===g.pinchAround?g.around:g.pinchAround;I.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),I.noMoveStart=!0,I}}function Go(b,u){(!b.duration||b.duration<u.duration)&&(b.duration=u.duration,b.easing=u.easing)}function So(b,u,g){const{maxSpeed:C,linearity:I,deceleration:P}=g,N=m.clamp(b*I/(u/1e3),-C,C),B=Math.abs(N)/(P*I);return{easing:g.easing,duration:1e3*B,amount:N*(B/2)}}class Fs extends m.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,C,I={}){const P=ge(g.getCanvasContainer(),C),N=g.unproject(P);super(u,m.extend({point:P,lngLat:N,originalEvent:C},I)),this._defaultPrevented=!1,this.target=g}}class Si extends m.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,C){const I="touchend"===u?C.changedTouches:C.touches,P=ue(g.getCanvasContainer(),I),N=P.map(U=>g.unproject(U)),B=P.reduce((U,q,H,J)=>U.add(q.div(J.length)),new m.Point(0,0));super(u,{points:P,point:B,lngLats:N,lngLat:g.unproject(B),originalEvent:C}),this._defaultPrevented=!1}}class au extends m.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,C){super(u,{originalEvent:C}),this._defaultPrevented=!1}}class Ru{constructor(u,g){this._map=u,this._clickTolerance=g.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new au(u.type,this._map,u))}mousedown(u,g){return this._mousedownPos=g,this._firePreventable(new Fs(u.type,this._map,u))}mouseup(u){this._map.fire(new Fs(u.type,this._map,u))}preclick(u){const g=m.extend({},u);g.type="preclick",this._map.fire(new Fs(g.type,this._map,g))}click(u,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||(this.preclick(u),this._map.fire(new Fs(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new Fs(u.type,this._map,u))}mouseover(u){this._map.fire(new Fs(u.type,this._map,u))}mouseout(u){this._map.fire(new Fs(u.type,this._map,u))}touchstart(u){return this._firePreventable(new Si(u.type,this._map,u))}touchmove(u){this._map.fire(new Si(u.type,this._map,u))}touchend(u){this._map.fire(new Si(u.type,this._map,u))}touchcancel(u){this._map.fire(new Si(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lu{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new Fs(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new Fs(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ys{constructor(u,g){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,g){this.isEnabled()&&u.shiftKey&&0===u.button&&(pn(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(u,g){if(!this._active)return;const C=g,I=this._startPos,P=this._lastPos;if(!I||!P||P.equals(C)||!this._box&&C.dist(I)<this._clickTolerance)return;this._lastPos=C,this._box||(this._box=mt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const N=Math.min(I.x,C.x),B=Math.max(I.x,C.x),U=Math.min(I.y,C.y),q=Math.max(I.y,C.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${N}px,${U}px)`,this._box.style.width=B-N+"px",this._box.style.height=q-U+"px")})}mouseupWindow(u,g){if(!this._active)return;const C=this._startPos,I=g;if(C&&0===u.button){if(this.reset(),ce(),C.x!==I.x||C.y!==I.y)return this._map.fire(new m.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:P=>P.fitScreenCoordinates(C,I,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&27===u.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),he(),delete this._startPos,delete this._lastPos}_fireEvent(u,g){return this._map.fire(new m.Event(u,{originalEvent:g}))}}function Aa(b,u){const g={};for(let C=0;C<b.length;C++)g[b[C].identifier]=u[C];return g}class el{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,g,C){(this.centroid||C.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=u.timeStamp),C.length===this.numTouches&&(this.centroid=function(I){const P=new m.Point(0,0);for(const N of I)P._add(N);return P.div(I.length)}(g),this.touches=Aa(C,g)))}touchmove(u,g,C){if(this.aborted||!this.centroid)return;const I=Aa(C,g);for(const P in this.touches){const N=I[P];(!N||N.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(u,g,C){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),0===C.length){const I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}class za{constructor(u){this.singleTap=new el(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,g,C){this.singleTap.touchstart(u,g,C)}touchmove(u,g,C){this.singleTap.touchmove(u,g,C)}touchend(u,g,C){const I=this.singleTap.touchend(u,g,C);if(I){const P=u.timeStamp-this.lastTime<500,N=!this.lastTap||this.lastTap.dist(I)<30;if(P&&N||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}class Qu{constructor(){this._zoomIn=new za({numTouches:1,numTaps:2}),this._zoomOut=new za({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,g,C){this._zoomIn.touchstart(u,g,C),this._zoomOut.touchstart(u,g,C)}touchmove(u,g,C){this._zoomIn.touchmove(u,g,C),this._zoomOut.touchmove(u,g,C)}touchend(u,g,C){const I=this._zoomIn.touchend(u,g,C),P=this._zoomOut.touchend(u,g,C);return I?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:N.getZoom()+1,around:N.unproject(I)},{originalEvent:u})}):P?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:N.getZoom()-1,around:N.unproject(P)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ou={0:1,2:2};class ga{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,g){return!1}_move(u,g){return{}}mousedown(u,g){if(this._lastPoint)return;const C=ze(u);this._correctButton(u,C)&&(this._lastPoint=g,this._eventButton=C)}mousemoveWindow(u,g){const C=this._lastPoint;if(C)if(u.preventDefault(),null!=this._eventButton&&function(I,P){const N=Ou[P];return void 0===I.buttons||(I.buttons&N)!==N}(u,this._eventButton))this.reset();else if(this._moved||!(g.dist(C)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(C,g)}mouseupWindow(u){this._lastPoint&&ze(u)===this._eventButton&&(this._moved&&ce(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ul extends ga{mousedown(u,g){super.mousedown(u,g),this._lastPoint&&(this._active=!0)}_correctButton(u,g){return 0===g&&!u.ctrlKey}_move(u,g){return{around:g,panDelta:g.sub(u)}}}class cc extends ga{_correctButton(u,g){return 0===g&&u.ctrlKey||2===g}_move(u,g){const C=.8*(g.x-u.x);if(C)return this._active=!0,{bearingDelta:C}}contextmenu(u){u.preventDefault()}}class Il extends ga{_correctButton(u,g){return 0===g&&u.ctrlKey||2===g}_move(u,g){const C=-.5*(g.y-u.y);if(C)return this._active=!0,{pitchDelta:C}}contextmenu(u){u.preventDefault()}}class jn{constructor(u,g){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=g.clickTolerance||1,this.reset(),m.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new m.Point(0,0)}touchstart(u,g,C){return this._calculateTransform(u,g,C)}touchmove(u,g,C){if(this._active&&!(C.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===C.length&&!m.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,g,C)}}touchend(u,g,C){this._calculateTransform(u,g,C),this._active&&C.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,g,C){C.length>0&&(this._active=!0);const I=Aa(C,g),P=new m.Point(0,0),N=new m.Point(0,0);let B=0;for(const q in I){const H=I[q],J=this._touches[q];J&&(P._add(H),N._add(H.sub(J)),B++,I[q]=H)}if(this._touches=I,B<this._minTouches||!N.mag())return;const U=N.div(B);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(B),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=mt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class uc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,g,C){return{}}touchstart(u,g,C){this._firstTwoTouches||C.length<2||(this._firstTwoTouches=[C[0].identifier,C[1].identifier],this._start([g[0],g[1]]))}touchmove(u,g,C){const I=this._firstTwoTouches;if(!I)return;u.preventDefault();const[P,N]=I,B=dc(C,g,P),U=dc(C,g,N);if(!B||!U)return;const q=this._aroundCenter?null:B.add(U).div(2);return this._move([B,U],q,u)}touchend(u,g,C){if(!this._firstTwoTouches)return;const[I,P]=this._firstTwoTouches,N=dc(C,g,I),B=dc(C,g,P);N&&B||(this._active&&ce(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function dc(b,u,g){for(let C=0;C<b.length;C++)if(b[C].identifier===g)return u[C]}function Dc(b,u){return Math.log(b/u)/Math.LN2}class ys extends uc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,g){const C=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Dc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dc(this._distance,C),pinchAround:g}}}function Ju(b,u){return 180*b.angleWith(u)/Math.PI}class sa extends uc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,g){const C=this._vector;if(this._vector=u[0].sub(u[1]),C&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ju(this._vector,C),pinchAround:g}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const g=25/(Math.PI*this._minDiameter)*360,C=this._startVector;if(!C)return!1;const I=Ju(u,C);return Math.abs(I)<g}}function Or(b){return Math.abs(b.y)>Math.abs(b.x)}class Ca extends uc{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,Or(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,g,C){const I=this._lastPoints;if(!I)return;const P=u[0].sub(I[0]),N=u[1].sub(I[1]);return this._map._cooperativeGestures&&!m.isFullscreen()&&C.touches.length<3||(this._valid=this.gestureBeginsVertically(P,N,C.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(P.y+N.y)/2*-.5})}gestureBeginsVertically(u,g,C){if(void 0!==this._valid)return this._valid;const I=u.mag()>=2,P=g.mag()>=2;if(!I&&!P)return;if(!I||!P)return null==this._firstMove&&(this._firstMove=C),C-this._firstMove<100&&void 0;const N=u.y>0==g.y>0;return Or(u)&&Or(g)&&N}}const qd={panStep:100,bearingStep:15,pitchStep:10};class l{constructor(){const u=qd;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let g=0,C=0,I=0,P=0,N=0;switch(u.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:u.shiftKey?C=-1:(u.preventDefault(),P=-1);break;case 39:u.shiftKey?C=1:(u.preventDefault(),P=1);break;case 38:u.shiftKey?I=1:(u.preventDefault(),N=-1);break;case 40:u.shiftKey?I=-1:(u.preventDefault(),N=1);break;default:return}return this._rotationDisabled&&(C=0,I=0),{cameraAnimation:B=>{const U=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:h,zoom:g?Math.round(U)+g*(u.shiftKey?2:1):U,bearing:B.getBearing()+C*this._bearingStep,pitch:B.getPitch()+I*this._pitchStep,offset:[-P*this._panStep,-N*this._panStep],center:B.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function h(b){return b*(2-b)}const y=4.000244140625;class w{constructor(u,g){this._map=u,this._el=u.getCanvasContainer(),this._handler=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,m.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||m.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let g=u.deltaMode===m.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const C=m.exported.now(),I=C-(this._lastWheelEventTime||0);this._lastWheelEventTime=C,0!==g&&g%y==0?this._type="wheel":0!==g&&Math.abs(g)<4?this._type="trackpad":I>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(I*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),u.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=u,this._delta-=g,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=ge(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:g,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;"wheel"===this._type&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const g=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(0!==this._delta){const U="wheel"===this._type&&Math.abs(this._delta)>y?this._wheelZoomRate:this._defaultZoomRate;let q=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&0!==q&&(q=1/q);const H=g(),J=Math.pow(2,H),_e="number"==typeof this._targetZoom?u.zoomScale(this._targetZoom):J;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(_e*q))),"wheel"===this._type&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._delta=0}const C="number"==typeof this._targetZoom?this._targetZoom:g(),I=this._startZoom,P=this._easing;let N,B=!1;if("wheel"===this._type&&I&&P){const U=Math.min((m.exported.now()-this._lastWheelEventTime)/200,1),q=P(U);N=m.number(I,C,q),U<1?this._frameId||(this._frameId=!0):B=!0}else N=C,B=!0;return this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!B,zoomDelta:N-g(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let g=m.ease;if(this._prevEase){const C=this._prevEase,I=(m.exported.now()-C.start)/C.duration,P=C.easing(I+.01)-C.easing(I),N=.27/Math.sqrt(P*P+1e-4)*.01,B=Math.sqrt(.0729-N*N);g=m.bezier(N,B,.25,1)}return this._prevEase={start:m.exported.now(),duration:u,easing:g},g}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=mt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(m.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class D{constructor(u,g){this._clickZoom=u,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class z{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,g){return u.preventDefault(),{cameraAnimation:C=>{C.easeTo({duration:300,zoom:C.getZoom()+(u.shiftKey?-1:1),around:C.unproject(g)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class G{constructor(){this._tap=new za({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,g,C){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?C.length>0&&(this._swipePoint=g[0],this._swipeTouch=C[0].identifier):this._tap.touchstart(u,g,C))}touchmove(u,g,C){if(this._tapTime){if(this._swipePoint){if(C[0].identifier!==this._swipeTouch)return;const I=g[0],P=I.y-this._swipePoint.y;return this._swipePoint=I,u.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(u,g,C)}touchend(u,g,C){this._tapTime?this._swipePoint&&0===C.length&&this.reset():this._tap.touchend(u,g,C)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ie{constructor(u,g,C){this._el=u,this._mousePan=g,this._touchPan=C}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Oe{constructor(u,g,C){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=g,this._mousePitch=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class lt{constructor(u,g,C,I){this._el=u,this._touchZoom=g,this._touchRotate=C,this._tapDragZoom=I,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const kt=b=>b.zoom||b.drag||b.pitch||b.rotate;class Zt extends m.Event{}class Un{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,g){const C=m.sub([],g,u);this.radius=m.length(C[2]<0?m.div([],C,this.constants):[C[0],C[1],0])}projectRay(u){m.div(u,u,this.constants),m.normalize(u,u),m.mul$1(u,u,this.constants);const g=m.scale$2([],u,this.radius);if(g[2]>0){const C=m.scale$2([],[0,0,1],m.dot(g,[0,0,1])),I=m.scale$2([],m.normalize([],[g[0],g[1],0]),this.radius),P=m.add([],g,m.scale$2([],m.sub([],m.add([],I,C),g),2));g[0]=P[0],g[1]=P[1]}return g}}function Fn(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class Xn{constructor(u,g){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new su(u),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Un,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(g),m.bindAll(["handleEvent","handleWindowEvent"],this);const C=this._el;this._listeners=[[C,"touchstart",{passive:!0}],[C,"touchmove",{passive:!1}],[C,"touchend",void 0],[C,"touchcancel",void 0],[C,"mousedown",void 0],[C,"mousemove",void 0],[C,"mouseup",void 0],[m.window.document,"mousemove",{capture:!0}],[m.window.document,"mouseup",void 0],[C,"mouseover",void 0],[C,"mouseout",void 0],[C,"dblclick",void 0],[C,"click",void 0],[C,"keydown",{capture:!1}],[C,"keyup",void 0],[C,"wheel",{passive:!1}],[C,"contextmenu",void 0],[m.window,"blur",void 0]];for(const[I,P,N]of this._listeners)I.addEventListener(P,I===m.window.document?this.handleWindowEvent:this.handleEvent,N)}destroy(){for(const[u,g,C]of this._listeners)u.removeEventListener(g,u===m.window.document?this.handleWindowEvent:this.handleEvent,C)}_addDefaultHandlers(u){const g=this._map,C=g.getCanvasContainer();this._add("mapEvent",new Ru(g,u));const I=g.boxZoom=new Ys(g,u);this._add("boxZoom",I);const P=new Qu,N=new z;g.doubleClickZoom=new D(N,P),this._add("tapZoom",P),this._add("clickZoom",N);const B=new G;this._add("tapDragZoom",B);const U=g.touchPitch=new Ca(g);this._add("touchPitch",U);const q=new cc(u),H=new Il(u);g.dragRotate=new Oe(u,q,H),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const J=new ul(u),_e=new jn(g,u);g.dragPan=new ie(C,J,_e),this._add("mousePan",J),this._add("touchPan",_e,["touchZoom","touchRotate"]);const Ce=new sa,Te=new ys;g.touchZoomRotate=new lt(C,Te,Ce,B),this._add("touchRotate",Ce,["touchPan","touchZoom"]),this._add("touchZoom",Te,["touchPan","touchRotate"]),this._add("blockableMapEvent",new lu(g));const Pe=g.scrollZoom=new w(g,this);this._add("scrollZoom",Pe,["mousePan"]);const Le=g.keyboard=new l;this._add("keyboard",Le);for(const ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[ee]&&g[ee].enable(u[ee])}_add(u,g,C){this._handlers.push({handlerName:u,handler:g,allowed:C}),this._handlersById[u]=g}stop(u){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!kt(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,g,C){for(const I in u)if(I!==C&&(!g||g.indexOf(I)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const g=[];for(const C of u)this._el.contains(C.target)&&g.push(C);return g}handleEvent(u,g){this._updatingCamera=!0;const C="renderFrame"===u.type,I=C?void 0:u,P={needsRenderFrame:!1},N={},B={},U=u.touches?this._getMapTouches(u.touches):void 0,q=U?ue(this._el,U):C?void 0:ge(this._el,u);for(const{handlerName:_e,handler:Ce,allowed:Te}of this._handlers){if(!Ce.isEnabled())continue;let Pe;this._blockedByActive(B,Te,_e)?Ce.reset():Ce[g||u.type]&&(Pe=Ce[g||u.type](u,q,U),this.mergeHandlerResult(P,N,Pe,_e,I),Pe&&Pe.needsRenderFrame&&this._triggerRenderFrame()),(Pe||Ce.isActive())&&(B[_e]=Ce)}const H={};for(const _e in this._previousActiveHandlers)B[_e]||(H[_e]=I);this._previousActiveHandlers=B,(Object.keys(H).length||Fn(P))&&(this._changes.push([P,N,H]),this._triggerRenderFrame()),(Object.keys(B).length||Fn(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=P;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(u,g,C,I,P){if(!C)return;m.extend(u,C);const N={handlerName:I,originalEvent:C.originalEvent||P};void 0!==C.zoomDelta&&(g.zoom=N),void 0!==C.panDelta&&(g.drag=N),void 0!==C.pitchDelta&&(g.pitch=N),void 0!==C.bearingDelta&&(g.rotate=N)}_applyChanges(){const u={},g={},C={};for(const[I,P,N]of this._changes)I.panDelta&&(u.panDelta=(u.panDelta||new m.Point(0,0))._add(I.panDelta)),I.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+I.zoomDelta),I.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+I.bearingDelta),I.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+I.pitchDelta),void 0!==I.around&&(u.around=I.around),void 0!==I.aroundCoord&&(u.aroundCoord=I.aroundCoord),void 0!==I.pinchAround&&(u.pinchAround=I.pinchAround),I.noInertia&&(u.noInertia=I.noInertia),m.extend(g,P),m.extend(C,N);this._updateMapTransform(u,g,C),this._changes=[]}_updateMapTransform(u,g,C){const I=this._map,P=I.transform,N=Se=>[Se.x,Se.y,Se.z];if((Se=>{const Ge=this._eventsInProgress.drag;return Ge&&!this._handlersById[Ge.handlerName].isActive()})()&&!Fn(u)){const Se=P.zoom;P.cameraElevationReference="sea",P.recenterOnTerrain(),P.cameraElevationReference="ground",Se!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&I._stop(!0),!Fn(u))return void this._fireEvents(g,C,!0);let{panDelta:B,zoomDelta:U,bearingDelta:q,pitchDelta:H,around:J,aroundCoord:_e,pinchAround:Ce}=u;P._isCameraConstrained&&(U>0&&(U=0),P._isCameraConstrained=!1),void 0!==Ce&&(J=Ce),(U||(Se=>g.drag&&!this._eventsInProgress.drag)())&&J&&(this._dragOrigin=N(P.pointCoordinate3D(J)),this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",I._stop(!0),J=J||I.transform.centerPoint,q&&(P.bearing+=q),H&&(P.pitch+=H),P._updateCameraState();const Te=[0,0,0];if(B)if("mercator"===P.projection.name){const Se=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(J).dir),Ge=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(J.sub(B)).dir);Te[0]=Ge[0]-Se[0],Te[1]=Ge[1]-Se[1]}else{const Se=P.pointCoordinate(J);if("globe"===P.projection.name){B=B.rotate(-P.angle);const Ge=P._pixelsPerMercatorPixel/P.worldSize;Te[0]=-B.x*m.mercatorScale(m.latFromMercatorY(Se.y))*Ge,Te[1]=-B.y*m.mercatorScale(P.center.lat)*Ge}else{const Ge=P.pointCoordinate(J.sub(B));Se&&Ge&&(Te[0]=Ge.x-Se.x,Te[1]=Ge.y-Se.y)}}const Pe=P.zoom,Le=[0,0,0];if(U){const Se=N(_e||P.pointCoordinate3D(J)),Ge={dir:m.normalize([],m.sub([],Se,P._camera.position))};if(Ge.dir[2]<0){const We=P.zoomDeltaToMovement(Se,U);m.scale$2(Le,Ge.dir,We)}}const ee=m.add(Te,Te,Le);P._translateCameraConstrained(ee),U&&Math.abs(P.zoom-Pe)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(g,C,!0)}_fireEvents(u,g,C){const I=kt(this._eventsInProgress),P=kt(u),N={};for(const H in u){const{originalEvent:J}=u[H];this._eventsInProgress[H]||(N[`${H}start`]=J),this._eventsInProgress[H]=u[H]}!I&&P&&this._fireEvent("movestart",P.originalEvent);for(const H in N)this._fireEvent(H,N[H]);P&&this._fireEvent("move",P.originalEvent);for(const H in u){const{originalEvent:J}=u[H];this._fireEvent(H,J)}const B={};let U;for(const H in this._eventsInProgress){const{handlerName:J,originalEvent:_e}=this._eventsInProgress[H];this._handlersById[J].isActive()||(delete this._eventsInProgress[H],U=g[J]||_e,B[`${H}end`]=U)}for(const H in B)this._fireEvent(H,B[H]);const q=kt(this._eventsInProgress);if(C&&(I||P)&&!q){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=_e=>0!==_e&&-this._bearingSnap<_e&&_e<this._bearingSnap;H?(J(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:U})):(this._map.fire(new m.Event("moveend",{originalEvent:U})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,g){this._map.fire(new m.Event(u,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new Zt("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const hi="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Sr extends m.Evented{constructor(u,g){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=g.bearingSnap,this._respectPrefersReducedMotion=!1!==g.respectPrefersReducedMotion,m.bindAll(["_renderFrameCallback"],this)}getCenter(){return new m.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(u,g){return this.jumpTo({center:u},g)}panBy(u,g,C){return u=m.Point.convert(u).mult(-1),this.panTo(this.transform.center,m.extend({offset:u},g),C)}panTo(u,g,C){return this.easeTo(m.extend({center:u},g),C)}getZoom(){return this.transform.zoom}setZoom(u,g){return this.jumpTo({zoom:u},g),this}zoomTo(u,g,C){return this.easeTo(m.extend({zoom:u},g),C)}zoomIn(u,g){return this.zoomTo(this.getZoom()+1,u,g),this}zoomOut(u,g){return this.zoomTo(this.getZoom()-1,u,g),this}getBearing(){return this.transform.bearing}setBearing(u,g){return this.jumpTo({bearing:u},g),this}getPadding(){return this.transform.padding}setPadding(u,g){return this.jumpTo({padding:u},g),this}rotateTo(u,g,C){return this.easeTo(m.extend({bearing:u},g),C)}resetNorth(u,g){return this.rotateTo(0,m.extend({duration:1e3},u),g),this}resetNorthPitch(u,g){return this.easeTo(m.extend({bearing:0,pitch:0,duration:1e3},u),g),this}snapToNorth(u,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,g):this}getPitch(){return this.transform.pitch}setPitch(u,g){return this.jumpTo({pitch:u},g),this}cameraForBounds(u,g){u=m.LngLatBounds.convert(u);const C=g&&g.bearing||0,I=g&&g.pitch||0,P=u.getNorthWest(),N=u.getSouthEast();return this._cameraForBounds(this.transform,P,N,C,I,g)}_extendCameraOptions(u){const g={top:0,bottom:0,right:0,left:0};if("number"==typeof(u=m.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding){const C=u.padding;u.padding={top:C,bottom:C,right:C,left:C}}return u.padding=m.extend(g,u.padding),u}_minimumAABBFrustumDistance(u,g){const C=g.max[0]-g.min[0],I=g.max[1]-g.min[1];return C/I>u.aspect?C/(2*Math.tan(.5*u.fovX)*u.aspect):I/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,g,C,I,P,N){const B=u.clone(),U=this._extendCameraOptions(N);B.bearing=I,B.pitch=P;const q=m.LngLat.convert(g),H=m.LngLat.convert(C),J=.5*(q.lat+H.lat),_e=.5*(q.lng+H.lng),Ce=m.latLngToECEF(J,_e),Te=m.normalize([],Ce),Pe=m.normalize([],m.cross([],Te,[0,1,0])),Le=m.cross([],Pe,Te),ee=[Pe[0],Pe[1],Pe[2],0,Le[0],Le[1],Le[2],0,Te[0],Te[1],Te[2],0,0,0,0,1],Se=[Ce,m.latLngToECEF(q.lat,q.lng),m.latLngToECEF(H.lat,q.lng),m.latLngToECEF(H.lat,H.lng),m.latLngToECEF(q.lat,H.lng),m.latLngToECEF(J,q.lng),m.latLngToECEF(J,H.lng),m.latLngToECEF(q.lat,_e),m.latLngToECEF(H.lat,_e)];let Ge=m.Aabb.fromPoints(Se.map(hn=>[m.dot(Pe,hn),m.dot(Le,hn),m.dot(Te,hn)]));const We=m.transformMat4([],Ge.center,ee);0===m.squaredLength(We)&&m.set(We,0,0,1),m.normalize(We,We),m.scale$2(We,We,m.GLOBE_RADIUS),B.center=m.ecefToLatLng(We);const ht=B.getWorldToCameraMatrix(),ft=m.invert(new Float64Array(16),ht);Ge=m.Aabb.applyTransform(Ge,m.multiply([],ht,ee)),m.transformMat4(We,We,ht);const ut=.5*(Ge.max[2]-Ge.min[2]),St=this._minimumAABBFrustumDistance(B,Ge),bt=m.scale$2([],[0,0,1],ut),zt=m.add(bt,We,bt),En=St+(0===B.pitch?0:m.distance(We,zt)),Pt=B.globeCenterInViewSpace,sn=m.sub([],We,[Pt[0],Pt[1],Pt[2]]);m.normalize(sn,sn),m.scale$2(sn,sn,En);const Ht=m.add([],We,sn);m.transformMat4(Ht,Ht,ft);const xn=m.earthRadius/m.GLOBE_RADIUS,Bt=m.length(Ht),rn=m.mercatorZfromAltitude(Math.max(Bt*xn-m.earthRadius,Number.EPSILON),0),wn=Math.min(B.zoomFromMercatorZAdjusted(rn),U.maxZoom);return wn>.5*(m.GLOBE_ZOOM_THRESHOLD_MIN+m.GLOBE_ZOOM_THRESHOLD_MAX)?(B.setProjection({name:"mercator"}),B.zoom=wn,this._cameraForBounds(B,g,C,I,P,N)):{center:B.center,zoom:wn,bearing:I,pitch:P}}queryTerrainElevation(u,g){const C=this.transform.elevation;return C?(g=m.extend({},{exaggerated:!0},g),C.getAtPoint(m.MercatorCoordinate.fromLngLat(u),null,g.exaggerated)):null}_cameraForBounds(u,g,C,I,P,N){if("globe"===u.projection.name)return this._cameraForBoundsOnGlobe(u,g,C,I,P,N);const B=u.clone(),U=this._extendCameraOptions(N),q=B.padding;B.bearing=I,B.pitch=P;const H=m.LngLat.convert(g),J=m.LngLat.convert(C),_e=new m.LngLat(H.lng,J.lat),Ce=new m.LngLat(J.lng,H.lat),Te=B.project(H),Pe=B.project(J),Le=this.queryTerrainElevation(H),ee=this.queryTerrainElevation(J),Se=this.queryTerrainElevation(_e),Ge=this.queryTerrainElevation(Ce),We=[[Te.x,Te.y,Math.min(Le||0,ee||0,Se||0,Ge||0)],[Pe.x,Pe.y,Math.max(Le||0,ee||0,Se||0,Ge||0)]];let ht=m.Aabb.fromPoints(We);const ft=B.getWorldToCameraMatrix(),ut=m.invert(new Float64Array(16),ft);ht=m.Aabb.applyTransform(ht,ft);const St=m.sub([],ht.max,ht.min),bt=q.left||0,zt=q.right||0,En=q.bottom||0,Pt=q.top||0,{left:sn,right:Ht,top:xn,bottom:Bt}=U.padding,rn=.5*(bt+zt),wn=.5*(Pt+En),hn=Math.min(B.scaleZoom(B.scale*Math.min((B.width-(bt+zt+sn+Ht))/St[0],(B.height-(En+Pt+Bt+xn))/St[1])),U.maxZoom),Sn=B.scale/B.zoomScale(hn);ht=new m.Aabb([ht.min[0]-(sn+rn)*Sn,ht.min[1]-(Bt+wn)*Sn,ht.min[2]],[ht.max[0]+(Ht+rn)*Sn,ht.max[1]+(xn+wn)*Sn,ht.max[2]]);const yi=.5*St[2],$i=this._minimumAABBFrustumDistance(B,ht),ei=[0,0,1,0];m.transformMat4$1(ei,ei,ft),m.normalize$2(ei,ei);const ii=m.scale$2([],ei,$i+yi),fr=m.add([],ht.center,ii),pr=("number"==typeof U.offset.x&&"number"==typeof U.offset.y?new m.Point(U.offset.x,U.offset.y):m.Point.convert(U.offset)).rotate(-m.degToRad(I));ht.center[0]-=pr.x*Sn,ht.center[1]+=pr.y*Sn,m.transformMat4(ht.center,ht.center,ut),m.transformMat4(fr,fr,ut);const di=[ht.center[0],ht.center[1],fr[2]*B.pixelsPerMeter];m.scale$2(di,di,1/B.worldSize);const _o=m.lngFromMercatorX(di[0]),No=m.latFromMercatorY(di[1]),$o=Math.min(B._zoomFromMercatorZ(di[2]),U.maxZoom),Ao=new m.LngLat(_o,No);return B.mercatorFromTransition&&$o<.5*(m.GLOBE_ZOOM_THRESHOLD_MIN+m.GLOBE_ZOOM_THRESHOLD_MAX)?(B.setProjection({name:"globe"}),B.zoom=$o,this._cameraForBounds(B,g,C,I,P,N)):{center:Ao,zoom:$o,bearing:I,pitch:P}}fitBounds(u,g,C){const I=this.cameraForBounds(u,g);return this._fitInternal(I,g,C)}fitScreenCoordinates(u,g,C,I,P){const N=m.Point.convert(u),B=m.Point.convert(g),U=new m.Point(Math.min(N.x,B.x),Math.min(N.y,B.y)),q=new m.Point(Math.max(N.x,B.x),Math.max(N.y,B.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(N,B))return this;const H=this.transform.pointLocation3D(U),J=this.transform.pointLocation3D(q),_e=this.transform.pointLocation3D(new m.Point(U.x,q.y)),Ce=this.transform.pointLocation3D(new m.Point(q.x,U.y)),Te=[Math.min(H.lng,J.lng,_e.lng,Ce.lng),Math.min(H.lat,J.lat,_e.lat,Ce.lat)],Pe=[Math.max(H.lng,J.lng,_e.lng,Ce.lng),Math.max(H.lat,J.lat,_e.lat,Ce.lat)],Le=I&&I.pitch?I.pitch:this.getPitch(),ee=this._cameraForBounds(this.transform,Te,Pe,C,Le,I);return this._fitInternal(ee,I,P)}_fitInternal(u,g,C){return u?(delete(g=m.extend(u,g)).padding,g.linear?this.easeTo(g,C):this.flyTo(g,C)):this}jumpTo(u,g){this.stop();const C=u.preloadOnly?this.transform.clone():this.transform;let I=!1,P=!1,N=!1;return"zoom"in u&&C.zoom!==+u.zoom&&(I=!0,C.zoom=+u.zoom),void 0!==u.center&&(C.center=m.LngLat.convert(u.center)),"bearing"in u&&C.bearing!==+u.bearing&&(P=!0,C.bearing=+u.bearing),"pitch"in u&&C.pitch!==+u.pitch&&(N=!0,C.pitch=+u.pitch),null==u.padding||C.isPaddingEqual(u.padding)||(C.padding=u.padding),u.preloadOnly?(this._preloadTiles(C),this):(this.fire(new m.Event("movestart",g)).fire(new m.Event("move",g)),I&&this.fire(new m.Event("zoomstart",g)).fire(new m.Event("zoom",g)).fire(new m.Event("zoomend",g)),P&&this.fire(new m.Event("rotatestart",g)).fire(new m.Event("rotate",g)).fire(new m.Event("rotateend",g)),N&&this.fire(new m.Event("pitchstart",g)).fire(new m.Event("pitch",g)).fire(new m.Event("pitchend",g)),this.fire(new m.Event("moveend",g)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||m.warnOnce(hi),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,g){const C=this.transform;if(!C.projection.supportsFreeCamera)return m.warnOnce(hi),this;this.stop();const I=C.zoom,P=C.pitch,N=C.bearing;C.setFreeCameraOptions(u);const B=I!==C.zoom,U=P!==C.pitch,q=N!==C.bearing;return this.fire(new m.Event("movestart",g)).fire(new m.Event("move",g)),B&&this.fire(new m.Event("zoomstart",g)).fire(new m.Event("zoom",g)).fire(new m.Event("zoomend",g)),q&&this.fire(new m.Event("rotatestart",g)).fire(new m.Event("rotate",g)).fire(new m.Event("rotateend",g)),U&&this.fire(new m.Event("pitchstart",g)).fire(new m.Event("pitch",g)).fire(new m.Event("pitchend",g)),this.fire(new m.Event("moveend",g)),this}easeTo(u,g){this._stop(!1,u.easeId),(!1===(u=m.extend({offset:[0,0],duration:500,easing:m.ease},u)).animate||this._prefersReducedMotion(u))&&(u.duration=0);const C=this.transform,I=this.getZoom(),P=this.getBearing(),N=this.getPitch(),B=this.getPadding(),U="zoom"in u?+u.zoom:I,q="bearing"in u?this._normalizeBearing(u.bearing,P):P,H="pitch"in u?+u.pitch:N,J="padding"in u?u.padding:C.padding,_e=m.Point.convert(u.offset);let Ce,Te,Pe;if("globe"===C.projection.name){const bt=m.MercatorCoordinate.fromLngLat(C.center),zt=_e.rotate(-C.angle);bt.x+=zt.x/C.worldSize,bt.y+=zt.y/C.worldSize;const En=bt.toLngLat(),Pt=m.LngLat.convert(u.center||En);this._normalizeCenter(Pt),Ce=C.centerPoint.add(zt),Te=new m.Point(bt.x,bt.y).mult(C.worldSize),Pe=new m.Point(m.mercatorXfromLng(Pt.lng),m.mercatorYfromLat(Pt.lat)).mult(C.worldSize).sub(Te)}else{Ce=C.centerPoint.add(_e);const bt=C.pointLocation(Ce),zt=m.LngLat.convert(u.center||bt);this._normalizeCenter(zt),Te=C.project(bt),Pe=C.project(zt).sub(Te)}const Le=C.zoomScale(U-I);let ee,Se;u.around&&(ee=m.LngLat.convert(u.around),Se=C.locationPoint(ee));const Ge=this._zooming||U!==I,We=this._rotating||P!==q,ht=this._pitching||H!==N,ft=!C.isPaddingEqual(J),ut=bt=>zt=>{if(Ge&&(bt.zoom=m.number(I,U,zt)),We&&(bt.bearing=m.number(P,q,zt)),ht&&(bt.pitch=m.number(N,H,zt)),ft&&(bt.interpolatePadding(B,J,zt),Ce=bt.centerPoint.add(_e)),ee)bt.setLocationAtPoint(ee,Se);else{const En=bt.zoomScale(bt.zoom-I),Pt=U>I?Math.min(2,Le):Math.max(.5,Le),sn=Math.pow(Pt,1-zt),Ht=bt.unproject(Te.add(Pe.mult(zt*sn)).mult(En));bt.setLocationAtPoint(bt.renderWorldCopies?Ht.wrap():Ht,Ce)}return u.preloadOnly||this._fireMoveEvents(g),bt};if(u.preloadOnly){const bt=this._emulate(ut,u.duration,C);return this._preloadTiles(bt),this}const St={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ge,this._rotating=We,this._pitching=ht,this._padding=ft,this._easeId=u.easeId,this._prepareEase(g,u.noMoveStart,St),this._ease(ut(C),bt=>{C.recenterOnTerrain(),this._afterEase(g,bt)},u),this}_prepareEase(u,g,C={}){this._moving=!0,this.transform.cameraElevationReference="sea",g||C.moving||this.fire(new m.Event("movestart",u)),this._zooming&&!C.zooming&&this.fire(new m.Event("zoomstart",u)),this._rotating&&!C.rotating&&this.fire(new m.Event("rotatestart",u)),this._pitching&&!C.pitching&&this.fire(new m.Event("pitchstart",u))}_fireMoveEvents(u){this.fire(new m.Event("move",u)),this._zooming&&this.fire(new m.Event("zoom",u)),this._rotating&&this.fire(new m.Event("rotate",u)),this._pitching&&this.fire(new m.Event("pitch",u))}_afterEase(u,g){if(this._easeId&&g&&this._easeId===g)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const C=this._zooming,I=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,C&&this.fire(new m.Event("zoomend",u)),I&&this.fire(new m.Event("rotateend",u)),P&&this.fire(new m.Event("pitchend",u)),this.fire(new m.Event("moveend",u))}flyTo(u,g){if(this._prefersReducedMotion(u)){const hn=m.pick(u,["center","zoom","bearing","pitch","around"]);return this.jumpTo(hn,g)}this.stop(),u=m.extend({offset:[0,0],speed:1.2,curve:1.42,easing:m.ease},u);const C=this.transform,I=this.getZoom(),P=this.getBearing(),N=this.getPitch(),B=this.getPadding(),U="zoom"in u?m.clamp(+u.zoom,C.minZoom,C.maxZoom):I,q="bearing"in u?this._normalizeBearing(u.bearing,P):P,H="pitch"in u?+u.pitch:N,J="padding"in u?u.padding:C.padding,_e=C.zoomScale(U-I),Ce=m.Point.convert(u.offset);let Te=C.centerPoint.add(Ce);const Pe=C.pointLocation(Te),Le=m.LngLat.convert(u.center||Pe);this._normalizeCenter(Le);const ee=C.project(Pe),Se=C.project(Le).sub(ee);let Ge=u.curve;const We=Math.max(C.width,C.height),ht=We/_e,ft=Se.mag();if("minZoom"in u){const hn=m.clamp(Math.min(u.minZoom,I,U),C.minZoom,C.maxZoom),Sn=We/C.zoomScale(hn-I);Ge=Math.sqrt(Sn/ft*2)}const ut=Ge*Ge;function St(hn){const Sn=(ht*ht-We*We+(hn?-1:1)*ut*ut*ft*ft)/(2*(hn?ht:We)*ut*ft);return Math.log(Math.sqrt(Sn*Sn+1)-Sn)}function bt(hn){return(Math.exp(hn)-Math.exp(-hn))/2}function zt(hn){return(Math.exp(hn)+Math.exp(-hn))/2}const En=St(0);let Pt=function(hn){return zt(En)/zt(En+Ge*hn)},sn=function(hn){return We*((zt(En)*(bt(Sn=En+Ge*hn)/zt(Sn))-bt(En))/ut)/ft;var Sn},Ht=(St(1)-En)/Ge;if(Math.abs(ft)<1e-6||!isFinite(Ht)){if(Math.abs(We-ht)<1e-6)return this.easeTo(u,g);const hn=ht<We?-1:1;Ht=Math.abs(Math.log(ht/We))/Ge,sn=function(){return 0},Pt=function(Sn){return Math.exp(hn*Ge*Sn)}}u.duration="duration"in u?+u.duration:1e3*Ht/("screenSpeed"in u?+u.screenSpeed/Ge:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const xn=P!==q,Bt=H!==N,rn=!C.isPaddingEqual(J),wn=hn=>Sn=>{const yi=Sn*Ht,$i=1/Pt(yi);hn.zoom=1===Sn?U:I+hn.scaleZoom($i),xn&&(hn.bearing=m.number(P,q,Sn)),Bt&&(hn.pitch=m.number(N,H,Sn)),rn&&(hn.interpolatePadding(B,J,Sn),Te=hn.centerPoint.add(Ce));const ei=1===Sn?Le:hn.unproject(ee.add(Se.mult(sn(yi))).mult($i));return hn.setLocationAtPoint(hn.renderWorldCopies?ei.wrap():ei,Te),hn._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(g),hn};if(u.preloadOnly){const hn=this._emulate(wn,u.duration,C);return this._preloadTiles(hn),this}return this._zooming=!0,this._rotating=xn,this._pitching=Bt,this._padding=rn,this._prepareEase(g,!1),this._ease(wn(C),()=>this._afterEase(g),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const C=this._onEaseEnd;this._onEaseEnd=void 0,C.call(this,g)}if(!u){const C=this.handlers;C&&C.stop(!1)}return this}_ease(u,g,C){!1===C.animate||0===C.duration?(u(1),g()):(this._easeStart=m.exported.now(),this._easeOptions=C,this._onEaseFrame=u,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((m.exported.now()-this._easeStart)/this._easeOptions.duration,1),g=this._onEaseFrame;g&&g(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,g){u=m.wrap(u,-180,180);const C=Math.abs(u-g);return Math.abs(u-360-g)<C&&(u-=360),Math.abs(u+360-g)<C&&(u+=360),u}_normalizeCenter(u){const g=this.transform;if(!g.renderWorldCopies||g.maxBounds)return;const C=u.lng-g.center.lng;u.lng+=C>180?-360:C<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&m.exported.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,g,C){const I=Math.ceil(15*g/1e3),P=[],N=u(C.clone());for(let B=0;B<=I;B++){const U=N(B/I);P.push(U.clone())}return P}}class On{constructor(u={}){this.options=u,m.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const g=this.options&&this.options.compact;return this._map=u,this._container=mt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=mt("button","mapboxgl-ctrl-attrib-button",this._container),mt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=mt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===g&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(u,g){const C=this._map._getUIString(`AttributionControl.${g}`);u.setAttribute("aria-label",C),u.removeAttribute("title"),u.firstElementChild&&u.firstElementChild.setAttribute("title",C)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||m.config.ACCESS_TOKEN}];if(u){const C=g.reduce((I,P,N)=>(P.value&&(I+=`${P.key}=${P.value}${N<g.length-1?"&":""}`),I),"?");u.href=`${m.config.FEEDBACK_URL}/${C}#${Zn(this._map,!0)}`,u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}}_updateData(u){!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const I=this._map.style.stylesheet;this.styleOwner=I.owner,this.styleId=I.id}const g=this._map.style._sourceCaches;for(const I in g){const P=g[I];if(P.used){const N=P.getSource();N.attribution&&u.indexOf(N.attribution)<0&&u.push(N.attribution)}}u.sort((I,P)=>I.length-P.length),u=u.filter((I,P)=>{for(let N=P+1;N<u.length;N++)if(u[N].indexOf(I)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const C=u.join(" | ");C!==this._attribHTML&&(this._attribHTML=C,u.length?(this._innerContainer.innerHTML=C,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Sa{constructor(){m.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=mt("div","mapboxgl-ctrl");const g=mt("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&"metadata"!==u.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(0===Object.entries(u).length)return!0;for(const g in u){const C=u[g].getSource();if(C.hasOwnProperty("mapbox_logo")&&!C.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const g=u[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}}}class hc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const g=++this._id;return this._queue.push({callback:u,id:g,cancelled:!1}),g}remove(u){const g=this._currentlyRunning,C=g?this._queue.concat(g):this._queue;for(const I of C)if(I.id===u)return void(I.cancelled=!0)}run(u=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const C of g)if(!C.cancelled&&(C.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function $l(b,u,g){if(b=new m.LngLat(b.lng,b.lat),u){const C=new m.LngLat(b.lng-360,b.lat),I=new m.LngLat(b.lng+360,b.lat),P=360*Math.ceil(Math.abs(b.lng-g.center.lng)/360),N=g.locationPoint(b).distSqr(u),B=u.x<0||u.y<0||u.x>g.width||u.y>g.height;g.locationPoint(C).distSqr(u)<N&&(B||Math.abs(C.lng-g.center.lng)<P)?b=C:g.locationPoint(I).distSqr(u)<N&&(B||Math.abs(I.lng-g.center.lng)<P)&&(b=I)}for(;Math.abs(b.lng-g.center.lng)>180;){const C=g.locationPoint(b);if(C.x>=0&&C.y>=0&&C.x<=g.width&&C.y<=g.height)break;b.lng>g.center.lng?b.lng-=360:b.lng+=360}return b}const ku={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Wn extends m.Evented{constructor(u,g){if(super(),(u instanceof m.window.HTMLElement||g)&&(u=m.extend({element:u},g)),m.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=m.Point.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=mt("div");const I=41,P=27,N=Xt("svg",{display:"block",height:I*this._scale+"px",width:P*this._scale+"px",viewBox:`0 0 ${P} ${I}`},this._element),B=Xt("radialGradient",{id:"shadowGradient"},Xt("defs",{},N));Xt("stop",{offset:"10%","stop-opacity":.4},B),Xt("stop",{offset:"100%","stop-opacity":.05},B),Xt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},N),Xt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},N),Xt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},N),Xt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},N),this._offset=m.Point.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",I=>{I.preventDefault()}),this._element.addEventListener("mousedown",I=>{I.preventDefault()});const C=this._element.classList;for(const I in ku)C.remove(`mapboxgl-marker-anchor-${I}`);C.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=m.LngLat.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const I=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[I,-1*(24.6+I)],"bottom-right":[-I,-1*(24.6+I)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const g=u.code,C=u.charCode||u.keyCode;"Space"!==g&&"Enter"!==g&&32!==C&&13!==C||this.togglePopup()}_onMapClick(u){const g=u.originalEvent.target,C=this._element;this._popup&&(g===C||C.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,g=this._pos;if(!u||!g)return!1;const C=u.unproject(g),I=u.getFreeCameraOptions();if(!I.position)return!1;const P=I.position.toLngLat();return P.distanceTo(C)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const g=this._pos;if(!g||g.x<0||g.x>u.transform.width||g.y<0||g.y>u.transform.height)return void this._clearFadeTimer();const C=u.unproject(g);let I;u._showingGlobe()&&m.isLngLatBehindGlobe(u.transform,this._lngLat)?I=0:(I=1-u._queryFogOpacity(C),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(I*=this._occludedOpacity)),this._element.style.opacity=`${I}`,this._element.style.pointerEvents=I>0?"auto":"none",this._popup&&this._popup._setOpacity(I),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const g=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${u.x}px,${u.y}px)\n            ${ku[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${g.x}px,${g.y}px)\n        `}_calculateXYTransform(){const u=this._pos,g=this._map,C=this.getPitchAlignment();if(!g||!u||"map"!==C)return"";if(!g._showingGlobe()){const U=g.getPitch();return U?`rotateX(${U}deg)`:""}const I=m.radToDeg(m.globeTiltAtLngLat(g.transform,this._lngLat)),P=u.sub(m.globeCenterToScreenPoint(g.transform)),N=Math.abs(P.x)+Math.abs(P.y);if(0===N)return"";const B=I/N;return`rotateX(${-P.y*B}deg) rotateY(${P.x*B}deg)`}_calculateZTransform(){const u=this._pos,g=this._map;if(!g||!u)return"";let C=0;const I=this.getRotationAlignment();if("map"===I)if(g._showingGlobe()){const P=g.project(new m.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),N=g.project(new m.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);C=m.radToDeg(Math.atan2(N.y,N.x))-90}else C=-g.getBearing();else if("horizon"===I){const P=m.smoothstep(4,6,g.getZoom()),N=m.globeCenterToScreenPoint(g.transform);N.y+=P*g.transform.height;const B=u.sub(N),U=m.radToDeg(Math.atan2(B.y,B.x));C=(U>90?U-270:U+90)*(1-P)}return C+=this._rotation,C?`rotateZ(${C}deg)`:""}_update(u){m.window.cancelAnimationFrame(this._updateFrameId);const g=this._map;g&&(g.transform.renderWorldCopies&&(this._lngLat=$l(this._lngLat,this._pos,g.transform)),this._pos=g.project(this._lngLat),!0===u?this._updateFrameId=m.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),g._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(g._showingGlobe()||g.getTerrain()||g.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=m.Point.convert(u),this._update(),this}_onMove(u){const g=this._map;if(!g)return;const C=this._pointerdownPos,I=this._positionDelta;if(C&&I){if(!this._isDragging){const P=this._clickTolerance||g._clickTolerance;if(u.point.dist(C)<P)return;this._isDragging=!0}this._pos=u.point.sub(I),this._lngLat=g.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new m.Event("dragstart"))),this.fire(new m.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new m.Event("dragend")),this._state="inactive"}_addDragHandler(u){const g=this._map,C=this._pos;g&&C&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(C),this._pointerdownPos=u.point,this._state="pending",g.on("mousemove",this._onMove),g.on("touchmove",this._onMove),g.once("mouseup",this._onUp),g.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const g=this._map;return g&&(u?(g.on("mousedown",this._addDragHandler),g.on("touchstart",this._addDragHandler)):(g.off("mousedown",this._addDragHandler),g.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ig={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Dg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function hm(b=new m.Point(0,0),u="bottom"){if("number"==typeof b){const g=Math.round(Math.sqrt(.5*Math.pow(b,2)));switch(u){case"top":return new m.Point(0,b);case"top-left":return new m.Point(g,g);case"top-right":return new m.Point(-g,g);case"bottom":return new m.Point(0,-b);case"bottom-left":return new m.Point(g,-g);case"bottom-right":return new m.Point(-g,-g);case"left":return new m.Point(b,0);case"right":return new m.Point(-b,0)}return new m.Point(0,0)}return b instanceof m.Point||Array.isArray(b)?m.Point.convert(b):m.Point.convert(b[u]||[0,0])}class Tg{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const g=m.easeCubicInOut((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-g)+this._end*g}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,g,C){this._start=this.getValue(g),this._end=u,this._startTime=g,this._endTime=g+C}}const Cy={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Sy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Wd={showCompass:!0,showZoom:!0,visualizePitch:!1};class gd{constructor(u,g,C=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new cc({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,C&&(this.mousePitch=new Il({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),m.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener("mousedown",this.mousedown),g.addEventListener("touchstart",this.touchstart,{passive:!1}),g.addEventListener("touchmove",this.touchmove),g.addEventListener("touchend",this.touchend),g.addEventListener("touchcancel",this.reset)}down(u,g){this.mouseRotate.mousedown(u,g),this.mousePitch&&this.mousePitch.mousedown(u,g),pn()}move(u,g){const C=this.map,I=this.mouseRotate.mousemoveWindow(u,g),P=I&&I.bearingDelta;if(P&&C.setBearing(C.getBearing()+P),this.mousePitch){const N=this.mousePitch.mousemoveWindow(u,g),B=N&&N.pitchDelta;B&&C.setPitch(C.getPitch()+B)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){he(),m.window.removeEventListener("mousemove",this.mousemove),m.window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(m.extend({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),ge(this.element,u)),m.window.addEventListener("mousemove",this.mousemove),m.window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,ge(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){1!==u.targetTouches.length?this.reset():(this._startPos=this._lastPos=ue(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){1!==u.targetTouches.length?this.reset():(this._lastPos=ue(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){0===u.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ag={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Pg={maxWidth:100,unit:"metric"},Va={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ed={version:m.version,supported:He,setRTLTextPlugin:m.setRTLTextPlugin,getRTLTextPluginStatus:m.getRTLTextPluginStatus,Map:class extends Sr{constructor(b){if(m.LivePerformanceUtils.mark(m.PerformanceMarkers.create),null!=(b=m.extend({},Sy,b)).minZoom&&null!=b.maxZoom&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=b.minPitch&&null!=b.maxPitch&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=b.minPitch&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=b.maxPitch&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(b.antialias&&m.isSafariWithAntialiasingBug(m.window)&&(b.antialias=!1,m.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ns(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),b),this._interactive=b.interactive,this._minTileCacheSize=b.minTileCacheSize,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._useWebGL2=b.useWebGL2,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=b.crossSourceCollisions,this._collectResourceTiming=b.collectResourceTiming,this._optimizeForTerrain=b.optimizeForTerrain,this._language=this._parseLanguage(b.language),this._worldview=b.worldview,this._renderTaskQueue=new hc,this._domRenderTaskQueue=new hc,this._controls=[],this._markers=[],this._popups=[],this._mapId=m.uniqueId(),this._locale=m.extend({},Cy,b.locale),this._clickTolerance=b.clickTolerance,this._cooperativeGestures=b.cooperativeGestures,this._performanceMetricsCollection=b.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Tg(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new m.RequestManager(b.transformRequest,b.accessToken,b.testMode),this._silenceAuthErrors=!!b.testMode,"string"==typeof b.container){if(this._container=m.window.document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof m.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(this._container.childNodes.length>0&&m.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),b.maxBounds&&this.setMaxBounds(b.maxBounds),m.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==m.window&&(m.window.addEventListener("online",this._onWindowOnline,!1),m.window.addEventListener("resize",this._onWindowResize,!1),m.window.addEventListener("orientationchange",this._onWindowResize,!1),m.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),m.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Xn(this,b),this._localFontFamily=b.localFontFamily,this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),b.projection&&this.setProjection(b.projection),this._hash=b.hash&&new cs("string"==typeof b.hash&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,m.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),b.attributionControl&&this.addControl(new On({customAttribution:b.customAttribution})),this._logoControl=new Sa,this.addControl(this._logoControl,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update("style"===u.dataType),this.fire(new m.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new m.Event(`${u.dataType}dataloading`,u))})}_getMapId(){return this._mapId}addControl(b,u){if(void 0===u&&(u=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new m.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=b.onAdd(this);this._controls.push(b);const C=this._controlPositions[u];return-1!==u.indexOf("bottom")?C.insertBefore(g,C.firstChild):C.appendChild(g),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new m.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(b);return u>-1&&this._controls.splice(u,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(b){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new m.Event("movestart",b)).fire(new m.Event("move",b)),this.fire(new m.Event("resize",b)),u&&this.fire(new m.Event("moveend",b)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(b){return this.transform.setMaxBounds(m.LngLatBounds.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b?this.setZoom(b):this.fire(new m.Event("zoomstart")).fire(new m.Event("zoom")).fire(new m.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b?this.setZoom(b):this.fire(new m.Event("zoomstart")).fire(new m.Event("zoom")).fire(new m.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b?this.setPitch(b):this.fire(new m.Event("pitchstart")).fire(new m.Event("pitch")).fire(new m.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b?this.setPitch(b):this.fire(new m.Event("pitchstart")).fire(new m.Event("pitch")).fire(new m.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(b){return"auto"===b?m.window.navigator.language:Array.isArray(b)?0===b.length?void 0:b.map(u=>"auto"===u?m.window.navigator.language:u):b}setLanguage(b){const u=this._parseLanguage(b);if(!this.style||u===this._language)return this;this._language=u,this.style._reloadSources();for(const g of this._controls)g._setLanguage&&g._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(b){return this.style&&b!==this._worldview?(this._worldview=b,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(b){return this._lazyInitEmptyStyle(),b?"string"==typeof b&&(b={name:b}):b=null,this._useExplicitProjection=!!b,this._prioritizeAndUpdateProjection(b,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const b=this.transform,u=b.projection.name;let g;"globe"===u&&b.zoom>=m.GLOBE_ZOOM_THRESHOLD_MAX?(b.setMercatorFromTransition(),g=!0):"mercator"===u&&b.zoom<m.GLOBE_ZOOM_THRESHOLD_MAX&&(b.setProjection({name:"globe"}),g=!0),g&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(b,u){return this._updateProjection(b||u||{name:"mercator"})}_updateProjection(b){let u;if(u="globe"===b.name&&this.transform.zoom>=m.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(b),this.style.applyProjectionUpdate(),u){this.painter.clearBackgroundTiles();for(const g in this.style._sourceCaches)this.style._sourceCaches[g].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(b){return this.transform.locationPoint3D(m.LngLat.convert(b))}unproject(b){return this.transform.pointLocation3D(m.Point.convert(b))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(b,u,g){if("mouseenter"===b||"mouseover"===b){let C=!1;const I=N=>{const B=u.filter(q=>this.getLayer(q)),U=B.length?this.queryRenderedFeatures(N.point,{layers:B}):[];U.length?C||(C=!0,g.call(this,new Fs(b,this,N.originalEvent,{features:U}))):C=!1},P=()=>{C=!1};return{layers:new Set(u),listener:g,delegates:{mousemove:I,mouseout:P}}}if("mouseleave"===b||"mouseout"===b){let C=!1;const I=N=>{const B=u.filter(U=>this.getLayer(U));(B.length?this.queryRenderedFeatures(N.point,{layers:B}):[]).length?C=!0:C&&(C=!1,g.call(this,new Fs(b,this,N.originalEvent)))},P=N=>{C&&(C=!1,g.call(this,new Fs(b,this,N.originalEvent)))};return{layers:new Set(u),listener:g,delegates:{mousemove:I,mouseout:P}}}{const C=I=>{const P=u.filter(B=>this.getLayer(B)),N=P.length?this.queryRenderedFeatures(I.point,{layers:P}):[];N.length&&(I.features=N,g.call(this,I),delete I.features)};return{layers:new Set(u),listener:g,delegates:{[b]:C}}}}on(b,u,g){if(void 0===g)return super.on(b,u);Array.isArray(u)||(u=[u]);const C=this._createDelegatedListener(b,u,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(C);for(const I in C.delegates)this.on(I,C.delegates[I]);return this}once(b,u,g){if(void 0===g)return super.once(b,u);Array.isArray(u)||(u=[u]);const C=this._createDelegatedListener(b,u,g);for(const I in C.delegates)this.once(I,C.delegates[I]);return this}off(b,u,g){if(void 0===g)return super.off(b,u);u=new Set(Array.isArray(u)?u:[u]);const C=(P,N)=>{if(P.size!==N.size)return!1;for(const B of P)if(!N.has(B))return!1;return!0},I=this._delegatedListeners?this._delegatedListeners[b]:void 0;return I&&(P=>{for(let N=0;N<P.length;N++){const B=P[N];if(B.listener===g&&C(B.layers,u)){for(const U in B.delegates)this.off(U,B.delegates[U]);return P.splice(N,1),this}}})(I),this}queryRenderedFeatures(b,u){return this.style?(void 0!==u||void 0===b||b instanceof m.Point||Array.isArray(b)||(u=b,b=void 0),this.style.queryRenderedFeatures(b=b||[[0,0],[this.transform.width,this.transform.height]],u=u||{},this.transform)):[]}querySourceFeatures(b,u){return this.style.querySourceFeatures(b,u)}isPointOnSurface(b){const{name:u}=this.transform.projection;return"globe"!==u&&"mercator"!==u&&m.warnOnce(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(m.Point.convert(b))}setStyle(b,u){return!1!==(u=m.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u)).diff&&u.localIdeographFontFamily===this._localIdeographFontFamily&&u.localFontFamily===this._localFontFamily&&this.style&&b?(this._diffStyle(b,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(b,u))}_getUIString(b){const u=this._locale[b];if(null==u)throw new Error(`Missing UI string '${b}'`);return u}_updateStyle(b,u){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),b&&(this.style=new ko(this,u||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof b?this.style.loadURL(b):this.style.loadJSON(b)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ko(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,u){if("string"==typeof b){const g=this._requestManager.normalizeStyleURL(b),C=this._requestManager.transformRequest(g,m.ResourceType.Style);m.getJSON(C,(I,P)=>{I?this.fire(new m.ErrorEvent(I)):P&&this._updateDiff(P,u)})}else"object"==typeof b&&this._updateDiff(b,u)}_updateDiff(b,u){try{this.style.setState(b)&&this._update(!0)}catch(g){m.warnOnce(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(b,u)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(m.warnOnce("There is no style added to the map."),!1)}addSource(b,u){return this._lazyInitEmptyStyle(),this.style.addSource(b,u),this._update(!0)}isSourceLoaded(b){return!!this.style&&this.style._isSourceCacheLoaded(b)}areTilesLoaded(){const b=this.style&&this.style._sourceCaches;for(const u in b){const g=b[u]._tiles;for(const C in g){const I=g[C];if("loaded"!==I.state&&"errored"!==I.state)return!1}}return!0}addSourceType(b,u,g){this._lazyInitEmptyStyle(),this.style.addSourceType(b,u,g)}removeSource(b){return this.style.removeSource(b),this._updateTerrain(),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,u,{pixelRatio:g=1,sdf:C=!1,stretchX:I,stretchY:P,content:N}={}){if(this._lazyInitEmptyStyle(),u instanceof m.window.HTMLImageElement||m.window.ImageBitmap&&u instanceof m.window.ImageBitmap){const{width:B,height:U,data:q}=m.exported.getImageData(u);this.style.addImage(b,{data:new m.RGBAImage({width:B,height:U},q),pixelRatio:g,stretchX:I,stretchY:P,content:N,sdf:C,version:0})}else if(void 0===u.width||void 0===u.height)this.fire(new m.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:B,height:U}=u,q=u;this.style.addImage(b,{data:new m.RGBAImage({width:B,height:U},new Uint8Array(q.data)),pixelRatio:g,stretchX:I,stretchY:P,content:N,sdf:C,version:0,userImage:q}),q.onAdd&&q.onAdd(this,b)}}updateImage(b,u){const g=this.style.getImage(b);if(!g)return void this.fire(new m.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const C=u instanceof m.window.HTMLImageElement||m.window.ImageBitmap&&u instanceof m.window.ImageBitmap?m.exported.getImageData(u):u,{width:I,height:P}=C;void 0!==I&&void 0!==P?I===g.data.width&&P===g.data.height?(g.data.replace(C.data,!(u instanceof m.window.HTMLImageElement||m.window.ImageBitmap&&u instanceof m.window.ImageBitmap)),this.style.updateImage(b,g)):this.fire(new m.ErrorEvent(new Error(`The width and height of the updated image (${I}, ${P})\n                must be that same as the previous version of the image\n                (${g.data.width}, ${g.data.height})`))):this.fire(new m.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new m.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,u){m.getImage(this._requestManager.transformRequest(b,m.ResourceType.Image),(g,C)=>{u(g,C instanceof m.window.HTMLImageElement?m.exported.getImageData(C):C)})}listImages(){return this.style.listImages()}addLayer(b,u){return this._lazyInitEmptyStyle(),this.style.addLayer(b,u),this._update(!0)}moveLayer(b,u){return this.style.moveLayer(b,u),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}setLayerZoomRange(b,u,g){return this.style.setLayerZoomRange(b,u,g),this._update(!0)}setFilter(b,u,g={}){return this.style.setFilter(b,u,g),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,u,g,C={}){return this.style.setPaintProperty(b,u,g,C),this._update(!0)}getPaintProperty(b,u){return this.style.getPaintProperty(b,u)}setLayoutProperty(b,u,g,C={}){return this.style.setLayoutProperty(b,u,g,C),this._update(!0)}getLayoutProperty(b,u){return this.style.getLayoutProperty(b,u)}setLight(b,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,u),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(b){return this._lazyInitEmptyStyle(),!b&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(b),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(b){return this._lazyInitEmptyStyle(),this.style.setFog(b),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(b){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(m.LngLat.convert(b),this.transform):0}setFeatureState(b,u){return this.style.setFeatureState(b,u),this._update()}removeFeatureState(b,u){return this.style.removeFeatureState(b,u),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}_updateContainerDimensions(){if(!this._container)return;const b=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let g,C,I,P=this._container;for(;P&&(!C||!I);){const N=m.window.getComputedStyle(P).transform;N&&"none"!==N&&(g=N.match(/matrix.*\((.+)\)/)[1].split(", "),g[0]&&"0"!==g[0]&&"1"!==g[0]&&(C=g[0]),g[3]&&"0"!==g[3]&&"1"!==g[3]&&(I=g[3])),P=P.parentElement}this._containerWidth=C?Math.abs(b/C):b,this._containerHeight=I?Math.abs(u/I):u}_detectMissingCSS(){"rgb(250, 128, 114)"!==m.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&m.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const b=this._container;b.classList.add("mapboxgl-map"),(this._missingCSSCanary=mt("div","mapboxgl-canary",b)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=mt("div","mapboxgl-canvas-container",b);this._interactive&&u.classList.add("mapboxgl-interactive"),this._canvas=mt("canvas","mapboxgl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const g=this._controlContainer=mt("div","mapboxgl-control-container",b),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(I=>{C[I]=mt("div",`mapboxgl-ctrl-${I}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,u){const g=m.exported.devicePixelRatio||1;this._canvas.width=g*Math.ceil(b),this._canvas.height=g*Math.ceil(u),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${u}px`}_addMarker(b){this._markers.push(b)}_removeMarker(b){const u=this._markers.indexOf(b);-1!==u&&this._markers.splice(u,1)}_addPopup(b){this._popups.push(b)}_removePopup(b){const u=this._popups.indexOf(b);-1!==u&&this._popups.splice(u,1)}_setupPainter(){const b=m.extend({},He.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._useWebGL2&&this._canvas.getContext("webgl2",b),g=u||this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);g?(this._useWebGL2&&!u&&m.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),m.storeAuthState(g,!0),this.painter=new xr(g,this.transform,!!u),this.on("data",C=>{"source"===C.dataType&&this.painter.setTileLoadedFlag(!0)}),m.exported$1.testSupport(g)):this.fire(new m.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new m.Event("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new m.Event("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_requestDomTask(b){!this.loaded()||this.loaded()&&!this.isMoving()?b():this._domRenderTaskQueue.add(b)}_render(b){let u;const g=this.painter.context.extTimerQuery,C=m.exported.now();if(this.listens("gpu-timing-frame")&&(u=g.createQueryEXT(),g.beginQueryEXT(g.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],m.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],m.window.performance.now())),this._renderTaskQueue.run(b),this._domRenderTaskQueue.run(b),this._removed)return;this._updateProjectionTransition();const I=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,U=this.transform.pitch,q=m.exported.now(),H=new m.EvaluationParameters(B,{now:q,fadeDuration:I,pitch:U,transition:this.style.getTransition()});this.style.update(H)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(C),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(C),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,I,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:I,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new m.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new m.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const B=m.exported.now()-C;g.endQueryEXT(g.TIME_ELAPSED_EXT,u),setTimeout(()=>{const U=g.getQueryObjectEXT(u,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(u),this.fire(new m.Event("gpu-timing-frame",{cpuTime:B,gpuTime:U})),m.window.performance.mark("frame-gpu",{startTime:C,detail:{gpuTime:U}})},50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers(B);this.fire(new m.Event("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender(B);this.fire(new m.Event("gpu-timing-deferred-render",{gpuTime:U}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(N||this._repaint)this.triggerRepaint();else{const B=!this.isMoving()&&this.loaded();if(B&&(P=this._updateAverageElevation(C,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new m.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new m.Event("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,m.LivePerformanceUtils.mark(m.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&m.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(b){for(const u of this._markers)b&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!b||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(b,u=!1){const g=C=>(this.transform.averageElevation=C,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&g(0);if((u||b-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(b)){const C=this.transform.averageElevation;let I=this.transform.sampleAverageElevation(),P=!1;this.transform.elevation&&(P=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(I)?I=0:this._averageElevationLastSampledAt=b;const N=Math.abs(C-I);if(N>1){if(this._isInitialLoad||P)return this._averageElevation.jumpTo(I),g(I);this._averageElevation.easeTo(I,b,300)}else if(N>1e-4)return this._averageElevation.jumpTo(I),g(I)}return!!this._averageElevation.isEasing(b)&&g(this._averageElevation.getValue(b))}_authenticate(){m.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,b=>{if(b&&(b.message===m.AUTH_ERR_MSG||401===b.status)){const u=this.painter.context.gl;m.storeAuthState(u,!1),this._logoControl instanceof Sa&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new m.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),m.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const b=this._isDragging();this.painter.updateTerrain(this.style,b)}_calculateSpeedIndex(){const b=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const g=this.painter.context.gl,C=g.createFramebuffer();function I(P){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,P,0);const N=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4);return g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,N),N}return g.bindFramebuffer(g.FRAMEBUFFER,C),this._canvasPixelComparison(I(b),u.canvasCopies.map(I),u.timeStamps)}_canvasPixelComparison(b,u,g){let C=g[1]-g[0];const I=b.length/4;for(let P=0;P<u.length;P++){const N=u[P];let B=0;for(let U=0;U<N.length;U+=4)N[U]===b[U]&&N[U+1]===b[U+1]&&N[U+2]===b[U+2]&&N[U+3]===b[U+3]&&(B+=1);C+=(g[P+2]-g[P+1])*(1-B/I)}return C}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==m.window&&(m.window.removeEventListener("resize",this._onWindowResize,!1),m.window.removeEventListener("orientationchange",this._onWindowResize,!1),m.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),m.window.removeEventListener("online",this._onWindowOnline,!1),m.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),m.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new m.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(b){this._renderNextFrame=this._renderNextFrame||b,this.style&&!this._frame&&(this._frame=m.exported.frame(u=>{const g=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,g&&this._render(u)}))}_preloadTiles(b){const u=this.style?Object.values(this.style._sourceCaches):[];return m.asyncAll(u,(g,C)=>g._preloadTiles(b,C),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}_onVisibilityChange(){"hidden"===m.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(b){this._showTerrainWireframe!==b&&(this._showTerrainWireframe=b,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(b){this._speedIndexTiming!==b&&(this._speedIndexTiming=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(b){this._showTileAABBs!==b&&(this._showTileAABBs=b,b&&this._update())}_setCacheLimits(b,u){m.setCacheLimits(b,u)}get version(){return m.version}},NavigationControl:class{constructor(b){this.options=m.extend({},Wd,b),this._container=mt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(m.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),mt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),mt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(m.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const g=this._map;g&&(this.options.visualizePitch?g.resetNorthPitch({},{originalEvent:u}):g.resetNorth({},{originalEvent:u}))}),this._compassIcon=mt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map;if(!b)return;const u=b.getZoom(),g=u===b.getMaxZoom(),C=u===b.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=C,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",C.toString())}_rotateCompassArrow(){const b=this._map;if(!b)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(b.transform.pitch*(Math.PI/180)),.5)}) rotateX(${b.transform.pitch}deg) rotateZ(${b.transform.angle*(180/Math.PI)}deg)`:`rotate(${b.transform.angle*(180/Math.PI)}deg)`;b._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),b.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&b.on("pitch",this._rotateCompassArrow),b.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gd(b,this._compass,this.options.visualizePitch)),this._container}onRemove(){const b=this._map;b&&(this._container.remove(),this.options.showZoom&&b.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&b.off("pitch",this._rotateCompassArrow),b.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(b,u){const g=mt("button",b,this._container);return g.type="button",g.addEventListener("click",u),g}_setButtonTitle(b,u){if(!this._map)return;const g=this._map._getUIString(`NavigationControl.${u}`);b.setAttribute("aria-label",g),b.firstElementChild&&b.firstElementChild.setAttribute("title",g)}},GeolocateControl:class extends m.Evented{constructor(b){super(),this.options=m.extend({geolocation:m.window.navigator.geolocation},Ag,b),m.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ml(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(b){return this._map=b,this._container=mt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(b){const u=(g=!!this.options.geolocation)=>{this._supportsGeolocation=g,b(g)};void 0!==this._supportsGeolocation?b(this._supportsGeolocation):void 0!==m.window.navigator.permissions?m.window.navigator.permissions.query({name:"geolocation"}).then(g=>u("denied"!==g.state)).catch(()=>u()):u()}_isOutOfMapMaxBounds(b){const u=this._map.getMaxBounds(),g=b.coords;return!!u&&(g.longitude<u.getWest()||g.longitude>u.getEast()||g.latitude<u.getSouth()||g.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new m.Event("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(b),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new m.Event("geolocate",b)),this._finish()}}_updateCamera(b){const u=new m.LngLat(b.coords.longitude,b.coords.latitude),g=b.coords.accuracy,C=this._map.getBearing(),I=m.extend({bearing:C},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(g),I,{geolocateSource:!0})}_updateMarker(b){if(b){const u=new m.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map.transform,u=m.mercatorZfromAltitude(1,b._center.lat)*b.worldSize,g=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(b){if(this._map){if(this.options.trackUserLocation)if(1===b.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===b.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new m.Event("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=mt("button","mapboxgl-ctrl-geolocate",this._container),mt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===b){m.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=mt("div","mapboxgl-user-location"),this._dotElement.appendChild(mt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(mt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Wn({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=mt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u.originalEvent&&"resize"===u.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new m.Event("trackuserlocationend")))})}}_onDeviceOrientation(b){this._userLocationDotMarker&&(b.webkitCompassHeading?this._heading=b.webkitCompassHeading:!0===b.absolute&&(this._heading=-1*b.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return m.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new m.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new m.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new m.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(b={maximumAge:6e5,timeout:0},this._noTimeout=!0):(b=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,b),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const b=()=>{m.window.addEventListener("ondeviceorientationabsolute"in m.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==m.window.DeviceMotionEvent&&"function"==typeof m.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(u=>{"granted"===u&&b()}).catch(console.error):b()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),m.window.removeEventListener("deviceorientation",this._onDeviceOrientation),m.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:On,ScaleControl:class{constructor(b){this.options=m.extend({},Pg,b),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),m.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const b=this.options.maxWidth||100,u=this._map,g=u._containerHeight/2,C=u._containerWidth/2-b/2,I=u.unproject([C,g]),P=u.unproject([C+b,g]),N=I.distanceTo(P);if("imperial"===this.options.unit){const B=3.2808*N;B>5280?this._setScale(b,B/5280,"mile"):this._setScale(b,B,"foot")}else"nautical"===this.options.unit?this._setScale(b,N/1852,"nautical-mile"):N>=1e3?this._setScale(b,N/1e3,"kilometer"):this._setScale(b,N,"meter")}_setScale(b,u,g){this._map._requestDomTask(()=>{const C=function(P){const N=Math.pow(10,`${Math.floor(P)}`.length-1);let B=P/N;return B=B>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(U){const q=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*q)/q}(B),N*B}(u),I=C/u;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==g?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:g}).format(C):`${C}&nbsp;${Va[g]}`,this._container.style.width=b*I+"px"})}onAdd(b){return this._map=b,this._language=b.getLanguage(),this._container=mt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(b){this._language=b,this._update()}setUnit(b){this.options.unit=b,this._update()}},FullscreenControl:class{constructor(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof m.window.HTMLElement?this._container=b.container:m.warnOnce("Full screen control 'container' must be a DOM element.")),m.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in m.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in m.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=mt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",m.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,m.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!m.window.document.fullscreenEnabled&&!m.window.document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=mt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);mt("span","mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),m.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",b)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(m.window.document.fullscreenElement||m.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?m.window.document.exitFullscreen?m.window.document.exitFullscreen():m.window.document.webkitCancelFullScreen&&m.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends m.Evented{constructor(b){super(),this.options=m.extend(Object.create(Ig),b),m.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(b&&b.className?b.className.trim().split(/\s+/):[])}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&b.on("preclick",this._onClose),this.options.closeOnMove&&b.on("move",this._onClose),b.on("remove",this.remove),this._update(),b._addPopup(this),this._focusFirstElement(),this._trackPointer?(b.on("mousemove",this._onMouseEvent),b.on("mouseup",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")):b.on("move",this._update),this.fire(new m.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const b=this._map;return b&&(b.off("move",this._update),b.off("move",this._onClose),b.off("preclick",this._onClose),b.off("click",this._onClose),b.off("remove",this.remove),b.off("mousemove",this._onMouseEvent),b.off("mouseup",this._onMouseEvent),b.off("drag",this._onMouseEvent),b._canvasContainer&&b._canvasContainer.classList.remove("mapboxgl-track-pointer"),b._removePopup(this),this._map=void 0),this.fire(new m.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(b){this._lngLat=m.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const b=this._map;return b&&(b.off("move",this._update),b.on("mousemove",this._onMouseEvent),b.on("drag",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(m.window.document.createTextNode(b))}setHTML(b){const u=m.window.document.createDocumentFragment(),g=m.window.document.createElement("body");let C;for(g.innerHTML=b;C=g.firstChild,C;)u.appendChild(C);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=mt("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(b),this.options.closeButton){const g=this._closeButton=mt("button","mapboxgl-popup-close-button",u);g.type="button",g.setAttribute("aria-label","Close popup"),g.setAttribute("aria-hidden","true"),g.innerHTML="&#215;",g.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(b){return this._classList.add(b),this._updateClassList(),this}removeClassName(b){return this._classList.delete(b),this._updateClassList(),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){let u;return this._classList.delete(b)?u=!1:(this._classList.add(b),u=!0),this._updateClassList(),u}_onMouseEvent(b){this._update(b.point)}_getAnchor(b){if(this.options.anchor)return this.options.anchor;const u=this._map,g=this._container,C=this._pos;if(!u||!g||!C)return"bottom";const I=g.offsetWidth,P=g.offsetHeight,N=C.x<I/2,B=C.x>u.transform.width-I/2;if(C.y+b<P)return N?"top-left":B?"top-right":"top";if(C.y>u.transform.height-P){if(N)return"bottom-left";if(B)return"bottom-right"}return N?"left":B?"right":"bottom"}_updateClassList(){const b=this._container;if(!b)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),b.className=u.join(" ")}_update(b){const u=this._map,g=this._content;if(!u||!this._lngLat&&!this._trackPointer||!g)return;let C=this._container;if(C||(C=this._container=mt("div","mapboxgl-popup",u.getContainer()),this._tip=mt("div","mapboxgl-popup-tip",C),C.appendChild(g)),this.options.maxWidth&&C.style.maxWidth!==this.options.maxWidth&&(C.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$l(this._lngLat,this._pos,u.transform)),!this._trackPointer||b){const I=this._pos=this._trackPointer&&b?b:u.project(this._lngLat),P=hm(this.options.offset),N=this._anchor=this._getAnchor(P.y),B=hm(this.options.offset,N),U=I.add(B).round();u._requestDomTask(()=>{this._container&&N&&(this._container.style.transform=`${ku[N]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&u._showingGlobe()){const I=m.isLngLatBehindGlobe(u.transform,this._lngLat)?0:1;this._setOpacity(I)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Dg);b&&b.focus()}_onClose(){this.remove()}_setOpacity(b){this._container&&(this._container.style.opacity=`${b}`),this._content&&(this._content.style.pointerEvents=b?"auto":"none")}},Marker:Wn,Style:ko,LngLat:m.LngLat,LngLatBounds:m.LngLatBounds,Point:m.Point,MercatorCoordinate:m.MercatorCoordinate,FreeCameraOptions:_r,Evented:m.Evented,config:m.config,prewarm:function(){Ll().acquire(ta)},clearPrewarmedResources:function(){const b=go;b&&(b.isPreloaded()&&1===b.numActive()?(b.release(ta),go=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return m.config.ACCESS_TOKEN},set accessToken(b){m.config.ACCESS_TOKEN=b},get baseApiUrl(){return m.config.API_URL},set baseApiUrl(b){m.config.API_URL=b},get workerCount(){return wo.workerCount},set workerCount(b){wo.workerCount=b},get maxParallelImageRequests(){return m.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){m.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){m.clearTileCache(b)},workerUrl:"",workerClass:null,setNow:m.exported.setNow,restoreNow:m.exported.restoreNow};return ed}),be}()},4772:un=>{"use strict";var vt=Object.getOwnPropertySymbols,Ve=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;un.exports=function at(){try{if(!Object.assign)return!1;var m=new String("abc");if(m[5]="de","5"===Object.getOwnPropertyNames(m)[0])return!1;for(var xe={},He=0;He<10;He++)xe["_"+String.fromCharCode(He)]=He;if("0123456789"!==Object.getOwnPropertyNames(xe).map(function(mt){return xe[mt]}).join(""))return!1;var tt={};return"abcdefghijklmnopqrst".split("").forEach(function(mt){tt[mt]=mt}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},tt)).join("")}catch{return!1}}()?Object.assign:function(m,xe){for(var He,tt,ct=function Fe(m){if(null==m)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(m)}(m),mt=1;mt<arguments.length;mt++){for(var Xt in He=Object(arguments[mt]))Ve.call(He,Xt)&&(ct[Xt]=He[Xt]);if(vt){tt=vt(He);for(var Mt=0;Mt<tt.length;Mt++)be.call(He,tt[Mt])&&(ct[tt[Mt]]=He[tt[Mt]])}}return ct}},4246:un=>{"use strict";var vt=function(Ve){return Ve!=Ve};un.exports=function(be,Fe){return 0===be&&0===Fe?1/be==1/Fe:!!(be===Fe||vt(be)&&vt(Fe))}},314:(un,vt,Ve)=>{"use strict";var be=Ve(1648),Fe=Ve(5436),at=Ve(4246),m=Ve(1353),xe=Ve(3090),He=Fe(m(),Object);be(He,{getPolyfill:m,implementation:at,shim:xe}),un.exports=He},1353:(un,vt,Ve)=>{"use strict";var be=Ve(4246);un.exports=function(){return"function"==typeof Object.is?Object.is:be}},3090:(un,vt,Ve)=>{"use strict";var be=Ve(1353),Fe=Ve(1648);un.exports=function(){var m=be();return Fe(Object,{is:m},{is:function(){return Object.is!==m}}),m}},7972:(un,vt,Ve)=>{"use strict";var be;if(!Object.keys){var Fe=Object.prototype.hasOwnProperty,at=Object.prototype.toString,m=Ve(9637),xe=Object.prototype.propertyIsEnumerable,He=!xe.call({toString:null},"toString"),ct=xe.call(function(){},"prototype"),tt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],mt=function(Rt){var pn=Rt.constructor;return pn&&pn.prototype===Rt},Xt={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Mt=function(){if(typeof window>"u")return!1;for(var Rt in window)try{if(!Xt["$"+Rt]&&Fe.call(window,Rt)&&null!==window[Rt]&&"object"==typeof window[Rt])try{mt(window[Rt])}catch{return!0}}catch{return!0}return!1}();be=function(pn){var he=null!==pn&&"object"==typeof pn,De="[object Function]"===at.call(pn),ce=m(pn),ge=he&&"[object String]"===at.call(pn),ue=[];if(!he&&!De&&!ce)throw new TypeError("Object.keys called on a non-object");var ze=ct&&De;if(ge&&pn.length>0&&!Fe.call(pn,0))for(var de=0;de<pn.length;++de)ue.push(String(de));if(ce&&pn.length>0)for(var re=0;re<pn.length;++re)ue.push(String(re));else for(var Ae in pn)(!ze||"prototype"!==Ae)&&Fe.call(pn,Ae)&&ue.push(String(Ae));if(He)for(var ne=function(Rt){if(typeof window>"u"||!Mt)return mt(Rt);try{return mt(Rt)}catch{return!1}}(pn),ot=0;ot<tt.length;++ot)(!ne||"constructor"!==tt[ot])&&Fe.call(pn,tt[ot])&&ue.push(tt[ot]);return ue}}un.exports=be},7809:(un,vt,Ve)=>{"use strict";var be=Array.prototype.slice,Fe=Ve(9637),at=Object.keys,m=at?function(ct){return at(ct)}:Ve(7972),xe=Object.keys;m.shim=function(){if(Object.keys){var ct=function(){var tt=Object.keys(arguments);return tt&&tt.length===arguments.length}(1,2);ct||(Object.keys=function(mt){return Fe(mt)?xe(be.call(mt)):xe(mt)})}else Object.keys=m;return Object.keys||m},un.exports=m},9637:un=>{"use strict";var vt=Object.prototype.toString;un.exports=function(be){var Fe=vt.call(be),at="[object Arguments]"===Fe;return at||(at="[object Array]"!==Fe&&null!==be&&"object"==typeof be&&"number"==typeof be.length&&be.length>=0&&"[object Function]"===vt.call(be.callee)),at}},4018:un=>{un.exports=function(Ve,be,Fe,at){var m=Ve[0],xe=Ve[1],He=!1;void 0===Fe&&(Fe=0),void 0===at&&(at=be.length);for(var ct=(at-Fe)/2,tt=0,mt=ct-1;tt<ct;mt=tt++){var Xt=be[Fe+2*tt+0],Mt=be[Fe+2*tt+1],Rt=be[Fe+2*mt+1];Mt>xe!=Rt>xe&&m<(be[Fe+2*mt+0]-Xt)*(xe-Mt)/(Rt-Mt)+Xt&&(He=!He)}return He}},4179:(un,vt,Ve)=>{var be=Ve(4018),Fe=Ve(8875);un.exports=function(m,xe,He,ct){return xe.length>0&&Array.isArray(xe[0])?Fe(m,xe,He,ct):be(m,xe,He,ct)},un.exports.nested=Fe,un.exports.flat=be},8875:un=>{un.exports=function(Ve,be,Fe,at){var m=Ve[0],xe=Ve[1],He=!1;void 0===Fe&&(Fe=0),void 0===at&&(at=be.length);for(var ct=at-Fe,tt=0,mt=ct-1;tt<ct;mt=tt++){var Xt=be[tt+Fe][0],Mt=be[tt+Fe][1],Rt=be[mt+Fe][1];Mt>xe!=Rt>xe&&m<(be[mt+Fe][0]-Xt)*(xe-Mt)/(Rt-Mt)+Xt&&(He=!He)}return He}},8464:function(un){un.exports=function(){"use strict";function vt(_t,we){if(!(_t instanceof we))throw new TypeError("Cannot call a class as a function")}function Ve(_t,we){for(var fe=0;fe<we.length;fe++){var le=we[fe];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(_t,le.key,le)}}function be(_t,we,fe){return we&&Ve(_t.prototype,we),fe&&Ve(_t,fe),_t}var Fe=function _t(we,fe){this.next=null,this.key=we,this.data=fe,this.left=null,this.right=null};function at(_t,we){return _t>we?1:_t<we?-1:0}function m(_t,we,fe){for(var le=new Fe(null,null),$e=le,pt=le;;){var Gt=fe(_t,we.key);if(Gt<0){if(null===we.left)break;if(fe(_t,we.left.key)<0&&(we.left=(fn=we.left).right,fn.right=we,null===(we=fn).left))break;pt.left=we,pt=we,we=we.left}else{if(!(Gt>0))break;if(null===we.right)break;var fn;if(fe(_t,we.right.key)>0&&(we.right=(fn=we.right).left,fn.left=we,null===(we=fn).right))break;$e.right=we,$e=we,we=we.right}}return $e.right=we.left,pt.left=we.right,we.left=le.right,we.right=le.left,we}function xe(_t,we,fe,le){var $e=new Fe(_t,we);if(null===fe)return $e.left=$e.right=null,$e;var pt=le(_t,(fe=m(_t,fe,le)).key);return pt<0?($e.left=fe.left,$e.right=fe,fe.left=null):pt>=0&&($e.right=fe.right,$e.left=fe,fe.right=null),$e}function He(_t,we,fe){var le=null,$e=null;if(we){var pt=fe((we=m(_t,we,fe)).key,_t);0===pt?(le=we.left,$e=we.right):pt<0?($e=we.right,we.right=null,le=we):(le=we.left,we.left=null,$e=we)}return{left:le,right:$e}}function tt(_t,we,fe,le,$e){if(_t){le(we+(fe?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+$e(_t)+"\n");var pt=we+(fe?"    ":"\u2502   ");_t.left&&tt(_t.left,pt,!1,le,$e),_t.right&&tt(_t.right,pt,!0,le,$e)}}var mt=function(){function _t(we){void 0===we&&(we=at),this._root=null,this._size=0,this._comparator=we}return _t.prototype.insert=function(we,fe){return this._size++,this._root=xe(we,fe,this._root,this._comparator)},_t.prototype.add=function(we,fe){var le=new Fe(we,fe);null===this._root&&(le.left=le.right=null,this._size++,this._root=le);var $e=this._comparator,pt=m(we,this._root,$e),Gt=$e(we,pt.key);return 0===Gt?this._root=pt:(Gt<0?(le.left=pt.left,le.right=pt,pt.left=null):Gt>0&&(le.right=pt.right,le.left=pt,pt.right=null),this._size++,this._root=le),this._root},_t.prototype.remove=function(we){this._root=this._remove(we,this._root,this._comparator)},_t.prototype._remove=function(we,fe,le){var $e;return null===fe?null:0===le(we,(fe=m(we,fe,le)).key)?(null===fe.left?$e=fe.right:($e=m(we,fe.left,le)).right=fe.right,this._size--,$e):fe},_t.prototype.pop=function(){var we=this._root;if(we){for(;we.left;)we=we.left;return this._root=m(we.key,this._root,this._comparator),this._root=this._remove(we.key,this._root,this._comparator),{key:we.key,data:we.data}}return null},_t.prototype.findStatic=function(we){for(var fe=this._root,le=this._comparator;fe;){var $e=le(we,fe.key);if(0===$e)return fe;fe=$e<0?fe.left:fe.right}return null},_t.prototype.find=function(we){return this._root&&(this._root=m(we,this._root,this._comparator),0!==this._comparator(we,this._root.key))?null:this._root},_t.prototype.contains=function(we){for(var fe=this._root,le=this._comparator;fe;){var $e=le(we,fe.key);if(0===$e)return!0;fe=$e<0?fe.left:fe.right}return!1},_t.prototype.forEach=function(we,fe){for(var le=this._root,$e=[],pt=!1;!pt;)null!==le?($e.push(le),le=le.left):0!==$e.length?(le=$e.pop(),we.call(fe,le),le=le.right):pt=!0;return this},_t.prototype.range=function(we,fe,le,$e){for(var pt=[],Gt=this._comparator,fn=this._root;0!==pt.length||fn;)if(fn)pt.push(fn),fn=fn.left;else{if(Gt((fn=pt.pop()).key,fe)>0)break;if(Gt(fn.key,we)>=0&&le.call($e,fn))return this;fn=fn.right}return this},_t.prototype.keys=function(){var we=[];return this.forEach(function(fe){return we.push(fe.key)}),we},_t.prototype.values=function(){var we=[];return this.forEach(function(fe){return we.push(fe.data)}),we},_t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},_t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},_t.prototype.minNode=function(we){if(void 0===we&&(we=this._root),we)for(;we.left;)we=we.left;return we},_t.prototype.maxNode=function(we){if(void 0===we&&(we=this._root),we)for(;we.right;)we=we.right;return we},_t.prototype.at=function(we){for(var fe=this._root,le=!1,$e=0,pt=[];!le;)if(fe)pt.push(fe),fe=fe.left;else if(pt.length>0){if(fe=pt.pop(),$e===we)return fe;$e++,fe=fe.right}else le=!0;return null},_t.prototype.next=function(we){var fe=this._root,le=null;if(we.right){for(le=we.right;le.left;)le=le.left;return le}for(var $e=this._comparator;fe;){var pt=$e(we.key,fe.key);if(0===pt)break;pt<0?(le=fe,fe=fe.left):fe=fe.right}return le},_t.prototype.prev=function(we){var fe=this._root,le=null;if(null!==we.left){for(le=we.left;le.right;)le=le.right;return le}for(var $e=this._comparator;fe;){var pt=$e(we.key,fe.key);if(0===pt)break;pt<0?fe=fe.left:(le=fe,fe=fe.right)}return le},_t.prototype.clear=function(){return this._root=null,this._size=0,this},_t.prototype.toList=function(){return function yt(_t){for(var we=_t,fe=[],le=!1,$e=new Fe(null,null),pt=$e;!le;)we?(fe.push(we),we=we.left):fe.length>0?we=(we=pt=pt.next=fe.pop()).right:le=!0;return pt.next=null,$e.next}(this._root)},_t.prototype.load=function(we,fe,le){void 0===fe&&(fe=[]),void 0===le&&(le=!1);var $e=we.length,pt=this._comparator;if(le&&he(we,fe,0,$e-1,pt),null===this._root)this._root=Xt(we,fe,0,$e),this._size=$e;else{var Gt=function pn(_t,we,fe){for(var le=new Fe(null,null),$e=le,pt=_t,Gt=we;null!==pt&&null!==Gt;)fe(pt.key,Gt.key)<0?($e.next=pt,pt=pt.next):($e.next=Gt,Gt=Gt.next),$e=$e.next;return null!==pt?$e.next=pt:null!==Gt&&($e.next=Gt),le.next}(this.toList(),function Mt(_t,we){for(var fe=new Fe(null,null),le=fe,$e=0;$e<_t.length;$e++)le=le.next=new Fe(_t[$e],we[$e]);return le.next=null,fe.next}(we,fe),pt);this._root=Rt({head:Gt},0,$e=this._size+$e)}return this},_t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(_t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(_t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),_t.prototype.toString=function(we){void 0===we&&(we=function($e){return String($e.key)});var fe=[];return tt(this._root,"",!0,function(le){return fe.push(le)},we),fe.join("")},_t.prototype.update=function(we,fe,le){var $e=this._comparator,pt=He(we,this._root,$e),Gt=pt.left,fn=pt.right;$e(we,fe)<0?fn=xe(fe,le,fn,$e):Gt=xe(fe,le,Gt,$e),this._root=function ct(_t,we,fe){return null===we?_t:(null===_t||((we=m(_t.key,we,fe)).left=_t),we)}(Gt,fn,$e)},_t.prototype.split=function(we){return He(we,this._root,this._comparator)},_t}();function Xt(_t,we,fe,le){var $e=le-fe;if($e>0){var pt=fe+Math.floor($e/2),cn=new Fe(_t[pt],we[pt]);return cn.left=Xt(_t,we,fe,pt),cn.right=Xt(_t,we,pt+1,le),cn}return null}function Rt(_t,we,fe){var le=fe-we;if(le>0){var $e=we+Math.floor(le/2),pt=Rt(_t,we,$e),Gt=_t.head;return Gt.left=pt,_t.head=_t.head.next,Gt.right=Rt(_t,$e+1,fe),Gt}return null}function he(_t,we,fe,le,$e){if(!(fe>=le)){for(var pt=_t[fe+le>>1],Gt=fe-1,fn=le+1;;){do{Gt++}while($e(_t[Gt],pt)<0);do{fn--}while($e(_t[fn],pt)>0);if(Gt>=fn)break;var cn=_t[Gt];_t[Gt]=_t[fn],_t[fn]=cn,cn=we[Gt],we[Gt]=we[fn],we[fn]=cn}he(_t,we,fe,fn,$e),he(_t,we,fn+1,le,$e)}}var De=function(we,fe){return we.ll.x<=fe.x&&fe.x<=we.ur.x&&we.ll.y<=fe.y&&fe.y<=we.ur.y},ce=function(we,fe){return fe.ur.x<we.ll.x||we.ur.x<fe.ll.x||fe.ur.y<we.ll.y||we.ur.y<fe.ll.y?null:{ll:{x:we.ll.x<fe.ll.x?fe.ll.x:we.ll.x,y:we.ll.y<fe.ll.y?fe.ll.y:we.ll.y},ur:{x:we.ur.x<fe.ur.x?we.ur.x:fe.ur.x,y:we.ur.y<fe.ur.y?we.ur.y:fe.ur.y}}},ge=Number.EPSILON;void 0===ge&&(ge=Math.pow(2,-52));var ue=ge*ge,ze=function(we,fe){if(-ge<we&&we<ge&&-ge<fe&&fe<ge)return 0;var le=we-fe;return le*le<ue*we*fe?0:we<fe?-1:1},de=function(){function _t(){vt(this,_t),this.reset()}return be(_t,[{key:"reset",value:function(){this.xRounder=new re,this.yRounder=new re}},{key:"round",value:function(fe,le){return{x:this.xRounder.round(fe),y:this.yRounder.round(le)}}}]),_t}(),re=function(){function _t(){vt(this,_t),this.tree=new mt,this.round(0)}return be(_t,[{key:"round",value:function(fe){var le=this.tree.add(fe),$e=this.tree.prev(le);if(null!==$e&&0===ze(le.key,$e.key))return this.tree.remove(fe),$e.key;var pt=this.tree.next(le);return null!==pt&&0===ze(le.key,pt.key)?(this.tree.remove(fe),pt.key):fe}}]),_t}(),Ae=new de,ne=function(we,fe){return we.x*fe.y-we.y*fe.x},ot=function(we,fe){return we.x*fe.x+we.y*fe.y},Ue=function(we,fe,le){var Gt=ne({x:fe.x-we.x,y:fe.y-we.y},{x:le.x-we.x,y:le.y-we.y});return ze(Gt,0)},Ke=function(we){return Math.sqrt(ot(we,we))},Me=function(we,fe,le){var $e={x:fe.x-we.x,y:fe.y-we.y},pt={x:le.x-we.x,y:le.y-we.y};return ne(pt,$e)/Ke(pt)/Ke($e)},on=function(we,fe,le){var $e={x:fe.x-we.x,y:fe.y-we.y},pt={x:le.x-we.x,y:le.y-we.y};return ot(pt,$e)/Ke(pt)/Ke($e)},Lt=function(we,fe,le){return 0===fe.y?null:{x:we.x+fe.x/fe.y*(le-we.y),y:le}},Ee=function(we,fe,le){return 0===fe.x?null:{x:le,y:we.y+fe.y/fe.x*(le-we.x)}},Re=function(){function _t(we,fe){vt(this,_t),void 0===we.events?we.events=[this]:we.events.push(this),this.point=we,this.isLeft=fe}return be(_t,null,[{key:"compare",value:function(fe,le){var $e=_t.comparePoints(fe.point,le.point);return 0!==$e?$e:(fe.point!==le.point&&fe.link(le),fe.isLeft!==le.isLeft?fe.isLeft?1:-1:gt.compare(fe.segment,le.segment))}},{key:"comparePoints",value:function(fe,le){return fe.x<le.x?-1:fe.x>le.x?1:fe.y<le.y?-1:fe.y>le.y?1:0}}]),be(_t,[{key:"link",value:function(fe){if(fe.point===this.point)throw new Error("Tried to link already linked events");for(var le=fe.point.events,$e=0,pt=le.length;$e<pt;$e++){var Gt=le[$e];this.point.events.push(Gt),Gt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var fe=this.point.events.length,le=0;le<fe;le++){var $e=this.point.events[le];if(void 0===$e.segment.consumedBy)for(var pt=le+1;pt<fe;pt++){var Gt=this.point.events[pt];void 0===Gt.consumedBy&&$e.otherSE.point.events===Gt.otherSE.point.events&&$e.segment.consume(Gt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var fe=[],le=0,$e=this.point.events.length;le<$e;le++){var pt=this.point.events[le];pt!==this&&!pt.segment.ringOut&&pt.segment.isInResult()&&fe.push(pt)}return fe}},{key:"getLeftmostComparator",value:function(fe){var le=this,$e=new Map,pt=function(fn){var cn=fn.otherSE;$e.set(fn,{sine:Me(le.point,fe.point,cn.point),cosine:on(le.point,fe.point,cn.point)})};return function(Gt,fn){$e.has(Gt)||pt(Gt),$e.has(fn)||pt(fn);var cn=$e.get(Gt),Wt=cn.sine,Mi=cn.cosine,Ni=$e.get(fn),Nn=Ni.sine,Ci=Ni.cosine;return Wt>=0&&Nn>=0?Mi<Ci?1:Mi>Ci?-1:0:Wt<0&&Nn<0?Mi<Ci?-1:Mi>Ci?1:0:Nn<Wt?-1:Nn>Wt?1:0}}}]),_t}(),it=0,gt=function(){function _t(we,fe,le,$e){vt(this,_t),this.id=++it,this.leftSE=we,we.segment=this,we.otherSE=fe,this.rightSE=fe,fe.segment=this,fe.otherSE=we,this.rings=le,this.windings=$e}return be(_t,null,[{key:"compare",value:function(fe,le){var $e=fe.leftSE.point.x,pt=le.leftSE.point.x,Gt=fe.rightSE.point.x,fn=le.rightSE.point.x;if(fn<$e)return 1;if(Gt<pt)return-1;var cn=fe.leftSE.point.y,Wt=le.leftSE.point.y,Mi=fe.rightSE.point.y,Ni=le.rightSE.point.y;if($e<pt){if(Wt<cn&&Wt<Mi)return 1;if(Wt>cn&&Wt>Mi)return-1;var Nn=fe.comparePoint(le.leftSE.point);if(Nn<0)return 1;if(Nn>0)return-1;var Ci=le.comparePoint(fe.rightSE.point);return 0!==Ci?Ci:-1}if($e>pt){if(cn<Wt&&cn<Ni)return-1;if(cn>Wt&&cn>Ni)return 1;var Nr=le.comparePoint(fe.leftSE.point);if(0!==Nr)return Nr;var nr=fe.comparePoint(le.rightSE.point);return nr<0?1:nr>0?-1:1}if(cn<Wt)return-1;if(cn>Wt)return 1;if(Gt<fn){var cr=le.comparePoint(fe.rightSE.point);if(0!==cr)return cr}if(Gt>fn){var po=fe.comparePoint(le.rightSE.point);if(po<0)return 1;if(po>0)return-1}if(Gt!==fn){var Xo=Mi-cn,$s=Gt-$e,qe=Ni-Wt,oe=fn-pt;if(Xo>$s&&qe<oe)return 1;if(Xo<$s&&qe>oe)return-1}return Gt>fn?1:Gt<fn||Mi<Ni?-1:Mi>Ni?1:fe.id<le.id?-1:fe.id>le.id?1:0}}]),be(_t,[{key:"replaceRightSE",value:function(fe){this.rightSE=fe,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var fe=this.leftSE.point.y,le=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:fe<le?fe:le},ur:{x:this.rightSE.point.x,y:fe>le?fe:le}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(fe){return fe.x===this.leftSE.point.x&&fe.y===this.leftSE.point.y||fe.x===this.rightSE.point.x&&fe.y===this.rightSE.point.y}},{key:"comparePoint",value:function(fe){if(this.isAnEndpoint(fe))return 0;var le=this.leftSE.point,$e=this.rightSE.point,pt=this.vector();if(le.x===$e.x)return fe.x===le.x?0:fe.x<le.x?1:-1;if(fe.x===le.x+(fe.y-le.y)/pt.y*pt.x)return 0;var Wt=le.y+(fe.x-le.x)/pt.x*pt.y;return fe.y===Wt?0:fe.y<Wt?-1:1}},{key:"getIntersection",value:function(fe){var le=this.bbox(),$e=fe.bbox(),pt=ce(le,$e);if(null===pt)return null;var Gt=this.leftSE.point,fn=this.rightSE.point,cn=fe.leftSE.point,Wt=fe.rightSE.point,Mi=De(le,cn)&&0===this.comparePoint(cn),Ni=De($e,Gt)&&0===fe.comparePoint(Gt),Nn=De(le,Wt)&&0===this.comparePoint(Wt),Ci=De($e,fn)&&0===fe.comparePoint(fn);if(Ni&&Mi)return Ci&&!Nn?fn:!Ci&&Nn?Wt:null;if(Ni)return Nn&&Gt.x===Wt.x&&Gt.y===Wt.y?null:Gt;if(Mi)return Ci&&fn.x===cn.x&&fn.y===cn.y?null:cn;if(Ci&&Nn)return null;if(Ci)return fn;if(Nn)return Wt;var Nr=function(we,fe,le,$e){if(0===fe.x)return Ee(le,$e,we.x);if(0===$e.x)return Ee(we,fe,le.x);if(0===fe.y)return Lt(le,$e,we.y);if(0===$e.y)return Lt(we,fe,le.y);var pt=ne(fe,$e);if(0==pt)return null;var Gt={x:le.x-we.x,y:le.y-we.y},fn=ne(Gt,fe)/pt,cn=ne(Gt,$e)/pt;return{x:(we.x+cn*fe.x+(le.x+fn*$e.x))/2,y:(we.y+cn*fe.y+(le.y+fn*$e.y))/2}}(Gt,this.vector(),cn,fe.vector());return null!==Nr&&De(pt,Nr)?Ae.round(Nr.x,Nr.y):null}},{key:"split",value:function(fe){var le=[],$e=void 0!==fe.events,pt=new Re(fe,!0),Gt=new Re(fe,!1),fn=this.rightSE;this.replaceRightSE(Gt),le.push(Gt),le.push(pt);var cn=new _t(pt,fn,this.rings.slice(),this.windings.slice());return Re.comparePoints(cn.leftSE.point,cn.rightSE.point)>0&&cn.swapEvents(),Re.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),$e&&(pt.checkForConsuming(),Gt.checkForConsuming()),le}},{key:"swapEvents",value:function(){var fe=this.rightSE;this.rightSE=this.leftSE,this.leftSE=fe,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var le=0,$e=this.windings.length;le<$e;le++)this.windings[le]*=-1}},{key:"consume",value:function(fe){for(var le=this,$e=fe;le.consumedBy;)le=le.consumedBy;for(;$e.consumedBy;)$e=$e.consumedBy;var pt=_t.compare(le,$e);if(0!==pt){if(pt>0){var Gt=le;le=$e,$e=Gt}if(le.prev===$e){var fn=le;le=$e,$e=fn}for(var cn=0,Wt=$e.rings.length;cn<Wt;cn++){var Mi=$e.rings[cn],Ni=$e.windings[cn],Nn=le.rings.indexOf(Mi);-1===Nn?(le.rings.push(Mi),le.windings.push(Ni)):le.windings[Nn]+=Ni}$e.rings=null,$e.windings=null,$e.consumedBy=le,$e.leftSE.consumedBy=le.leftSE,$e.rightSE.consumedBy=le.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var fe=this.beforeState();this._afterState={rings:fe.rings.slice(0),windings:fe.windings.slice(0),multiPolys:[]};for(var le=this._afterState.rings,$e=this._afterState.windings,pt=this._afterState.multiPolys,Gt=0,fn=this.rings.length;Gt<fn;Gt++){var cn=this.rings[Gt],Wt=this.windings[Gt],Mi=le.indexOf(cn);-1===Mi?(le.push(cn),$e.push(Wt)):$e[Mi]+=Wt}for(var Ni=[],Nn=[],Ci=0,Nr=le.length;Ci<Nr;Ci++)if(0!==$e[Ci]){var nr=le[Ci],cr=nr.poly;if(-1===Nn.indexOf(cr))if(nr.isExterior)Ni.push(cr);else{-1===Nn.indexOf(cr)&&Nn.push(cr);var po=Ni.indexOf(nr.poly);-1!==po&&Ni.splice(po,1)}}for(var Xo=0,$s=Ni.length;Xo<$s;Xo++){var qe=Ni[Xo].multiPoly;-1===pt.indexOf(qe)&&pt.push(qe)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var fe=this.beforeState().multiPolys,le=this.afterState().multiPolys;switch(mn.type){case"union":this._isInResult=0===fe.length!=(0===le.length);break;case"intersection":var Gt,fn;fe.length<le.length?(Gt=fe.length,fn=le.length):(Gt=le.length,fn=fe.length),this._isInResult=fn===mn.numMultiPolys&&Gt<fn;break;case"xor":var cn=Math.abs(fe.length-le.length);this._isInResult=cn%2==1;break;case"difference":var Wt=function(Ni){return 1===Ni.length&&Ni[0].isSubject};this._isInResult=Wt(fe)!==Wt(le);break;default:throw new Error("Unrecognized operation type found ".concat(mn.type))}return this._isInResult}}],[{key:"fromRing",value:function(fe,le,$e){var pt,Gt,fn,cn=Re.comparePoints(fe,le);if(cn<0)pt=fe,Gt=le,fn=1;else{if(!(cn>0))throw new Error("Tried to create degenerate segment at [".concat(fe.x,", ").concat(fe.y,"]"));pt=le,Gt=fe,fn=-1}return new _t(new Re(pt,!0),new Re(Gt,!1),[$e],[fn])}}]),_t}(),Ie=function(){function _t(we,fe,le){if(vt(this,_t),!Array.isArray(we)||0===we.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=fe,this.isExterior=le,this.segments=[],"number"!=typeof we[0][0]||"number"!=typeof we[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var $e=Ae.round(we[0][0],we[0][1]);this.bbox={ll:{x:$e.x,y:$e.y},ur:{x:$e.x,y:$e.y}};for(var pt=$e,Gt=1,fn=we.length;Gt<fn;Gt++){if("number"!=typeof we[Gt][0]||"number"!=typeof we[Gt][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var cn=Ae.round(we[Gt][0],we[Gt][1]);cn.x===pt.x&&cn.y===pt.y||(this.segments.push(gt.fromRing(pt,cn,this)),cn.x<this.bbox.ll.x&&(this.bbox.ll.x=cn.x),cn.y<this.bbox.ll.y&&(this.bbox.ll.y=cn.y),cn.x>this.bbox.ur.x&&(this.bbox.ur.x=cn.x),cn.y>this.bbox.ur.y&&(this.bbox.ur.y=cn.y),pt=cn)}($e.x!==pt.x||$e.y!==pt.y)&&this.segments.push(gt.fromRing(pt,$e,this))}return be(_t,[{key:"getSweepEvents",value:function(){for(var fe=[],le=0,$e=this.segments.length;le<$e;le++){var pt=this.segments[le];fe.push(pt.leftSE),fe.push(pt.rightSE)}return fe}}]),_t}(),qt=function(){function _t(we,fe){if(vt(this,_t),!Array.isArray(we))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ie(we[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var le=1,$e=we.length;le<$e;le++){var pt=new Ie(we[le],this,!1);pt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=pt.bbox.ll.x),pt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=pt.bbox.ll.y),pt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=pt.bbox.ur.x),pt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=pt.bbox.ur.y),this.interiorRings.push(pt)}this.multiPoly=fe}return be(_t,[{key:"getSweepEvents",value:function(){for(var fe=this.exteriorRing.getSweepEvents(),le=0,$e=this.interiorRings.length;le<$e;le++)for(var pt=this.interiorRings[le].getSweepEvents(),Gt=0,fn=pt.length;Gt<fn;Gt++)fe.push(pt[Gt]);return fe}}]),_t}(),Ct=function(){function _t(we,fe){if(vt(this,_t),!Array.isArray(we))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof we[0][0][0]&&(we=[we])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var le=0,$e=we.length;le<$e;le++){var pt=new qt(we[le],this);pt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=pt.bbox.ll.x),pt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=pt.bbox.ll.y),pt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=pt.bbox.ur.x),pt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=pt.bbox.ur.y),this.polys.push(pt)}this.isSubject=fe}return be(_t,[{key:"getSweepEvents",value:function(){for(var fe=[],le=0,$e=this.polys.length;le<$e;le++)for(var pt=this.polys[le].getSweepEvents(),Gt=0,fn=pt.length;Gt<fn;Gt++)fe.push(pt[Gt]);return fe}}]),_t}(),Cn=function(){function _t(we){vt(this,_t),this.events=we;for(var fe=0,le=we.length;fe<le;fe++)we[fe].segment.ringOut=this;this.poly=null}return be(_t,null,[{key:"factory",value:function(fe){for(var le=[],$e=0,pt=fe.length;$e<pt;$e++){var Gt=fe[$e];if(Gt.isInResult()&&!Gt.ringOut){for(var fn=null,cn=Gt.leftSE,Wt=Gt.rightSE,Mi=[cn],Ni=cn.point,Nn=[];fn=cn,Mi.push(cn=Wt),cn.point!==Ni;)for(;;){var Ci=cn.getAvailableLinkedEvents();if(0===Ci.length){var Nr=Mi[0].point,nr=Mi[Mi.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Nr.x,",")+" ".concat(Nr.y,"]. Last matching segment found ends at")+" [".concat(nr.x,", ").concat(nr.y,"]."))}if(1===Ci.length){Wt=Ci[0].otherSE;break}for(var cr=null,po=0,Xo=Nn.length;po<Xo;po++)if(Nn[po].point===cn.point){cr=po;break}if(null===cr){Nn.push({index:Mi.length,point:cn.point});var oe=cn.getLeftmostComparator(fn);Wt=Ci.sort(oe)[0].otherSE;break}var $s=Nn.splice(cr)[0],qe=Mi.splice($s.index);qe.unshift(qe[0].otherSE),le.push(new _t(qe.reverse()))}le.push(new _t(Mi))}}return le}}]),be(_t,[{key:"getGeom",value:function(){for(var fe=this.events[0].point,le=[fe],$e=1,pt=this.events.length-1;$e<pt;$e++){var Gt=this.events[$e].point;0!==Ue(Gt,fe,this.events[$e+1].point)&&(le.push(Gt),fe=Gt)}if(1===le.length)return null;0===Ue(le[0],fe,le[1])&&le.shift(),le.push(le[0]);for(var Mi=this.isExteriorRing()?1:-1,Ni=this.isExteriorRing()?0:le.length-1,Nn=this.isExteriorRing()?le.length:-1,Ci=[],Nr=Ni;Nr!=Nn;Nr+=Mi)Ci.push([le[Nr].x,le[Nr].y]);return Ci}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var fe=this.enclosingRing();this._isExteriorRing=!fe||!fe.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var fe=this.events[0],le=1,$e=this.events.length;le<$e;le++){var pt=this.events[le];Re.compare(fe,pt)>0&&(fe=pt)}for(var Gt=fe.segment.prevInResult(),fn=Gt?Gt.prevInResult():null;;){if(!Gt)return null;if(!fn)return Gt.ringOut;if(fn.ringOut!==Gt.ringOut)return fn.ringOut.enclosingRing()!==Gt.ringOut?Gt.ringOut:Gt.ringOut.enclosingRing();Gt=fn.prevInResult(),fn=Gt?Gt.prevInResult():null}}}]),_t}(),Ut=function(){function _t(we){vt(this,_t),this.exteriorRing=we,we.poly=this,this.interiorRings=[]}return be(_t,[{key:"addInterior",value:function(fe){this.interiorRings.push(fe),fe.poly=this}},{key:"getGeom",value:function(){var fe=[this.exteriorRing.getGeom()];if(null===fe[0])return null;for(var le=0,$e=this.interiorRings.length;le<$e;le++){var pt=this.interiorRings[le].getGeom();null!==pt&&fe.push(pt)}return fe}}]),_t}(),Bn=function(){function _t(we){vt(this,_t),this.rings=we,this.polys=this._composePolys(we)}return be(_t,[{key:"getGeom",value:function(){for(var fe=[],le=0,$e=this.polys.length;le<$e;le++){var pt=this.polys[le].getGeom();null!==pt&&fe.push(pt)}return fe}},{key:"_composePolys",value:function(fe){for(var le=[],$e=0,pt=fe.length;$e<pt;$e++){var Gt=fe[$e];if(!Gt.poly)if(Gt.isExteriorRing())le.push(new Ut(Gt));else{var fn=Gt.enclosingRing();fn.poly||le.push(new Ut(fn)),fn.poly.addInterior(Gt)}}return le}}]),_t}(),zn=function(){function _t(we){var fe=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt.compare;vt(this,_t),this.queue=we,this.tree=new mt(fe),this.segments=[]}return be(_t,[{key:"process",value:function(fe){var le=fe.segment,$e=[];if(fe.consumedBy)return fe.isLeft?this.queue.remove(fe.otherSE):this.tree.remove(le),$e;var pt=fe.isLeft?this.tree.insert(le):this.tree.find(le);if(!pt)throw new Error("Unable to find segment #".concat(le.id," ")+"[".concat(le.leftSE.point.x,", ").concat(le.leftSE.point.y,"] -> ")+"[".concat(le.rightSE.point.x,", ").concat(le.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Gt=pt,fn=pt,cn=void 0,Wt=void 0;void 0===cn;)null===(Gt=this.tree.prev(Gt))?cn=null:void 0===Gt.key.consumedBy&&(cn=Gt.key);for(;void 0===Wt;)null===(fn=this.tree.next(fn))?Wt=null:void 0===fn.key.consumedBy&&(Wt=fn.key);if(fe.isLeft){var Mi=null;if(cn){var Ni=cn.getIntersection(le);if(null!==Ni&&(le.isAnEndpoint(Ni)||(Mi=Ni),!cn.isAnEndpoint(Ni)))for(var Nn=this._splitSafely(cn,Ni),Ci=0,Nr=Nn.length;Ci<Nr;Ci++)$e.push(Nn[Ci])}var nr=null;if(Wt){var cr=Wt.getIntersection(le);if(null!==cr&&(le.isAnEndpoint(cr)||(nr=cr),!Wt.isAnEndpoint(cr)))for(var po=this._splitSafely(Wt,cr),Xo=0,$s=po.length;Xo<$s;Xo++)$e.push(po[Xo])}if(null!==Mi||null!==nr){var qe;qe=null===Mi?nr:null===nr||Re.comparePoints(Mi,nr)<=0?Mi:nr,this.queue.remove(le.rightSE),$e.push(le.rightSE);for(var se=le.split(qe),je=0,et=se.length;je<et;je++)$e.push(se[je])}$e.length>0?(this.tree.remove(le),$e.push(fe)):(this.segments.push(le),le.prev=cn)}else{if(cn&&Wt){var ke=cn.getIntersection(Wt);if(null!==ke){if(!cn.isAnEndpoint(ke))for(var Tt=this._splitSafely(cn,ke),It=0,Ye=Tt.length;It<Ye;It++)$e.push(Tt[It]);if(!Wt.isAnEndpoint(ke))for(var Nt=this._splitSafely(Wt,ke),_n=0,Dn=Nt.length;_n<Dn;_n++)$e.push(Nt[_n])}}this.tree.remove(le)}return $e}},{key:"_splitSafely",value:function(fe,le){this.tree.remove(fe);var $e=fe.rightSE;this.queue.remove($e);var pt=fe.split(le);return pt.push($e),void 0===fe.consumedBy&&this.tree.insert(fe),pt}}]),_t}(),Jn=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Kt=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,mn=new(function(){function _t(){vt(this,_t)}return be(_t,[{key:"run",value:function(fe,le,$e){mn.type=fe,Ae.reset();for(var pt=[new Ct(le,!0)],Gt=0,fn=$e.length;Gt<fn;Gt++)pt.push(new Ct($e[Gt],!1));if(mn.numMultiPolys=pt.length,"difference"===mn.type)for(var cn=pt[0],Wt=1;Wt<pt.length;)null!==ce(pt[Wt].bbox,cn.bbox)?Wt++:pt.splice(Wt,1);if("intersection"===mn.type)for(var Mi=0,Ni=pt.length;Mi<Ni;Mi++)for(var Nn=pt[Mi],Ci=Mi+1,Nr=pt.length;Ci<Nr;Ci++)if(null===ce(Nn.bbox,pt[Ci].bbox))return[];for(var nr=new mt(Re.compare),cr=0,po=pt.length;cr<po;cr++)for(var Xo=pt[cr].getSweepEvents(),$s=0,qe=Xo.length;$s<qe;$s++)if(nr.insert(Xo[$s]),nr.size>Jn)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var oe=new zn(nr),se=nr.size,je=nr.pop();je;){var et=je.key;if(nr.size===se){var ke=et.segment;throw new Error("Unable to pop() ".concat(et.isLeft?"left":"right"," SweepEvent ")+"[".concat(et.point.x,", ").concat(et.point.y,"] from segment #").concat(ke.id," ")+"[".concat(ke.leftSE.point.x,", ").concat(ke.leftSE.point.y,"] -> ")+"[".concat(ke.rightSE.point.x,", ").concat(ke.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(nr.size>Jn)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(oe.segments.length>Kt)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Tt=oe.process(et),It=0,Ye=Tt.length;It<Ye;It++){var Nt=Tt[It];void 0===Nt.consumedBy&&nr.insert(Nt)}se=nr.size,je=nr.pop()}Ae.reset();var _n=Cn.factory(oe.segments);return new Bn(_n).getGeom()}}]),_t}());return{union:function(we){for(var fe=arguments.length,le=new Array(fe>1?fe-1:0),$e=1;$e<fe;$e++)le[$e-1]=arguments[$e];return mn.run("union",we,le)},intersection:function(we){for(var fe=arguments.length,le=new Array(fe>1?fe-1:0),$e=1;$e<fe;$e++)le[$e-1]=arguments[$e];return mn.run("intersection",we,le)},xor:function(we){for(var fe=arguments.length,le=new Array(fe>1?fe-1:0),$e=1;$e<fe;$e++)le[$e-1]=arguments[$e];return mn.run("xor",we,le)},difference:function(we){for(var fe=arguments.length,le=new Array(fe>1?fe-1:0),$e=1;$e<fe;$e++)le[$e-1]=arguments[$e];return mn.run("difference",we,le)}}}()},7861:(un,vt,Ve)=>{"use strict";un.exports=Fe,un.exports.default=Fe;var be=Ve(2136);function Fe(ce,ge){if(!(this instanceof Fe))return new Fe(ce,ge);this._maxEntries=Math.max(4,ce||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),ge&&this._initFormat(ge),this.clear()}function at(ce,ge,ue){if(!ue)return ge.indexOf(ce);for(var ze=0;ze<ge.length;ze++)if(ue(ce,ge[ze]))return ze;return-1}function m(ce,ge){xe(ce,0,ce.children.length,ge,ce)}function xe(ce,ge,ue,ze,de){de||(de=he(null)),de.minX=1/0,de.minY=1/0,de.maxX=-1/0,de.maxY=-1/0;for(var Ae,re=ge;re<ue;re++)Ae=ce.children[re],He(de,ce.leaf?ze(Ae):Ae);return de}function He(ce,ge){return ce.minX=Math.min(ce.minX,ge.minX),ce.minY=Math.min(ce.minY,ge.minY),ce.maxX=Math.max(ce.maxX,ge.maxX),ce.maxY=Math.max(ce.maxY,ge.maxY),ce}function ct(ce,ge){return ce.minX-ge.minX}function tt(ce,ge){return ce.minY-ge.minY}function mt(ce){return(ce.maxX-ce.minX)*(ce.maxY-ce.minY)}function Xt(ce){return ce.maxX-ce.minX+(ce.maxY-ce.minY)}function Mt(ce,ge){return(Math.max(ge.maxX,ce.maxX)-Math.min(ge.minX,ce.minX))*(Math.max(ge.maxY,ce.maxY)-Math.min(ge.minY,ce.minY))}function yt(ce,ge){var ue=Math.max(ce.minX,ge.minX),ze=Math.max(ce.minY,ge.minY),de=Math.min(ce.maxX,ge.maxX),re=Math.min(ce.maxY,ge.maxY);return Math.max(0,de-ue)*Math.max(0,re-ze)}function Rt(ce,ge){return ce.minX<=ge.minX&&ce.minY<=ge.minY&&ge.maxX<=ce.maxX&&ge.maxY<=ce.maxY}function pn(ce,ge){return ge.minX<=ce.maxX&&ge.minY<=ce.maxY&&ge.maxX>=ce.minX&&ge.maxY>=ce.minY}function he(ce){return{children:ce,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function De(ce,ge,ue,ze,de){for(var Ae,re=[ge,ue];re.length;)!((ue=re.pop())-(ge=re.pop())<=ze)&&(Ae=ge+Math.ceil((ue-ge)/ze/2)*ze,be(ce,Ae,ge,ue,de),re.push(ge,Ae,Ae,ue))}Fe.prototype={all:function(){return this._all(this.data,[])},search:function(ce){var ge=this.data,ue=[],ze=this.toBBox;if(!pn(ce,ge))return ue;for(var re,Ae,ne,ot,de=[];ge;){for(re=0,Ae=ge.children.length;re<Ae;re++)ne=ge.children[re],pn(ce,ot=ge.leaf?ze(ne):ne)&&(ge.leaf?ue.push(ne):Rt(ce,ot)?this._all(ne,ue):de.push(ne));ge=de.pop()}return ue},collides:function(ce){var ge=this.data,ue=this.toBBox;if(!pn(ce,ge))return!1;for(var de,re,Ae,ne,ze=[];ge;){for(de=0,re=ge.children.length;de<re;de++)if(Ae=ge.children[de],pn(ce,ne=ge.leaf?ue(Ae):Ae)){if(ge.leaf||Rt(ce,ne))return!0;ze.push(Ae)}ge=ze.pop()}return!1},load:function(ce){if(!ce||!ce.length)return this;if(ce.length<this._minEntries){for(var ge=0,ue=ce.length;ge<ue;ge++)this.insert(ce[ge]);return this}var ze=this._build(ce.slice(),0,ce.length-1,0);if(this.data.children.length)if(this.data.height===ze.height)this._splitRoot(this.data,ze);else{if(this.data.height<ze.height){var de=this.data;this.data=ze,ze=de}this._insert(ze,this.data.height-ze.height-1,!0)}else this.data=ze;return this},insert:function(ce){return ce&&this._insert(ce,this.data.height-1),this},clear:function(){return this.data=he([]),this},remove:function(ce,ge){if(!ce)return this;for(var Ae,ne,ot,Ue,ue=this.data,ze=this.toBBox(ce),de=[],re=[];ue||de.length;){if(ue||(ue=de.pop(),ne=de[de.length-1],Ae=re.pop(),Ue=!0),ue.leaf&&-1!==(ot=at(ce,ue.children,ge)))return ue.children.splice(ot,1),de.push(ue),this._condense(de),this;Ue||ue.leaf||!Rt(ue,ze)?ne?(Ae++,ue=ne.children[Ae],Ue=!1):ue=null:(de.push(ue),re.push(Ae),Ae=0,ne=ue,ue=ue.children[0])}return this},toBBox:function(ce){return ce},compareMinX:ct,compareMinY:tt,toJSON:function(){return this.data},fromJSON:function(ce){return this.data=ce,this},_all:function(ce,ge){for(var ue=[];ce;)ce.leaf?ge.push.apply(ge,ce.children):ue.push.apply(ue,ce.children),ce=ue.pop();return ge},_build:function(ce,ge,ue,ze){var Ae,de=ue-ge+1,re=this._maxEntries;if(de<=re)return m(Ae=he(ce.slice(ge,ue+1)),this.toBBox),Ae;ze||(ze=Math.ceil(Math.log(de)/Math.log(re)),re=Math.ceil(de/Math.pow(re,ze-1))),(Ae=he([])).leaf=!1,Ae.height=ze;var Ue,Ke,Me,on,ne=Math.ceil(de/re),ot=ne*Math.ceil(Math.sqrt(re));for(De(ce,ge,ue,ot,this.compareMinX),Ue=ge;Ue<=ue;Ue+=ot)for(De(ce,Ue,Me=Math.min(Ue+ot-1,ue),ne,this.compareMinY),Ke=Ue;Ke<=Me;Ke+=ne)on=Math.min(Ke+ne-1,Me),Ae.children.push(this._build(ce,Ke,on,ze-1));return m(Ae,this.toBBox),Ae},_chooseSubtree:function(ce,ge,ue,ze){for(var de,re,Ae,ne,ot,Ue,Ke,Me;ze.push(ge),!ge.leaf&&ze.length-1!==ue;){for(Ke=Me=1/0,de=0,re=ge.children.length;de<re;de++)ot=mt(Ae=ge.children[de]),(Ue=Mt(ce,Ae)-ot)<Me?(Me=Ue,Ke=ot<Ke?ot:Ke,ne=Ae):Ue===Me&&ot<Ke&&(Ke=ot,ne=Ae);ge=ne||ge.children[0]}return ge},_insert:function(ce,ge,ue){var de=ue?ce:(0,this.toBBox)(ce),re=[],Ae=this._chooseSubtree(de,this.data,ge,re);for(Ae.children.push(ce),He(Ae,de);ge>=0&&re[ge].children.length>this._maxEntries;)this._split(re,ge),ge--;this._adjustParentBBoxes(de,re,ge)},_split:function(ce,ge){var ue=ce[ge],ze=ue.children.length,de=this._minEntries;this._chooseSplitAxis(ue,de,ze);var re=this._chooseSplitIndex(ue,de,ze),Ae=he(ue.children.splice(re,ue.children.length-re));Ae.height=ue.height,Ae.leaf=ue.leaf,m(ue,this.toBBox),m(Ae,this.toBBox),ge?ce[ge-1].children.push(Ae):this._splitRoot(ue,Ae)},_splitRoot:function(ce,ge){this.data=he([ce,ge]),this.data.height=ce.height+1,this.data.leaf=!1,m(this.data,this.toBBox)},_chooseSplitIndex:function(ce,ge,ue){var ze,de,re,Ae,ne,ot,Ue,Ke;for(ot=Ue=1/0,ze=ge;ze<=ue-ge;ze++)Ae=yt(de=xe(ce,0,ze,this.toBBox),re=xe(ce,ze,ue,this.toBBox)),ne=mt(de)+mt(re),Ae<ot?(ot=Ae,Ke=ze,Ue=ne<Ue?ne:Ue):Ae===ot&&ne<Ue&&(Ue=ne,Ke=ze);return Ke},_chooseSplitAxis:function(ce,ge,ue){var ze=ce.leaf?this.compareMinX:ct,de=ce.leaf?this.compareMinY:tt;this._allDistMargin(ce,ge,ue,ze)<this._allDistMargin(ce,ge,ue,de)&&ce.children.sort(ze)},_allDistMargin:function(ce,ge,ue,ze){ce.children.sort(ze);var ot,Ue,de=this.toBBox,re=xe(ce,0,ge,de),Ae=xe(ce,ue-ge,ue,de),ne=Xt(re)+Xt(Ae);for(ot=ge;ot<ue-ge;ot++)Ue=ce.children[ot],He(re,ce.leaf?de(Ue):Ue),ne+=Xt(re);for(ot=ue-ge-1;ot>=ge;ot--)Ue=ce.children[ot],He(Ae,ce.leaf?de(Ue):Ue),ne+=Xt(Ae);return ne},_adjustParentBBoxes:function(ce,ge,ue){for(var ze=ue;ze>=0;ze--)He(ge[ze],ce)},_condense:function(ce){for(var ue,ge=ce.length-1;ge>=0;ge--)0===ce[ge].children.length?ge>0?(ue=ce[ge-1].children).splice(ue.indexOf(ce[ge]),1):this.clear():m(ce[ge],this.toBBox)},_initFormat:function(ce){var ge=["return a"," - b",";"];this.compareMinX=new Function("a","b",ge.join(ce[0])),this.compareMinY=new Function("a","b",ge.join(ce[1])),this.toBBox=new Function("a","return {minX: a"+ce[0]+", minY: a"+ce[1]+", maxX: a"+ce[2]+", maxY: a"+ce[3]+"};")}}},2136:function(un){un.exports=function(){"use strict";function Ve(at,m,xe,He,ct){for(;He>xe;){if(He-xe>600){var tt=He-xe+1,mt=m-xe+1,Xt=Math.log(tt),Mt=.5*Math.exp(2*Xt/3),yt=.5*Math.sqrt(Xt*Mt*(tt-Mt)/tt)*(mt-tt/2<0?-1:1);Ve(at,m,Math.max(xe,Math.floor(m-mt*Mt/tt+yt)),Math.min(He,Math.floor(m+(tt-mt)*Mt/tt+yt)),ct)}var he=at[m],De=xe,ce=He;for(be(at,xe,m),ct(at[He],he)>0&&be(at,xe,He);De<ce;){for(be(at,De,ce),De++,ce--;ct(at[De],he)<0;)De++;for(;ct(at[ce],he)>0;)ce--}0===ct(at[xe],he)?be(at,xe,ce):be(at,++ce,He),ce<=m&&(xe=ce+1),m<=ce&&(He=ce-1)}}function be(at,m,xe){var He=at[m];at[m]=at[xe],at[xe]=He}function Fe(at,m){return at<m?-1:at>m?1:0}return function vt(at,m,xe,He,ct){Ve(at,m,xe||0,He||at.length-1,ct||Fe)}}()},3817:(un,vt,Ve)=>{"use strict";var be=Ve(9789),Fe=Object,at=TypeError;un.exports=be(function(){if(null!=this&&this!==Fe(this))throw new at("RegExp.prototype.flags getter called on non-object");var xe="";return this.hasIndices&&(xe+="d"),this.global&&(xe+="g"),this.ignoreCase&&(xe+="i"),this.multiline&&(xe+="m"),this.dotAll&&(xe+="s"),this.unicode&&(xe+="u"),this.unicodeSets&&(xe+="v"),this.sticky&&(xe+="y"),xe},"get flags",!0)},1139:(un,vt,Ve)=>{"use strict";var be=Ve(1648),Fe=Ve(5436),at=Ve(3817),m=Ve(4861),xe=Ve(6002),He=Fe(m());be(He,{getPolyfill:m,implementation:at,shim:xe}),un.exports=He},4861:(un,vt,Ve)=>{"use strict";var be=Ve(3817),Fe=Ve(1648).supportsDescriptors,at=Object.getOwnPropertyDescriptor;un.exports=function(){if(Fe&&"gim"===/a/gim.flags){var xe=at(RegExp.prototype,"flags");if(xe&&"function"==typeof xe.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var He="",ct={};if(Object.defineProperty(ct,"hasIndices",{get:function(){He+="d"}}),Object.defineProperty(ct,"sticky",{get:function(){He+="y"}}),"dy"===He)return xe.get}}return be}},6002:(un,vt,Ve)=>{"use strict";var be=Ve(1648).supportsDescriptors,Fe=Ve(4861),at=Object.getOwnPropertyDescriptor,m=Object.defineProperty,xe=TypeError,He=Object.getPrototypeOf,ct=/a/;un.exports=function(){if(!be||!He)throw new xe("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var mt=Fe(),Xt=He(ct),Mt=at(Xt,"flags");return(!Mt||Mt.get!==mt)&&m(Xt,"flags",{configurable:!0,enumerable:!1,get:mt}),mt}},6138:function(un,vt){!function(Ve){"use strict";function at(Rt,pn,he,De,ce){let ge,ue,ze,de,re=pn[0],Ae=De[0],ne=0,ot=0;Ae>re==Ae>-re?(ge=re,re=pn[++ne]):(ge=Ae,Ae=De[++ot]);let Ue=0;if(ne<Rt&&ot<he)for(Ae>re==Ae>-re?(ze=ge-((ue=re+ge)-re),re=pn[++ne]):(ze=ge-((ue=Ae+ge)-Ae),Ae=De[++ot]),ge=ue,0!==ze&&(ce[Ue++]=ze);ne<Rt&&ot<he;)Ae>re==Ae>-re?(ze=ge-((ue=ge+re)-(de=ue-ge))+(re-de),re=pn[++ne]):(ze=ge-((ue=ge+Ae)-(de=ue-ge))+(Ae-de),Ae=De[++ot]),ge=ue,0!==ze&&(ce[Ue++]=ze);for(;ne<Rt;)ze=ge-((ue=ge+re)-(de=ue-ge))+(re-de),re=pn[++ne],ge=ue,0!==ze&&(ce[Ue++]=ze);for(;ot<he;)ze=ge-((ue=ge+Ae)-(de=ue-ge))+(Ae-de),Ae=De[++ot],ge=ue,0!==ze&&(ce[Ue++]=ze);return 0===ge&&0!==Ue||(ce[Ue++]=ge),Ue}function m(Rt){return new Float64Array(Rt)}const tt=m(4),mt=m(8),Xt=m(12),Mt=m(16),yt=m(4);Ve.orient2d=function(Rt,pn,he,De,ce,ge){const ue=(pn-ge)*(he-ce),ze=(Rt-ce)*(De-ge),de=ue-ze;if(0===ue||0===ze||ue>0!=ze>0)return de;const re=Math.abs(ue+ze);return Math.abs(de)>=33306690738754716e-32*re?de:-function(Ae,ne,ot,Ue,Ke,Me,on){let Lt,Ee,dt,Re,it,gt,Ie,qt,Ct,Cn,Ut,Bn,zn,Jn,Kt,Qn,mn,Mr;const Ii=Ae-Ke,vr=ot-Ke,mi=ne-Me,wi=Ue-Me;it=(Kt=(qt=Ii-(Ie=(gt=134217729*Ii)-(gt-Ii)))*(Cn=wi-(Ct=(gt=134217729*wi)-(gt-wi)))-((Jn=Ii*wi)-Ie*Ct-qt*Ct-Ie*Cn))-(Ut=Kt-(mn=(qt=mi-(Ie=(gt=134217729*mi)-(gt-mi)))*(Cn=vr-(Ct=(gt=134217729*vr)-(gt-vr)))-((Qn=mi*vr)-Ie*Ct-qt*Ct-Ie*Cn))),tt[0]=Kt-(Ut+it)+(it-mn),it=(zn=Jn-((Bn=Jn+Ut)-(it=Bn-Jn))+(Ut-it))-(Ut=zn-Qn),tt[1]=zn-(Ut+it)+(it-Qn),it=(Mr=Bn+Ut)-Bn,tt[2]=Bn-(Mr-it)+(Ut-it),tt[3]=Mr;let _t=function(pt,Gt){let fn=Gt[0];for(let cn=1;cn<4;cn++)fn+=Gt[cn];return fn}(0,tt),we=22204460492503146e-32*on;if(_t>=we||-_t>=we||(Lt=Ae-(Ii+(it=Ae-Ii))+(it-Ke),dt=ot-(vr+(it=ot-vr))+(it-Ke),Ee=ne-(mi+(it=ne-mi))+(it-Me),Re=Ue-(wi+(it=Ue-wi))+(it-Me),0===Lt&&0===Ee&&0===dt&&0===Re)||(we=11093356479670487e-47*on+33306690738754706e-32*Math.abs(_t),(_t+=Ii*Re+wi*Lt-(mi*dt+vr*Ee))>=we||-_t>=we))return _t;it=(Kt=(qt=Lt-(Ie=(gt=134217729*Lt)-(gt-Lt)))*(Cn=wi-(Ct=(gt=134217729*wi)-(gt-wi)))-((Jn=Lt*wi)-Ie*Ct-qt*Ct-Ie*Cn))-(Ut=Kt-(mn=(qt=Ee-(Ie=(gt=134217729*Ee)-(gt-Ee)))*(Cn=vr-(Ct=(gt=134217729*vr)-(gt-vr)))-((Qn=Ee*vr)-Ie*Ct-qt*Ct-Ie*Cn))),yt[0]=Kt-(Ut+it)+(it-mn),it=(zn=Jn-((Bn=Jn+Ut)-(it=Bn-Jn))+(Ut-it))-(Ut=zn-Qn),yt[1]=zn-(Ut+it)+(it-Qn),it=(Mr=Bn+Ut)-Bn,yt[2]=Bn-(Mr-it)+(Ut-it),yt[3]=Mr;const fe=at(4,tt,4,yt,mt);it=(Kt=(qt=Ii-(Ie=(gt=134217729*Ii)-(gt-Ii)))*(Cn=Re-(Ct=(gt=134217729*Re)-(gt-Re)))-((Jn=Ii*Re)-Ie*Ct-qt*Ct-Ie*Cn))-(Ut=Kt-(mn=(qt=mi-(Ie=(gt=134217729*mi)-(gt-mi)))*(Cn=dt-(Ct=(gt=134217729*dt)-(gt-dt)))-((Qn=mi*dt)-Ie*Ct-qt*Ct-Ie*Cn))),yt[0]=Kt-(Ut+it)+(it-mn),it=(zn=Jn-((Bn=Jn+Ut)-(it=Bn-Jn))+(Ut-it))-(Ut=zn-Qn),yt[1]=zn-(Ut+it)+(it-Qn),it=(Mr=Bn+Ut)-Bn,yt[2]=Bn-(Mr-it)+(Ut-it),yt[3]=Mr;const le=at(fe,mt,4,yt,Xt);it=(Kt=(qt=Lt-(Ie=(gt=134217729*Lt)-(gt-Lt)))*(Cn=Re-(Ct=(gt=134217729*Re)-(gt-Re)))-((Jn=Lt*Re)-Ie*Ct-qt*Ct-Ie*Cn))-(Ut=Kt-(mn=(qt=Ee-(Ie=(gt=134217729*Ee)-(gt-Ee)))*(Cn=dt-(Ct=(gt=134217729*dt)-(gt-dt)))-((Qn=Ee*dt)-Ie*Ct-qt*Ct-Ie*Cn))),yt[0]=Kt-(Ut+it)+(it-mn),it=(zn=Jn-((Bn=Jn+Ut)-(it=Bn-Jn))+(Ut-it))-(Ut=zn-Qn),yt[1]=zn-(Ut+it)+(it-Qn),it=(Mr=Bn+Ut)-Bn,yt[2]=Bn-(Mr-it)+(Ut-it),yt[3]=Mr;const $e=at(le,Xt,4,yt,Mt);return Mt[$e-1]}(Rt,pn,he,De,ce,ge,re)},Ve.orient2dfast=function(Rt,pn,he,De,ce,ge){return(pn-ge)*(he-ce)-(Rt-ce)*(De-ge)},Object.defineProperty(Ve,"__esModule",{value:!0})}(vt)},2245:(un,vt,Ve)=>{"use strict";var be=Ve(491),Fe=Ve(9224),at=Ve(2486)(),m=Ve(9262),xe=be("%TypeError%"),He=be("%Math.floor%");un.exports=function(tt,mt){if("function"!=typeof tt)throw new xe("`fn` is not a function");if("number"!=typeof mt||mt<0||mt>4294967295||He(mt)!==mt)throw new xe("`length` must be a positive 32-bit integer");var Xt=arguments.length>2&&!!arguments[2],Mt=!0,yt=!0;if("length"in tt&&m){var Rt=m(tt,"length");Rt&&!Rt.configurable&&(Mt=!1),Rt&&!Rt.writable&&(yt=!1)}return(Mt||yt||!Xt)&&(at?Fe(tt,"length",mt,!0,!0):Fe(tt,"length",mt)),tt}},9789:(un,vt,Ve)=>{"use strict";var be=Ve(9224),Fe=Ve(2486)(),at=Ve(1552).functionsHaveConfigurableNames(),m=TypeError;un.exports=function(He,ct){if("function"!=typeof He)throw new m("`fn` is not a function");return(!(arguments.length>2&&arguments[2])||at)&&(Fe?be(He,"name",ct,!0,!0):be(He,"name",ct)),He}},9579:un=>{"use strict";un.exports={eudist:function(Ve,be,Fe){for(var at=Ve.length,m=0,xe=0;xe<at;xe++){var He=(Ve[xe]||0)-(be[xe]||0);m+=He*He}return Fe?Math.sqrt(m):m},mandist:function(Ve,be,Fe){for(var at=Ve.length,m=0,xe=0;xe<at;xe++)m+=Math.abs((Ve[xe]||0)-(be[xe]||0));return Fe?Math.sqrt(m):m},dist:function(Ve,be,Fe){var at=Math.abs(Ve-be);return Fe?at:at*at}}},7180:(un,vt,Ve)=>{"use strict";var be=Ve(9579),Fe=be.eudist,at=be.dist;un.exports={kmrand:function(xe,He){for(var ct={},tt=[],mt=He<<2,Xt=xe.length,Mt=xe[0].length>0;tt.length<He&&mt-- >0;){var yt=xe[Math.floor(Math.random()*Xt)],Rt=Mt?yt.join("_"):""+yt;ct[Rt]||(ct[Rt]=!0,tt.push(yt))}if(tt.length<He)throw new Error("Error initializating clusters");return tt},kmpp:function(xe,He){var ct=xe[0].length?Fe:at,tt=[],mt=xe.length,Xt=xe[0].length>0,yt=xe[Math.floor(Math.random()*mt)];for(Xt&&yt.join("_"),tt.push(yt);tt.length<He;){for(var pn=[],he=tt.length,De=0,ce=[],ge=0;ge<mt;ge++){for(var ue=1/0,ze=0;ze<he;ze++){var de=ct(xe[ge],tt[ze]);de<=ue&&(ue=de)}pn[ge]=ue}for(var re=0;re<mt;re++)De+=pn[re];for(var Ae=0;Ae<mt;Ae++)ce[Ae]={i:Ae,v:xe[Ae],pr:pn[Ae]/De,cs:0};ce.sort(function(Ke,Me){return Ke.pr-Me.pr}),ce[0].cs=ce[0].pr;for(var ne=1;ne<mt;ne++)ce[ne].cs=ce[ne-1].cs+ce[ne].pr;for(var ot=Math.random(),Ue=0;Ue<mt-1&&ce[Ue++].cs<ot;);tt.push(ce[Ue-1].v)}return tt}}},3282:(un,vt,Ve)=>{"use strict";var be=Ve(9579),Fe=Ve(7180),at=be.eudist,He=Fe.kmrand,ct=Fe.kmpp;function mt(Mt,yt,Rt){Rt=Rt||[];for(var pn=0;pn<Mt;pn++)Rt[pn]=yt;return Rt}un.exports=function Xt(Mt,yt,Rt,pn){var he=[],De=[],ce=[],ge=[],ue=!1,ze=pn||1e4,de=Mt.length,re=Mt[0].length,Ae=re>0,ne=[];if(Rt)he="kmrand"==Rt?He(Mt,yt):"kmpp"==Rt?ct(Mt,yt):Rt;else for(var ot={};he.length<yt;){var Ue=Math.floor(Math.random()*de);ot[Ue]||(ot[Ue]=!0,he.push(Mt[Ue]))}do{mt(yt,0,ne);for(var Ke=0;Ke<de;Ke++){for(var Me=1/0,on=0,Lt=0;Lt<yt;Lt++)(ge=Ae?at(Mt[Ke],he[Lt]):Math.abs(Mt[Ke]-he[Lt]))<=Me&&(Me=ge,on=Lt);ce[Ke]=on,ne[on]++}for(var Ee=[],Re=(De=[],0);Re<yt;Re++)Ee[Re]=Ae?mt(re,0,Ee[Re]):0,De[Re]=he[Re];if(Ae){for(var it=0;it<yt;it++)he[it]=[];for(var gt=0;gt<de;gt++)for(var qt=Ee[ce[gt]],Ct=Mt[gt],Cn=0;Cn<re;Cn++)qt[Cn]+=Ct[Cn];ue=!0;for(var Ut=0;Ut<yt;Ut++){for(var Bn=he[Ut],zn=Ee[Ut],Jn=De[Ut],Kt=ne[Ut],Qn=0;Qn<re;Qn++)Bn[Qn]=zn[Qn]/Kt||0;if(ue)for(var mn=0;mn<re;mn++)if(Jn[mn]!=Bn[mn]){ue=!1;break}}}else{for(var Mr=0;Mr<de;Mr++)Ee[ce[Mr]]+=Mt[Mr];for(var vr=0;vr<yt;vr++)he[vr]=Ee[vr]/ne[vr]||0;ue=!0;for(var mi=0;mi<yt;mi++)if(De[mi]!=he[mi]){ue=!1;break}}ue=ue||--ze<=0}while(!ue);return{it:1e4-ze,k:yt,idxs:ce,centroids:he}}},7935:(un,vt,Ve)=>{"use strict";Ve.r(vt),Ve.d(vt,{default:()=>be});class be{constructor(m=[],xe=Fe){if(this.data=m,this.length=this.data.length,this.compare=xe,this.length>0)for(let He=(this.length>>1)-1;He>=0;He--)this._down(He)}push(m){this.data.push(m),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const m=this.data[0],xe=this.data.pop();return this.length--,this.length>0&&(this.data[0]=xe,this._down(0)),m}peek(){return this.data[0]}_up(m){const{data:xe,compare:He}=this,ct=xe[m];for(;m>0;){const tt=m-1>>1,mt=xe[tt];if(He(ct,mt)>=0)break;xe[m]=mt,m=tt}xe[m]=ct}_down(m){const{data:xe,compare:He}=this,ct=this.length>>1,tt=xe[m];for(;m<ct;){let mt=1+(m<<1),Xt=xe[mt];const Mt=mt+1;if(Mt<this.length&&He(xe[Mt],Xt)<0&&(mt=Mt,Xt=xe[Mt]),He(Xt,tt)>=0)break;xe[m]=Xt,m=mt}xe[m]=tt}}function Fe(at,m){return at<m?-1:at>m?1:0}},4855:function(un,vt){!function(Ve){"use strict";function be(){}function Fe(l){this.message=l||""}function at(l){this.message=l||""}function m(l){this.message=l||""}function xe(){}function He(l){return null===l?Fi:l.color}function ct(l){return null===l?null:l.parent}function tt(l,h){null!==l&&(l.color=h)}function mt(l){return null===l?null:l.left}function Xt(l){return null===l?null:l.right}function Mt(){this.root_=null,this.size_=0}function yt(){}function Rt(){this.array_=[],arguments[0]instanceof se&&this.addAll(arguments[0])}function pn(){}function he(l){this.message=l||""}function De(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(l){if(null==this)throw new TypeError(this+" is not an object");var h=Object(this),y=Math.max(Math.min(h.length,9007199254740991),0)||0,w=1 in arguments&&parseInt(Number(arguments[1]),10)||0;w=w<0?Math.max(y+w,0):Math.min(w,y);var D=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:y;for(D=D<0?Math.max(y+arguments[2],0):Math.min(D,y);w<D;)h[w]=l,++w;return h},writable:!0}),Number.isFinite=Number.isFinite||function(l){return"number"==typeof l&&isFinite(l)},Number.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(l){return l!=l},Math.trunc=Math.trunc||function(l){return l<0?Math.ceil(l):Math.floor(l)};var ce=function(){};ce.prototype.interfaces_=function(){return[]},ce.prototype.getClass=function(){return ce},ce.prototype.equalsWithTolerance=function(l,h,y){return Math.abs(l-h)<=y};var ge=function(l){function h(y){l.call(this,y),this.name="IllegalArgumentException",this.message=y,this.stack=(new l).stack}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h}(Error),ue=function(){},ze={MAX_VALUE:{configurable:!0}};ue.isNaN=function(l){return Number.isNaN(l)},ue.doubleToLongBits=function(l){return l},ue.longBitsToDouble=function(l){return l},ue.isInfinite=function(l){return!Number.isFinite(l)},ze.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(ue,ze);var de=function(){},re=function(){},Ae=function(){},ne=function l(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=l.NULL_ORDINATE;else if(1===arguments.length){var h=arguments[0];this.x=h.x,this.y=h.y,this.z=h.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=l.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},ot={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};ne.prototype.setOrdinate=function(l,h){switch(l){case ne.X:this.x=h;break;case ne.Y:this.y=h;break;case ne.Z:this.z=h;break;default:throw new ge("Invalid ordinate index: "+l)}},ne.prototype.equals2D=function(){if(1===arguments.length){var l=arguments[0];return this.x===l.x&&this.y===l.y}if(2===arguments.length){var h=arguments[0],y=arguments[1];return!!ce.equalsWithTolerance(this.x,h.x,y)&&!!ce.equalsWithTolerance(this.y,h.y,y)}},ne.prototype.getOrdinate=function(l){switch(l){case ne.X:return this.x;case ne.Y:return this.y;case ne.Z:return this.z}throw new ge("Invalid ordinate index: "+l)},ne.prototype.equals3D=function(l){return this.x===l.x&&this.y===l.y&&(this.z===l.z||ue.isNaN(this.z))&&ue.isNaN(l.z)},ne.prototype.equals=function(l){return l instanceof ne&&this.equals2D(l)},ne.prototype.equalInZ=function(l,h){return ce.equalsWithTolerance(this.z,l.z,h)},ne.prototype.compareTo=function(l){return this.x<l.x?-1:this.x>l.x?1:this.y<l.y?-1:this.y>l.y?1:0},ne.prototype.clone=function(){},ne.prototype.copy=function(){return new ne(this)},ne.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},ne.prototype.distance3D=function(l){var h=this.x-l.x,y=this.y-l.y,w=this.z-l.z;return Math.sqrt(h*h+y*y+w*w)},ne.prototype.distance=function(l){var h=this.x-l.x,y=this.y-l.y;return Math.sqrt(h*h+y*y)},ne.prototype.hashCode=function(){var l=17;return 37*(l=37*l+ne.hashCode(this.x))+ne.hashCode(this.y)},ne.prototype.setCoordinate=function(l){this.x=l.x,this.y=l.y,this.z=l.z},ne.prototype.interfaces_=function(){return[de,re,be]},ne.prototype.getClass=function(){return ne},ne.hashCode=function(){if(1===arguments.length){var h=ue.doubleToLongBits(arguments[0]);return Math.trunc((h^h)>>>32)}},ot.DimensionalComparator.get=function(){return Ue},ot.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},ot.NULL_ORDINATE.get=function(){return ue.NaN},ot.X.get=function(){return 0},ot.Y.get=function(){return 1},ot.Z.get=function(){return 2},Object.defineProperties(ne,ot);var Ue=function(l){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var h=arguments[0];if(2!==h&&3!==h)throw new ge("only 2 or 3 dimensions may be specified");this._dimensionsToTest=h}};Ue.prototype.compare=function(l,h){var y=l,w=h,D=Ue.compare(y.x,w.x);if(0!==D)return D;var z=Ue.compare(y.y,w.y);return 0!==z?z:this._dimensionsToTest<=2?0:Ue.compare(y.z,w.z)},Ue.prototype.interfaces_=function(){return[Ae]},Ue.prototype.getClass=function(){return Ue},Ue.compare=function(l,h){return l<h?-1:l>h?1:ue.isNaN(l)?ue.isNaN(h)?0:-1:ue.isNaN(h)?1:0};var Ke=function(){};Ke.prototype.create=function(){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Me=function(){},on={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me},Me.toLocationSymbol=function(l){switch(l){case Me.EXTERIOR:return"e";case Me.BOUNDARY:return"b";case Me.INTERIOR:return"i";case Me.NONE:return"-"}throw new ge("Unknown location value: "+l)},on.INTERIOR.get=function(){return 0},on.BOUNDARY.get=function(){return 1},on.EXTERIOR.get=function(){return 2},on.NONE.get=function(){return-1},Object.defineProperties(Me,on);var Lt=function(l,h){return l.interfaces_&&l.interfaces_().indexOf(h)>-1},Ee=function(){},dt={LOG_10:{configurable:!0}};Ee.prototype.interfaces_=function(){return[]},Ee.prototype.getClass=function(){return Ee},Ee.log10=function(l){var h=Math.log(l);return ue.isInfinite(h)||ue.isNaN(h)?h:h/Ee.LOG_10},Ee.min=function(l,h,y,w){var D=l;return h<D&&(D=h),y<D&&(D=y),w<D&&(D=w),D},Ee.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var l=arguments[0],h=arguments[1],y=arguments[2];return l<h?h:l>y?y:l}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var w=arguments[0],D=arguments[1],z=arguments[2];return w<D?D:w>z?z:w}},Ee.wrap=function(l,h){return l<0?h- -l%h:l%h},Ee.max=function(){if(3===arguments.length){var h=arguments[1],y=arguments[2],w=arguments[0];return h>w&&(w=h),y>w&&(w=y),w}if(4===arguments.length){var z=arguments[1],G=arguments[2],ie=arguments[3],Oe=arguments[0];return z>Oe&&(Oe=z),G>Oe&&(Oe=G),ie>Oe&&(Oe=ie),Oe}},Ee.average=function(l,h){return(l+h)/2},dt.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Ee,dt);var Re=function(l){this.str=l};Re.prototype.append=function(l){this.str+=l},Re.prototype.setCharAt=function(l,h){this.str=this.str.substr(0,l)+h+this.str.substr(l+1)},Re.prototype.toString=function(l){return this.str};var it=function(l){this.value=l};it.prototype.intValue=function(){return this.value},it.prototype.compareTo=function(l){return this.value<l?-1:this.value>l?1:0},it.isNaN=function(l){return Number.isNaN(l)};var gt=function(){};gt.isWhitespace=function(l){return l<=32&&l>=0||127===l},gt.toUpperCase=function(l){return l.toUpperCase()};var Ie=function l(){this._hi=0,this._lo=0,0===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof l?this.init(arguments[0]):"string"==typeof arguments[0]&&l.call(this,l.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},qt={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ie.prototype.le=function(l){return(this._hi<l._hi||this._hi===l._hi)&&this._lo<=l._lo},Ie.prototype.extractSignificantDigits=function(l,h){var y=this.abs(),w=Ie.magnitude(y._hi),D=Ie.TEN.pow(w);(y=y.divide(D)).gt(Ie.TEN)?(y=y.divide(Ie.TEN),w+=1):y.lt(Ie.ONE)&&(y=y.multiply(Ie.TEN),w-=1);for(var z=w+1,G=new Re,ie=Ie.MAX_PRINT_DIGITS-1,Oe=0;Oe<=ie;Oe++){l&&Oe===z&&G.append(".");var lt=Math.trunc(y._hi);if(lt<0)break;var kt=!1,Zt=0;lt>9?(kt=!0,Zt="9"):Zt="0"+lt,G.append(Zt),y=y.subtract(Ie.valueOf(lt)).multiply(Ie.TEN),kt&&y.selfAdd(Ie.TEN);var Un=!0,Fn=Ie.magnitude(y._hi);if(Fn<0&&Math.abs(Fn)>=ie-Oe&&(Un=!1),!Un)break}return h[0]=w,G.toString()},Ie.prototype.sqr=function(){return this.multiply(this)},Ie.prototype.doubleValue=function(){return this._hi+this._lo},Ie.prototype.subtract=function(){return arguments[0]instanceof Ie?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},Ie.prototype.equals=function(){if(1===arguments.length){var l=arguments[0];return this._hi===l._hi&&this._lo===l._lo}},Ie.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Ie.prototype.selfSubtract=function(){if(arguments[0]instanceof Ie){var l=arguments[0];return this.isNaN()?this:this.selfAdd(-l._hi,-l._lo)}if("number"==typeof arguments[0]){var h=arguments[0];return this.isNaN()?this:this.selfAdd(-h,0)}},Ie.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Ie.prototype.min=function(l){return this.le(l)?this:l},Ie.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Ie){var l=arguments[0];return this.selfDivide(l._hi,l._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){var z,ie,Oe,kt,y=arguments[0],D=null,G=null,lt=null,Zt=null;return this._hi=Zt=(Oe=this._hi/y)+(lt=(this._hi-(kt=Oe*y)-(Zt=(D=(lt=Ie.SPLIT*Oe)-(D=lt-Oe))*(G=(Zt=Ie.SPLIT*y)-(G=Zt-y))-kt+D*(ie=y-G)+(z=Oe-D)*G+z*ie)+this._lo-Oe*arguments[1])/y),this._lo=Oe-Zt+lt,this}},Ie.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Ie.prototype.divide=function(){if(arguments[0]instanceof Ie){var y,D,z,ie,l=arguments[0],h=null,w=null,G=null,Oe=null;return y=(z=this._hi/l._hi)-(h=(G=Ie.SPLIT*z)-(h=G-z)),Oe=h*(w=(Oe=Ie.SPLIT*l._hi)-(w=Oe-l._hi))-(ie=z*l._hi)+h*(D=l._hi-w)+y*w+y*D,new Ie(Oe=z+(G=(this._hi-ie-Oe+this._lo-z*l._lo)/l._hi),z-Oe+G)}if("number"==typeof arguments[0]){var lt=arguments[0];return ue.isNaN(lt)?Ie.createNaN():Ie.copy(this).selfDivide(lt,0)}},Ie.prototype.ge=function(l){return(this._hi>l._hi||this._hi===l._hi)&&this._lo>=l._lo},Ie.prototype.pow=function(l){if(0===l)return Ie.valueOf(1);var h=new Ie(this),y=Ie.valueOf(1),w=Math.abs(l);if(w>1)for(;w>0;)w%2==1&&y.selfMultiply(h),(w/=2)>0&&(h=h.sqr());else y=h;return l<0?y.reciprocal():y},Ie.prototype.ceil=function(){if(this.isNaN())return Ie.NaN;var l=Math.ceil(this._hi),h=0;return l===this._hi&&(h=Math.ceil(this._lo)),new Ie(l,h)},Ie.prototype.compareTo=function(l){return this._hi<l._hi?-1:this._hi>l._hi?1:this._lo<l._lo?-1:this._lo>l._lo?1:0},Ie.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Ie.prototype.setValue=function(){return arguments[0]instanceof Ie||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},Ie.prototype.max=function(l){return this.ge(l)?this:l},Ie.prototype.sqrt=function(){if(this.isZero())return Ie.valueOf(0);if(this.isNegative())return Ie.NaN;var l=1/Math.sqrt(this._hi),y=Ie.valueOf(this._hi*l),w=this.subtract(y.sqr())._hi*(.5*l);return y.add(w)},Ie.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Ie){var l=arguments[0];return this.selfAdd(l._hi,l._lo)}if("number"==typeof arguments[0]){var y,w,D,G,ie,h=arguments[0];return this._hi=(y=(D=this._hi+h)+(ie=h-(G=D-this._hi)+(this._hi-(D-G))+this._lo))+(w=ie+(D-y)),this._lo=w+(y-this._hi),this}}else if(2===arguments.length){var kt,Zt,Fn,Sr,Oe=arguments[0],lt=arguments[1],Un=null,Xn=null,hi=null;Xn=(Fn=this._hi+Oe)-(hi=Fn-this._hi),Un=(Zt=this._lo+lt)-(Sr=Zt-this._lo);var On=(kt=Fn+(hi=(Xn=Oe-hi+(this._hi-Xn))+Zt))+(hi=(Un=lt-Sr+(this._lo-Un))+(hi+(Fn-kt))),Sa=hi+(kt-On);return this._hi=On,this._lo=Sa,this}},Ie.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Ie){var l=arguments[0];return this.selfMultiply(l._hi,l._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){var z,ie,y=arguments[0],D=null,G=null,Oe=null,lt=null;D=(Oe=Ie.SPLIT*this._hi)-this._hi,D=Oe-D;var kt=(Oe=this._hi*y)+(lt=D*(G=(lt=Ie.SPLIT*y)-(G=lt-y))-Oe+D*(ie=y-G)+(z=this._hi-D)*G+z*ie+(this._hi*arguments[1]+this._lo*y)),Zt=lt+(D=Oe-kt);return this._hi=kt,this._lo=Zt,this}},Ie.prototype.selfSqr=function(){return this.selfMultiply(this)},Ie.prototype.floor=function(){if(this.isNaN())return Ie.NaN;var l=Math.floor(this._hi),h=0;return l===this._hi&&(h=Math.floor(this._lo)),new Ie(l,h)},Ie.prototype.negate=function(){return this.isNaN()?this:new Ie(-this._hi,-this._lo)},Ie.prototype.clone=function(){},Ie.prototype.multiply=function(){if(arguments[0]instanceof Ie){var l=arguments[0];return l.isNaN()?Ie.createNaN():Ie.copy(this).selfMultiply(l)}if("number"==typeof arguments[0]){var h=arguments[0];return ue.isNaN(h)?Ie.createNaN():Ie.copy(this).selfMultiply(h,0)}},Ie.prototype.isNaN=function(){return ue.isNaN(this._hi)},Ie.prototype.intValue=function(){return Math.trunc(this._hi)},Ie.prototype.toString=function(){var l=Ie.magnitude(this._hi);return l>=-3&&l<=20?this.toStandardNotation():this.toSciNotation()},Ie.prototype.toStandardNotation=function(){var l=this.getSpecialNumberString();if(null!==l)return l;var h=new Array(1).fill(null),y=this.extractSignificantDigits(!0,h),w=h[0]+1,D=y;return"."===y.charAt(0)?D="0"+y:w<0?D="0."+Ie.stringOfChar("0",-w)+y:-1===y.indexOf(".")&&(D=y+Ie.stringOfChar("0",w-y.length)+".0"),this.isNegative()?"-"+D:D},Ie.prototype.reciprocal=function(){var h,w,D,G,l=null,y=null,z=null,ie=null;h=(D=1/this._hi)-(l=(z=Ie.SPLIT*D)-(l=z-D)),y=(ie=Ie.SPLIT*this._hi)-this._hi;var Oe=D+(z=(1-(G=D*this._hi)-(ie=l*(y=ie-y)-G+l*(w=this._hi-y)+h*y+h*w)-D*this._lo)/this._hi);return new Ie(Oe,D-Oe+z)},Ie.prototype.toSciNotation=function(){if(this.isZero())return Ie.SCI_NOT_ZERO;var l=this.getSpecialNumberString();if(null!==l)return l;var h=new Array(1).fill(null),y=this.extractSignificantDigits(!1,h),w=Ie.SCI_NOT_EXPONENT_CHAR+h[0];if("0"===y.charAt(0))throw new Error("Found leading zero: "+y);var D="";y.length>1&&(D=y.substring(1));var z=y.charAt(0)+"."+D;return this.isNegative()?"-"+z+w:z+w},Ie.prototype.abs=function(){return this.isNaN()?Ie.NaN:this.isNegative()?this.negate():new Ie(this)},Ie.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Ie.prototype.lt=function(l){return(this._hi<l._hi||this._hi===l._hi)&&this._lo<l._lo},Ie.prototype.add=function(){if(arguments[0]instanceof Ie){var l=arguments[0];return Ie.copy(this).selfAdd(l)}if("number"==typeof arguments[0]){var h=arguments[0];return Ie.copy(this).selfAdd(h)}},Ie.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else if(arguments[0]instanceof Ie){var h=arguments[0];this._hi=h._hi,this._lo=h._lo}}else if(2===arguments.length){var w=arguments[1];this._hi=arguments[0],this._lo=w}},Ie.prototype.gt=function(l){return(this._hi>l._hi||this._hi===l._hi)&&this._lo>l._lo},Ie.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Ie.prototype.trunc=function(){return this.isNaN()?Ie.NaN:this.isPositive()?this.floor():this.ceil()},Ie.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Ie.prototype.interfaces_=function(){return[be,de,re]},Ie.prototype.getClass=function(){return Ie},Ie.sqr=function(l){return Ie.valueOf(l).selfMultiply(l)},Ie.valueOf=function(){return"string"==typeof arguments[0]?Ie.parse(arguments[0]):"number"==typeof arguments[0]?new Ie(arguments[0]):void 0},Ie.sqrt=function(l){return Ie.valueOf(l).sqrt()},Ie.parse=function(l){for(var h=0,y=l.length;gt.isWhitespace(l.charAt(h));)h++;var w=!1;if(h<y){var D=l.charAt(h);"-"!==D&&"+"!==D||(h++,"-"===D&&(w=!0))}for(var z=new Ie,G=0,ie=0,Oe=0;!(h>=y);){var lt=l.charAt(h);if(h++,gt.isDigit(lt)){var kt=lt-"0";z.selfMultiply(Ie.TEN),z.selfAdd(kt),G++}else{if("."!==lt){if("e"===lt||"E"===lt){var Zt=l.substring(h);try{Oe=it.parseInt(Zt)}catch(Sr){throw Sr instanceof Error?new Error("Invalid exponent "+Zt+" in string "+l):Sr}break}throw new Error("Unexpected character '"+lt+"' at position "+h+" in string "+l)}ie=G}}var Un=z,Fn=G-ie-Oe;if(0===Fn)Un=z;else if(Fn>0){var Xn=Ie.TEN.pow(Fn);Un=z.divide(Xn)}else if(Fn<0){var hi=Ie.TEN.pow(-Fn);Un=z.multiply(hi)}return w?Un.negate():Un},Ie.createNaN=function(){return new Ie(ue.NaN,ue.NaN)},Ie.copy=function(l){return new Ie(l)},Ie.magnitude=function(l){var h=Math.abs(l),y=Math.log(h)/Math.log(10),w=Math.trunc(Math.floor(y));return 10*Math.pow(10,w)<=h&&(w+=1),w},Ie.stringOfChar=function(l,h){for(var y=new Re,w=0;w<h;w++)y.append(l);return y.toString()},qt.PI.get=function(){return new Ie(3.141592653589793,12246467991473532e-32)},qt.TWO_PI.get=function(){return new Ie(6.283185307179586,24492935982947064e-32)},qt.PI_2.get=function(){return new Ie(1.5707963267948966,6123233995736766e-32)},qt.E.get=function(){return new Ie(2.718281828459045,14456468917292502e-32)},qt.NaN.get=function(){return new Ie(ue.NaN,ue.NaN)},qt.EPS.get=function(){return 123259516440783e-46},qt.SPLIT.get=function(){return 134217729},qt.MAX_PRINT_DIGITS.get=function(){return 32},qt.TEN.get=function(){return Ie.valueOf(10)},qt.ONE.get=function(){return Ie.valueOf(1)},qt.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},qt.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Ie,qt);var Ct=function(){},Cn={DP_SAFE_EPSILON:{configurable:!0}};Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},Ct.orientationIndex=function(l,h,y){var w=Ct.orientationIndexFilter(l,h,y);if(w<=1)return w;var D=Ie.valueOf(h.x).selfAdd(-l.x),z=Ie.valueOf(h.y).selfAdd(-l.y),G=Ie.valueOf(y.x).selfAdd(-h.x),ie=Ie.valueOf(y.y).selfAdd(-h.y);return D.selfMultiply(ie).selfSubtract(z.selfMultiply(G)).signum()},Ct.signOfDet2x2=function(l,h,y,w){return l.multiply(w).selfSubtract(h.multiply(y)).signum()},Ct.intersection=function(l,h,y,w){var D=Ie.valueOf(w.y).selfSubtract(y.y).selfMultiply(Ie.valueOf(h.x).selfSubtract(l.x)),z=Ie.valueOf(w.x).selfSubtract(y.x).selfMultiply(Ie.valueOf(h.y).selfSubtract(l.y)),G=D.subtract(z),ie=Ie.valueOf(w.x).selfSubtract(y.x).selfMultiply(Ie.valueOf(l.y).selfSubtract(y.y)),Oe=Ie.valueOf(w.y).selfSubtract(y.y).selfMultiply(Ie.valueOf(l.x).selfSubtract(y.x)),lt=ie.subtract(Oe).selfDivide(G).doubleValue(),kt=Ie.valueOf(l.x).selfAdd(Ie.valueOf(h.x).selfSubtract(l.x).selfMultiply(lt)).doubleValue(),Zt=Ie.valueOf(h.x).selfSubtract(l.x).selfMultiply(Ie.valueOf(l.y).selfSubtract(y.y)),Un=Ie.valueOf(h.y).selfSubtract(l.y).selfMultiply(Ie.valueOf(l.x).selfSubtract(y.x)),Fn=Zt.subtract(Un).selfDivide(G).doubleValue(),Xn=Ie.valueOf(y.y).selfAdd(Ie.valueOf(w.y).selfSubtract(y.y).selfMultiply(Fn)).doubleValue();return new ne(kt,Xn)},Ct.orientationIndexFilter=function(l,h,y){var w=null,D=(l.x-y.x)*(h.y-y.y),z=(l.y-y.y)*(h.x-y.x),G=D-z;if(D>0){if(z<=0)return Ct.signum(G);w=D+z}else{if(!(D<0)||z>=0)return Ct.signum(G);w=-D-z}var ie=Ct.DP_SAFE_EPSILON*w;return G>=ie||-G>=ie?Ct.signum(G):2},Ct.signum=function(l){return l>0?1:l<0?-1:0},Cn.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Ct,Cn);var Ut=function(){},Bn={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Bn.X.get=function(){return 0},Bn.Y.get=function(){return 1},Bn.Z.get=function(){return 2},Bn.M.get=function(){return 3},Ut.prototype.setOrdinate=function(l,h,y){},Ut.prototype.size=function(){},Ut.prototype.getOrdinate=function(l,h){},Ut.prototype.getCoordinate=function(){},Ut.prototype.getCoordinateCopy=function(l){},Ut.prototype.getDimension=function(){},Ut.prototype.getX=function(l){},Ut.prototype.clone=function(){},Ut.prototype.expandEnvelope=function(l){},Ut.prototype.copy=function(){},Ut.prototype.getY=function(l){},Ut.prototype.toCoordinateArray=function(){},Ut.prototype.interfaces_=function(){return[re]},Ut.prototype.getClass=function(){return Ut},Object.defineProperties(Ut,Bn);var zn=function(){},Jn=function(l){function h(){l.call(this,"Projective point not representable on the Cartesian plane.")}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(zn),Kt=function(){};Kt.arraycopy=function(l,h,y,w,D){for(var z=0,G=h;G<h+D;G++)y[w+z]=l[G],z++},Kt.getProperty=function(l){return{"line.separator":"\n"}[l]};var Qn=function l(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var h=arguments[0];this.x=h.x,this.y=h.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var w=arguments[1];this.x=arguments[0],this.y=w,this.w=1}else if(arguments[0]instanceof l&&arguments[1]instanceof l){var D=arguments[0],z=arguments[1];this.x=D.y*z.w-z.y*D.w,this.y=z.x*D.w-D.x*z.w,this.w=D.x*z.y-z.x*D.y}else if(arguments[0]instanceof ne&&arguments[1]instanceof ne){var G=arguments[0],ie=arguments[1];this.x=G.y-ie.y,this.y=ie.x-G.x,this.w=G.x*ie.y-ie.x*G.y}}else if(3===arguments.length){var lt=arguments[1],kt=arguments[2];this.x=arguments[0],this.y=lt,this.w=kt}else if(4===arguments.length){var Zt=arguments[0],Un=arguments[1],Fn=arguments[2],Xn=arguments[3],hi=Zt.y-Un.y,Sr=Un.x-Zt.x,On=Zt.x*Un.y-Un.x*Zt.y,Sa=Fn.y-Xn.y,hc=Xn.x-Fn.x,$l=Fn.x*Xn.y-Xn.x*Fn.y;this.x=Sr*$l-hc*On,this.y=Sa*On-hi*$l,this.w=hi*hc-Sa*Sr}};Qn.prototype.getY=function(){var l=this.y/this.w;if(ue.isNaN(l)||ue.isInfinite(l))throw new Jn;return l},Qn.prototype.getX=function(){var l=this.x/this.w;if(ue.isNaN(l)||ue.isInfinite(l))throw new Jn;return l},Qn.prototype.getCoordinate=function(){var l=new ne;return l.x=this.getX(),l.y=this.getY(),l},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Qn.intersection=function(l,h,y,w){var D=l.y-h.y,z=h.x-l.x,G=l.x*h.y-h.x*l.y,ie=y.y-w.y,Oe=w.x-y.x,lt=y.x*w.y-w.x*y.y,kt=D*Oe-ie*z,Zt=(z*lt-Oe*G)/kt,Un=(ie*G-D*lt)/kt;if(ue.isNaN(Zt)||ue.isInfinite(Zt)||ue.isNaN(Un)||ue.isInfinite(Un))throw new Jn;return new ne(Zt,Un)};var mn=function l(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof ne){var h=arguments[0];this.init(h.x,h.x,h.y,h.y)}else arguments[0]instanceof l&&this.init(arguments[0]);else if(2===arguments.length){var w=arguments[0],D=arguments[1];this.init(w.x,D.x,w.y,D.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},Mr={serialVersionUID:{configurable:!0}};mn.prototype.getArea=function(){return this.getWidth()*this.getHeight()},mn.prototype.equals=function(l){if(!(l instanceof mn))return!1;var h=l;return this.isNull()?h.isNull():this._maxx===h.getMaxX()&&this._maxy===h.getMaxY()&&this._minx===h.getMinX()&&this._miny===h.getMinY()},mn.prototype.intersection=function(l){return this.isNull()||l.isNull()||!this.intersects(l)?new mn:new mn(this._minx>l._minx?this._minx:l._minx,this._maxx<l._maxx?this._maxx:l._maxx,this._miny>l._miny?this._miny:l._miny,this._maxy<l._maxy?this._maxy:l._maxy)},mn.prototype.isNull=function(){return this._maxx<this._minx},mn.prototype.getMaxX=function(){return this._maxx},mn.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof ne){var l=arguments[0];return this.covers(l.x,l.y)}if(arguments[0]instanceof mn){var h=arguments[0];return!this.isNull()&&!h.isNull()&&h.getMinX()>=this._minx&&h.getMaxX()<=this._maxx&&h.getMinY()>=this._miny&&h.getMaxY()<=this._maxy}}else if(2===arguments.length){var y=arguments[0],w=arguments[1];return!this.isNull()&&y>=this._minx&&y<=this._maxx&&w>=this._miny&&w<=this._maxy}},mn.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof mn){var l=arguments[0];return!this.isNull()&&!l.isNull()&&!(l._minx>this._maxx||l._maxx<this._minx||l._miny>this._maxy||l._maxy<this._miny)}if(arguments[0]instanceof ne){var h=arguments[0];return this.intersects(h.x,h.y)}}else if(2===arguments.length){var y=arguments[0],w=arguments[1];return!this.isNull()&&!(y>this._maxx||y<this._minx||w>this._maxy||w<this._miny)}},mn.prototype.getMinY=function(){return this._miny},mn.prototype.getMinX=function(){return this._minx},mn.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof ne){var l=arguments[0];this.expandToInclude(l.x,l.y)}else if(arguments[0]instanceof mn){var h=arguments[0];if(h.isNull())return null;this.isNull()?(this._minx=h.getMinX(),this._maxx=h.getMaxX(),this._miny=h.getMinY(),this._maxy=h.getMaxY()):(h._minx<this._minx&&(this._minx=h._minx),h._maxx>this._maxx&&(this._maxx=h._maxx),h._miny<this._miny&&(this._miny=h._miny),h._maxy>this._maxy&&(this._maxy=h._maxy))}}else if(2===arguments.length){var y=arguments[0],w=arguments[1];this.isNull()?(this._minx=y,this._maxx=y,this._miny=w,this._maxy=w):(y<this._minx&&(this._minx=y),y>this._maxx&&(this._maxx=y),w<this._miny&&(this._miny=w),w>this._maxy&&(this._maxy=w))}},mn.prototype.minExtent=function(){if(this.isNull())return 0;var l=this.getWidth(),h=this.getHeight();return l<h?l:h},mn.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},mn.prototype.compareTo=function(l){var h=l;return this.isNull()?h.isNull()?0:-1:h.isNull()?1:this._minx<h._minx?-1:this._minx>h._minx?1:this._miny<h._miny?-1:this._miny>h._miny?1:this._maxx<h._maxx?-1:this._maxx>h._maxx?1:this._maxy<h._maxy?-1:this._maxy>h._maxy?1:0},mn.prototype.translate=function(l,h){if(this.isNull())return null;this.init(this.getMinX()+l,this.getMaxX()+l,this.getMinY()+h,this.getMaxY()+h)},mn.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},mn.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},mn.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},mn.prototype.maxExtent=function(){if(this.isNull())return 0;var l=this.getWidth(),h=this.getHeight();return l>h?l:h},mn.prototype.expandBy=function(){if(1===arguments.length){var l=arguments[0];this.expandBy(l,l)}else if(2===arguments.length){var h=arguments[0],y=arguments[1];if(this.isNull())return null;this._minx-=h,this._maxx+=h,this._miny-=y,this._maxy+=y,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},mn.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof mn)return this.covers(arguments[0]);if(arguments[0]instanceof ne)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])},mn.prototype.centre=function(){return this.isNull()?null:new ne((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},mn.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof ne){var l=arguments[0];this.init(l.x,l.x,l.y,l.y)}else if(arguments[0]instanceof mn){var h=arguments[0];this._minx=h._minx,this._maxx=h._maxx,this._miny=h._miny,this._maxy=h._maxy}}else if(2===arguments.length){var y=arguments[0],w=arguments[1];this.init(y.x,w.x,y.y,w.y)}else if(4===arguments.length){var D=arguments[0],z=arguments[1],G=arguments[2],ie=arguments[3];D<z?(this._minx=D,this._maxx=z):(this._minx=z,this._maxx=D),G<ie?(this._miny=G,this._maxy=ie):(this._miny=ie,this._maxy=G)}},mn.prototype.getMaxY=function(){return this._maxy},mn.prototype.distance=function(l){if(this.intersects(l))return 0;var h=0;this._maxx<l._minx?h=l._minx-this._maxx:this._minx>l._maxx&&(h=this._minx-l._maxx);var y=0;return this._maxy<l._miny?y=l._miny-this._maxy:this._miny>l._maxy&&(y=this._miny-l._maxy),0===h?y:0===y?h:Math.sqrt(h*h+y*y)},mn.prototype.hashCode=function(){var l=17;return 37*(l=37*(l=37*(l=37*l+ne.hashCode(this._minx))+ne.hashCode(this._maxx))+ne.hashCode(this._miny))+ne.hashCode(this._maxy)},mn.prototype.interfaces_=function(){return[de,be]},mn.prototype.getClass=function(){return mn},mn.intersects=function(){if(3===arguments.length){var l=arguments[0],h=arguments[1],y=arguments[2];return y.x>=(l.x<h.x?l.x:h.x)&&y.x<=(l.x>h.x?l.x:h.x)&&y.y>=(l.y<h.y?l.y:h.y)&&y.y<=(l.y>h.y?l.y:h.y)}if(4===arguments.length){var w=arguments[0],D=arguments[1],z=arguments[2],G=arguments[3],ie=Math.min(z.x,G.x),Oe=Math.max(z.x,G.x),lt=Math.min(w.x,D.x),kt=Math.max(w.x,D.x);return!(lt>Oe||kt<ie||(ie=Math.min(z.y,G.y),Oe=Math.max(z.y,G.y),lt=Math.min(w.y,D.y),kt=Math.max(w.y,D.y),lt>Oe||kt<ie))}},Mr.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(mn,Mr);var Ii={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},vr=function(l){this.geometryFactory=l||new gi};vr.prototype.read=function(l){var h,y;l=l.replace(/[\n\r]/g," ");var D=Ii.typeStr.exec(l);if(-1!==l.search("EMPTY")&&((D=Ii.emptyTypeStr.exec(l))[2]=void 0),D&&(y=D[1].toLowerCase(),wi[y]&&(h=wi[y].apply(this,[D[2]]))),void 0===h)throw new Error("Could not parse WKT "+l);return h},vr.prototype.write=function(l){return this.extractGeometry(l)},vr.prototype.extractGeometry=function(l){var h=l.getGeometryType().toLowerCase();if(!mi[h])return null;var y=h.toUpperCase();return l.isEmpty()?y+" EMPTY":y+"("+mi[h].apply(this,[l])+")"};var mi={coordinate:function(l){return l.x+" "+l.y},point:function(l){return mi.coordinate.call(this,l._coordinates._coordinates[0])},multipoint:function(l){for(var h=[],y=0,w=l._geometries.length;y<w;++y)h.push("("+mi.point.apply(this,[l._geometries[y]])+")");return h.join(",")},linestring:function(l){for(var h=[],y=0,w=l._points._coordinates.length;y<w;++y)h.push(mi.coordinate.apply(this,[l._points._coordinates[y]]));return h.join(",")},linearring:function(l){for(var h=[],y=0,w=l._points._coordinates.length;y<w;++y)h.push(mi.coordinate.apply(this,[l._points._coordinates[y]]));return h.join(",")},multilinestring:function(l){for(var h=[],y=0,w=l._geometries.length;y<w;++y)h.push("("+mi.linestring.apply(this,[l._geometries[y]])+")");return h.join(",")},polygon:function(l){var h=[];h.push("("+mi.linestring.apply(this,[l._shell])+")");for(var y=0,w=l._holes.length;y<w;++y)h.push("("+mi.linestring.apply(this,[l._holes[y]])+")");return h.join(",")},multipolygon:function(l){for(var h=[],y=0,w=l._geometries.length;y<w;++y)h.push("("+mi.polygon.apply(this,[l._geometries[y]])+")");return h.join(",")},geometrycollection:function(l){for(var h=[],y=0,w=l._geometries.length;y<w;++y)h.push(this.extractGeometry(l._geometries[y]));return h.join(",")}},wi={point:function(l){if(void 0===l)return this.geometryFactory.createPoint();var h=l.trim().split(Ii.spaces);return this.geometryFactory.createPoint(new ne(Number.parseFloat(h[0]),Number.parseFloat(h[1])))},multipoint:function(l){if(void 0===l)return this.geometryFactory.createMultiPoint();for(var h,y=l.trim().split(","),w=[],D=0,z=y.length;D<z;++D)h=y[D].replace(Ii.trimParens,"$1"),w.push(wi.point.apply(this,[h]));return this.geometryFactory.createMultiPoint(w)},linestring:function(l){if(void 0===l)return this.geometryFactory.createLineString();for(var h,y=l.trim().split(","),w=[],D=0,z=y.length;D<z;++D)h=y[D].trim().split(Ii.spaces),w.push(new ne(Number.parseFloat(h[0]),Number.parseFloat(h[1])));return this.geometryFactory.createLineString(w)},linearring:function(l){if(void 0===l)return this.geometryFactory.createLinearRing();for(var h,y=l.trim().split(","),w=[],D=0,z=y.length;D<z;++D)h=y[D].trim().split(Ii.spaces),w.push(new ne(Number.parseFloat(h[0]),Number.parseFloat(h[1])));return this.geometryFactory.createLinearRing(w)},multilinestring:function(l){if(void 0===l)return this.geometryFactory.createMultiLineString();for(var h,y=l.trim().split(Ii.parenComma),w=[],D=0,z=y.length;D<z;++D)h=y[D].replace(Ii.trimParens,"$1"),w.push(wi.linestring.apply(this,[h]));return this.geometryFactory.createMultiLineString(w)},polygon:function(l){if(void 0===l)return this.geometryFactory.createPolygon();for(var h,y,w,D,z=l.trim().split(Ii.parenComma),G=[],ie=0,Oe=z.length;ie<Oe;++ie)h=z[ie].replace(Ii.trimParens,"$1"),y=wi.linestring.apply(this,[h]),w=this.geometryFactory.createLinearRing(y._points),0===ie?D=w:G.push(w);return this.geometryFactory.createPolygon(D,G)},multipolygon:function(l){if(void 0===l)return this.geometryFactory.createMultiPolygon();for(var h,y=l.trim().split(Ii.doubleParenComma),w=[],D=0,z=y.length;D<z;++D)h=y[D].replace(Ii.trimParens,"$1"),w.push(wi.polygon.apply(this,[h]));return this.geometryFactory.createMultiPolygon(w)},geometrycollection:function(l){if(void 0===l)return this.geometryFactory.createGeometryCollection();for(var h=(l=l.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),y=[],w=0,D=h.length;w<D;++w)y.push(this.read(h[w]));return this.geometryFactory.createGeometryCollection(y)}},_t=function(l){this.parser=new vr(l)};_t.prototype.write=function(l){return this.parser.write(l)},_t.toLineString=function(l,h){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+l.x+" "+l.y+", "+h.x+" "+h.y+" )"};var we=function(l){function h(y){l.call(this,y),this.name="RuntimeException",this.message=y,this.stack=(new l).stack}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h}(Error),fe=function(l){function h(){l.call(this),0===arguments.length?l.call(this):1===arguments.length&&l.call(this,arguments[0])}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(we),le=function(){};le.prototype.interfaces_=function(){return[]},le.prototype.getClass=function(){return le},le.shouldNeverReachHere=function(){if(0===arguments.length)le.shouldNeverReachHere(null);else if(1===arguments.length){var l=arguments[0];throw new fe("Should never reach here"+(null!==l?": "+l:""))}},le.isTrue=function(){var h;if(1===arguments.length)le.isTrue(arguments[0],null);else if(2===arguments.length&&(h=arguments[1],!arguments[0]))throw null===h?new fe:new fe(h)},le.equals=function(){var l,h,y;if(2===arguments.length)le.equals(l=arguments[0],h=arguments[1],null);else if(3===arguments.length&&(y=arguments[2],!(h=arguments[1]).equals(l=arguments[0])))throw new fe("Expected "+l+" but encountered "+h+(null!==y?": "+y:""))};var $e=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ne,this._intPt[1]=new ne,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},pt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};$e.prototype.getIndexAlongSegment=function(l,h){return this.computeIntLineIndex(),this._intLineIndex[l][h]},$e.prototype.getTopologySummary=function(){var l=new Re;return this.isEndPoint()&&l.append(" endpoint"),this._isProper&&l.append(" proper"),this.isCollinear()&&l.append(" collinear"),l.toString()},$e.prototype.computeIntersection=function(l,h,y,w){this._inputLines[0][0]=l,this._inputLines[0][1]=h,this._inputLines[1][0]=y,this._inputLines[1][1]=w,this._result=this.computeIntersect(l,h,y,w)},$e.prototype.getIntersectionNum=function(){return this._result},$e.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var l=arguments[0];this.getEdgeDistance(l,0)>this.getEdgeDistance(l,1)?(this._intLineIndex[l][0]=0,this._intLineIndex[l][1]=1):(this._intLineIndex[l][0]=1,this._intLineIndex[l][1]=0)}},$e.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},$e.prototype.setPrecisionModel=function(l){this._precisionModel=l},$e.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var l=arguments[0],h=0;h<this._result;h++)if(!this._intPt[h].equals2D(this._inputLines[l][0])&&!this._intPt[h].equals2D(this._inputLines[l][1]))return!0;return!1}},$e.prototype.getIntersection=function(l){return this._intPt[l]},$e.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},$e.prototype.hasIntersection=function(){return this._result!==$e.NO_INTERSECTION},$e.prototype.getEdgeDistance=function(l,h){return $e.computeEdgeDistance(this._intPt[h],this._inputLines[l][0],this._inputLines[l][1])},$e.prototype.isCollinear=function(){return this._result===$e.COLLINEAR_INTERSECTION},$e.prototype.toString=function(){return _t.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+_t.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},$e.prototype.getEndpoint=function(l,h){return this._inputLines[l][h]},$e.prototype.isIntersection=function(l){for(var h=0;h<this._result;h++)if(this._intPt[h].equals2D(l))return!0;return!1},$e.prototype.getIntersectionAlongSegment=function(l,h){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[l][h]]},$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e},$e.computeEdgeDistance=function(l,h,y){var w=Math.abs(y.x-h.x),D=Math.abs(y.y-h.y),z=-1;if(l.equals(h))z=0;else if(l.equals(y))z=w>D?w:D;else{var G=Math.abs(l.x-h.x),ie=Math.abs(l.y-h.y);0!==(z=w>D?G:ie)||l.equals(h)||(z=Math.max(G,ie))}return le.isTrue(!(0===z&&!l.equals(h)),"Bad distance calculation"),z},$e.nonRobustComputeEdgeDistance=function(l,h,y){var w=l.x-h.x,D=l.y-h.y,z=Math.sqrt(w*w+D*D);return le.isTrue(!(0===z&&!l.equals(h)),"Invalid distance calculation"),z},pt.DONT_INTERSECT.get=function(){return 0},pt.DO_INTERSECT.get=function(){return 1},pt.COLLINEAR.get=function(){return 2},pt.NO_INTERSECTION.get=function(){return 0},pt.POINT_INTERSECTION.get=function(){return 1},pt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties($e,pt);var Gt=function(l){function h(){l.apply(this,arguments)}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.isInSegmentEnvelopes=function(y){var w=new mn(this._inputLines[0][0],this._inputLines[0][1]),D=new mn(this._inputLines[1][0],this._inputLines[1][1]);return w.contains(y)&&D.contains(y)},h.prototype.computeIntersection=function(){if(3!==arguments.length)return l.prototype.computeIntersection.apply(this,arguments);var y=arguments[0],w=arguments[1],D=arguments[2];if(this._isProper=!1,mn.intersects(w,D,y)&&0===Wt.orientationIndex(w,D,y)&&0===Wt.orientationIndex(D,w,y))return this._isProper=!0,(y.equals(w)||y.equals(D))&&(this._isProper=!1),this._result=l.POINT_INTERSECTION,null;this._result=l.NO_INTERSECTION},h.prototype.normalizeToMinimum=function(y,w,D,z,G){G.x=this.smallestInAbsValue(y.x,w.x,D.x,z.x),G.y=this.smallestInAbsValue(y.y,w.y,D.y,z.y),y.x-=G.x,y.y-=G.y,w.x-=G.x,w.y-=G.y,D.x-=G.x,D.y-=G.y,z.x-=G.x,z.y-=G.y},h.prototype.safeHCoordinateIntersection=function(y,w,D,z){var G=null;try{G=Qn.intersection(y,w,D,z)}catch(ie){if(!(ie instanceof Jn))throw ie;G=h.nearestEndpoint(y,w,D,z)}return G},h.prototype.intersection=function(y,w,D,z){var G=this.intersectionWithNormalization(y,w,D,z);return this.isInSegmentEnvelopes(G)||(G=new ne(h.nearestEndpoint(y,w,D,z))),null!==this._precisionModel&&this._precisionModel.makePrecise(G),G},h.prototype.smallestInAbsValue=function(y,w,D,z){var G=y,ie=Math.abs(G);return Math.abs(w)<ie&&(G=w,ie=Math.abs(w)),Math.abs(D)<ie&&(G=D,ie=Math.abs(D)),Math.abs(z)<ie&&(G=z),G},h.prototype.checkDD=function(y,w,D,z,G){var ie=Ct.intersection(y,w,D,z),Oe=this.isInSegmentEnvelopes(ie);Kt.out.println("DD in env = "+Oe+"  --------------------- "+ie),G.distance(ie)>1e-4&&Kt.out.println("Distance = "+G.distance(ie))},h.prototype.intersectionWithNormalization=function(y,w,D,z){var G=new ne(y),ie=new ne(w),Oe=new ne(D),lt=new ne(z),kt=new ne;this.normalizeToEnvCentre(G,ie,Oe,lt,kt);var Zt=this.safeHCoordinateIntersection(G,ie,Oe,lt);return Zt.x+=kt.x,Zt.y+=kt.y,Zt},h.prototype.computeCollinearIntersection=function(y,w,D,z){var G=mn.intersects(y,w,D),ie=mn.intersects(y,w,z),Oe=mn.intersects(D,z,y),lt=mn.intersects(D,z,w);return G&&ie?(this._intPt[0]=D,this._intPt[1]=z,l.COLLINEAR_INTERSECTION):Oe&&lt?(this._intPt[0]=y,this._intPt[1]=w,l.COLLINEAR_INTERSECTION):G&&Oe?(this._intPt[0]=D,this._intPt[1]=y,!D.equals(y)||ie||lt?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):G&&lt?(this._intPt[0]=D,this._intPt[1]=w,!D.equals(w)||ie||Oe?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):ie&&Oe?(this._intPt[0]=z,this._intPt[1]=y,!z.equals(y)||G||lt?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):ie&&lt?(this._intPt[0]=z,this._intPt[1]=w,!z.equals(w)||G||Oe?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):l.NO_INTERSECTION},h.prototype.normalizeToEnvCentre=function(y,w,D,z,G){var ie=y.x<w.x?y.x:w.x,Oe=y.y<w.y?y.y:w.y,lt=y.x>w.x?y.x:w.x,kt=y.y>w.y?y.y:w.y,Zt=D.x<z.x?D.x:z.x,Un=D.y<z.y?D.y:z.y,Fn=D.x>z.x?D.x:z.x,Xn=D.y>z.y?D.y:z.y,Sr=((Oe>Un?Oe:Un)+(kt<Xn?kt:Xn))/2;G.x=((ie>Zt?ie:Zt)+(lt<Fn?lt:Fn))/2,G.y=Sr,y.x-=G.x,y.y-=G.y,w.x-=G.x,w.y-=G.y,D.x-=G.x,D.y-=G.y,z.x-=G.x,z.y-=G.y},h.prototype.computeIntersect=function(y,w,D,z){if(this._isProper=!1,!mn.intersects(y,w,D,z))return l.NO_INTERSECTION;var G=Wt.orientationIndex(y,w,D),ie=Wt.orientationIndex(y,w,z);if(G>0&&ie>0||G<0&&ie<0)return l.NO_INTERSECTION;var Oe=Wt.orientationIndex(D,z,y),lt=Wt.orientationIndex(D,z,w);return Oe>0&&lt>0||Oe<0&&lt<0?l.NO_INTERSECTION:0===G&&0===ie&&0===Oe&&0===lt?this.computeCollinearIntersection(y,w,D,z):(0===G||0===ie||0===Oe||0===lt?(this._isProper=!1,y.equals2D(D)||y.equals2D(z)?this._intPt[0]=y:w.equals2D(D)||w.equals2D(z)?this._intPt[0]=w:0===G?this._intPt[0]=new ne(D):0===ie?this._intPt[0]=new ne(z):0===Oe?this._intPt[0]=new ne(y):0===lt&&(this._intPt[0]=new ne(w))):(this._isProper=!0,this._intPt[0]=this.intersection(y,w,D,z)),l.POINT_INTERSECTION)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h.nearestEndpoint=function(y,w,D,z){var G=y,ie=Wt.distancePointLine(y,D,z),Oe=Wt.distancePointLine(w,D,z);return Oe<ie&&(ie=Oe,G=w),(Oe=Wt.distancePointLine(D,y,w))<ie&&(ie=Oe,G=D),(Oe=Wt.distancePointLine(z,y,w))<ie&&(ie=Oe,G=z),G},h}($e),fn=function(){};fn.prototype.interfaces_=function(){return[]},fn.prototype.getClass=function(){return fn},fn.orientationIndex=function(l,h,y){return fn.signOfDet2x2(h.x-l.x,h.y-l.y,y.x-h.x,y.y-h.y)},fn.signOfDet2x2=function(l,h,y,w){var D=null,z=null,G=null;if(D=1,0===l||0===w)return 0===h||0===y?0:h>0?y>0?-D:D:y>0?D:-D;if(0===h||0===y)return w>0?l>0?D:-D:l>0?-D:D;if(h>0?w>0?h<=w||(D=-D,z=l,l=y,y=z,z=h,h=w,w=z):h<=-w?(D=-D,y=-y,w=-w):(z=l,l=-y,y=z,z=h,h=-w,w=z):w>0?-h<=w?(D=-D,l=-l,h=-h):(z=-l,l=y,y=z,z=-h,h=w,w=z):h>=w?(l=-l,h=-h,y=-y,w=-w):(D=-D,z=-l,l=-y,y=z,z=-h,h=-w,w=z),l>0){if(!(y>0&&l<=y))return D}else{if(y>0||!(l>=y))return-D;D=-D,l=-l,y=-y}for(;;){if((w-=(G=Math.floor(y/l))*h)<0)return-D;if(w>h)return D;if(l>(y-=G*l)+y){if(h<w+w)return D}else{if(h>w+w)return-D;y=l-y,w=h-w,D=-D}if(0===w)return 0===y?0:-D;if(0===y||(l-=(G=Math.floor(l/y))*y,(h-=G*w)<0))return D;if(h>w)return-D;if(y>l+l){if(w<h+h)return-D}else{if(w>h+h)return D;l=y-l,h=w-h,D=-D}if(0===h)return 0===l?0:D;if(0===l)return-D}};var cn=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]};cn.prototype.countSegment=function(l,h){if(l.x<this._p.x&&h.x<this._p.x)return null;if(this._p.x===h.x&&this._p.y===h.y)return this._isPointOnSegment=!0,null;if(l.y===this._p.y&&h.y===this._p.y){var y=l.x,w=h.x;return y>w&&(y=h.x,w=l.x),this._p.x>=y&&this._p.x<=w&&(this._isPointOnSegment=!0),null}if(l.y>this._p.y&&h.y<=this._p.y||h.y>this._p.y&&l.y<=this._p.y){var z=l.y-this._p.y,ie=h.y-this._p.y,Oe=fn.signOfDet2x2(l.x-this._p.x,z,h.x-this._p.x,ie);if(0===Oe)return this._isPointOnSegment=!0,null;ie<z&&(Oe=-Oe),Oe>0&&this._crossingCount++}},cn.prototype.isPointInPolygon=function(){return this.getLocation()!==Me.EXTERIOR},cn.prototype.getLocation=function(){return this._isPointOnSegment?Me.BOUNDARY:this._crossingCount%2==1?Me.INTERIOR:Me.EXTERIOR},cn.prototype.isOnSegment=function(){return this._isPointOnSegment},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn},cn.locatePointInRing=function(){if(arguments[0]instanceof ne&&Lt(arguments[1],Ut)){for(var h=arguments[1],y=new cn(arguments[0]),w=new ne,D=new ne,z=1;z<h.size();z++)if(h.getCoordinate(z,w),h.getCoordinate(z-1,D),y.countSegment(w,D),y.isOnSegment())return y.getLocation();return y.getLocation()}if(arguments[0]instanceof ne&&arguments[1]instanceof Array){for(var ie=arguments[1],Oe=new cn(arguments[0]),lt=1;lt<ie.length;lt++)if(Oe.countSegment(ie[lt],ie[lt-1]),Oe.isOnSegment())return Oe.getLocation();return Oe.getLocation()}};var Wt=function(){},Mi={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.orientationIndex=function(l,h,y){return Ct.orientationIndex(l,h,y)},Wt.signedArea=function(){if(arguments[0]instanceof Array){var l=arguments[0];if(l.length<3)return 0;for(var h=0,y=l[0].x,w=1;w<l.length-1;w++)h+=(l[w].x-y)*(l[w-1].y-l[w+1].y);return h/2}if(Lt(arguments[0],Ut)){var G=arguments[0],ie=G.size();if(ie<3)return 0;var Oe=new ne,lt=new ne,kt=new ne;G.getCoordinate(0,lt),G.getCoordinate(1,kt);var Zt=lt.x;kt.x-=Zt;for(var Un=0,Fn=1;Fn<ie-1;Fn++)Oe.y=lt.y,lt.x=kt.x,lt.y=kt.y,G.getCoordinate(Fn+1,kt),kt.x-=Zt,Un+=lt.x*(Oe.y-kt.y);return Un/2}},Wt.distanceLineLine=function(l,h,y,w){if(l.equals(h))return Wt.distancePointLine(l,y,w);if(y.equals(w))return Wt.distancePointLine(w,l,h);var D=!1;if(mn.intersects(l,h,y,w)){var z=(h.x-l.x)*(w.y-y.y)-(h.y-l.y)*(w.x-y.x);if(0===z)D=!0;else{var ie=((l.y-y.y)*(h.x-l.x)-(l.x-y.x)*(h.y-l.y))/z,Oe=((l.y-y.y)*(w.x-y.x)-(l.x-y.x)*(w.y-y.y))/z;(Oe<0||Oe>1||ie<0||ie>1)&&(D=!0)}}else D=!0;return D?Ee.min(Wt.distancePointLine(l,y,w),Wt.distancePointLine(h,y,w),Wt.distancePointLine(y,l,h),Wt.distancePointLine(w,l,h)):0},Wt.isPointInRing=function(l,h){return Wt.locatePointInRing(l,h)!==Me.EXTERIOR},Wt.computeLength=function(l){var h=l.size();if(h<=1)return 0;var y=0,w=new ne;l.getCoordinate(0,w);for(var D=w.x,z=w.y,G=1;G<h;G++){l.getCoordinate(G,w);var ie=w.x,Oe=w.y,lt=ie-D,kt=Oe-z;y+=Math.sqrt(lt*lt+kt*kt),D=ie,z=Oe}return y},Wt.isCCW=function(l){var h=l.length-1;if(h<3)throw new ge("Ring has fewer than 4 points, so orientation cannot be determined");for(var y=l[0],w=0,D=1;D<=h;D++){var z=l[D];z.y>y.y&&(y=z,w=D)}var G=w;do{(G-=1)<0&&(G=h)}while(l[G].equals2D(y)&&G!==w);var ie=w;do{ie=(ie+1)%h}while(l[ie].equals2D(y)&&ie!==w);var Oe=l[G],lt=l[ie];if(Oe.equals2D(y)||lt.equals2D(y)||Oe.equals2D(lt))return!1;var kt=Wt.computeOrientation(Oe,y,lt);return 0===kt?Oe.x>lt.x:kt>0},Wt.locatePointInRing=function(l,h){return cn.locatePointInRing(l,h)},Wt.distancePointLinePerpendicular=function(l,h,y){var w=(y.x-h.x)*(y.x-h.x)+(y.y-h.y)*(y.y-h.y);return Math.abs(((h.y-l.y)*(y.x-h.x)-(h.x-l.x)*(y.y-h.y))/w)*Math.sqrt(w)},Wt.computeOrientation=function(l,h,y){return Wt.orientationIndex(l,h,y)},Wt.distancePointLine=function(){if(2===arguments.length){var l=arguments[0],h=arguments[1];if(0===h.length)throw new ge("Line array must contain at least one vertex");for(var y=l.distance(h[0]),w=0;w<h.length-1;w++){var D=Wt.distancePointLine(l,h[w],h[w+1]);D<y&&(y=D)}return y}if(3===arguments.length){var z=arguments[0],G=arguments[1],ie=arguments[2];if(G.x===ie.x&&G.y===ie.y)return z.distance(G);var Oe=(ie.x-G.x)*(ie.x-G.x)+(ie.y-G.y)*(ie.y-G.y),lt=((z.x-G.x)*(ie.x-G.x)+(z.y-G.y)*(ie.y-G.y))/Oe;return lt<=0?z.distance(G):lt>=1?z.distance(ie):Math.abs(((G.y-z.y)*(ie.x-G.x)-(G.x-z.x)*(ie.y-G.y))/Oe)*Math.sqrt(Oe)}},Wt.isOnLine=function(l,h){for(var y=new Gt,w=1;w<h.length;w++)if(y.computeIntersection(l,h[w-1],h[w]),y.hasIntersection())return!0;return!1},Mi.CLOCKWISE.get=function(){return-1},Mi.RIGHT.get=function(){return Wt.CLOCKWISE},Mi.COUNTERCLOCKWISE.get=function(){return 1},Mi.LEFT.get=function(){return Wt.COUNTERCLOCKWISE},Mi.COLLINEAR.get=function(){return 0},Mi.STRAIGHT.get=function(){return Wt.COLLINEAR},Object.defineProperties(Wt,Mi);var Ni=function(){};Ni.prototype.filter=function(l){},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni};var Nn=function(){var l=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=l,this._SRID=l.getSRID()},Ci={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Nn.prototype.isGeometryCollection=function(){return this.getSortIndex()===Nn.SORTINDEX_GEOMETRYCOLLECTION},Nn.prototype.getFactory=function(){return this._factory},Nn.prototype.getGeometryN=function(l){return this},Nn.prototype.getArea=function(){return 0},Nn.prototype.isRectangle=function(){return!1},Nn.prototype.equals=function(){if(arguments[0]instanceof Nn){var l=arguments[0];return null!==l&&this.equalsTopo(l)}if(arguments[0]instanceof Object){var h=arguments[0];return h instanceof Nn&&this.equalsExact(h)}},Nn.prototype.equalsExact=function(l){return this===l||this.equalsExact(l,0)},Nn.prototype.geometryChanged=function(){this.apply(Nn.geometryChangedFilter)},Nn.prototype.geometryChangedAction=function(){this._envelope=null},Nn.prototype.equalsNorm=function(l){return null!==l&&this.norm().equalsExact(l.norm())},Nn.prototype.getLength=function(){return 0},Nn.prototype.getNumGeometries=function(){return 1},Nn.prototype.compareTo=function(){if(1===arguments.length){var l=arguments[0],h=l;return this.getSortIndex()!==h.getSortIndex()?this.getSortIndex()-h.getSortIndex():this.isEmpty()&&h.isEmpty()?0:this.isEmpty()?-1:h.isEmpty()?1:this.compareToSameClass(l)}if(2===arguments.length){var y=arguments[0],w=arguments[1];return this.getSortIndex()!==y.getSortIndex()?this.getSortIndex()-y.getSortIndex():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(y,w)}},Nn.prototype.getUserData=function(){return this._userData},Nn.prototype.getSRID=function(){return this._SRID},Nn.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Nn.prototype.checkNotGeometryCollection=function(l){if(l.getSortIndex()===Nn.SORTINDEX_GEOMETRYCOLLECTION)throw new ge("This method does not support GeometryCollection arguments")},Nn.prototype.equal=function(l,h,y){return 0===y?l.equals(h):l.distance(h)<=y},Nn.prototype.norm=function(){var l=this.copy();return l.normalize(),l},Nn.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Nn.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new mn(this._envelope)},Nn.prototype.setSRID=function(l){this._SRID=l},Nn.prototype.setUserData=function(l){this._userData=l},Nn.prototype.compare=function(l,h){for(var y=l.iterator(),w=h.iterator();y.hasNext()&&w.hasNext();){var D=y.next(),z=w.next(),G=D.compareTo(z);if(0!==G)return G}return y.hasNext()?1:w.hasNext()?-1:0},Nn.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Nn.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Nn.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Nn.SORTINDEX_MULTIPOINT||this.getSortIndex()===Nn.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Nn.SORTINDEX_MULTIPOLYGON},Nn.prototype.interfaces_=function(){return[re,de,be]},Nn.prototype.getClass=function(){return Nn},Nn.hasNonEmptyElements=function(l){for(var h=0;h<l.length;h++)if(!l[h].isEmpty())return!0;return!1},Nn.hasNullElements=function(l){for(var h=0;h<l.length;h++)if(null===l[h])return!0;return!1},Ci.serialVersionUID.get=function(){return 0x799ea46522854c00},Ci.SORTINDEX_POINT.get=function(){return 0},Ci.SORTINDEX_MULTIPOINT.get=function(){return 1},Ci.SORTINDEX_LINESTRING.get=function(){return 2},Ci.SORTINDEX_LINEARRING.get=function(){return 3},Ci.SORTINDEX_MULTILINESTRING.get=function(){return 4},Ci.SORTINDEX_POLYGON.get=function(){return 5},Ci.SORTINDEX_MULTIPOLYGON.get=function(){return 6},Ci.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},Ci.geometryChangedFilter.get=function(){return Nr},Object.defineProperties(Nn,Ci);var Nr=function(){};Nr.interfaces_=function(){return[Ni]},Nr.filter=function(l){l.geometryChangedAction()};var nr=function(){};nr.prototype.filter=function(l){},nr.prototype.interfaces_=function(){return[]},nr.prototype.getClass=function(){return nr};var cr=function(){},po={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};cr.prototype.isInBoundary=function(l){},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},po.Mod2BoundaryNodeRule.get=function(){return Xo},po.EndPointBoundaryNodeRule.get=function(){return $s},po.MultiValentEndPointBoundaryNodeRule.get=function(){return qe},po.MonoValentEndPointBoundaryNodeRule.get=function(){return oe},po.MOD2_BOUNDARY_RULE.get=function(){return new Xo},po.ENDPOINT_BOUNDARY_RULE.get=function(){return new $s},po.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new qe},po.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new oe},po.OGC_SFS_BOUNDARY_RULE.get=function(){return cr.MOD2_BOUNDARY_RULE},Object.defineProperties(cr,po);var Xo=function(){};Xo.prototype.isInBoundary=function(l){return l%2==1},Xo.prototype.interfaces_=function(){return[cr]},Xo.prototype.getClass=function(){return Xo};var $s=function(){};$s.prototype.isInBoundary=function(l){return l>0},$s.prototype.interfaces_=function(){return[cr]},$s.prototype.getClass=function(){return $s};var qe=function(){};qe.prototype.isInBoundary=function(l){return l>1},qe.prototype.interfaces_=function(){return[cr]},qe.prototype.getClass=function(){return qe};var oe=function(){};oe.prototype.isInBoundary=function(l){return 1===l},oe.prototype.interfaces_=function(){return[cr]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.add=function(){},se.prototype.addAll=function(){},se.prototype.isEmpty=function(){},se.prototype.iterator=function(){},se.prototype.size=function(){},se.prototype.toArray=function(){},se.prototype.remove=function(){},(Fe.prototype=new Error).name="IndexOutOfBoundsException";var je=function(){};je.prototype.hasNext=function(){},je.prototype.next=function(){},je.prototype.remove=function(){};var et=function(l){function h(){l.apply(this,arguments)}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.get=function(){},h.prototype.set=function(){},h.prototype.isEmpty=function(){},h}(se);(at.prototype=new Error).name="NoSuchElementException";var ke=function(l){function h(){l.call(this),this.array_=[],arguments[0]instanceof se&&this.addAll(arguments[0])}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.ensureCapacity=function(){},h.prototype.interfaces_=function(){return[l,se]},h.prototype.add=function(y){return 1===arguments.length?this.array_.push(y):this.array_.splice(arguments[0],arguments[1]),!0},h.prototype.clear=function(){this.array_=[]},h.prototype.addAll=function(y){for(var w=y.iterator();w.hasNext();)this.add(w.next());return!0},h.prototype.set=function(y,w){var D=this.array_[y];return this.array_[y]=w,D},h.prototype.iterator=function(){return new Tt(this)},h.prototype.get=function(y){if(y<0||y>=this.size())throw new Fe;return this.array_[y]},h.prototype.isEmpty=function(){return 0===this.array_.length},h.prototype.size=function(){return this.array_.length},h.prototype.toArray=function(){for(var y=[],w=0,D=this.array_.length;w<D;w++)y.push(this.array_[w]);return y},h.prototype.remove=function(y){for(var w=!1,D=0,z=this.array_.length;D<z;D++)if(this.array_[D]===y){this.array_.splice(D,1),w=!0;break}return w},h}(et),Tt=function(l){function h(y){l.call(this),this.arrayList_=y,this.position_=0}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new at;return this.arrayList_.get(this.position_++)},h.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},h.prototype.set=function(y){return this.arrayList_.set(this.position_-1,y)},h.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},h}(je),It=function(l){function h(){if(l.call(this),0!==arguments.length)if(1===arguments.length){var w=arguments[0];this.ensureCapacity(w.length),this.add(w,!0)}else if(2===arguments.length){var D=arguments[0],z=arguments[1];this.ensureCapacity(D.length),this.add(D,z)}}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={coordArrayType:{configurable:!0}};return y.coordArrayType.get=function(){return new Array(0).fill(null)},h.prototype.getCoordinate=function(w){return this.get(w)},h.prototype.addAll=function(){if(2===arguments.length){for(var D=arguments[1],z=!1,G=arguments[0].iterator();G.hasNext();)this.add(G.next(),D),z=!0;return z}return l.prototype.addAll.apply(this,arguments)},h.prototype.clone=function(){for(var w=l.prototype.clone.call(this),D=0;D<this.size();D++)w.add(D,this.get(D).copy());return w},h.prototype.toCoordinateArray=function(){return this.toArray(h.coordArrayType)},h.prototype.add=function(){if(1===arguments.length)l.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof ne&&"boolean"==typeof arguments[1]){var G=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(G))return null;l.prototype.add.call(this,G)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var lt=arguments[0],kt=arguments[1];if(arguments[2])for(var Zt=0;Zt<lt.length;Zt++)this.add(lt[Zt],kt);else for(var Un=lt.length-1;Un>=0;Un--)this.add(lt[Un],kt);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof ne){var Fn=arguments[0],Xn=arguments[1];if(!arguments[2]){var hi=this.size();if(hi>0&&(Fn>0&&this.get(Fn-1).equals2D(Xn)||Fn<hi&&this.get(Fn).equals2D(Xn)))return null}l.prototype.add.call(this,Fn,Xn)}}else if(4===arguments.length){var Sr=arguments[0],On=arguments[1],Sa=arguments[2],hc=arguments[3],$l=1;Sa>hc&&($l=-1);for(var ku=Sa;ku!==hc;ku+=$l)this.add(Sr[ku],On);return!0}},h.prototype.closeRing=function(){this.size()>0&&this.add(new ne(this.get(0)),!1)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},Object.defineProperties(h,y),h}(ke),Ye=function(){},Nt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Nt.ForwardComparator.get=function(){return _n},Nt.BidirectionalComparator.get=function(){return Dn},Nt.coordArrayType.get=function(){return new Array(0).fill(null)},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye},Ye.isRing=function(l){return!(l.length<4||!l[0].equals2D(l[l.length-1]))},Ye.ptNotInList=function(l,h){for(var y=0;y<l.length;y++){var w=l[y];if(Ye.indexOf(w,h)<0)return w}return null},Ye.scroll=function(l,h){var y=Ye.indexOf(h,l);if(y<0)return null;var w=new Array(l.length).fill(null);Kt.arraycopy(l,y,w,0,l.length-y),Kt.arraycopy(l,0,w,l.length-y,y),Kt.arraycopy(w,0,l,0,l.length)},Ye.equals=function(){if(2===arguments.length){var l=arguments[0],h=arguments[1];if(l===h)return!0;if(null===l||null===h||l.length!==h.length)return!1;for(var y=0;y<l.length;y++)if(!l[y].equals(h[y]))return!1;return!0}if(3===arguments.length){var w=arguments[0],D=arguments[1],z=arguments[2];if(w===D)return!0;if(null===w||null===D||w.length!==D.length)return!1;for(var G=0;G<w.length;G++)if(0!==z.compare(w[G],D[G]))return!1;return!0}},Ye.intersection=function(l,h){for(var y=new It,w=0;w<l.length;w++)h.intersects(l[w])&&y.add(l[w],!0);return y.toCoordinateArray()},Ye.hasRepeatedPoints=function(l){for(var h=1;h<l.length;h++)if(l[h-1].equals(l[h]))return!0;return!1},Ye.removeRepeatedPoints=function(l){return Ye.hasRepeatedPoints(l)?new It(l,!1).toCoordinateArray():l},Ye.reverse=function(l){for(var h=l.length-1,y=Math.trunc(h/2),w=0;w<=y;w++){var D=l[w];l[w]=l[h-w],l[h-w]=D}},Ye.removeNull=function(l){for(var h=0,y=0;y<l.length;y++)null!==l[y]&&h++;var w=new Array(h).fill(null);if(0===h)return w;for(var D=0,z=0;z<l.length;z++)null!==l[z]&&(w[D++]=l[z]);return w},Ye.copyDeep=function(){if(1===arguments.length){for(var l=arguments[0],h=new Array(l.length).fill(null),y=0;y<l.length;y++)h[y]=new ne(l[y]);return h}if(5===arguments.length)for(var w=arguments[0],D=arguments[1],z=arguments[2],G=arguments[3],ie=arguments[4],Oe=0;Oe<ie;Oe++)z[G+Oe]=new ne(w[D+Oe])},Ye.isEqualReversed=function(l,h){for(var y=0;y<l.length;y++)if(0!==l[y].compareTo(h[l.length-y-1]))return!1;return!0},Ye.envelope=function(l){for(var h=new mn,y=0;y<l.length;y++)h.expandToInclude(l[y]);return h},Ye.toCoordinateArray=function(l){return l.toArray(Ye.coordArrayType)},Ye.atLeastNCoordinatesOrNothing=function(l,h){return h.length>=l?h:[]},Ye.indexOf=function(l,h){for(var y=0;y<h.length;y++)if(l.equals(h[y]))return y;return-1},Ye.increasingDirection=function(l){for(var h=0;h<Math.trunc(l.length/2);h++){var w=l[h].compareTo(l[l.length-1-h]);if(0!==w)return w}return 1},Ye.compare=function(l,h){for(var y=0;y<l.length&&y<h.length;){var w=l[y].compareTo(h[y]);if(0!==w)return w;y++}return y<h.length?-1:y<l.length?1:0},Ye.minCoordinate=function(l){for(var h=null,y=0;y<l.length;y++)(null===h||h.compareTo(l[y])>0)&&(h=l[y]);return h},Ye.extract=function(l,h,y){h=Ee.clamp(h,0,l.length);var w=(y=Ee.clamp(y,-1,l.length))-h+1;y<0&&(w=0),h>=l.length&&(w=0),y<h&&(w=0);var D=new Array(w).fill(null);if(0===w)return D;for(var z=0,G=h;G<=y;G++)D[z++]=l[G];return D},Object.defineProperties(Ye,Nt);var _n=function(){};_n.prototype.compare=function(l,h){return Ye.compare(l,h)},_n.prototype.interfaces_=function(){return[Ae]},_n.prototype.getClass=function(){return _n};var Dn=function(){};Dn.prototype.compare=function(l,h){var y=l,w=h;if(y.length<w.length)return-1;if(y.length>w.length)return 1;if(0===y.length)return 0;var D=Ye.compare(y,w);return Ye.isEqualReversed(y,w)?0:D},Dn.prototype.OLDcompare=function(l,h){var y=l,w=h;if(y.length<w.length)return-1;if(y.length>w.length)return 1;if(0===y.length)return 0;for(var D=Ye.increasingDirection(y),z=Ye.increasingDirection(w),G=D>0?0:y.length-1,ie=z>0?0:y.length-1,Oe=0;Oe<y.length;Oe++){var lt=y[G].compareTo(w[ie]);if(0!==lt)return lt;G+=D,ie+=z}return 0},Dn.prototype.interfaces_=function(){return[Ae]},Dn.prototype.getClass=function(){return Dn};var yn=function(){};yn.prototype.get=function(){},yn.prototype.put=function(){},yn.prototype.size=function(){},yn.prototype.values=function(){},yn.prototype.entrySet=function(){};var qi=function(l){function h(){l.apply(this,arguments)}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h}(yn);(m.prototype=new Error).name="OperationNotSupported",(xe.prototype=new se).contains=function(){};var Yi=function(l){function h(){l.call(this),this.array_=[],arguments[0]instanceof se&&this.addAll(arguments[0])}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.contains=function(y){for(var w=0,D=this.array_.length;w<D;w++)if(this.array_[w]===y)return!0;return!1},h.prototype.add=function(y){return!this.contains(y)&&(this.array_.push(y),!0)},h.prototype.addAll=function(y){for(var w=y.iterator();w.hasNext();)this.add(w.next());return!0},h.prototype.remove=function(y){throw new Error},h.prototype.size=function(){return this.array_.length},h.prototype.isEmpty=function(){return 0===this.array_.length},h.prototype.toArray=function(){for(var y=[],w=0,D=this.array_.length;w<D;w++)y.push(this.array_[w]);return y},h.prototype.iterator=function(){return new ji(this)},h}(xe),ji=function(l){function h(y){l.call(this),this.hashSet_=y,this.position_=0}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new at;return this.hashSet_.array_[this.position_++]},h.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},h.prototype.remove=function(){throw new m},h}(je),Fi=0;(Mt.prototype=new qi).get=function(l){for(var h=this.root_;null!==h;){var y=l.compareTo(h.key);if(y<0)h=h.left;else{if(!(y>0))return h.value;h=h.right}}return null},Mt.prototype.put=function(l,h){if(null===this.root_)return this.root_={key:l,value:h,left:null,right:null,parent:null,color:Fi,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var y,w,D=this.root_;do{if(y=D,(w=l.compareTo(D.key))<0)D=D.left;else{if(!(w>0)){var z=D.value;return D.value=h,z}D=D.right}}while(null!==D);var G={key:l,left:null,right:null,value:h,parent:y,color:Fi,getValue:function(){return this.value},getKey:function(){return this.key}};return w<0?y.left=G:y.right=G,this.fixAfterInsertion(G),this.size_++,null},Mt.prototype.fixAfterInsertion=function(l){for(l.color=1;null!=l&&l!==this.root_&&1===l.parent.color;)if(ct(l)===mt(ct(ct(l)))){var h=Xt(ct(ct(l)));1===He(h)?(tt(ct(l),Fi),tt(h,Fi),tt(ct(ct(l)),1),l=ct(ct(l))):(l===Xt(ct(l))&&(l=ct(l),this.rotateLeft(l)),tt(ct(l),Fi),tt(ct(ct(l)),1),this.rotateRight(ct(ct(l))))}else{var y=mt(ct(ct(l)));1===He(y)?(tt(ct(l),Fi),tt(y,Fi),tt(ct(ct(l)),1),l=ct(ct(l))):(l===mt(ct(l))&&(l=ct(l),this.rotateRight(l)),tt(ct(l),Fi),tt(ct(ct(l)),1),this.rotateLeft(ct(ct(l))))}this.root_.color=Fi},Mt.prototype.values=function(){var l=new ke,h=this.getFirstEntry();if(null!==h)for(l.add(h.value);null!==(h=Mt.successor(h));)l.add(h.value);return l},Mt.prototype.entrySet=function(){var l=new Yi,h=this.getFirstEntry();if(null!==h)for(l.add(h);null!==(h=Mt.successor(h));)l.add(h);return l},Mt.prototype.rotateLeft=function(l){if(null!=l){var h=l.right;l.right=h.left,null!=h.left&&(h.left.parent=l),h.parent=l.parent,null===l.parent?this.root_=h:l.parent.left===l?l.parent.left=h:l.parent.right=h,h.left=l,l.parent=h}},Mt.prototype.rotateRight=function(l){if(null!=l){var h=l.left;l.left=h.right,null!=h.right&&(h.right.parent=l),h.parent=l.parent,null===l.parent?this.root_=h:l.parent.right===l?l.parent.right=h:l.parent.left=h,h.right=l,l.parent=h}},Mt.prototype.getFirstEntry=function(){var l=this.root_;if(null!=l)for(;null!=l.left;)l=l.left;return l},Mt.successor=function(l){if(null===l)return null;if(null!==l.right){for(var h=l.right;null!==h.left;)h=h.left;return h}for(var y=l.parent,w=l;null!==y&&w===y.right;)w=y,y=y.parent;return y},Mt.prototype.size=function(){return this.size_};var or=function(){};or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},yt.prototype=new xe,(Rt.prototype=new yt).contains=function(l){for(var h=0,y=this.array_.length;h<y;h++)if(0===this.array_[h].compareTo(l))return!0;return!1},Rt.prototype.add=function(l){if(this.contains(l))return!1;for(var h=0,y=this.array_.length;h<y;h++)if(1===this.array_[h].compareTo(l))return this.array_.splice(h,0,l),!0;return this.array_.push(l),!0},Rt.prototype.addAll=function(l){for(var h=l.iterator();h.hasNext();)this.add(h.next());return!0},Rt.prototype.remove=function(l){throw new m},Rt.prototype.size=function(){return this.array_.length},Rt.prototype.isEmpty=function(){return 0===this.array_.length},Rt.prototype.toArray=function(){for(var l=[],h=0,y=this.array_.length;h<y;h++)l.push(this.array_[h]);return l},Rt.prototype.iterator=function(){return new dr(this)};var dr=function(l){this.treeSet_=l,this.position_=0};dr.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new at;return this.treeSet_.array_[this.position_++]},dr.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},dr.prototype.remove=function(){throw new m};var zo=function(){};zo.sort=function(){var l,h,y,D=arguments[0];if(1===arguments.length)D.sort(function(G,ie){return G.compareTo(ie)});else if(2===arguments.length)y=arguments[1],D.sort(function(G,ie){return y.compare(G,ie)});else if(3===arguments.length){(h=D.slice(arguments[1],arguments[2])).sort();var z=D.slice(0,arguments[1]).concat(h,D.slice(arguments[2],D.length));for(D.splice(0,D.length),l=0;l<z.length;l++)D.push(z[l])}else if(4===arguments.length)for(h=D.slice(arguments[1],arguments[2]),y=arguments[3],h.sort(function(G,ie){return y.compare(G,ie)}),z=D.slice(0,arguments[1]).concat(h,D.slice(arguments[2],D.length)),D.splice(0,D.length),l=0;l<z.length;l++)D.push(z[l])},zo.asList=function(l){for(var h=new ke,y=0,w=l.length;y<w;y++)h.add(l[y]);return h};var Vi=function(){},mo={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};mo.P.get=function(){return 0},mo.L.get=function(){return 1},mo.A.get=function(){return 2},mo.FALSE.get=function(){return-1},mo.TRUE.get=function(){return-2},mo.DONTCARE.get=function(){return-3},mo.SYM_FALSE.get=function(){return"F"},mo.SYM_TRUE.get=function(){return"T"},mo.SYM_DONTCARE.get=function(){return"*"},mo.SYM_P.get=function(){return"0"},mo.SYM_L.get=function(){return"1"},mo.SYM_A.get=function(){return"2"},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi},Vi.toDimensionSymbol=function(l){switch(l){case Vi.FALSE:return Vi.SYM_FALSE;case Vi.TRUE:return Vi.SYM_TRUE;case Vi.DONTCARE:return Vi.SYM_DONTCARE;case Vi.P:return Vi.SYM_P;case Vi.L:return Vi.SYM_L;case Vi.A:return Vi.SYM_A}throw new ge("Unknown dimension value: "+l)},Vi.toDimensionValue=function(l){switch(gt.toUpperCase(l)){case Vi.SYM_FALSE:return Vi.FALSE;case Vi.SYM_TRUE:return Vi.TRUE;case Vi.SYM_DONTCARE:return Vi.DONTCARE;case Vi.SYM_P:return Vi.P;case Vi.SYM_L:return Vi.L;case Vi.SYM_A:return Vi.A}throw new ge("Unknown dimension symbol: "+l)},Object.defineProperties(Vi,mo);var ta=function(){};ta.prototype.filter=function(l){},ta.prototype.interfaces_=function(){return[]},ta.prototype.getClass=function(){return ta};var wo=function(){};wo.prototype.filter=function(l,h){},wo.prototype.isDone=function(){},wo.prototype.isGeometryChanged=function(){},wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo};var go=function(l){function h(w,D){if(l.call(this,D),this._geometries=w||[],l.hasNullElements(this._geometries))throw new ge("geometries must not contain null elements")}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.computeEnvelopeInternal=function(){for(var w=new mn,D=0;D<this._geometries.length;D++)w.expandToInclude(this._geometries[D].getEnvelopeInternal());return w},h.prototype.getGeometryN=function(w){return this._geometries[w]},h.prototype.getSortIndex=function(){return l.SORTINDEX_GEOMETRYCOLLECTION},h.prototype.getCoordinates=function(){for(var w=new Array(this.getNumPoints()).fill(null),D=-1,z=0;z<this._geometries.length;z++)for(var G=this._geometries[z].getCoordinates(),ie=0;ie<G.length;ie++)w[++D]=G[ie];return w},h.prototype.getArea=function(){for(var w=0,D=0;D<this._geometries.length;D++)w+=this._geometries[D].getArea();return w},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];if(!this.isEquivalentClass(w))return!1;var z=w;if(this._geometries.length!==z._geometries.length)return!1;for(var G=0;G<this._geometries.length;G++)if(!this._geometries[G].equalsExact(z._geometries[G],D))return!1;return!0}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.normalize=function(){for(var w=0;w<this._geometries.length;w++)this._geometries[w].normalize();zo.sort(this._geometries)},h.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},h.prototype.getBoundaryDimension=function(){for(var w=Vi.FALSE,D=0;D<this._geometries.length;D++)w=Math.max(w,this._geometries[D].getBoundaryDimension());return w},h.prototype.getDimension=function(){for(var w=Vi.FALSE,D=0;D<this._geometries.length;D++)w=Math.max(w,this._geometries[D].getDimension());return w},h.prototype.getLength=function(){for(var w=0,D=0;D<this._geometries.length;D++)w+=this._geometries[D].getLength();return w},h.prototype.getNumPoints=function(){for(var w=0,D=0;D<this._geometries.length;D++)w+=this._geometries[D].getNumPoints();return w},h.prototype.getNumGeometries=function(){return this._geometries.length},h.prototype.reverse=function(){for(var D=new Array(this._geometries.length).fill(null),z=0;z<this._geometries.length;z++)D[z]=this._geometries[z].reverse();return this.getFactory().createGeometryCollection(D)},h.prototype.compareToSameClass=function(){if(1===arguments.length){var w=arguments[0],D=new Rt(zo.asList(this._geometries)),z=new Rt(zo.asList(w._geometries));return this.compare(D,z)}if(2===arguments.length){for(var ie=arguments[1],Oe=arguments[0],lt=this.getNumGeometries(),kt=Oe.getNumGeometries(),Zt=0;Zt<lt&&Zt<kt;){var Un=this.getGeometryN(Zt),Fn=Oe.getGeometryN(Zt),Xn=Un.compareToSameClass(Fn,ie);if(0!==Xn)return Xn;Zt++}return Zt<lt?1:Zt<kt?-1:0}},h.prototype.apply=function(){if(Lt(arguments[0],nr))for(var w=arguments[0],D=0;D<this._geometries.length;D++)this._geometries[D].apply(w);else if(Lt(arguments[0],wo)){var z=arguments[0];if(0===this._geometries.length)return null;for(var G=0;G<this._geometries.length&&(this._geometries[G].apply(z),!z.isDone());G++);z.isGeometryChanged()&&this.geometryChanged()}else if(Lt(arguments[0],ta)){var ie=arguments[0];ie.filter(this);for(var Oe=0;Oe<this._geometries.length;Oe++)this._geometries[Oe].apply(ie)}else if(Lt(arguments[0],Ni)){var lt=arguments[0];lt.filter(this);for(var kt=0;kt<this._geometries.length;kt++)this._geometries[kt].apply(lt)}},h.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),le.shouldNeverReachHere(),null},h.prototype.clone=function(){var w=l.prototype.clone.call(this);w._geometries=new Array(this._geometries.length).fill(null);for(var D=0;D<this._geometries.length;D++)w._geometries[D]=this._geometries[D].clone();return w},h.prototype.getGeometryType=function(){return"GeometryCollection"},h.prototype.copy=function(){for(var w=new Array(this._geometries.length).fill(null),D=0;D<w.length;D++)w[D]=this._geometries[D].copy();return new h(w,this._factory)},h.prototype.isEmpty=function(){for(var w=0;w<this._geometries.length;w++)if(!this._geometries[w].isEmpty())return!1;return!0},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(h,y),h}(Nn),Ll=function(l){function h(){l.apply(this,arguments)}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.getSortIndex=function(){return Nn.SORTINDEX_MULTILINESTRING},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];return!!this.isEquivalentClass(w)&&l.prototype.equalsExact.call(this,w,D)}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.getBoundaryDimension=function(){return this.isClosed()?Vi.FALSE:0},h.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var w=0;w<this._geometries.length;w++)if(!this._geometries[w].isClosed())return!1;return!0},h.prototype.getDimension=function(){return 1},h.prototype.reverse=function(){for(var w=this._geometries.length,D=new Array(w).fill(null),z=0;z<this._geometries.length;z++)D[w-1-z]=this._geometries[z].reverse();return this.getFactory().createMultiLineString(D)},h.prototype.getBoundary=function(){return new Hs(this).getBoundary()},h.prototype.getGeometryType=function(){return"MultiLineString"},h.prototype.copy=function(){for(var w=new Array(this._geometries.length).fill(null),D=0;D<w.length;D++)w[D]=this._geometries[D].copy();return new h(w,this._factory)},h.prototype.interfaces_=function(){return[or]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(h,y),h}(go),Hs=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var l=arguments[0],h=cr.MOD2_BOUNDARY_RULE;this._geom=l,this._geomFact=l.getFactory(),this._bnRule=h}else if(2===arguments.length){var y=arguments[0],w=arguments[1];this._geom=y,this._geomFact=y.getFactory(),this._bnRule=w}};Hs.prototype.boundaryMultiLineString=function(l){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var h=this.computeBoundaryCoordinates(l);return 1===h.length?this._geomFact.createPoint(h[0]):this._geomFact.createMultiPointFromCoords(h)},Hs.prototype.getBoundary=function(){return this._geom instanceof Yo?this.boundaryLineString(this._geom):this._geom instanceof Ll?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Hs.prototype.boundaryLineString=function(l){return this._geom.isEmpty()?this.getEmptyMultiPoint():l.isClosed()?this._bnRule.isInBoundary(2)?l.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([l.getStartPoint(),l.getEndPoint()])},Hs.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Hs.prototype.computeBoundaryCoordinates=function(l){var h=new ke;this._endpointMap=new Mt;for(var y=0;y<l.getNumGeometries();y++){var w=l.getGeometryN(y);0!==w.getNumPoints()&&(this.addEndpoint(w.getCoordinateN(0)),this.addEndpoint(w.getCoordinateN(w.getNumPoints()-1)))}for(var D=this._endpointMap.entrySet().iterator();D.hasNext();){var z=D.next(),G=z.getValue().count;this._bnRule.isInBoundary(G)&&h.add(z.getKey())}return Ye.toCoordinateArray(h)},Hs.prototype.addEndpoint=function(l){var h=this._endpointMap.get(l);null===h&&(h=new Vd,this._endpointMap.put(l,h)),h.count++},Hs.prototype.interfaces_=function(){return[]},Hs.prototype.getClass=function(){return Hs},Hs.getBoundary=function(){return 1===arguments.length?new Hs(arguments[0]).getBoundary():2===arguments.length?new Hs(arguments[0],arguments[1]).getBoundary():void 0};var Vd=function(){this.count=null};Vd.prototype.interfaces_=function(){return[]},Vd.prototype.getClass=function(){return Vd};var _i=function(){},kc={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},_i.chars=function(l,h){for(var y=new Array(h).fill(null),w=0;w<h;w++)y[w]=l;return String(y)},_i.getStackTrace=function(){if(1===arguments.length){var l=arguments[0],h=new function(){},y=new function(){}(h);return l.printStackTrace(y),h.toString()}if(2===arguments.length){for(var D=arguments[1],z="",G=new function(){}(new function(){}(_i.getStackTrace(arguments[0]))),ie=0;ie<D;ie++)try{z+=G.readLine()+_i.NEWLINE}catch(Oe){if(!(Oe instanceof pn))throw Oe;le.shouldNeverReachHere()}return z}},_i.split=function(l,h){for(var y=h.length,w=new ke,D=""+l,z=D.indexOf(h);z>=0;){var G=D.substring(0,z);w.add(G),z=(D=D.substring(z+y)).indexOf(h)}D.length>0&&w.add(D);for(var ie=new Array(w.size()).fill(null),Oe=0;Oe<ie.length;Oe++)ie[Oe]=w.get(Oe);return ie},_i.toString=function(){if(1===arguments.length)return _i.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},_i.spaces=function(l){return _i.chars(" ",l)},kc.NEWLINE.get=function(){return Kt.getProperty("line.separator")},kc.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(_i,kc);var Cr=function(){};Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr},Cr.copyCoord=function(l,h,y,w){for(var D=Math.min(l.getDimension(),y.getDimension()),z=0;z<D;z++)y.setOrdinate(w,z,l.getOrdinate(h,z))},Cr.isRing=function(l){var h=l.size();return 0===h||!(h<=3)&&l.getOrdinate(0,Ut.X)===l.getOrdinate(h-1,Ut.X)&&l.getOrdinate(0,Ut.Y)===l.getOrdinate(h-1,Ut.Y)},Cr.isEqual=function(l,h){var y=l.size();if(y!==h.size())return!1;for(var w=Math.min(l.getDimension(),h.getDimension()),D=0;D<y;D++)for(var z=0;z<w;z++){var G=l.getOrdinate(D,z),ie=h.getOrdinate(D,z);if(!(l.getOrdinate(D,z)===h.getOrdinate(D,z)||ue.isNaN(G)&&ue.isNaN(ie)))return!1}return!0},Cr.extend=function(l,h,y){var w=l.create(y,h.getDimension()),D=h.size();if(Cr.copy(h,0,w,0,D),D>0)for(var z=D;z<y;z++)Cr.copy(h,D-1,w,z,1);return w},Cr.reverse=function(l){for(var h=l.size()-1,y=Math.trunc(h/2),w=0;w<=y;w++)Cr.swap(l,w,h-w)},Cr.swap=function(l,h,y){if(h===y)return null;for(var w=0;w<l.getDimension();w++){var D=l.getOrdinate(h,w);l.setOrdinate(h,w,l.getOrdinate(y,w)),l.setOrdinate(y,w,D)}},Cr.copy=function(l,h,y,w,D){for(var z=0;z<D;z++)Cr.copyCoord(l,h+z,y,w+z)},Cr.toString=function(){if(1===arguments.length){var l=arguments[0],h=l.size();if(0===h)return"()";var y=l.getDimension(),w=new Re;w.append("(");for(var D=0;D<h;D++){D>0&&w.append(" ");for(var z=0;z<y;z++)z>0&&w.append(","),w.append(_i.toString(l.getOrdinate(D,z)))}return w.append(")"),w.toString()}},Cr.ensureValidRing=function(l,h){var y=h.size();return 0===y?h:y<=3?Cr.createClosedRing(l,h,4):h.getOrdinate(0,Ut.X)===h.getOrdinate(y-1,Ut.X)&&h.getOrdinate(0,Ut.Y)===h.getOrdinate(y-1,Ut.Y)?h:Cr.createClosedRing(l,h,y+1)},Cr.createClosedRing=function(l,h,y){var w=l.create(y,h.getDimension()),D=h.size();Cr.copy(h,0,w,0,D);for(var z=D;z<y;z++)Cr.copy(h,0,w,z,1);return w};var Yo=function(l){function h(w,D){l.call(this,D),this._points=null,this.init(w)}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new mn:this._points.expandEnvelope(new mn)},h.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},h.prototype.getSortIndex=function(){return l.SORTINDEX_LINESTRING},h.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];if(!this.isEquivalentClass(w))return!1;var z=w;if(this._points.size()!==z._points.size())return!1;for(var G=0;G<this._points.size();G++)if(!this.equal(this._points.getCoordinate(G),z._points.getCoordinate(G),D))return!1;return!0}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.normalize=function(){for(var w=0;w<Math.trunc(this._points.size()/2);w++){var D=this._points.size()-1-w;if(!this._points.getCoordinate(w).equals(this._points.getCoordinate(D)))return this._points.getCoordinate(w).compareTo(this._points.getCoordinate(D))>0&&Cr.reverse(this._points),null}},h.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},h.prototype.getBoundaryDimension=function(){return this.isClosed()?Vi.FALSE:0},h.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},h.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},h.prototype.getDimension=function(){return 1},h.prototype.getLength=function(){return Wt.computeLength(this._points)},h.prototype.getNumPoints=function(){return this._points.size()},h.prototype.reverse=function(){var w=this._points.copy();return Cr.reverse(w),this.getFactory().createLineString(w)},h.prototype.compareToSameClass=function(){if(1===arguments.length){for(var w=arguments[0],D=0,z=0;D<this._points.size()&&z<w._points.size();){var G=this._points.getCoordinate(D).compareTo(w._points.getCoordinate(z));if(0!==G)return G;D++,z++}return D<this._points.size()?1:z<w._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},h.prototype.apply=function(){if(Lt(arguments[0],nr))for(var w=arguments[0],D=0;D<this._points.size();D++)w.filter(this._points.getCoordinate(D));else if(Lt(arguments[0],wo)){var z=arguments[0];if(0===this._points.size())return null;for(var G=0;G<this._points.size()&&(z.filter(this._points,G),!z.isDone());G++);z.isGeometryChanged()&&this.geometryChanged()}else(Lt(arguments[0],ta)||Lt(arguments[0],Ni))&&arguments[0].filter(this)},h.prototype.getBoundary=function(){return new Hs(this).getBoundary()},h.prototype.isEquivalentClass=function(w){return w instanceof h},h.prototype.clone=function(){var w=l.prototype.clone.call(this);return w._points=this._points.clone(),w},h.prototype.getCoordinateN=function(w){return this._points.getCoordinate(w)},h.prototype.getGeometryType=function(){return"LineString"},h.prototype.copy=function(){return new h(this._points.copy(),this._factory)},h.prototype.getCoordinateSequence=function(){return this._points},h.prototype.isEmpty=function(){return 0===this._points.size()},h.prototype.init=function(w){if(null===w&&(w=this.getFactory().getCoordinateSequenceFactory().create([])),1===w.size())throw new ge("Invalid number of points in LineString (found "+w.size()+" - must be 0 or >= 2)");this._points=w},h.prototype.isCoordinate=function(w){for(var D=0;D<this._points.size();D++)if(this._points.getCoordinate(D).equals(w))return!0;return!1},h.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},h.prototype.getPointN=function(w){return this.getFactory().createPoint(this._points.getCoordinate(w))},h.prototype.interfaces_=function(){return[or]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(h,y),h}(Nn),Iu=function(){};Iu.prototype.interfaces_=function(){return[]},Iu.prototype.getClass=function(){return Iu};var is=function(l){function h(w,D){l.call(this,D),this._coordinates=w||null,this.init(this._coordinates)}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new mn;var w=new mn;return w.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),w},h.prototype.getSortIndex=function(){return l.SORTINDEX_POINT},h.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];return!!this.isEquivalentClass(w)&&(!(!this.isEmpty()||!w.isEmpty())||this.isEmpty()===w.isEmpty()&&this.equal(w.getCoordinate(),this.getCoordinate(),D))}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.normalize=function(){},h.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},h.prototype.getBoundaryDimension=function(){return Vi.FALSE},h.prototype.getDimension=function(){return 0},h.prototype.getNumPoints=function(){return this.isEmpty()?0:1},h.prototype.reverse=function(){return this.copy()},h.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},h.prototype.compareToSameClass=function(){if(1===arguments.length){var w=arguments[0];return this.getCoordinate().compareTo(w.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},h.prototype.apply=function(){if(Lt(arguments[0],nr)){var w=arguments[0];if(this.isEmpty())return null;w.filter(this.getCoordinate())}else if(Lt(arguments[0],wo)){var D=arguments[0];if(this.isEmpty())return null;D.filter(this._coordinates,0),D.isGeometryChanged()&&this.geometryChanged()}else(Lt(arguments[0],ta)||Lt(arguments[0],Ni))&&arguments[0].filter(this)},h.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},h.prototype.clone=function(){var w=l.prototype.clone.call(this);return w._coordinates=this._coordinates.clone(),w},h.prototype.getGeometryType=function(){return"Point"},h.prototype.copy=function(){return new h(this._coordinates.copy(),this._factory)},h.prototype.getCoordinateSequence=function(){return this._coordinates},h.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},h.prototype.isEmpty=function(){return 0===this._coordinates.size()},h.prototype.init=function(w){null===w&&(w=this.getFactory().getCoordinateSequenceFactory().create([])),le.isTrue(w.size()<=1),this._coordinates=w},h.prototype.isSimple=function(){return!0},h.prototype.interfaces_=function(){return[Iu]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(h,y),h}(Nn),xa=function(){};xa.prototype.interfaces_=function(){return[]},xa.prototype.getClass=function(){return xa};var rs=function(l){function h(w,D,z){if(l.call(this,z),this._shell=null,this._holes=null,null===w&&(w=this.getFactory().createLinearRing()),null===D&&(D=[]),l.hasNullElements(D))throw new ge("holes must not contain null elements");if(w.isEmpty()&&l.hasNonEmptyElements(D))throw new ge("shell is empty but holes are not");this._shell=w,this._holes=D}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},h.prototype.getSortIndex=function(){return l.SORTINDEX_POLYGON},h.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var w=new Array(this.getNumPoints()).fill(null),D=-1,z=this._shell.getCoordinates(),G=0;G<z.length;G++)w[++D]=z[G];for(var ie=0;ie<this._holes.length;ie++)for(var Oe=this._holes[ie].getCoordinates(),lt=0;lt<Oe.length;lt++)w[++D]=Oe[lt];return w},h.prototype.getArea=function(){var w=0;w+=Math.abs(Wt.signedArea(this._shell.getCoordinateSequence()));for(var D=0;D<this._holes.length;D++)w-=Math.abs(Wt.signedArea(this._holes[D].getCoordinateSequence()));return w},h.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var w=this._shell.getCoordinateSequence(),D=this.getEnvelopeInternal(),z=0;z<5;z++){var G=w.getX(z);if(G!==D.getMinX()&&G!==D.getMaxX())return!1;var ie=w.getY(z);if(ie!==D.getMinY()&&ie!==D.getMaxY())return!1}for(var Oe=w.getX(0),lt=w.getY(0),kt=1;kt<=4;kt++){var Zt=w.getX(kt),Un=w.getY(kt);if(Zt!==Oe==(Un!==lt))return!1;Oe=Zt,lt=Un}return!0},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];if(!this.isEquivalentClass(w))return!1;var z=w;if(!this._shell.equalsExact(z._shell,D)||this._holes.length!==z._holes.length)return!1;for(var Oe=0;Oe<this._holes.length;Oe++)if(!this._holes[Oe].equalsExact(z._holes[Oe],D))return!1;return!0}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var w=0;w<this._holes.length;w++)this.normalize(this._holes[w],!1);zo.sort(this._holes)}else if(2===arguments.length){var D=arguments[0],z=arguments[1];if(D.isEmpty())return null;var G=new Array(D.getCoordinates().length-1).fill(null);Kt.arraycopy(D.getCoordinates(),0,G,0,G.length);var ie=Ye.minCoordinate(D.getCoordinates());Ye.scroll(G,ie),Kt.arraycopy(G,0,D.getCoordinates(),0,G.length),D.getCoordinates()[G.length]=G[0],Wt.isCCW(D.getCoordinates())===z&&Ye.reverse(D.getCoordinates())}},h.prototype.getCoordinate=function(){return this._shell.getCoordinate()},h.prototype.getNumInteriorRing=function(){return this._holes.length},h.prototype.getBoundaryDimension=function(){return 1},h.prototype.getDimension=function(){return 2},h.prototype.getLength=function(){var w=0;w+=this._shell.getLength();for(var D=0;D<this._holes.length;D++)w+=this._holes[D].getLength();return w},h.prototype.getNumPoints=function(){for(var w=this._shell.getNumPoints(),D=0;D<this._holes.length;D++)w+=this._holes[D].getNumPoints();return w},h.prototype.reverse=function(){var w=this.copy();w._shell=this._shell.copy().reverse(),w._holes=new Array(this._holes.length).fill(null);for(var D=0;D<this._holes.length;D++)w._holes[D]=this._holes[D].copy().reverse();return w},h.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},h.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var ie=arguments[1],Oe=arguments[0],Zt=this._shell.compareToSameClass(Oe._shell,ie);if(0!==Zt)return Zt;for(var Un=this.getNumInteriorRing(),Fn=Oe.getNumInteriorRing(),Xn=0;Xn<Un&&Xn<Fn;){var hi=this.getInteriorRingN(Xn),Sr=Oe.getInteriorRingN(Xn),On=hi.compareToSameClass(Sr,ie);if(0!==On)return On;Xn++}return Xn<Un?1:Xn<Fn?-1:0}},h.prototype.apply=function(w){if(Lt(w,nr)){this._shell.apply(w);for(var D=0;D<this._holes.length;D++)this._holes[D].apply(w)}else if(Lt(w,wo)){if(this._shell.apply(w),!w.isDone())for(var z=0;z<this._holes.length&&(this._holes[z].apply(w),!w.isDone());z++);w.isGeometryChanged()&&this.geometryChanged()}else if(Lt(w,ta))w.filter(this);else if(Lt(w,Ni)){w.filter(this),this._shell.apply(w);for(var G=0;G<this._holes.length;G++)this._holes[G].apply(w)}},h.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var w=new Array(this._holes.length+1).fill(null);w[0]=this._shell;for(var D=0;D<this._holes.length;D++)w[D+1]=this._holes[D];return w.length<=1?this.getFactory().createLinearRing(w[0].getCoordinateSequence()):this.getFactory().createMultiLineString(w)},h.prototype.clone=function(){var w=l.prototype.clone.call(this);w._shell=this._shell.clone(),w._holes=new Array(this._holes.length).fill(null);for(var D=0;D<this._holes.length;D++)w._holes[D]=this._holes[D].clone();return w},h.prototype.getGeometryType=function(){return"Polygon"},h.prototype.copy=function(){for(var w=this._shell.copy(),D=new Array(this._holes.length).fill(null),z=0;z<D.length;z++)D[z]=this._holes[z].copy();return new h(w,D,this._factory)},h.prototype.getExteriorRing=function(){return this._shell},h.prototype.isEmpty=function(){return this._shell.isEmpty()},h.prototype.getInteriorRingN=function(w){return this._holes[w]},h.prototype.interfaces_=function(){return[xa]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(h,y),h}(Nn),ic=function(l){function h(){l.apply(this,arguments)}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.getSortIndex=function(){return Nn.SORTINDEX_MULTIPOINT},h.prototype.isValid=function(){return!0},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];return!!this.isEquivalentClass(w)&&l.prototype.equalsExact.call(this,w,D)}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():l.prototype.getCoordinate.apply(this,arguments)},h.prototype.getBoundaryDimension=function(){return Vi.FALSE},h.prototype.getDimension=function(){return 0},h.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},h.prototype.getGeometryType=function(){return"MultiPoint"},h.prototype.copy=function(){for(var w=new Array(this._geometries.length).fill(null),D=0;D<w.length;D++)w[D]=this._geometries[D].copy();return new h(w,this._factory)},h.prototype.interfaces_=function(){return[Iu]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(h,y),h}(go),ka=function(l){function h(w,D){w instanceof ne&&D instanceof gi&&(w=D.getCoordinateSequenceFactory().create(w)),l.call(this,w,D),this.validateConstruction()}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return h.prototype.getSortIndex=function(){return Nn.SORTINDEX_LINEARRING},h.prototype.getBoundaryDimension=function(){return Vi.FALSE},h.prototype.isClosed=function(){return!!this.isEmpty()||l.prototype.isClosed.call(this)},h.prototype.reverse=function(){var w=this._points.copy();return Cr.reverse(w),this.getFactory().createLinearRing(w)},h.prototype.validateConstruction=function(){if(!this.isEmpty()&&!l.prototype.isClosed.call(this))throw new ge("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<h.MINIMUM_VALID_SIZE)throw new ge("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},h.prototype.getGeometryType=function(){return"LinearRing"},h.prototype.copy=function(){return new h(this._points.copy(),this._factory)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},y.MINIMUM_VALID_SIZE.get=function(){return 4},y.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(h,y),h}(Yo),da=function(l){function h(){l.apply(this,arguments)}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={serialVersionUID:{configurable:!0}};return h.prototype.getSortIndex=function(){return Nn.SORTINDEX_MULTIPOLYGON},h.prototype.equalsExact=function(){if(2===arguments.length){var w=arguments[0],D=arguments[1];return!!this.isEquivalentClass(w)&&l.prototype.equalsExact.call(this,w,D)}return l.prototype.equalsExact.apply(this,arguments)},h.prototype.getBoundaryDimension=function(){return 1},h.prototype.getDimension=function(){return 2},h.prototype.reverse=function(){for(var D=new Array(this._geometries.length).fill(null),z=0;z<this._geometries.length;z++)D[z]=this._geometries[z].reverse();return this.getFactory().createMultiPolygon(D)},h.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var w=new ke,D=0;D<this._geometries.length;D++)for(var z=this._geometries[D].getBoundary(),G=0;G<z.getNumGeometries();G++)w.add(z.getGeometryN(G));var ie=new Array(w.size()).fill(null);return this.getFactory().createMultiLineString(w.toArray(ie))},h.prototype.getGeometryType=function(){return"MultiPolygon"},h.prototype.copy=function(){for(var w=new Array(this._geometries.length).fill(null),D=0;D<w.length;D++)w[D]=this._geometries[D].copy();return new h(w,this._factory)},h.prototype.interfaces_=function(){return[xa]},h.prototype.getClass=function(){return h},y.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(h,y),h}(go),ba=function(l){this._factory=l||null,this._isUserDataCopied=!1},Qt={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ba.prototype.setCopyUserData=function(l){this._isUserDataCopied=l},ba.prototype.edit=function(l,h){if(null===l)return null;var y=this.editInternal(l,h);return this._isUserDataCopied&&y.setUserData(l.getUserData()),y},ba.prototype.editInternal=function(l,h){return null===this._factory&&(this._factory=l.getFactory()),l instanceof go?this.editGeometryCollection(l,h):l instanceof rs?this.editPolygon(l,h):l instanceof is||l instanceof Yo?h.edit(l,this._factory):(le.shouldNeverReachHere("Unsupported Geometry class: "+l.getClass().getName()),null)},ba.prototype.editGeometryCollection=function(l,h){for(var y=h.edit(l,this._factory),w=new ke,D=0;D<y.getNumGeometries();D++){var z=this.edit(y.getGeometryN(D),h);null===z||z.isEmpty()||w.add(z)}return y.getClass()===ic?this._factory.createMultiPoint(w.toArray([])):y.getClass()===Ll?this._factory.createMultiLineString(w.toArray([])):y.getClass()===da?this._factory.createMultiPolygon(w.toArray([])):this._factory.createGeometryCollection(w.toArray([]))},ba.prototype.editPolygon=function(l,h){var y=h.edit(l,this._factory);if(null===y&&(y=this._factory.createPolygon(null)),y.isEmpty())return y;var w=this.edit(y.getExteriorRing(),h);if(null===w||w.isEmpty())return this._factory.createPolygon();for(var D=new ke,z=0;z<y.getNumInteriorRing();z++){var G=this.edit(y.getInteriorRingN(z),h);null===G||G.isEmpty()||D.add(G)}return this._factory.createPolygon(w,D.toArray([]))},ba.prototype.interfaces_=function(){return[]},ba.prototype.getClass=function(){return ba},ba.GeometryEditorOperation=function(){},Qt.NoOpGeometryOperation.get=function(){return Nl},Qt.CoordinateOperation.get=function(){return fs},Qt.CoordinateSequenceOperation.get=function(){return qs},Object.defineProperties(ba,Qt);var Nl=function(){};Nl.prototype.edit=function(l,h){return l},Nl.prototype.interfaces_=function(){return[ba.GeometryEditorOperation]},Nl.prototype.getClass=function(){return Nl};var fs=function(){};fs.prototype.edit=function(l,h){var y=this.editCoordinates(l.getCoordinates(),l);return null===y?l:l instanceof ka?h.createLinearRing(y):l instanceof Yo?h.createLineString(y):l instanceof is?y.length>0?h.createPoint(y[0]):h.createPoint():l},fs.prototype.interfaces_=function(){return[ba.GeometryEditorOperation]},fs.prototype.getClass=function(){return fs};var qs=function(){};qs.prototype.edit=function(l,h){return l instanceof ka?h.createLinearRing(this.edit(l.getCoordinateSequence(),l)):l instanceof Yo?h.createLineString(this.edit(l.getCoordinateSequence(),l)):l instanceof is?h.createPoint(this.edit(l.getCoordinateSequence(),l)):l},qs.prototype.interfaces_=function(){return[ba.GeometryEditorOperation]},qs.prototype.getClass=function(){return qs};var Ko=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var l=arguments[0];this._coordinates=new Array(l).fill(null);for(var h=0;h<l;h++)this._coordinates[h]=new ne}else if(Lt(arguments[0],Ut)){var y=arguments[0];if(null===y)return this._coordinates=new Array(0).fill(null),null;this._dimension=y.getDimension(),this._coordinates=new Array(y.size()).fill(null);for(var w=0;w<this._coordinates.length;w++)this._coordinates[w]=y.getCoordinateCopy(w)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var D=arguments[0],z=arguments[1];this._coordinates=D,this._dimension=z,null===D&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var G=arguments[0],ie=arguments[1];this._coordinates=new Array(G).fill(null),this._dimension=ie;for(var Oe=0;Oe<G;Oe++)this._coordinates[Oe]=new ne}},bc={serialVersionUID:{configurable:!0}};Ko.prototype.setOrdinate=function(l,h,y){switch(h){case Ut.X:this._coordinates[l].x=y;break;case Ut.Y:this._coordinates[l].y=y;break;case Ut.Z:this._coordinates[l].z=y;break;default:throw new ge("invalid ordinateIndex")}},Ko.prototype.size=function(){return this._coordinates.length},Ko.prototype.getOrdinate=function(l,h){switch(h){case Ut.X:return this._coordinates[l].x;case Ut.Y:return this._coordinates[l].y;case Ut.Z:return this._coordinates[l].z}return ue.NaN},Ko.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var h=arguments[0],y=arguments[1];y.x=this._coordinates[h].x,y.y=this._coordinates[h].y,y.z=this._coordinates[h].z}},Ko.prototype.getCoordinateCopy=function(l){return new ne(this._coordinates[l])},Ko.prototype.getDimension=function(){return this._dimension},Ko.prototype.getX=function(l){return this._coordinates[l].x},Ko.prototype.clone=function(){for(var l=new Array(this.size()).fill(null),h=0;h<this._coordinates.length;h++)l[h]=this._coordinates[h].clone();return new Ko(l,this._dimension)},Ko.prototype.expandEnvelope=function(l){for(var h=0;h<this._coordinates.length;h++)l.expandToInclude(this._coordinates[h]);return l},Ko.prototype.copy=function(){for(var l=new Array(this.size()).fill(null),h=0;h<this._coordinates.length;h++)l[h]=this._coordinates[h].copy();return new Ko(l,this._dimension)},Ko.prototype.toString=function(){if(this._coordinates.length>0){var l=new Re(17*this._coordinates.length);l.append("("),l.append(this._coordinates[0]);for(var h=1;h<this._coordinates.length;h++)l.append(", "),l.append(this._coordinates[h]);return l.append(")"),l.toString()}return"()"},Ko.prototype.getY=function(l){return this._coordinates[l].y},Ko.prototype.toCoordinateArray=function(){return this._coordinates},Ko.prototype.interfaces_=function(){return[Ut,be]},Ko.prototype.getClass=function(){return Ko},bc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ko,bc);var Fl=function(){},Ws={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Fl.prototype.readResolve=function(){return Fl.instance()},Fl.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Ko(arguments[0]);if(Lt(arguments[0],Ut))return new Ko(arguments[0])}else if(2===arguments.length){var y=arguments[0],w=arguments[1];return w>3&&(w=3),w<2?new Ko(y):new Ko(y,w)}},Fl.prototype.interfaces_=function(){return[Ke,be]},Fl.prototype.getClass=function(){return Fl},Fl.instance=function(){return Fl.instanceObject},Ws.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Ws.instanceObject.get=function(){return new Fl},Object.defineProperties(Fl,Ws);var eu=function(l){function h(){l.call(this),this.map_=new Map}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.get=function(y){return this.map_.get(y)||null},h.prototype.put=function(y,w){return this.map_.set(y,w),w},h.prototype.values=function(){for(var y=new ke,w=this.map_.values(),D=w.next();!D.done;)y.add(D.value),D=w.next();return y},h.prototype.entrySet=function(){var y=new Yi;return this.map_.entries().forEach(function(w){return y.add(w)}),y},h.prototype.size=function(){return this.map_.size()},h}(yn),tn=function l(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=l.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Ai){var h=arguments[0];this._modelType=h,h===l.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var y=arguments[0];this._modelType=l.FIXED,this.setScale(y)}else if(arguments[0]instanceof l){var w=arguments[0];this._modelType=w._modelType,this._scale=w._scale}},Ln={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};tn.prototype.equals=function(l){return l instanceof tn&&this._modelType===l._modelType&&this._scale===l._scale},tn.prototype.compareTo=function(l){var h=l,y=this.getMaximumSignificantDigits(),w=h.getMaximumSignificantDigits();return new it(y).compareTo(new it(w))},tn.prototype.getScale=function(){return this._scale},tn.prototype.isFloating=function(){return this._modelType===tn.FLOATING||this._modelType===tn.FLOATING_SINGLE},tn.prototype.getType=function(){return this._modelType},tn.prototype.toString=function(){var l="UNKNOWN";return this._modelType===tn.FLOATING?l="Floating":this._modelType===tn.FLOATING_SINGLE?l="Floating-Single":this._modelType===tn.FIXED&&(l="Fixed (Scale="+this.getScale()+")"),l},tn.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var l=arguments[0];return ue.isNaN(l)||this._modelType===tn.FLOATING_SINGLE?l:this._modelType===tn.FIXED?Math.round(l*this._scale)/this._scale:l}if(arguments[0]instanceof ne){var h=arguments[0];if(this._modelType===tn.FLOATING)return null;h.x=this.makePrecise(h.x),h.y=this.makePrecise(h.y)}},tn.prototype.getMaximumSignificantDigits=function(){var l=16;return this._modelType===tn.FLOATING?l=16:this._modelType===tn.FLOATING_SINGLE?l=6:this._modelType===tn.FIXED&&(l=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),l},tn.prototype.setScale=function(l){this._scale=Math.abs(l)},tn.prototype.interfaces_=function(){return[be,de]},tn.prototype.getClass=function(){return tn},tn.mostPrecise=function(l,h){return l.compareTo(h)>=0?l:h},Ln.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Ln.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(tn,Ln);var Ai=function l(h){this._name=h||null,l.nameToTypeMap.put(h,this)},La={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ai.prototype.readResolve=function(){return Ai.nameToTypeMap.get(this._name)},Ai.prototype.toString=function(){return this._name},Ai.prototype.interfaces_=function(){return[be]},Ai.prototype.getClass=function(){return Ai},La.serialVersionUID.get=function(){return-552860263173159e4},La.nameToTypeMap.get=function(){return new eu},Object.defineProperties(Ai,La),tn.Type=Ai,tn.FIXED=new Ai("FIXED"),tn.FLOATING=new Ai("FLOATING"),tn.FLOATING_SINGLE=new Ai("FLOATING SINGLE");var gi=function l(){this._precisionModel=new tn,this._SRID=0,this._coordinateSequenceFactory=l.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Lt(arguments[0],Ke)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof tn&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},sr={serialVersionUID:{configurable:!0}};gi.prototype.toGeometry=function(l){return l.isNull()?this.createPoint(null):l.getMinX()===l.getMaxX()&&l.getMinY()===l.getMaxY()?this.createPoint(new ne(l.getMinX(),l.getMinY())):l.getMinX()===l.getMaxX()||l.getMinY()===l.getMaxY()?this.createLineString([new ne(l.getMinX(),l.getMinY()),new ne(l.getMaxX(),l.getMaxY())]):this.createPolygon(this.createLinearRing([new ne(l.getMinX(),l.getMinY()),new ne(l.getMinX(),l.getMaxY()),new ne(l.getMaxX(),l.getMaxY()),new ne(l.getMaxX(),l.getMinY()),new ne(l.getMinX(),l.getMinY())]),null)},gi.prototype.createLineString=function(l){return l?l instanceof Array?new Yo(this.getCoordinateSequenceFactory().create(l),this):Lt(l,Ut)?new Yo(l,this):void 0:new Yo(this.getCoordinateSequenceFactory().create([]),this)},gi.prototype.createMultiLineString=function(){return 0===arguments.length?new Ll(null,this):1===arguments.length?new Ll(arguments[0],this):void 0},gi.prototype.buildGeometry=function(l){for(var h=null,y=!1,w=!1,D=l.iterator();D.hasNext();){var z=D.next(),G=z.getClass();null===h&&(h=G),G!==h&&(y=!0),z.isGeometryCollectionOrDerived()&&(w=!0)}if(null===h)return this.createGeometryCollection();if(y||w)return this.createGeometryCollection(gi.toGeometryArray(l));var ie=l.iterator().next();if(l.size()>1){if(ie instanceof rs)return this.createMultiPolygon(gi.toPolygonArray(l));if(ie instanceof Yo)return this.createMultiLineString(gi.toLineStringArray(l));if(ie instanceof is)return this.createMultiPoint(gi.toPointArray(l));le.shouldNeverReachHere("Unhandled class: "+ie.getClass().getName())}return ie},gi.prototype.createMultiPointFromCoords=function(l){return this.createMultiPoint(null!==l?this.getCoordinateSequenceFactory().create(l):null)},gi.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof ne){var l=arguments[0];return this.createPoint(null!==l?this.getCoordinateSequenceFactory().create([l]):null)}if(Lt(arguments[0],Ut))return new is(arguments[0],this)}},gi.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},gi.prototype.createPolygon=function(){if(0===arguments.length)return new rs(null,null,this);if(1===arguments.length){if(Lt(arguments[0],Ut))return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof ka)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new rs(arguments[0],arguments[1],this)},gi.prototype.getSRID=function(){return this._SRID},gi.prototype.createGeometryCollection=function(){return 0===arguments.length?new go(null,this):1===arguments.length?new go(arguments[0],this):void 0},gi.prototype.createGeometry=function(l){return new ba(this).edit(l,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},gi.prototype.getPrecisionModel=function(){return this._precisionModel},gi.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var l=arguments[0];return this.createLinearRing(null!==l?this.getCoordinateSequenceFactory().create(l):null)}if(Lt(arguments[0],Ut))return new ka(arguments[0],this)}},gi.prototype.createMultiPolygon=function(){return 0===arguments.length?new da(null,this):1===arguments.length?new da(arguments[0],this):void 0},gi.prototype.createMultiPoint=function(){if(0===arguments.length)return new ic(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ic(arguments[0],this);if(arguments[0]instanceof Array){var h=arguments[0];return this.createMultiPoint(null!==h?this.getCoordinateSequenceFactory().create(h):null)}if(Lt(arguments[0],Ut)){var y=arguments[0];if(null===y)return this.createMultiPoint(new Array(0).fill(null));for(var w=new Array(y.size()).fill(null),D=0;D<y.size();D++){var z=this.getCoordinateSequenceFactory().create(1,y.getDimension());Cr.copy(y,D,z,0,1),w[D]=this.createPoint(z)}return this.createMultiPoint(w)}}},gi.prototype.interfaces_=function(){return[be]},gi.prototype.getClass=function(){return gi},gi.toMultiPolygonArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.toGeometryArray=function(l){if(null===l)return null;var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.getDefaultCoordinateSequenceFactory=function(){return Fl.instance()},gi.toMultiLineStringArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.toLineStringArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.toMultiPointArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.toLinearRingArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.toPointArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.toPolygonArray=function(l){var h=new Array(l.size()).fill(null);return l.toArray(h)},gi.createPointFromInternalCoord=function(l,h){return h.getPrecisionModel().makePrecise(l),h.getFactory().createPoint(l)},sr.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(gi,sr);var Bl=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ir=function(l){this.geometryFactory=l||new gi};Ir.prototype.read=function(l){var h,y=(h="string"==typeof l?JSON.parse(l):l).type;if(!na[y])throw new Error("Unknown GeoJSON type: "+h.type);return-1!==Bl.indexOf(y)?na[y].apply(this,[h.coordinates]):na[y].apply(this,"GeometryCollection"===y?[h.geometries]:[h])},Ir.prototype.write=function(l){var h=l.getGeometryType();if(!br[h])throw new Error("Geometry is not supported");return br[h].apply(this,[l])};var na={Feature:function(l){var h={};for(var y in l)h[y]=l[y];if(l.geometry){if(!na[l.geometry.type])throw new Error("Unknown GeoJSON type: "+l.type);h.geometry=this.read(l.geometry)}return l.bbox&&(h.bbox=na.bbox.apply(this,[l.bbox])),h},FeatureCollection:function(l){var h={};if(l.features){h.features=[];for(var y=0;y<l.features.length;++y)h.features.push(this.read(l.features[y]))}return l.bbox&&(h.bbox=this.parse.bbox.apply(this,[l.bbox])),h},coordinates:function(l){for(var h=[],y=0;y<l.length;++y){var w=l[y];h.push(new ne(w[0],w[1]))}return h},bbox:function(l){return this.geometryFactory.createLinearRing([new ne(l[0],l[1]),new ne(l[2],l[1]),new ne(l[2],l[3]),new ne(l[0],l[3]),new ne(l[0],l[1])])},Point:function(l){var h=new ne(l[0],l[1]);return this.geometryFactory.createPoint(h)},MultiPoint:function(l){for(var h=[],y=0;y<l.length;++y)h.push(na.Point.apply(this,[l[y]]));return this.geometryFactory.createMultiPoint(h)},LineString:function(l){var h=na.coordinates.apply(this,[l]);return this.geometryFactory.createLineString(h)},MultiLineString:function(l){for(var h=[],y=0;y<l.length;++y)h.push(na.LineString.apply(this,[l[y]]));return this.geometryFactory.createMultiLineString(h)},Polygon:function(l){for(var h=na.coordinates.apply(this,[l[0]]),y=this.geometryFactory.createLinearRing(h),w=[],D=1;D<l.length;++D){var G=na.coordinates.apply(this,[l[D]]),ie=this.geometryFactory.createLinearRing(G);w.push(ie)}return this.geometryFactory.createPolygon(y,w)},MultiPolygon:function(l){for(var h=[],y=0;y<l.length;++y)h.push(na.Polygon.apply(this,[l[y]]));return this.geometryFactory.createMultiPolygon(h)},GeometryCollection:function(l){for(var h=[],y=0;y<l.length;++y)h.push(this.read(l[y]));return this.geometryFactory.createGeometryCollection(h)}},br={coordinate:function(l){return[l.x,l.y]},Point:function(l){return{type:"Point",coordinates:br.coordinate.apply(this,[l.getCoordinate()])}},MultiPoint:function(l){for(var h=[],y=0;y<l._geometries.length;++y){var D=br.Point.apply(this,[l._geometries[y]]);h.push(D.coordinates)}return{type:"MultiPoint",coordinates:h}},LineString:function(l){for(var h=[],y=l.getCoordinates(),w=0;w<y.length;++w)h.push(br.coordinate.apply(this,[y[w]]));return{type:"LineString",coordinates:h}},MultiLineString:function(l){for(var h=[],y=0;y<l._geometries.length;++y){var D=br.LineString.apply(this,[l._geometries[y]]);h.push(D.coordinates)}return{type:"MultiLineString",coordinates:h}},Polygon:function(l){var h=[],y=br.LineString.apply(this,[l._shell]);h.push(y.coordinates);for(var w=0;w<l._holes.length;++w){var z=br.LineString.apply(this,[l._holes[w]]);h.push(z.coordinates)}return{type:"Polygon",coordinates:h}},MultiPolygon:function(l){for(var h=[],y=0;y<l._geometries.length;++y){var D=br.Polygon.apply(this,[l._geometries[y]]);h.push(D.coordinates)}return{type:"MultiPolygon",coordinates:h}},GeometryCollection:function(l){for(var h=[],y=0;y<l._geometries.length;++y){var w=l._geometries[y],D=w.getGeometryType();h.push(br[D].apply(this,[w]))}return{type:"GeometryCollection",geometries:h}}},Io=function(l){this.geometryFactory=l||new gi,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ir(this.geometryFactory)};Io.prototype.read=function(l){var h=this.parser.read(l);return this.precisionModel.getType()===tn.FIXED&&this.reducePrecision(h),h},Io.prototype.reducePrecision=function(l){var h,y;if(l.coordinate)this.precisionModel.makePrecise(l.coordinate);else if(l.points)for(h=0,y=l.points.length;h<y;h++)this.precisionModel.makePrecise(l.points[h]);else if(l.geometries)for(h=0,y=l.geometries.length;h<y;h++)this.reducePrecision(l.geometries[h])};var hf=function(){this.parser=new Ir(this.geometryFactory)};hf.prototype.write=function(l){return this.parser.write(l)};var nn=function(){},Bi={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};nn.prototype.interfaces_=function(){return[]},nn.prototype.getClass=function(){return nn},nn.opposite=function(l){return l===nn.LEFT?nn.RIGHT:l===nn.RIGHT?nn.LEFT:l},Bi.ON.get=function(){return 0},Bi.LEFT.get=function(){return 1},Bi.RIGHT.get=function(){return 2},Object.defineProperties(nn,Bi),(he.prototype=new Error).name="EmptyStackException",(De.prototype=new et).add=function(l){return this.array_.push(l),!0},De.prototype.get=function(l){if(l<0||l>=this.size())throw new Error;return this.array_[l]},De.prototype.push=function(l){return this.array_.push(l),l},De.prototype.pop=function(l){if(0===this.array_.length)throw new he;return this.array_.pop()},De.prototype.peek=function(){if(0===this.array_.length)throw new he;return this.array_[this.array_.length-1]},De.prototype.empty=function(){return 0===this.array_.length},De.prototype.isEmpty=function(){return this.empty()},De.prototype.search=function(l){return this.array_.indexOf(l)},De.prototype.size=function(){return this.array_.length},De.prototype.toArray=function(){for(var l=[],h=0,y=this.array_.length;h<y;h++)l.push(this.array_[h]);return l};var Ia=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ia.prototype.getCoordinate=function(){return this._minCoord},Ia.prototype.getRightmostSide=function(l,h){var y=this.getRightmostSideOfSegment(l,h);return y<0&&(y=this.getRightmostSideOfSegment(l,h-1)),y<0&&(this._minCoord=null,this.checkForRightmostCoordinate(l)),y},Ia.prototype.findRightmostEdgeAtVertex=function(){var l=this._minDe.getEdge().getCoordinates();le.isTrue(this._minIndex>0&&this._minIndex<l.length,"rightmost point expected to be interior vertex of edge");var h=l[this._minIndex-1],y=l[this._minIndex+1],w=Wt.computeOrientation(this._minCoord,y,h),D=!1;(h.y<this._minCoord.y&&y.y<this._minCoord.y&&w===Wt.COUNTERCLOCKWISE||h.y>this._minCoord.y&&y.y>this._minCoord.y&&w===Wt.CLOCKWISE)&&(D=!0),D&&(this._minIndex=this._minIndex-1)},Ia.prototype.getRightmostSideOfSegment=function(l,h){var y=l.getEdge().getCoordinates();if(h<0||h+1>=y.length||y[h].y===y[h+1].y)return-1;var w=nn.LEFT;return y[h].y<y[h+1].y&&(w=nn.RIGHT),w},Ia.prototype.getEdge=function(){return this._orientedDe},Ia.prototype.checkForRightmostCoordinate=function(l){for(var h=l.getEdge().getCoordinates(),y=0;y<h.length-1;y++)(null===this._minCoord||h[y].x>this._minCoord.x)&&(this._minDe=l,this._minIndex=y,this._minCoord=h[y])},Ia.prototype.findRightmostEdgeAtNode=function(){var l=this._minDe.getNode().getEdges();this._minDe=l.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ia.prototype.findEdge=function(l){for(var h=l.iterator();h.hasNext();){var y=h.next();y.isForward()&&this.checkForRightmostCoordinate(y)}le.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===nn.LEFT&&(this._orientedDe=this._minDe.getSym())},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia};var vl=function(l){function h(y,w){l.call(this,h.msgWithCoord(y,w)),this.pt=w?new ne(w):null,this.name="TopologyException"}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.getCoordinate=function(){return this.pt},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h.msgWithCoord=function(y,w){return w?y:y+" [ "+w+" ]"},h}(we),yh=function(){this.array_=[]};yh.prototype.addLast=function(l){this.array_.push(l)},yh.prototype.removeFirst=function(){return this.array_.shift()},yh.prototype.isEmpty=function(){return 0===this.array_.length};var Ts=function(){this._finder=null,this._dirEdgeList=new ke,this._nodes=new ke,this._rightMostCoord=null,this._env=null,this._finder=new Ia};Ts.prototype.clearVisitedEdges=function(){for(var l=this._dirEdgeList.iterator();l.hasNext();)l.next().setVisited(!1)},Ts.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ts.prototype.computeNodeDepth=function(l){for(var h=null,y=l.getEdges().iterator();y.hasNext();){var w=y.next();if(w.isVisited()||w.getSym().isVisited()){h=w;break}}if(null===h)throw new vl("unable to find edge to compute depths at "+l.getCoordinate());l.getEdges().computeDepths(h);for(var D=l.getEdges().iterator();D.hasNext();){var z=D.next();z.setVisited(!0),this.copySymDepths(z)}},Ts.prototype.computeDepth=function(l){this.clearVisitedEdges();var h=this._finder.getEdge();h.setEdgeDepths(nn.RIGHT,l),this.copySymDepths(h),this.computeDepths(h)},Ts.prototype.create=function(l){this.addReachable(l),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ts.prototype.findResultEdges=function(){for(var l=this._dirEdgeList.iterator();l.hasNext();){var h=l.next();h.getDepth(nn.RIGHT)>=1&&h.getDepth(nn.LEFT)<=0&&!h.isInteriorAreaEdge()&&h.setInResult(!0)}},Ts.prototype.computeDepths=function(l){var h=new Yi,y=new yh,w=l.getNode();for(y.addLast(w),h.add(w),l.setVisited(!0);!y.isEmpty();){var D=y.removeFirst();h.add(D),this.computeNodeDepth(D);for(var z=D.getEdges().iterator();z.hasNext();){var G=z.next().getSym();if(!G.isVisited()){var ie=G.getNode();h.contains(ie)||(y.addLast(ie),h.add(ie))}}}},Ts.prototype.compareTo=function(l){return this._rightMostCoord.x<l._rightMostCoord.x?-1:this._rightMostCoord.x>l._rightMostCoord.x?1:0},Ts.prototype.getEnvelope=function(){if(null===this._env){for(var l=new mn,h=this._dirEdgeList.iterator();h.hasNext();)for(var y=h.next().getEdge().getCoordinates(),w=0;w<y.length-1;w++)l.expandToInclude(y[w]);this._env=l}return this._env},Ts.prototype.addReachable=function(l){var h=new De;for(h.add(l);!h.empty();){var y=h.pop();this.add(y,h)}},Ts.prototype.copySymDepths=function(l){var h=l.getSym();h.setDepth(nn.LEFT,l.getDepth(nn.RIGHT)),h.setDepth(nn.RIGHT,l.getDepth(nn.LEFT))},Ts.prototype.add=function(l,h){l.setVisited(!0),this._nodes.add(l);for(var y=l.getEdges().iterator();y.hasNext();){var w=y.next();this._dirEdgeList.add(w);var D=w.getSym().getNode();D.isVisited()||h.push(D)}},Ts.prototype.getNodes=function(){return this._nodes},Ts.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ts.prototype.interfaces_=function(){return[de]},Ts.prototype.getClass=function(){return Ts};var Ot=function l(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var y=arguments[0];this.init(1),this.location[nn.ON]=y}else if(arguments[0]instanceof l){var w=arguments[0];if(this.init(w.location.length),null!==w)for(var D=0;D<this.location.length;D++)this.location[D]=w.location[D]}}else if(3===arguments.length){var z=arguments[0],G=arguments[1],ie=arguments[2];this.init(3),this.location[nn.ON]=z,this.location[nn.LEFT]=G,this.location[nn.RIGHT]=ie}};Ot.prototype.setAllLocations=function(l){for(var h=0;h<this.location.length;h++)this.location[h]=l},Ot.prototype.isNull=function(){for(var l=0;l<this.location.length;l++)if(this.location[l]!==Me.NONE)return!1;return!0},Ot.prototype.setAllLocationsIfNull=function(l){for(var h=0;h<this.location.length;h++)this.location[h]===Me.NONE&&(this.location[h]=l)},Ot.prototype.isLine=function(){return 1===this.location.length},Ot.prototype.merge=function(l){if(l.location.length>this.location.length){var h=new Array(3).fill(null);h[nn.ON]=this.location[nn.ON],h[nn.LEFT]=Me.NONE,h[nn.RIGHT]=Me.NONE,this.location=h}for(var y=0;y<this.location.length;y++)this.location[y]===Me.NONE&&y<l.location.length&&(this.location[y]=l.location[y])},Ot.prototype.getLocations=function(){return this.location},Ot.prototype.flip=function(){if(this.location.length<=1)return null;var l=this.location[nn.LEFT];this.location[nn.LEFT]=this.location[nn.RIGHT],this.location[nn.RIGHT]=l},Ot.prototype.toString=function(){var l=new Re;return this.location.length>1&&l.append(Me.toLocationSymbol(this.location[nn.LEFT])),l.append(Me.toLocationSymbol(this.location[nn.ON])),this.location.length>1&&l.append(Me.toLocationSymbol(this.location[nn.RIGHT])),l.toString()},Ot.prototype.setLocations=function(l,h,y){this.location[nn.ON]=l,this.location[nn.LEFT]=h,this.location[nn.RIGHT]=y},Ot.prototype.get=function(l){return l<this.location.length?this.location[l]:Me.NONE},Ot.prototype.isArea=function(){return this.location.length>1},Ot.prototype.isAnyNull=function(){for(var l=0;l<this.location.length;l++)if(this.location[l]===Me.NONE)return!0;return!1},Ot.prototype.setLocation=function(){1===arguments.length?this.setLocation(nn.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},Ot.prototype.init=function(l){this.location=new Array(l).fill(null),this.setAllLocations(Me.NONE)},Ot.prototype.isEqualOnSide=function(l,h){return this.location[h]===l.location[h]},Ot.prototype.allPositionsEqual=function(l){for(var h=0;h<this.location.length;h++)if(this.location[h]!==l)return!1;return!0},Ot.prototype.interfaces_=function(){return[]},Ot.prototype.getClass=function(){return Ot};var mr=function l(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var h=arguments[0];this.elt[0]=new Ot(h),this.elt[1]=new Ot(h)}else if(arguments[0]instanceof l){var y=arguments[0];this.elt[0]=new Ot(y.elt[0]),this.elt[1]=new Ot(y.elt[1])}}else if(2===arguments.length){var w=arguments[0],D=arguments[1];this.elt[0]=new Ot(Me.NONE),this.elt[1]=new Ot(Me.NONE),this.elt[w].setLocation(D)}else if(3===arguments.length){var z=arguments[0],G=arguments[1],ie=arguments[2];this.elt[0]=new Ot(z,G,ie),this.elt[1]=new Ot(z,G,ie)}else if(4===arguments.length){var Oe=arguments[0],lt=arguments[1],kt=arguments[2],Zt=arguments[3];this.elt[0]=new Ot(Me.NONE,Me.NONE,Me.NONE),this.elt[1]=new Ot(Me.NONE,Me.NONE,Me.NONE),this.elt[Oe].setLocations(lt,kt,Zt)}};mr.prototype.getGeometryCount=function(){var l=0;return this.elt[0].isNull()||l++,this.elt[1].isNull()||l++,l},mr.prototype.setAllLocations=function(l,h){this.elt[l].setAllLocations(h)},mr.prototype.isNull=function(l){return this.elt[l].isNull()},mr.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var l=arguments[0];this.setAllLocationsIfNull(0,l),this.setAllLocationsIfNull(1,l)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},mr.prototype.isLine=function(l){return this.elt[l].isLine()},mr.prototype.merge=function(l){for(var h=0;h<2;h++)null===this.elt[h]&&null!==l.elt[h]?this.elt[h]=new Ot(l.elt[h]):this.elt[h].merge(l.elt[h])},mr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},mr.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get(nn.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},mr.prototype.toString=function(){var l=new Re;return null!==this.elt[0]&&(l.append("A:"),l.append(this.elt[0].toString())),null!==this.elt[1]&&(l.append(" B:"),l.append(this.elt[1].toString())),l.toString()},mr.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},mr.prototype.isAnyNull=function(l){return this.elt[l].isAnyNull()},mr.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(nn.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},mr.prototype.isEqualOnSide=function(l,h){return this.elt[0].isEqualOnSide(l.elt[0],h)&&this.elt[1].isEqualOnSide(l.elt[1],h)},mr.prototype.allPositionsEqual=function(l,h){return this.elt[l].allPositionsEqual(h)},mr.prototype.toLine=function(l){this.elt[l].isArea()&&(this.elt[l]=new Ot(this.elt[l].location[0]))},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr},mr.toLineLabel=function(l){for(var h=new mr(Me.NONE),y=0;y<2;y++)h.setLocation(y,l.getLocation(y));return h};var oi=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new ke,this._pts=new ke,this._label=new mr(Me.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ke,this._geometryFactory=null;var l=arguments[0];this._geometryFactory=arguments[1],this.computePoints(l),this.computeRing()};oi.prototype.computeRing=function(){if(null!==this._ring)return null;for(var l=new Array(this._pts.size()).fill(null),h=0;h<this._pts.size();h++)l[h]=this._pts.get(h);this._ring=this._geometryFactory.createLinearRing(l),this._isHole=Wt.isCCW(this._ring.getCoordinates())},oi.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},oi.prototype.computePoints=function(l){this._startDe=l;var h=l,y=!0;do{if(null===h)throw new vl("Found null DirectedEdge");if(h.getEdgeRing()===this)throw new vl("Directed Edge visited twice during ring-building at "+h.getCoordinate());this._edges.add(h);var w=h.getLabel();le.isTrue(w.isArea()),this.mergeLabel(w),this.addPoints(h.getEdge(),h.isForward(),y),y=!1,this.setEdgeRing(h,this),h=this.getNext(h)}while(h!==this._startDe)},oi.prototype.getLinearRing=function(){return this._ring},oi.prototype.getCoordinate=function(l){return this._pts.get(l)},oi.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var l=this._startDe;do{var h=l.getNode().getEdges().getOutgoingDegree(this);h>this._maxNodeDegree&&(this._maxNodeDegree=h),l=this.getNext(l)}while(l!==this._startDe);this._maxNodeDegree*=2},oi.prototype.addPoints=function(l,h,y){var w=l.getCoordinates();if(h){var D=1;y&&(D=0);for(var z=D;z<w.length;z++)this._pts.add(w[z])}else{var G=w.length-2;y&&(G=w.length-1);for(var ie=G;ie>=0;ie--)this._pts.add(w[ie])}},oi.prototype.isHole=function(){return this._isHole},oi.prototype.setInResult=function(){var l=this._startDe;do{l.getEdge().setInResult(!0),l=l.getNext()}while(l!==this._startDe)},oi.prototype.containsPoint=function(l){var h=this.getLinearRing();if(!h.getEnvelopeInternal().contains(l)||!Wt.isPointInRing(l,h.getCoordinates()))return!1;for(var y=this._holes.iterator();y.hasNext();)if(y.next().containsPoint(l))return!1;return!0},oi.prototype.addHole=function(l){this._holes.add(l)},oi.prototype.isShell=function(){return null===this._shell},oi.prototype.getLabel=function(){return this._label},oi.prototype.getEdges=function(){return this._edges},oi.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},oi.prototype.getShell=function(){return this._shell},oi.prototype.mergeLabel=function(){if(1===arguments.length){var l=arguments[0];this.mergeLabel(l,0),this.mergeLabel(l,1)}else if(2===arguments.length){var y=arguments[1],w=arguments[0].getLocation(y,nn.RIGHT);if(w===Me.NONE)return null;if(this._label.getLocation(y)===Me.NONE)return this._label.setLocation(y,w),null}},oi.prototype.setShell=function(l){this._shell=l,null!==l&&l.addHole(this)},oi.prototype.toPolygon=function(l){for(var h=new Array(this._holes.size()).fill(null),y=0;y<this._holes.size();y++)h[y]=this._holes.get(y).getLinearRing();return l.createPolygon(this.getLinearRing(),h)},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi};var ur=function(l){function h(){l.call(this,arguments[0],arguments[1])}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.setEdgeRing=function(y,w){y.setMinEdgeRing(w)},h.prototype.getNext=function(y){return y.getNextMin()},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(oi),Zs=function(l){function h(){l.call(this,arguments[0],arguments[1])}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.buildMinimalRings=function(){var y=new ke,w=this._startDe;do{if(null===w.getMinEdgeRing()){var D=new ur(w,this._geometryFactory);y.add(D)}w=w.getNext()}while(w!==this._startDe);return y},h.prototype.setEdgeRing=function(y,w){y.setEdgeRing(w)},h.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var y=this._startDe;do{y.getNode().getEdges().linkMinimalDirectedEdges(this),y=y.getNext()}while(y!==this._startDe)},h.prototype.getNext=function(y){return y.getNext()},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(oi),Wa=function(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])};Wa.prototype.setVisited=function(l){this._isVisited=l},Wa.prototype.setInResult=function(l){this._isInResult=l},Wa.prototype.isCovered=function(){return this._isCovered},Wa.prototype.isCoveredSet=function(){return this._isCoveredSet},Wa.prototype.setLabel=function(l){this._label=l},Wa.prototype.getLabel=function(){return this._label},Wa.prototype.setCovered=function(l){this._isCovered=l,this._isCoveredSet=!0},Wa.prototype.updateIM=function(l){le.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(l)},Wa.prototype.isInResult=function(){return this._isInResult},Wa.prototype.isVisited=function(){return this._isVisited},Wa.prototype.interfaces_=function(){return[]},Wa.prototype.getClass=function(){return Wa};var pd=function(l){function h(){l.call(this),this._coord=null,this._edges=null;var w=arguments[1];this._coord=arguments[0],this._edges=w,this._label=new mr(0,Me.NONE)}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.isIncidentEdgeInResult=function(){for(var y=this.getEdges().getEdges().iterator();y.hasNext();)if(y.next().getEdge().isInResult())return!0;return!1},h.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},h.prototype.getCoordinate=function(){return this._coord},h.prototype.print=function(y){y.println("node "+this._coord+" lbl: "+this._label)},h.prototype.computeIM=function(y){},h.prototype.computeMergedLocation=function(y,w){var D=Me.NONE;if(D=this._label.getLocation(w),!y.isNull(w)){var z=y.getLocation(w);D!==Me.BOUNDARY&&(D=z)}return D},h.prototype.setLabel=function(){if(2!==arguments.length)return l.prototype.setLabel.apply(this,arguments);var y=arguments[0],w=arguments[1];null===this._label?this._label=new mr(y,w):this._label.setLocation(y,w)},h.prototype.getEdges=function(){return this._edges},h.prototype.mergeLabel=function(){if(arguments[0]instanceof h)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof mr)for(var w=arguments[0],D=0;D<2;D++){var z=this.computeMergedLocation(w,D);this._label.getLocation(D)===Me.NONE&&this._label.setLocation(D,z)}},h.prototype.add=function(y){this._edges.insert(y),y.setNode(this)},h.prototype.setLabelBoundary=function(y){if(null===this._label)return null;var w=Me.NONE;null!==this._label&&(w=this._label.getLocation(y)),this._label.setLocation(y,w===Me.BOUNDARY?Me.INTERIOR:Me.BOUNDARY)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Wa),Qo=function(){this.nodeMap=new Mt,this.nodeFact=null,this.nodeFact=arguments[0]};Qo.prototype.find=function(l){return this.nodeMap.get(l)},Qo.prototype.addNode=function(){if(arguments[0]instanceof ne){var l=arguments[0],h=this.nodeMap.get(l);return null===h&&(h=this.nodeFact.createNode(l),this.nodeMap.put(l,h)),h}if(arguments[0]instanceof pd){var y=arguments[0],w=this.nodeMap.get(y.getCoordinate());return null===w?(this.nodeMap.put(y.getCoordinate(),y),y):(w.mergeLabel(y),w)}},Qo.prototype.print=function(l){for(var h=this.iterator();h.hasNext();)h.next().print(l)},Qo.prototype.iterator=function(){return this.nodeMap.values().iterator()},Qo.prototype.values=function(){return this.nodeMap.values()},Qo.prototype.getBoundaryNodes=function(l){for(var h=new ke,y=this.iterator();y.hasNext();){var w=y.next();w.getLabel().getLocation(l)===Me.BOUNDARY&&h.add(w)}return h},Qo.prototype.add=function(l){var h=l.getCoordinate();this.addNode(h).add(l)},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo};var Pi=function(){},Ud={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Pi.isNorthern=function(l){return l===Pi.NE||l===Pi.NW},Pi.isOpposite=function(l,h){return l!==h&&(l-h+4)%4==2},Pi.commonHalfPlane=function(l,h){if(l===h)return l;if((l-h+4)%4==2)return-1;var y=l<h?l:h;return 0===y&&3===(l>h?l:h)?3:y},Pi.isInHalfPlane=function(l,h){return h===Pi.SE?l===Pi.SE||l===Pi.SW:l===h||l===h+1},Pi.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var l=arguments[0],h=arguments[1];if(0===l&&0===h)throw new ge("Cannot compute the quadrant for point ( "+l+", "+h+" )");return l>=0?h>=0?Pi.NE:Pi.SE:h>=0?Pi.NW:Pi.SW}if(arguments[0]instanceof ne&&arguments[1]instanceof ne){var y=arguments[0],w=arguments[1];if(w.x===y.x&&w.y===y.y)throw new ge("Cannot compute the quadrant for two identical points "+y);return w.x>=y.x?w.y>=y.y?Pi.NE:Pi.SE:w.y>=y.y?Pi.NW:Pi.SW}},Ud.NE.get=function(){return 0},Ud.NW.get=function(){return 1},Ud.SW.get=function(){return 2},Ud.SE.get=function(){return 3},Object.defineProperties(Pi,Ud);var As=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var y=arguments[1],w=arguments[2];this._edge=arguments[0],this.init(y,w),this._label=null}else if(4===arguments.length){var z=arguments[1],G=arguments[2],ie=arguments[3];this._edge=arguments[0],this.init(z,G),this._label=ie}};As.prototype.compareDirection=function(l){return this._dx===l._dx&&this._dy===l._dy?0:this._quadrant>l._quadrant?1:this._quadrant<l._quadrant?-1:Wt.computeOrientation(l._p0,l._p1,this._p1)},As.prototype.getDy=function(){return this._dy},As.prototype.getCoordinate=function(){return this._p0},As.prototype.setNode=function(l){this._node=l},As.prototype.print=function(l){var h=Math.atan2(this._dy,this._dx),y=this.getClass().getName(),w=y.lastIndexOf("."),D=y.substring(w+1);l.print("  "+D+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+h+"   "+this._label)},As.prototype.compareTo=function(l){return this.compareDirection(l)},As.prototype.getDirectedCoordinate=function(){return this._p1},As.prototype.getDx=function(){return this._dx},As.prototype.getLabel=function(){return this._label},As.prototype.getEdge=function(){return this._edge},As.prototype.getQuadrant=function(){return this._quadrant},As.prototype.getNode=function(){return this._node},As.prototype.toString=function(){var l=Math.atan2(this._dy,this._dx),h=this.getClass().getName(),y=h.lastIndexOf(".");return"  "+h.substring(y+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+l+"   "+this._label},As.prototype.computeLabel=function(l){},As.prototype.init=function(l,h){this._p0=l,this._p1=h,this._dx=h.x-l.x,this._dy=h.y-l.y,this._quadrant=Pi.quadrant(this._dx,this._dy),le.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},As.prototype.interfaces_=function(){return[de]},As.prototype.getClass=function(){return As};var Cs=function(l){function h(){var y=arguments[0],w=arguments[1];if(l.call(this,y),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=w,w)this.init(y.getCoordinate(0),y.getCoordinate(1));else{var D=y.getNumPoints()-1;this.init(y.getCoordinate(D),y.getCoordinate(D-1))}this.computeDirectedLabel()}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.getNextMin=function(){return this._nextMin},h.prototype.getDepth=function(y){return this._depth[y]},h.prototype.setVisited=function(y){this._isVisited=y},h.prototype.computeDirectedLabel=function(){this._label=new mr(this._edge.getLabel()),this._isForward||this._label.flip()},h.prototype.getNext=function(){return this._next},h.prototype.setDepth=function(y,w){if(-999!==this._depth[y]&&this._depth[y]!==w)throw new vl("assigned depths do not match",this.getCoordinate());this._depth[y]=w},h.prototype.isInteriorAreaEdge=function(){for(var y=!0,w=0;w<2;w++)this._label.isArea(w)&&this._label.getLocation(w,nn.LEFT)===Me.INTERIOR&&this._label.getLocation(w,nn.RIGHT)===Me.INTERIOR||(y=!1);return y},h.prototype.setNextMin=function(y){this._nextMin=y},h.prototype.print=function(y){l.prototype.print.call(this,y),y.print(" "+this._depth[nn.LEFT]+"/"+this._depth[nn.RIGHT]),y.print(" ("+this.getDepthDelta()+")"),this._isInResult&&y.print(" inResult")},h.prototype.setMinEdgeRing=function(y){this._minEdgeRing=y},h.prototype.isLineEdge=function(){var y=this._label.isLine(0)||this._label.isLine(1),w=!this._label.isArea(0)||this._label.allPositionsEqual(0,Me.EXTERIOR),D=!this._label.isArea(1)||this._label.allPositionsEqual(1,Me.EXTERIOR);return y&&w&&D},h.prototype.setEdgeRing=function(y){this._edgeRing=y},h.prototype.getMinEdgeRing=function(){return this._minEdgeRing},h.prototype.getDepthDelta=function(){var y=this._edge.getDepthDelta();return this._isForward||(y=-y),y},h.prototype.setInResult=function(y){this._isInResult=y},h.prototype.getSym=function(){return this._sym},h.prototype.isForward=function(){return this._isForward},h.prototype.getEdge=function(){return this._edge},h.prototype.printEdge=function(y){this.print(y),y.print(" "),this._isForward?this._edge.print(y):this._edge.printReverse(y)},h.prototype.setSym=function(y){this._sym=y},h.prototype.setVisitedEdge=function(y){this.setVisited(y),this._sym.setVisited(y)},h.prototype.setEdgeDepths=function(y,w){var D=this.getEdge().getDepthDelta();this._isForward||(D=-D);var z=1;y===nn.LEFT&&(z=-1);var G=nn.opposite(y),ie=w+D*z;this.setDepth(y,w),this.setDepth(G,ie)},h.prototype.getEdgeRing=function(){return this._edgeRing},h.prototype.isInResult=function(){return this._isInResult},h.prototype.setNext=function(y){this._next=y},h.prototype.isVisited=function(){return this._isVisited},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h.depthFactor=function(y,w){return y===Me.EXTERIOR&&w===Me.INTERIOR?1:y===Me.INTERIOR&&w===Me.EXTERIOR?-1:0},h}(As),Za=function(){};Za.prototype.createNode=function(l){return new pd(l,null)},Za.prototype.interfaces_=function(){return[]},Za.prototype.getClass=function(){return Za};var Vo=function(){this._edges=new ke,this._nodes=null,this._edgeEndList=new ke,0===arguments.length?this._nodes=new Qo(new Za):1===arguments.length&&(this._nodes=new Qo(arguments[0]))};Vo.prototype.printEdges=function(l){l.println("Edges:");for(var h=0;h<this._edges.size();h++){l.println("edge "+h+":");var y=this._edges.get(h);y.print(l),y.eiList.print(l)}},Vo.prototype.find=function(l){return this._nodes.find(l)},Vo.prototype.addNode=function(){return arguments[0]instanceof pd||arguments[0]instanceof ne?this._nodes.addNode(arguments[0]):void 0},Vo.prototype.getNodeIterator=function(){return this._nodes.iterator()},Vo.prototype.linkResultDirectedEdges=function(){for(var l=this._nodes.iterator();l.hasNext();)l.next().getEdges().linkResultDirectedEdges()},Vo.prototype.debugPrintln=function(l){Kt.out.println(l)},Vo.prototype.isBoundaryNode=function(l,h){var y=this._nodes.find(h);if(null===y)return!1;var w=y.getLabel();return null!==w&&w.getLocation(l)===Me.BOUNDARY},Vo.prototype.linkAllDirectedEdges=function(){for(var l=this._nodes.iterator();l.hasNext();)l.next().getEdges().linkAllDirectedEdges()},Vo.prototype.matchInSameDirection=function(l,h,y,w){return!!l.equals(y)&&Wt.computeOrientation(l,h,w)===Wt.COLLINEAR&&Pi.quadrant(l,h)===Pi.quadrant(y,w)},Vo.prototype.getEdgeEnds=function(){return this._edgeEndList},Vo.prototype.debugPrint=function(l){Kt.out.print(l)},Vo.prototype.getEdgeIterator=function(){return this._edges.iterator()},Vo.prototype.findEdgeInSameDirection=function(l,h){for(var y=0;y<this._edges.size();y++){var w=this._edges.get(y),D=w.getCoordinates();if(this.matchInSameDirection(l,h,D[0],D[1])||this.matchInSameDirection(l,h,D[D.length-1],D[D.length-2]))return w}return null},Vo.prototype.insertEdge=function(l){this._edges.add(l)},Vo.prototype.findEdgeEnd=function(l){for(var h=this.getEdgeEnds().iterator();h.hasNext();){var y=h.next();if(y.getEdge()===l)return y}return null},Vo.prototype.addEdges=function(l){for(var h=l.iterator();h.hasNext();){var y=h.next();this._edges.add(y);var w=new Cs(y,!0),D=new Cs(y,!1);w.setSym(D),D.setSym(w),this.add(w),this.add(D)}},Vo.prototype.add=function(l){this._nodes.add(l),this._edgeEndList.add(l)},Vo.prototype.getNodes=function(){return this._nodes.values()},Vo.prototype.findEdge=function(l,h){for(var y=0;y<this._edges.size();y++){var w=this._edges.get(y),D=w.getCoordinates();if(l.equals(D[0])&&h.equals(D[1]))return w}return null},Vo.prototype.interfaces_=function(){return[]},Vo.prototype.getClass=function(){return Vo},Vo.linkResultDirectedEdges=function(l){for(var h=l.iterator();h.hasNext();)h.next().getEdges().linkResultDirectedEdges()};var ia=function(){this._geometryFactory=null,this._shellList=new ke,this._geometryFactory=arguments[0]};ia.prototype.sortShellsAndHoles=function(l,h,y){for(var w=l.iterator();w.hasNext();){var D=w.next();D.isHole()?y.add(D):h.add(D)}},ia.prototype.computePolygons=function(l){for(var h=new ke,y=l.iterator();y.hasNext();){var w=y.next().toPolygon(this._geometryFactory);h.add(w)}return h},ia.prototype.placeFreeHoles=function(l,h){for(var y=h.iterator();y.hasNext();){var w=y.next();if(null===w.getShell()){var D=this.findEdgeRingContaining(w,l);if(null===D)throw new vl("unable to assign hole to a shell",w.getCoordinate(0));w.setShell(D)}}},ia.prototype.buildMinimalEdgeRings=function(l,h,y){for(var w=new ke,D=l.iterator();D.hasNext();){var z=D.next();if(z.getMaxNodeDegree()>2){z.linkDirectedEdgesForMinimalEdgeRings();var G=z.buildMinimalRings(),ie=this.findShell(G);null!==ie?(this.placePolygonHoles(ie,G),h.add(ie)):y.addAll(G)}else w.add(z)}return w},ia.prototype.containsPoint=function(l){for(var h=this._shellList.iterator();h.hasNext();)if(h.next().containsPoint(l))return!0;return!1},ia.prototype.buildMaximalEdgeRings=function(l){for(var h=new ke,y=l.iterator();y.hasNext();){var w=y.next();if(w.isInResult()&&w.getLabel().isArea()&&null===w.getEdgeRing()){var D=new Zs(w,this._geometryFactory);h.add(D),D.setInResult()}}return h},ia.prototype.placePolygonHoles=function(l,h){for(var y=h.iterator();y.hasNext();){var w=y.next();w.isHole()&&w.setShell(l)}},ia.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},ia.prototype.findEdgeRingContaining=function(l,h){for(var y=l.getLinearRing(),w=y.getEnvelopeInternal(),D=y.getCoordinateN(0),z=null,G=null,ie=h.iterator();ie.hasNext();){var Oe=ie.next(),lt=Oe.getLinearRing(),kt=lt.getEnvelopeInternal();null!==z&&(G=z.getLinearRing().getEnvelopeInternal());var Zt=!1;kt.contains(w)&&Wt.isPointInRing(D,lt.getCoordinates())&&(Zt=!0),Zt&&(null===z||G.contains(kt))&&(z=Oe)}return z},ia.prototype.findShell=function(l){for(var h=0,y=null,w=l.iterator();w.hasNext();){var D=w.next();D.isHole()||(y=D,h++)}return le.isTrue(h<=1,"found two shells in MinimalEdgeRing list"),y},ia.prototype.add=function(){if(1===arguments.length){var l=arguments[0];this.add(l.getEdgeEnds(),l.getNodes())}else if(2===arguments.length){var h=arguments[0];Vo.linkResultDirectedEdges(arguments[1]);var w=this.buildMaximalEdgeRings(h),D=new ke,z=this.buildMinimalEdgeRings(w,this._shellList,D);this.sortShellsAndHoles(z,this._shellList,D),this.placeFreeHoles(this._shellList,D)}},ia.prototype.interfaces_=function(){return[]},ia.prototype.getClass=function(){return ia};var ra=function(){};ra.prototype.getBounds=function(){},ra.prototype.interfaces_=function(){return[]},ra.prototype.getClass=function(){return ra};var xl=function(){this._bounds=null,this._item=null;var h=arguments[1];this._bounds=arguments[0],this._item=h};xl.prototype.getItem=function(){return this._item},xl.prototype.getBounds=function(){return this._bounds},xl.prototype.interfaces_=function(){return[ra,be]},xl.prototype.getClass=function(){return xl};var rc=function(){this._size=null,this._items=null,this._size=0,this._items=new ke,this._items.add(null)};rc.prototype.poll=function(){if(this.isEmpty())return null;var l=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),l},rc.prototype.size=function(){return this._size},rc.prototype.reorder=function(l){for(var h=null,y=this._items.get(l);2*l<=this._size&&((h=2*l)!==this._size&&this._items.get(h+1).compareTo(this._items.get(h))<0&&h++,this._items.get(h).compareTo(y)<0);l=h)this._items.set(l,this._items.get(h));this._items.set(l,y)},rc.prototype.clear=function(){this._size=0,this._items.clear()},rc.prototype.isEmpty=function(){return 0===this._size},rc.prototype.add=function(l){this._items.add(null),this._size+=1;var h=this._size;for(this._items.set(0,l);l.compareTo(this._items.get(Math.trunc(h/2)))<0;h/=2)this._items.set(h,this._items.get(Math.trunc(h/2)));this._items.set(h,l)},rc.prototype.interfaces_=function(){return[]},rc.prototype.getClass=function(){return rc};var Xa=function(){};Xa.prototype.visitItem=function(l){},Xa.prototype.interfaces_=function(){return[]},Xa.prototype.getClass=function(){return Xa};var bl=function(){};bl.prototype.insert=function(l,h){},bl.prototype.remove=function(l,h){},bl.prototype.query=function(){},bl.prototype.interfaces_=function(){return[]},bl.prototype.getClass=function(){return bl};var ps=function(){this._childBoundables=new ke,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])},zl={serialVersionUID:{configurable:!0}};ps.prototype.getLevel=function(){return this._level},ps.prototype.size=function(){return this._childBoundables.size()},ps.prototype.getChildBoundables=function(){return this._childBoundables},ps.prototype.addChildBoundable=function(l){le.isTrue(null===this._bounds),this._childBoundables.add(l)},ps.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},ps.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},ps.prototype.interfaces_=function(){return[ra,be]},ps.prototype.getClass=function(){return ps},zl.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(ps,zl);var xi=function(){};xi.reverseOrder=function(){return{compare:function(l,h){return h.compareTo(l)}}},xi.min=function(l){return xi.sort(l),l.get(0)},xi.sort=function(l,h){var y=l.toArray();h?zo.sort(y,h):zo.sort(y);for(var w=l.iterator(),D=0,z=y.length;D<z;D++)w.next(),w.set(y[D])},xi.singletonList=function(l){var h=new ke;return h.add(l),h};var Uo=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var h=arguments[1],y=arguments[2];this._boundable1=arguments[0],this._boundable2=h,this._itemDistance=y,this._distance=this.distance()};Uo.prototype.expandToQueue=function(l,h){var y=Uo.isComposite(this._boundable1),w=Uo.isComposite(this._boundable2);if(y&&w)return Uo.area(this._boundable1)>Uo.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,l,h),null):(this.expand(this._boundable2,this._boundable1,l,h),null);if(y)return this.expand(this._boundable1,this._boundable2,l,h),null;if(w)return this.expand(this._boundable2,this._boundable1,l,h),null;throw new ge("neither boundable is composite")},Uo.prototype.isLeaves=function(){return!(Uo.isComposite(this._boundable1)||Uo.isComposite(this._boundable2))},Uo.prototype.compareTo=function(l){return this._distance<l._distance?-1:this._distance>l._distance?1:0},Uo.prototype.expand=function(l,h,y,w){for(var D=l.getChildBoundables().iterator();D.hasNext();){var z=D.next(),G=new Uo(z,h,this._itemDistance);G.getDistance()<w&&y.add(G)}},Uo.prototype.getBoundable=function(l){return 0===l?this._boundable1:this._boundable2},Uo.prototype.getDistance=function(){return this._distance},Uo.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Uo.prototype.interfaces_=function(){return[de]},Uo.prototype.getClass=function(){return Uo},Uo.area=function(l){return l.getBounds().getArea()},Uo.isComposite=function(l){return l instanceof ps};var ko=function l(){if(this._root=null,this._built=!1,this._itemBoundables=new ke,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=l.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var y=arguments[0];le.isTrue(y>1,"Node capacity must be greater than 1"),this._nodeCapacity=y}},jd={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};ko.prototype.getNodeCapacity=function(){return this._nodeCapacity},ko.prototype.lastNode=function(l){return l.get(l.size()-1)},ko.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var l=0,h=arguments[0].getChildBoundables().iterator();h.hasNext();){var y=h.next();y instanceof ps?l+=this.size(y):y instanceof xl&&(l+=1)}return l}},ko.prototype.removeItem=function(l,h){for(var y=null,w=l.getChildBoundables().iterator();w.hasNext();){var D=w.next();D instanceof xl&&D.getItem()===h&&(y=D)}return null!==y&&(l.getChildBoundables().remove(y),!0)},ko.prototype.itemsTree=function(){if(0===arguments.length){this.build();var l=this.itemsTree(this._root);return null===l?new ke:l}if(1===arguments.length){for(var h=arguments[0],y=new ke,w=h.getChildBoundables().iterator();w.hasNext();){var D=w.next();if(D instanceof ps){var z=this.itemsTree(D);null!==z&&y.add(z)}else D instanceof xl?y.add(D.getItem()):le.shouldNeverReachHere()}return y.size()<=0?null:y}},ko.prototype.insert=function(l,h){le.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new xl(l,h))},ko.prototype.boundablesAtLevel=function(){if(1===arguments.length){var l=arguments[0],h=new ke;return this.boundablesAtLevel(l,this._root,h),h}if(3===arguments.length){var y=arguments[0],w=arguments[1],D=arguments[2];if(le.isTrue(y>-2),w.getLevel()===y)return D.add(w),null;for(var z=w.getChildBoundables().iterator();z.hasNext();){var G=z.next();G instanceof ps?this.boundablesAtLevel(y,G,D):(le.isTrue(G instanceof xl),-1===y&&D.add(G))}return null}},ko.prototype.query=function(){if(1===arguments.length){var l=arguments[0];this.build();var h=new ke;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),l)&&this.query(l,this._root,h),h}if(2===arguments.length){var y=arguments[0],w=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.query(y,this._root,w)}else if(3===arguments.length)if(Lt(arguments[2],Xa)&&arguments[0]instanceof Object&&arguments[1]instanceof ps)for(var D=arguments[0],G=arguments[2],ie=arguments[1].getChildBoundables(),Oe=0;Oe<ie.size();Oe++){var lt=ie.get(Oe);this.getIntersectsOp().intersects(lt.getBounds(),D)&&(lt instanceof ps?this.query(D,lt,G):lt instanceof xl?G.visitItem(lt.getItem()):le.shouldNeverReachHere())}else if(Lt(arguments[2],et)&&arguments[0]instanceof Object&&arguments[1]instanceof ps)for(var kt=arguments[0],Un=arguments[2],Fn=arguments[1].getChildBoundables(),Xn=0;Xn<Fn.size();Xn++){var hi=Fn.get(Xn);this.getIntersectsOp().intersects(hi.getBounds(),kt)&&(hi instanceof ps?this.query(kt,hi,Un):hi instanceof xl?Un.add(hi.getItem()):le.shouldNeverReachHere())}},ko.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},ko.prototype.getRoot=function(){return this.build(),this._root},ko.prototype.remove=function(){if(2===arguments.length){var l=arguments[0],h=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),l)&&this.remove(l,this._root,h)}if(3===arguments.length){var y=arguments[0],w=arguments[1],D=arguments[2],z=this.removeItem(w,D);if(z)return!0;for(var G=null,ie=w.getChildBoundables().iterator();ie.hasNext();){var Oe=ie.next();if(this.getIntersectsOp().intersects(Oe.getBounds(),y)&&Oe instanceof ps&&(z=this.remove(y,Oe,D))){G=Oe;break}}return null!==G&&G.getChildBoundables().isEmpty()&&w.getChildBoundables().remove(G),z}},ko.prototype.createHigherLevels=function(l,h){le.isTrue(!l.isEmpty());var y=this.createParentBoundables(l,h+1);return 1===y.size()?y.get(0):this.createHigherLevels(y,h+1)},ko.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var l=0,h=arguments[0].getChildBoundables().iterator();h.hasNext();){var y=h.next();if(y instanceof ps){var w=this.depth(y);w>l&&(l=w)}}return l+1}},ko.prototype.createParentBoundables=function(l,h){le.isTrue(!l.isEmpty());var y=new ke;y.add(this.createNode(h));var w=new ke(l);xi.sort(w,this.getComparator());for(var D=w.iterator();D.hasNext();){var z=D.next();this.lastNode(y).getChildBoundables().size()===this.getNodeCapacity()&&y.add(this.createNode(h)),this.lastNode(y).addChildBoundable(z)}return y},ko.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},ko.prototype.interfaces_=function(){return[be]},ko.prototype.getClass=function(){return ko},ko.compareDoubles=function(l,h){return l>h?1:l<h?-1:0},jd.IntersectsOp.get=function(){return kn},jd.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},jd.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(ko,jd);var kn=function(){},Vl=function(){};Vl.prototype.distance=function(l,h){},Vl.prototype.interfaces_=function(){return[]},Vl.prototype.getClass=function(){return Vl};var wr=function(l){function h(w){l.call(this,w=w||h.DEFAULT_NODE_CAPACITY)}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return h.prototype.createParentBoundablesFromVerticalSlices=function(w,D){le.isTrue(w.length>0);for(var z=new ke,G=0;G<w.length;G++)z.addAll(this.createParentBoundablesFromVerticalSlice(w[G],D));return z},h.prototype.createNode=function(w){return new Ul(w)},h.prototype.size=function(){return 0===arguments.length?l.prototype.size.call(this):l.prototype.size.apply(this,arguments)},h.prototype.insert=function(){if(2!==arguments.length)return l.prototype.insert.apply(this,arguments);var w=arguments[0],D=arguments[1];if(w.isNull())return null;l.prototype.insert.call(this,w,D)},h.prototype.getIntersectsOp=function(){return h.intersectsOp},h.prototype.verticalSlices=function(w,D){for(var z=Math.trunc(Math.ceil(w.size()/D)),G=new Array(D).fill(null),ie=w.iterator(),Oe=0;Oe<D;Oe++){G[Oe]=new ke;for(var lt=0;ie.hasNext()&&lt<z;){var kt=ie.next();G[Oe].add(kt),lt++}}return G},h.prototype.query=function(){if(1===arguments.length)return l.prototype.query.call(this,arguments[0]);2===arguments.length?l.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Lt(arguments[2],Xa)&&arguments[0]instanceof Object&&arguments[1]instanceof ps||Lt(arguments[2],et)&&arguments[0]instanceof Object&&arguments[1]instanceof ps)&&l.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},h.prototype.getComparator=function(){return h.yComparator},h.prototype.createParentBoundablesFromVerticalSlice=function(w,D){return l.prototype.createParentBoundables.call(this,w,D)},h.prototype.remove=function(){return 2===arguments.length?l.prototype.remove.call(this,arguments[0],arguments[1]):l.prototype.remove.apply(this,arguments)},h.prototype.depth=function(){return 0===arguments.length?l.prototype.depth.call(this):l.prototype.depth.apply(this,arguments)},h.prototype.createParentBoundables=function(w,D){le.isTrue(!w.isEmpty());var z=Math.trunc(Math.ceil(w.size()/this.getNodeCapacity())),G=new ke(w);xi.sort(G,h.xComparator);var ie=this.verticalSlices(G,Math.trunc(Math.ceil(Math.sqrt(z))));return this.createParentBoundablesFromVerticalSlices(ie,D)},h.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Lt(arguments[0],Vl)){var w=arguments[0],D=new Uo(this.getRoot(),this.getRoot(),w);return this.nearestNeighbour(D)}if(arguments[0]instanceof Uo)return this.nearestNeighbour(arguments[0],ue.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof h&&Lt(arguments[1],Vl)){var G=arguments[0],ie=arguments[1],Oe=new Uo(this.getRoot(),G.getRoot(),ie);return this.nearestNeighbour(Oe)}if(arguments[0]instanceof Uo&&"number"==typeof arguments[1]){var lt=arguments[0],kt=arguments[1],Zt=null,Un=new rc;for(Un.add(lt);!Un.isEmpty()&&kt>0;){var Fn=Un.poll(),Xn=Fn.getDistance();if(Xn>=kt)break;Fn.isLeaves()?(kt=Xn,Zt=Fn):Fn.expandToQueue(Un,kt)}return[Zt.getBoundable(0).getItem(),Zt.getBoundable(1).getItem()]}}else if(3===arguments.length){var On=arguments[2],Sa=new xl(arguments[0],arguments[1]),hc=new Uo(this.getRoot(),Sa,On);return this.nearestNeighbour(hc)[0]}},h.prototype.interfaces_=function(){return[bl,be]},h.prototype.getClass=function(){return h},h.centreX=function(w){return h.avg(w.getMinX(),w.getMaxX())},h.avg=function(w,D){return(w+D)/2},h.centreY=function(w){return h.avg(w.getMinY(),w.getMaxY())},y.STRtreeNode.get=function(){return Ul},y.serialVersionUID.get=function(){return 0x39920f7d5f261e0},y.xComparator.get=function(){return{interfaces_:function(){return[Ae]},compare:function(w,D){return l.compareDoubles(h.centreX(w.getBounds()),h.centreX(D.getBounds()))}}},y.yComparator.get=function(){return{interfaces_:function(){return[Ae]},compare:function(w,D){return l.compareDoubles(h.centreY(w.getBounds()),h.centreY(D.getBounds()))}}},y.intersectsOp.get=function(){return{interfaces_:function(){return[l.IntersectsOp]},intersects:function(w,D){return w.intersects(D)}}},y.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(h,y),h}(ko),Ul=function(l){function h(){l.call(this,arguments[0])}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.computeBounds=function(){for(var y=null,w=this.getChildBoundables().iterator();w.hasNext();){var D=w.next();null===y?y=new mn(D.getBounds()):y.expandToInclude(D.getBounds())}return y},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(ps),ha=function(){};ha.prototype.interfaces_=function(){return[]},ha.prototype.getClass=function(){return ha},ha.relativeSign=function(l,h){return l<h?-1:l>h?1:0},ha.compare=function(l,h,y){if(h.equals2D(y))return 0;var w=ha.relativeSign(h.x,y.x),D=ha.relativeSign(h.y,y.y);switch(l){case 0:return ha.compareValue(w,D);case 1:return ha.compareValue(D,w);case 2:return ha.compareValue(D,-w);case 3:return ha.compareValue(-w,D);case 4:return ha.compareValue(-w,-D);case 5:return ha.compareValue(-D,-w);case 6:return ha.compareValue(-D,w);case 7:return ha.compareValue(w,-D)}return le.shouldNeverReachHere("invalid octant value"),0},ha.compareValue=function(l,h){return l<0?-1:l>0?1:h<0?-1:h>0?1:0};var sl=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var l=arguments[0],h=arguments[1],y=arguments[2],w=arguments[3];this._segString=l,this.coord=new ne(h),this.segmentIndex=y,this._segmentOctant=w,this._isInterior=!h.equals2D(l.getCoordinate(y))};sl.prototype.getCoordinate=function(){return this.coord},sl.prototype.print=function(l){l.print(this.coord),l.print(" seg # = "+this.segmentIndex)},sl.prototype.compareTo=function(l){var h=l;return this.segmentIndex<h.segmentIndex?-1:this.segmentIndex>h.segmentIndex?1:this.coord.equals2D(h.coord)?0:ha.compare(this._segmentOctant,this.coord,h.coord)},sl.prototype.isEndPoint=function(l){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===l},sl.prototype.isInterior=function(){return this._isInterior},sl.prototype.interfaces_=function(){return[de]},sl.prototype.getClass=function(){return sl};var Xs=function(){this._nodeMap=new Mt,this._edge=null,this._edge=arguments[0]};Xs.prototype.getSplitCoordinates=function(){var l=new It;this.addEndpoints();for(var h=this.iterator(),y=h.next();h.hasNext();){var w=h.next();this.addEdgeCoordinates(y,w,l),y=w}return l.toCoordinateArray()},Xs.prototype.addCollapsedNodes=function(){var l=new ke;this.findCollapsesFromInsertedNodes(l),this.findCollapsesFromExistingVertices(l);for(var h=l.iterator();h.hasNext();){var y=h.next().intValue();this.add(this._edge.getCoordinate(y),y)}},Xs.prototype.print=function(l){l.println("Intersections:");for(var h=this.iterator();h.hasNext();)h.next().print(l)},Xs.prototype.findCollapsesFromExistingVertices=function(l){for(var h=0;h<this._edge.size()-2;h++){var y=this._edge.getCoordinate(h),w=this._edge.getCoordinate(h+2);y.equals2D(w)&&l.add(new it(h+1))}},Xs.prototype.addEdgeCoordinates=function(l,h,y){var w=this._edge.getCoordinate(h.segmentIndex),D=h.isInterior()||!h.coord.equals2D(w);y.add(new ne(l.coord),!1);for(var z=l.segmentIndex+1;z<=h.segmentIndex;z++)y.add(this._edge.getCoordinate(z));D&&y.add(new ne(h.coord))},Xs.prototype.iterator=function(){return this._nodeMap.values().iterator()},Xs.prototype.addSplitEdges=function(l){this.addEndpoints(),this.addCollapsedNodes();for(var h=this.iterator(),y=h.next();h.hasNext();){var w=h.next(),D=this.createSplitEdge(y,w);l.add(D),y=w}},Xs.prototype.findCollapseIndex=function(l,h,y){if(!l.coord.equals2D(h.coord))return!1;var w=h.segmentIndex-l.segmentIndex;return h.isInterior()||w--,1===w&&(y[0]=l.segmentIndex+1,!0)},Xs.prototype.findCollapsesFromInsertedNodes=function(l){for(var h=new Array(1).fill(null),y=this.iterator(),w=y.next();y.hasNext();){var D=y.next();this.findCollapseIndex(w,D,h)&&l.add(new it(h[0])),w=D}},Xs.prototype.getEdge=function(){return this._edge},Xs.prototype.addEndpoints=function(){var l=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(l),l)},Xs.prototype.createSplitEdge=function(l,h){var y=h.segmentIndex-l.segmentIndex+2,w=this._edge.getCoordinate(h.segmentIndex),D=h.isInterior()||!h.coord.equals2D(w);D||y--;var z=new Array(y).fill(null),G=0;z[G++]=new ne(l.coord);for(var ie=l.segmentIndex+1;ie<=h.segmentIndex;ie++)z[G++]=this._edge.getCoordinate(ie);return D&&(z[G]=new ne(h.coord)),new jo(z,this._edge.getData())},Xs.prototype.add=function(l,h){var y=new sl(this._edge,l,h,this._edge.getSegmentOctant(h)),w=this._nodeMap.get(y);return null!==w?(le.isTrue(w.coord.equals2D(l),"Found equal nodes with different coordinates"),w):(this._nodeMap.put(y,y),y)},Xs.prototype.checkSplitEdgesCorrectness=function(l){var h=this._edge.getCoordinates(),y=l.get(0).getCoordinate(0);if(!y.equals2D(h[0]))throw new we("bad split edge start point at "+y);var w=l.get(l.size()-1).getCoordinates(),D=w[w.length-1];if(!D.equals2D(h[h.length-1]))throw new we("bad split edge end point at "+D)},Xs.prototype.interfaces_=function(){return[]},Xs.prototype.getClass=function(){return Xs};var wc=function(){};wc.prototype.interfaces_=function(){return[]},wc.prototype.getClass=function(){return wc},wc.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var l=arguments[0],h=arguments[1];if(0===l&&0===h)throw new ge("Cannot compute the octant for point ( "+l+", "+h+" )");var y=Math.abs(l),w=Math.abs(h);return l>=0?h>=0?y>=w?0:1:y>=w?7:6:h>=0?y>=w?3:2:y>=w?4:5}if(arguments[0]instanceof ne&&arguments[1]instanceof ne){var D=arguments[0],z=arguments[1],G=z.x-D.x,ie=z.y-D.y;if(0===G&&0===ie)throw new ge("Cannot compute the octant for two identical points "+D);return wc.octant(G,ie)}};var Na=function(){};Na.prototype.getCoordinates=function(){},Na.prototype.size=function(){},Na.prototype.getCoordinate=function(l){},Na.prototype.isClosed=function(){},Na.prototype.setData=function(l){},Na.prototype.getData=function(){},Na.prototype.interfaces_=function(){return[]},Na.prototype.getClass=function(){return Na};var tu=function(){};tu.prototype.addIntersection=function(l,h){},tu.prototype.interfaces_=function(){return[Na]},tu.prototype.getClass=function(){return tu};var jo=function(){this._nodeList=new Xs(this),this._pts=null,this._data=null;var h=arguments[1];this._pts=arguments[0],this._data=h};jo.prototype.getCoordinates=function(){return this._pts},jo.prototype.size=function(){return this._pts.length},jo.prototype.getCoordinate=function(l){return this._pts[l]},jo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},jo.prototype.getSegmentOctant=function(l){return l===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(l),this.getCoordinate(l+1))},jo.prototype.setData=function(l){this._data=l},jo.prototype.safeOctant=function(l,h){return l.equals2D(h)?0:wc.octant(l,h)},jo.prototype.getData=function(){return this._data},jo.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var w=arguments[1],z=new ne(arguments[0].getIntersection(arguments[3]));this.addIntersection(z,w)}},jo.prototype.toString=function(){return _t.toLineString(new Ko(this._pts))},jo.prototype.getNodeList=function(){return this._nodeList},jo.prototype.addIntersectionNode=function(l,h){var y=h,w=y+1;return w<this._pts.length&&l.equals2D(this._pts[w])&&(y=w),this._nodeList.add(l,y)},jo.prototype.addIntersections=function(l,h,y){for(var w=0;w<l.getIntersectionNum();w++)this.addIntersection(l,h,y,w)},jo.prototype.interfaces_=function(){return[tu]},jo.prototype.getClass=function(){return jo},jo.getNodedSubstrings=function(){if(1===arguments.length){var l=arguments[0],h=new ke;return jo.getNodedSubstrings(l,h),h}if(2===arguments.length)for(var w=arguments[1],D=arguments[0].iterator();D.hasNext();)D.next().getNodeList().addSplitEdges(w)};var ci=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new ne,this.p1=new ne;else if(1===arguments.length){var l=arguments[0];this.p0=new ne(l.p0),this.p1=new ne(l.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var w=arguments[2],D=arguments[3];this.p0=new ne(arguments[0],arguments[1]),this.p1=new ne(w,D)}},si={serialVersionUID:{configurable:!0}};ci.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},ci.prototype.orientationIndex=function(){if(arguments[0]instanceof ci){var l=arguments[0],h=Wt.orientationIndex(this.p0,this.p1,l.p0),y=Wt.orientationIndex(this.p0,this.p1,l.p1);return h>=0&&y>=0||h<=0&&y<=0?Math.max(h,y):0}if(arguments[0]instanceof ne)return Wt.orientationIndex(this.p0,this.p1,arguments[0])},ci.prototype.toGeometry=function(l){return l.createLineString([this.p0,this.p1])},ci.prototype.isVertical=function(){return this.p0.x===this.p1.x},ci.prototype.equals=function(l){if(!(l instanceof ci))return!1;var h=l;return this.p0.equals(h.p0)&&this.p1.equals(h.p1)},ci.prototype.intersection=function(l){var h=new Gt;return h.computeIntersection(this.p0,this.p1,l.p0,l.p1),h.hasIntersection()?h.getIntersection(0):null},ci.prototype.project=function(){if(arguments[0]instanceof ne){var l=arguments[0];if(l.equals(this.p0)||l.equals(this.p1))return new ne(l);var h=this.projectionFactor(l),y=new ne;return y.x=this.p0.x+h*(this.p1.x-this.p0.x),y.y=this.p0.y+h*(this.p1.y-this.p0.y),y}if(arguments[0]instanceof ci){var w=arguments[0],D=this.projectionFactor(w.p0),z=this.projectionFactor(w.p1);if(D>=1&&z>=1||D<=0&&z<=0)return null;var G=this.project(w.p0);D<0&&(G=this.p0),D>1&&(G=this.p1);var ie=this.project(w.p1);return z<0&&(ie=this.p0),z>1&&(ie=this.p1),new ci(G,ie)}},ci.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},ci.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},ci.prototype.getCoordinate=function(l){return 0===l?this.p0:this.p1},ci.prototype.distancePerpendicular=function(l){return Wt.distancePointLinePerpendicular(l,this.p0,this.p1)},ci.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},ci.prototype.midPoint=function(){return ci.midPoint(this.p0,this.p1)},ci.prototype.projectionFactor=function(l){if(l.equals(this.p0))return 0;if(l.equals(this.p1))return 1;var h=this.p1.x-this.p0.x,y=this.p1.y-this.p0.y,w=h*h+y*y;return w<=0?ue.NaN:((l.x-this.p0.x)*h+(l.y-this.p0.y)*y)/w},ci.prototype.closestPoints=function(l){var h=this.intersection(l);if(null!==h)return[h,h];var y=new Array(2).fill(null),w=ue.MAX_VALUE,D=null,z=this.closestPoint(l.p0);w=z.distance(l.p0),y[0]=z,y[1]=l.p0;var G=this.closestPoint(l.p1);(D=G.distance(l.p1))<w&&(w=D,y[0]=G,y[1]=l.p1);var ie=l.closestPoint(this.p0);(D=ie.distance(this.p0))<w&&(w=D,y[0]=this.p0,y[1]=ie);var Oe=l.closestPoint(this.p1);return(D=Oe.distance(this.p1))<w&&(w=D,y[0]=this.p1,y[1]=Oe),y},ci.prototype.closestPoint=function(l){var h=this.projectionFactor(l);return h>0&&h<1?this.project(l):this.p0.distance(l)<this.p1.distance(l)?this.p0:this.p1},ci.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},ci.prototype.getLength=function(){return this.p0.distance(this.p1)},ci.prototype.compareTo=function(l){var h=l,y=this.p0.compareTo(h.p0);return 0!==y?y:this.p1.compareTo(h.p1)},ci.prototype.reverse=function(){var l=this.p0;this.p0=this.p1,this.p1=l},ci.prototype.equalsTopo=function(l){return this.p0.equals(l.p0)&&(this.p1.equals(l.p1)||this.p0.equals(l.p1))&&this.p1.equals(l.p0)},ci.prototype.lineIntersection=function(l){try{return Qn.intersection(this.p0,this.p1,l.p0,l.p1)}catch(h){if(!(h instanceof Jn))throw h}return null},ci.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},ci.prototype.pointAlongOffset=function(l,h){var y=this.p0.x+l*(this.p1.x-this.p0.x),w=this.p0.y+l*(this.p1.y-this.p0.y),D=this.p1.x-this.p0.x,z=this.p1.y-this.p0.y,G=Math.sqrt(D*D+z*z),ie=0,Oe=0;if(0!==h){if(G<=0)throw new Error("Cannot compute offset from zero-length line segment");ie=h*D/G,Oe=h*z/G}return new ne(y-Oe,w+ie)},ci.prototype.setCoordinates=function(){if(1===arguments.length){var l=arguments[0];this.setCoordinates(l.p0,l.p1)}else if(2===arguments.length){var h=arguments[0],y=arguments[1];this.p0.x=h.x,this.p0.y=h.y,this.p1.x=y.x,this.p1.y=y.y}},ci.prototype.segmentFraction=function(l){var h=this.projectionFactor(l);return h<0?h=0:(h>1||ue.isNaN(h))&&(h=1),h},ci.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},ci.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},ci.prototype.distance=function(){if(arguments[0]instanceof ci){var l=arguments[0];return Wt.distanceLineLine(this.p0,this.p1,l.p0,l.p1)}if(arguments[0]instanceof ne)return Wt.distancePointLine(arguments[0],this.p0,this.p1)},ci.prototype.pointAlong=function(l){var h=new ne;return h.x=this.p0.x+l*(this.p1.x-this.p0.x),h.y=this.p0.y+l*(this.p1.y-this.p0.y),h},ci.prototype.hashCode=function(){var l=ue.doubleToLongBits(this.p0.x);l^=31*ue.doubleToLongBits(this.p0.y);var h=Math.trunc(l)^Math.trunc(l>>32),y=ue.doubleToLongBits(this.p1.x);return y^=31*ue.doubleToLongBits(this.p1.y),h^Math.trunc(y)^Math.trunc(y>>32)},ci.prototype.interfaces_=function(){return[de,be]},ci.prototype.getClass=function(){return ci},ci.midPoint=function(l,h){return new ne((l.x+h.x)/2,(l.y+h.y)/2)},si.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(ci,si);var Wu=function(){this.tempEnv1=new mn,this.tempEnv2=new mn,this._overlapSeg1=new ci,this._overlapSeg2=new ci};Wu.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var y=arguments[2],w=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1),y.getLineSegment(w,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Wu.prototype.interfaces_=function(){return[]},Wu.prototype.getClass=function(){return Wu};var wa=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var h=arguments[1],y=arguments[2],w=arguments[3];this._pts=arguments[0],this._start=h,this._end=y,this._context=w};wa.prototype.getLineSegment=function(l,h){h.p0=this._pts[l],h.p1=this._pts[l+1]},wa.prototype.computeSelect=function(l,h,y,w){if(w.tempEnv1.init(this._pts[h],this._pts[y]),y-h==1)return w.select(this,h),null;if(!l.intersects(w.tempEnv1))return null;var G=Math.trunc((h+y)/2);h<G&&this.computeSelect(l,h,G,w),G<y&&this.computeSelect(l,G,y,w)},wa.prototype.getCoordinates=function(){for(var l=new Array(this._end-this._start+1).fill(null),h=0,y=this._start;y<=this._end;y++)l[h++]=this._pts[y];return l},wa.prototype.computeOverlaps=function(l,h){this.computeOverlapsInternal(this._start,this._end,l,l._start,l._end,h)},wa.prototype.setId=function(l){this._id=l},wa.prototype.select=function(l,h){this.computeSelect(l,this._start,this._end,h)},wa.prototype.getEnvelope=function(){return null===this._env&&(this._env=new mn(this._pts[this._start],this._pts[this._end])),this._env},wa.prototype.getEndIndex=function(){return this._end},wa.prototype.getStartIndex=function(){return this._start},wa.prototype.getContext=function(){return this._context},wa.prototype.getId=function(){return this._id},wa.prototype.computeOverlapsInternal=function(l,h,y,w,D,z){var G=this._pts[l],ie=this._pts[h],Oe=y._pts[w],lt=y._pts[D];if(h-l==1&&D-w==1)return z.overlap(this,l,y,w),null;if(z.tempEnv1.init(G,ie),z.tempEnv2.init(Oe,lt),!z.tempEnv1.intersects(z.tempEnv2))return null;var kt=Math.trunc((l+h)/2),Zt=Math.trunc((w+D)/2);l<kt&&(w<Zt&&this.computeOverlapsInternal(l,kt,y,w,Zt,z),Zt<D&&this.computeOverlapsInternal(l,kt,y,Zt,D,z)),kt<h&&(w<Zt&&this.computeOverlapsInternal(kt,h,y,w,Zt,z),Zt<D&&this.computeOverlapsInternal(kt,h,y,Zt,D,z))},wa.prototype.interfaces_=function(){return[]},wa.prototype.getClass=function(){return wa};var os=function(){};os.prototype.interfaces_=function(){return[]},os.prototype.getClass=function(){return os},os.getChainStartIndices=function(l){var h=0,y=new ke;y.add(new it(h));do{var w=os.findChainEnd(l,h);y.add(new it(w)),h=w}while(h<l.length-1);return os.toIntArray(y)},os.findChainEnd=function(l,h){for(var y=h;y<l.length-1&&l[y].equals2D(l[y+1]);)y++;if(y>=l.length-1)return l.length-1;for(var w=Pi.quadrant(l[y],l[y+1]),D=h+1;D<l.length&&(l[D-1].equals2D(l[D])||Pi.quadrant(l[D-1],l[D])===w);)D++;return D-1},os.getChains=function(){if(1===arguments.length)return os.getChains(arguments[0],null);if(2===arguments.length){for(var h=arguments[0],y=arguments[1],w=new ke,D=os.getChainStartIndices(h),z=0;z<D.length-1;z++){var G=new wa(h,D[z],D[z+1],y);w.add(G)}return w}},os.toIntArray=function(l){for(var h=new Array(l.size()).fill(null),y=0;y<h.length;y++)h[y]=l.get(y).intValue();return h};var Ec=function(){};Ec.prototype.computeNodes=function(l){},Ec.prototype.getNodedSubstrings=function(){},Ec.prototype.interfaces_=function(){return[]},Ec.prototype.getClass=function(){return Ec};var Gd=function(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};Gd.prototype.setSegmentIntersector=function(l){this._segInt=l},Gd.prototype.interfaces_=function(){return[Ec]},Gd.prototype.getClass=function(){return Gd};var Do=function(l){function h(w){w?l.call(this,w):l.call(this),this._monoChains=new ke,this._index=new wr,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h;var y={SegmentOverlapAction:{configurable:!0}};return h.prototype.getMonotoneChains=function(){return this._monoChains},h.prototype.getNodedSubstrings=function(){return jo.getNodedSubstrings(this._nodedSegStrings)},h.prototype.getIndex=function(){return this._index},h.prototype.add=function(w){for(var D=os.getChains(w.getCoordinates(),w).iterator();D.hasNext();){var z=D.next();z.setId(this._idCounter++),this._index.insert(z.getEnvelope(),z),this._monoChains.add(z)}},h.prototype.computeNodes=function(w){this._nodedSegStrings=w;for(var D=w.iterator();D.hasNext();)this.add(D.next());this.intersectChains()},h.prototype.intersectChains=function(){for(var w=new md(this._segInt),D=this._monoChains.iterator();D.hasNext();)for(var z=D.next(),G=this._index.query(z.getEnvelope()).iterator();G.hasNext();){var ie=G.next();if(ie.getId()>z.getId()&&(z.computeOverlaps(ie,w),this._nOverlaps++),this._segInt.isDone())return null}},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},y.SegmentOverlapAction.get=function(){return md},Object.defineProperties(h,y),h}(Gd),md=function(l){function h(){l.call(this),this._si=null,this._si=arguments[0]}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.overlap=function(){if(4!==arguments.length)return l.prototype.overlap.apply(this,arguments);var w=arguments[1],D=arguments[2],z=arguments[3],G=arguments[0].getContext(),ie=D.getContext();this._si.processIntersections(G,w,ie,z)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Wu),Er=function l(){if(this._quadrantSegments=l.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=l.CAP_ROUND,this._joinStyle=l.JOIN_ROUND,this._mitreLimit=l.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=l.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var w=arguments[1];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(w)}else if(4===arguments.length){var z=arguments[1],G=arguments[2],ie=arguments[3];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(z),this.setJoinStyle(G),this.setMitreLimit(ie)}},Fa={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Er.prototype.getEndCapStyle=function(){return this._endCapStyle},Er.prototype.isSingleSided=function(){return this._isSingleSided},Er.prototype.setQuadrantSegments=function(l){this._quadrantSegments=l,0===this._quadrantSegments&&(this._joinStyle=Er.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Er.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),l<=0&&(this._quadrantSegments=1),this._joinStyle!==Er.JOIN_ROUND&&(this._quadrantSegments=Er.DEFAULT_QUADRANT_SEGMENTS)},Er.prototype.getJoinStyle=function(){return this._joinStyle},Er.prototype.setJoinStyle=function(l){this._joinStyle=l},Er.prototype.setSimplifyFactor=function(l){this._simplifyFactor=l<0?0:l},Er.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Er.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Er.prototype.setEndCapStyle=function(l){this._endCapStyle=l},Er.prototype.getMitreLimit=function(){return this._mitreLimit},Er.prototype.setMitreLimit=function(l){this._mitreLimit=l},Er.prototype.setSingleSided=function(l){this._isSingleSided=l},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er},Er.bufferDistanceError=function(l){var h=Math.PI/2/l;return 1-Math.cos(h/2)},Fa.CAP_ROUND.get=function(){return 1},Fa.CAP_FLAT.get=function(){return 2},Fa.CAP_SQUARE.get=function(){return 3},Fa.JOIN_ROUND.get=function(){return 1},Fa.JOIN_MITRE.get=function(){return 2},Fa.JOIN_BEVEL.get=function(){return 3},Fa.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Fa.DEFAULT_MITRE_LIMIT.get=function(){return 5},Fa.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Er,Fa);var Dr=function(l){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Wt.COUNTERCLOCKWISE,this._inputLine=l||null},oc={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Dr.prototype.isDeletable=function(l,h,y,w){var D=this._inputLine[l],z=this._inputLine[h],G=this._inputLine[y];return!!this.isConcave(D,z,G)&&!!this.isShallow(D,z,G,w)&&this.isShallowSampled(D,z,l,y,w)},Dr.prototype.deleteShallowConcavities=function(){for(var l=1,h=this.findNextNonDeletedIndex(l),y=this.findNextNonDeletedIndex(h),w=!1;y<this._inputLine.length;){var D=!1;this.isDeletable(l,h,y,this._distanceTol)&&(this._isDeleted[h]=Dr.DELETE,D=!0,w=!0),h=this.findNextNonDeletedIndex(l=D?y:h),y=this.findNextNonDeletedIndex(h)}return w},Dr.prototype.isShallowConcavity=function(l,h,y,w){return Wt.computeOrientation(l,h,y)===this._angleOrientation&&Wt.distancePointLine(h,l,y)<w},Dr.prototype.isShallowSampled=function(l,h,y,w,D){var z=Math.trunc((w-y)/Dr.NUM_PTS_TO_CHECK);z<=0&&(z=1);for(var G=y;G<w;G+=z)if(!this.isShallow(l,h,this._inputLine[G],D))return!1;return!0},Dr.prototype.isConcave=function(l,h,y){return Wt.computeOrientation(l,h,y)===this._angleOrientation},Dr.prototype.simplify=function(l){this._distanceTol=Math.abs(l),l<0&&(this._angleOrientation=Wt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var h=!1;do{h=this.deleteShallowConcavities()}while(h);return this.collapseLine()},Dr.prototype.findNextNonDeletedIndex=function(l){for(var h=l+1;h<this._inputLine.length&&this._isDeleted[h]===Dr.DELETE;)h++;return h},Dr.prototype.isShallow=function(l,h,y,w){return Wt.distancePointLine(h,l,y)<w},Dr.prototype.collapseLine=function(){for(var l=new It,h=0;h<this._inputLine.length;h++)this._isDeleted[h]!==Dr.DELETE&&l.add(this._inputLine[h]);return l.toCoordinateArray()},Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.simplify=function(l,h){return new Dr(l).simplify(h)},oc.INIT.get=function(){return 0},oc.DELETE.get=function(){return 1},oc.KEEP.get=function(){return 1},oc.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Dr,oc);var fa=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ke},ff={COORDINATE_ARRAY_TYPE:{configurable:!0}};fa.prototype.getCoordinates=function(){return this._ptList.toArray(fa.COORDINATE_ARRAY_TYPE)},fa.prototype.setPrecisionModel=function(l){this._precisionModel=l},fa.prototype.addPt=function(l){var h=new ne(l);if(this._precisionModel.makePrecise(h),this.isRedundant(h))return null;this._ptList.add(h)},fa.prototype.revere=function(){},fa.prototype.addPts=function(l,h){if(h)for(var y=0;y<l.length;y++)this.addPt(l[y]);else for(var w=l.length-1;w>=0;w--)this.addPt(l[w])},fa.prototype.isRedundant=function(l){if(this._ptList.size()<1)return!1;var h=this._ptList.get(this._ptList.size()-1);return l.distance(h)<this._minimimVertexDistance},fa.prototype.toString=function(){return(new gi).createLineString(this.getCoordinates()).toString()},fa.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var l=new ne(this._ptList.get(0)),h=this._ptList.get(this._ptList.size()-1);if(l.equals(h))return null;this._ptList.add(l)},fa.prototype.setMinimumVertexDistance=function(l){this._minimimVertexDistance=l},fa.prototype.interfaces_=function(){return[]},fa.prototype.getClass=function(){return fa},ff.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(fa,ff);var Ki=function(){},Du={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki},Ki.toDegrees=function(l){return 180*l/Math.PI},Ki.normalize=function(l){for(;l>Math.PI;)l-=Ki.PI_TIMES_2;for(;l<=-Math.PI;)l+=Ki.PI_TIMES_2;return l},Ki.angle=function(){if(1===arguments.length){var l=arguments[0];return Math.atan2(l.y,l.x)}if(2===arguments.length){var h=arguments[0],y=arguments[1];return Math.atan2(y.y-h.y,y.x-h.x)}},Ki.isAcute=function(l,h,y){return(l.x-h.x)*(y.x-h.x)+(l.y-h.y)*(y.y-h.y)>0},Ki.isObtuse=function(l,h,y){return(l.x-h.x)*(y.x-h.x)+(l.y-h.y)*(y.y-h.y)<0},Ki.interiorAngle=function(l,h,y){var w=Ki.angle(h,l),D=Ki.angle(h,y);return Math.abs(D-w)},Ki.normalizePositive=function(l){if(l<0){for(;l<0;)l+=Ki.PI_TIMES_2;l>=Ki.PI_TIMES_2&&(l=0)}else{for(;l>=Ki.PI_TIMES_2;)l-=Ki.PI_TIMES_2;l<0&&(l=0)}return l},Ki.angleBetween=function(l,h,y){var w=Ki.angle(h,l),D=Ki.angle(h,y);return Ki.diff(w,D)},Ki.diff=function(l,h){var y=null;return(y=l<h?h-l:l-h)>Math.PI&&(y=2*Math.PI-y),y},Ki.toRadians=function(l){return l*Math.PI/180},Ki.getTurn=function(l,h){var y=Math.sin(h-l);return y>0?Ki.COUNTERCLOCKWISE:y<0?Ki.CLOCKWISE:Ki.NONE},Ki.angleBetweenOriented=function(l,h,y){var w=Ki.angle(h,l),D=Ki.angle(h,y)-w;return D<=-Math.PI?D+Ki.PI_TIMES_2:D>Math.PI?D-Ki.PI_TIMES_2:D},Du.PI_TIMES_2.get=function(){return 2*Math.PI},Du.PI_OVER_2.get=function(){return Math.PI/2},Du.PI_OVER_4.get=function(){return Math.PI/4},Du.COUNTERCLOCKWISE.get=function(){return Wt.COUNTERCLOCKWISE},Du.CLOCKWISE.get=function(){return Wt.CLOCKWISE},Du.NONE.get=function(){return Wt.COLLINEAR},Object.defineProperties(Ki,Du);var To=function l(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ci,this._seg1=new ci,this._offset0=new ci,this._offset1=new ci,this._side=0,this._hasNarrowConcaveAngle=!1;var y=arguments[1],w=arguments[2];this._precisionModel=arguments[0],this._bufParams=y,this._li=new Gt,this._filletAngleQuantum=Math.PI/2/y.getQuadrantSegments(),y.getQuadrantSegments()>=8&&y.getJoinStyle()===Er.JOIN_ROUND&&(this._closingSegLengthFactor=l.MAX_CLOSING_SEG_LEN_FACTOR),this.init(w)},Zu={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};To.prototype.addNextSegment=function(l,h){if(this._s0=this._s1,this._s1=this._s2,this._s2=l,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var y=Wt.computeOrientation(this._s0,this._s1,this._s2),w=y===Wt.CLOCKWISE&&this._side===nn.LEFT||y===Wt.COUNTERCLOCKWISE&&this._side===nn.RIGHT;0===y?this.addCollinear(h):w?this.addOutsideTurn(y,h):this.addInsideTurn(y,h)},To.prototype.addLineEndCap=function(l,h){var y=new ci(l,h),w=new ci;this.computeOffsetSegment(y,nn.LEFT,this._distance,w);var D=new ci;this.computeOffsetSegment(y,nn.RIGHT,this._distance,D);var ie=Math.atan2(h.y-l.y,h.x-l.x);switch(this._bufParams.getEndCapStyle()){case Er.CAP_ROUND:this._segList.addPt(w.p1),this.addFilletArc(h,ie+Math.PI/2,ie-Math.PI/2,Wt.CLOCKWISE,this._distance),this._segList.addPt(D.p1);break;case Er.CAP_FLAT:this._segList.addPt(w.p1),this._segList.addPt(D.p1);break;case Er.CAP_SQUARE:var Oe=new ne;Oe.x=Math.abs(this._distance)*Math.cos(ie),Oe.y=Math.abs(this._distance)*Math.sin(ie);var lt=new ne(w.p1.x+Oe.x,w.p1.y+Oe.y),kt=new ne(D.p1.x+Oe.x,D.p1.y+Oe.y);this._segList.addPt(lt),this._segList.addPt(kt)}},To.prototype.getCoordinates=function(){return this._segList.getCoordinates()},To.prototype.addMitreJoin=function(l,h,y,w){var D=!0,z=null;try{z=Qn.intersection(h.p0,h.p1,y.p0,y.p1),(w<=0?1:z.distance(l)/Math.abs(w))>this._bufParams.getMitreLimit()&&(D=!1)}catch(G){if(!(G instanceof Jn))throw G;z=new ne(0,0),D=!1}D?this._segList.addPt(z):this.addLimitedMitreJoin(h,y,w,this._bufParams.getMitreLimit())},To.prototype.addFilletCorner=function(l,h,y,w,D){var ie=Math.atan2(h.y-l.y,h.x-l.x),kt=Math.atan2(y.y-l.y,y.x-l.x);w===Wt.CLOCKWISE?ie<=kt&&(ie+=2*Math.PI):ie>=kt&&(ie-=2*Math.PI),this._segList.addPt(h),this.addFilletArc(l,ie,kt,w,D),this._segList.addPt(y)},To.prototype.addOutsideTurn=function(l,h){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*To.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Er.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Er.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(h&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,l,this._distance),this._segList.addPt(this._offset1.p0))},To.prototype.createSquare=function(l){this._segList.addPt(new ne(l.x+this._distance,l.y+this._distance)),this._segList.addPt(new ne(l.x+this._distance,l.y-this._distance)),this._segList.addPt(new ne(l.x-this._distance,l.y-this._distance)),this._segList.addPt(new ne(l.x-this._distance,l.y+this._distance)),this._segList.closeRing()},To.prototype.addSegments=function(l,h){this._segList.addPts(l,h)},To.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},To.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},To.prototype.initSideSegments=function(l,h,y){this._s1=l,this._s2=h,this._side=y,this._seg1.setCoordinates(l,h),this.computeOffsetSegment(this._seg1,y,this._distance,this._offset1)},To.prototype.addLimitedMitreJoin=function(l,h,y,w){var D=this._seg0.p1,z=Ki.angle(D,this._seg0.p0),G=Ki.angleBetweenOriented(this._seg0.p0,D,this._seg1.p1)/2,ie=Ki.normalize(z+G),Oe=Ki.normalize(ie+Math.PI),lt=w*y,kt=y-lt*Math.abs(Math.sin(G)),Zt=D.x+lt*Math.cos(Oe),Un=D.y+lt*Math.sin(Oe),Fn=new ne(Zt,Un),Xn=new ci(D,Fn),hi=Xn.pointAlongOffset(1,kt),Sr=Xn.pointAlongOffset(1,-kt);this._side===nn.LEFT?(this._segList.addPt(hi),this._segList.addPt(Sr)):(this._segList.addPt(Sr),this._segList.addPt(hi))},To.prototype.computeOffsetSegment=function(l,h,y,w){var D=h===nn.LEFT?1:-1,z=l.p1.x-l.p0.x,G=l.p1.y-l.p0.y,ie=Math.sqrt(z*z+G*G),Oe=D*y*z/ie,lt=D*y*G/ie;w.p0.x=l.p0.x-lt,w.p0.y=l.p0.y+Oe,w.p1.x=l.p1.x-lt,w.p1.y=l.p1.y+Oe},To.prototype.addFilletArc=function(l,h,y,w,D){var z=w===Wt.CLOCKWISE?-1:1,G=Math.abs(h-y),ie=Math.trunc(G/this._filletAngleQuantum+.5);if(ie<1)return null;for(var Oe=G/ie,lt=0,kt=new ne;lt<G;){var Zt=h+z*lt;kt.x=l.x+D*Math.cos(Zt),kt.y=l.y+D*Math.sin(Zt),this._segList.addPt(kt),lt+=Oe}},To.prototype.addInsideTurn=function(l,h){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*To.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var y=new ne((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(y);var w=new ne((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(w)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},To.prototype.createCircle=function(l){var h=new ne(l.x+this._distance,l.y);this._segList.addPt(h),this.addFilletArc(l,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},To.prototype.addBevelJoin=function(l,h){this._segList.addPt(l.p1),this._segList.addPt(h.p0)},To.prototype.init=function(l){this._distance=l,this._maxCurveSegmentError=l*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new fa,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(l*To.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},To.prototype.addCollinear=function(l){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Er.JOIN_BEVEL||this._bufParams.getJoinStyle()===Er.JOIN_MITRE?(l&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Wt.CLOCKWISE,this._distance))},To.prototype.closeRing=function(){this._segList.closeRing()},To.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To},Zu.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Zu.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Zu.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Zu.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(To,Zu);var Ea=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var h=arguments[1];this._precisionModel=arguments[0],this._bufParams=h};Ea.prototype.getOffsetCurve=function(l,h){if(this._distance=h,0===h)return null;var y=h<0,w=Math.abs(h),D=this.getSegGen(w);l.length<=1?this.computePointCurve(l[0],D):this.computeOffsetCurve(l,y,D);var z=D.getCoordinates();return y&&Ye.reverse(z),z},Ea.prototype.computeSingleSidedBufferCurve=function(l,h,y){var w=this.simplifyTolerance(this._distance);if(h){y.addSegments(l,!0);var D=Dr.simplify(l,-w),z=D.length-1;y.initSideSegments(D[z],D[z-1],nn.LEFT),y.addFirstSegment();for(var G=z-2;G>=0;G--)y.addNextSegment(D[G],!0)}else{y.addSegments(l,!1);var ie=Dr.simplify(l,w),Oe=ie.length-1;y.initSideSegments(ie[0],ie[1],nn.LEFT),y.addFirstSegment();for(var lt=2;lt<=Oe;lt++)y.addNextSegment(ie[lt],!0)}y.addLastSegment(),y.closeRing()},Ea.prototype.computeRingBufferCurve=function(l,h,y){var w=this.simplifyTolerance(this._distance);h===nn.RIGHT&&(w=-w);var D=Dr.simplify(l,w),z=D.length-1;y.initSideSegments(D[z-1],D[0],h);for(var G=1;G<=z;G++)y.addNextSegment(D[G],1!==G);y.closeRing()},Ea.prototype.computeLineBufferCurve=function(l,h){var y=this.simplifyTolerance(this._distance),w=Dr.simplify(l,y),D=w.length-1;h.initSideSegments(w[0],w[1],nn.LEFT);for(var z=2;z<=D;z++)h.addNextSegment(w[z],!0);h.addLastSegment(),h.addLineEndCap(w[D-1],w[D]);var G=Dr.simplify(l,-y),ie=G.length-1;h.initSideSegments(G[ie],G[ie-1],nn.LEFT);for(var Oe=ie-2;Oe>=0;Oe--)h.addNextSegment(G[Oe],!0);h.addLastSegment(),h.addLineEndCap(G[1],G[0]),h.closeRing()},Ea.prototype.computePointCurve=function(l,h){switch(this._bufParams.getEndCapStyle()){case Er.CAP_ROUND:h.createCircle(l);break;case Er.CAP_SQUARE:h.createSquare(l)}},Ea.prototype.getLineCurve=function(l,h){if(this._distance=h,h<0&&!this._bufParams.isSingleSided()||0===h)return null;var y=Math.abs(h),w=this.getSegGen(y);return l.length<=1?this.computePointCurve(l[0],w):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(l,h<0,w):this.computeLineBufferCurve(l,w),w.getCoordinates()},Ea.prototype.getBufferParameters=function(){return this._bufParams},Ea.prototype.simplifyTolerance=function(l){return l*this._bufParams.getSimplifyFactor()},Ea.prototype.getRingCurve=function(l,h,y){if(this._distance=y,l.length<=2)return this.getLineCurve(l,y);if(0===y)return Ea.copyCoordinates(l);var w=this.getSegGen(y);return this.computeRingBufferCurve(l,h,w),w.getCoordinates()},Ea.prototype.computeOffsetCurve=function(l,h,y){var w=this.simplifyTolerance(this._distance);if(h){var D=Dr.simplify(l,-w),z=D.length-1;y.initSideSegments(D[z],D[z-1],nn.LEFT),y.addFirstSegment();for(var G=z-2;G>=0;G--)y.addNextSegment(D[G],!0)}else{var ie=Dr.simplify(l,w),Oe=ie.length-1;y.initSideSegments(ie[0],ie[1],nn.LEFT),y.addFirstSegment();for(var lt=2;lt<=Oe;lt++)y.addNextSegment(ie[lt],!0)}y.addLastSegment()},Ea.prototype.getSegGen=function(l){return new To(this._precisionModel,this._bufParams,l)},Ea.prototype.interfaces_=function(){return[]},Ea.prototype.getClass=function(){return Ea},Ea.copyCoordinates=function(l){for(var h=new Array(l.length).fill(null),y=0;y<h.length;y++)h[y]=new ne(l[y]);return h};var Tu=function(){this._subgraphs=null,this._seg=new ci,this._cga=new Wt,this._subgraphs=arguments[0]},hr={DepthSegment:{configurable:!0}};Tu.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var l=arguments[0],h=new ke,y=this._subgraphs.iterator();y.hasNext();){var w=y.next(),D=w.getEnvelope();l.y<D.getMinY()||l.y>D.getMaxY()||this.findStabbedSegments(l,w.getDirectedEdges(),h)}return h}if(3===arguments.length)if(Lt(arguments[2],et)&&arguments[0]instanceof ne&&arguments[1]instanceof Cs){for(var z=arguments[0],G=arguments[1],ie=arguments[2],Oe=G.getEdge().getCoordinates(),lt=0;lt<Oe.length-1;lt++)if(this._seg.p0=Oe[lt],this._seg.p1=Oe[lt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<z.x||this._seg.isHorizontal()||z.y<this._seg.p0.y||z.y>this._seg.p1.y||Wt.computeOrientation(this._seg.p0,this._seg.p1,z)===Wt.RIGHT)){var kt=G.getDepth(nn.LEFT);this._seg.p0.equals(Oe[lt])||(kt=G.getDepth(nn.RIGHT));var Zt=new wl(this._seg,kt);ie.add(Zt)}}else if(Lt(arguments[2],et)&&arguments[0]instanceof ne&&Lt(arguments[1],et))for(var Un=arguments[0],Xn=arguments[2],hi=arguments[1].iterator();hi.hasNext();){var Sr=hi.next();Sr.isForward()&&this.findStabbedSegments(Un,Sr,Xn)}},Tu.prototype.getDepth=function(l){var h=this.findStabbedSegments(l);return 0===h.size()?0:xi.min(h)._leftDepth},Tu.prototype.interfaces_=function(){return[]},Tu.prototype.getClass=function(){return Tu},hr.DepthSegment.get=function(){return wl},Object.defineProperties(Tu,hr);var wl=function(){this._upwardSeg=null,this._leftDepth=null;var h=arguments[1];this._upwardSeg=new ci(arguments[0]),this._leftDepth=h};wl.prototype.compareTo=function(l){var h=l;if(this._upwardSeg.minX()>=h._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=h._upwardSeg.minX())return-1;var y=this._upwardSeg.orientationIndex(h._upwardSeg);return 0!==y||0!=(y=-1*h._upwardSeg.orientationIndex(this._upwardSeg))?y:this._upwardSeg.compareTo(h._upwardSeg)},wl.prototype.compareX=function(l,h){var y=l.p0.compareTo(h.p0);return 0!==y?y:l.p1.compareTo(h.p1)},wl.prototype.toString=function(){return this._upwardSeg.toString()},wl.prototype.interfaces_=function(){return[de]},wl.prototype.getClass=function(){return wl};var gr=function(l,h,y){this.p0=l||null,this.p1=h||null,this.p2=y||null};gr.prototype.area=function(){return gr.area(this.p0,this.p1,this.p2)},gr.prototype.signedArea=function(){return gr.signedArea(this.p0,this.p1,this.p2)},gr.prototype.interpolateZ=function(l){if(null===l)throw new ge("Supplied point is null.");return gr.interpolateZ(l,this.p0,this.p1,this.p2)},gr.prototype.longestSideLength=function(){return gr.longestSideLength(this.p0,this.p1,this.p2)},gr.prototype.isAcute=function(){return gr.isAcute(this.p0,this.p1,this.p2)},gr.prototype.circumcentre=function(){return gr.circumcentre(this.p0,this.p1,this.p2)},gr.prototype.area3D=function(){return gr.area3D(this.p0,this.p1,this.p2)},gr.prototype.centroid=function(){return gr.centroid(this.p0,this.p1,this.p2)},gr.prototype.inCentre=function(){return gr.inCentre(this.p0,this.p1,this.p2)},gr.prototype.interfaces_=function(){return[]},gr.prototype.getClass=function(){return gr},gr.area=function(l,h,y){return Math.abs(((y.x-l.x)*(h.y-l.y)-(h.x-l.x)*(y.y-l.y))/2)},gr.signedArea=function(l,h,y){return((y.x-l.x)*(h.y-l.y)-(h.x-l.x)*(y.y-l.y))/2},gr.det=function(l,h,y,w){return l*w-h*y},gr.interpolateZ=function(l,h,y,w){var D=h.x,z=h.y,G=y.x-D,ie=w.x-D,Oe=y.y-z,lt=w.y-z,kt=G*lt-ie*Oe,Zt=l.x-D,Un=l.y-z;return h.z+(lt*Zt-ie*Un)/kt*(y.z-h.z)+(-Oe*Zt+G*Un)/kt*(w.z-h.z)},gr.longestSideLength=function(l,h,y){var w=l.distance(h),D=h.distance(y),z=y.distance(l),G=w;return D>G&&(G=D),z>G&&(G=z),G},gr.isAcute=function(l,h,y){return!!Ki.isAcute(l,h,y)&&!!Ki.isAcute(h,y,l)&&!!Ki.isAcute(y,l,h)},gr.circumcentre=function(l,h,y){var w=y.x,D=y.y,z=l.x-w,G=l.y-D,ie=h.x-w,Oe=h.y-D,lt=2*gr.det(z,G,ie,Oe),kt=gr.det(G,z*z+G*G,Oe,ie*ie+Oe*Oe),Zt=gr.det(z,z*z+G*G,ie,ie*ie+Oe*Oe);return new ne(w-kt/lt,D+Zt/lt)},gr.perpendicularBisector=function(l,h){var y=h.x-l.x,w=h.y-l.y,D=new Qn(l.x+y/2,l.y+w/2,1),z=new Qn(l.x-w+y/2,l.y+y+w/2,1);return new Qn(D,z)},gr.angleBisector=function(l,h,y){var w=h.distance(l),D=w/(w+h.distance(y));return new ne(l.x+D*(y.x-l.x),l.y+D*(y.y-l.y))},gr.area3D=function(l,h,y){var w=h.x-l.x,D=h.y-l.y,z=h.z-l.z,G=y.x-l.x,ie=y.y-l.y,Oe=y.z-l.z,lt=D*Oe-z*ie,kt=z*G-w*Oe,Zt=w*ie-D*G;return Math.sqrt(lt*lt+kt*kt+Zt*Zt)/2},gr.centroid=function(l,h,y){return new ne((l.x+h.x+y.x)/3,(l.y+h.y+y.y)/3)},gr.inCentre=function(l,h,y){var w=h.distance(y),D=l.distance(y),z=l.distance(h),G=w+D+z;return new ne((w*l.x+D*h.x+z*y.x)/G,(w*l.y+D*h.y+z*y.y)/G)};var Ya=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ke;var h=arguments[1],y=arguments[2];this._inputGeom=arguments[0],this._distance=h,this._curveBuilder=y};Ya.prototype.addPoint=function(l){if(this._distance<=0)return null;var h=l.getCoordinates(),y=this._curveBuilder.getLineCurve(h,this._distance);this.addCurve(y,Me.EXTERIOR,Me.INTERIOR)},Ya.prototype.addPolygon=function(l){var h=this._distance,y=nn.LEFT;this._distance<0&&(h=-this._distance,y=nn.RIGHT);var w=l.getExteriorRing(),D=Ye.removeRepeatedPoints(w.getCoordinates());if(this._distance<0&&this.isErodedCompletely(w,this._distance)||this._distance<=0&&D.length<3)return null;this.addPolygonRing(D,h,y,Me.EXTERIOR,Me.INTERIOR);for(var z=0;z<l.getNumInteriorRing();z++){var G=l.getInteriorRingN(z),ie=Ye.removeRepeatedPoints(G.getCoordinates());this._distance>0&&this.isErodedCompletely(G,-this._distance)||this.addPolygonRing(ie,h,nn.opposite(y),Me.INTERIOR,Me.EXTERIOR)}},Ya.prototype.isTriangleErodedCompletely=function(l,h){var y=new gr(l[0],l[1],l[2]),w=y.inCentre();return Wt.distancePointLine(w,y.p0,y.p1)<Math.abs(h)},Ya.prototype.addLineString=function(l){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var h=Ye.removeRepeatedPoints(l.getCoordinates()),y=this._curveBuilder.getLineCurve(h,this._distance);this.addCurve(y,Me.EXTERIOR,Me.INTERIOR)},Ya.prototype.addCurve=function(l,h,y){if(null===l||l.length<2)return null;var w=new jo(l,new mr(0,Me.BOUNDARY,h,y));this._curveList.add(w)},Ya.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Ya.prototype.addPolygonRing=function(l,h,y,w,D){if(0===h&&l.length<ka.MINIMUM_VALID_SIZE)return null;var z=w,G=D;l.length>=ka.MINIMUM_VALID_SIZE&&Wt.isCCW(l)&&(z=D,G=w,y=nn.opposite(y));var ie=this._curveBuilder.getRingCurve(l,y,h);this.addCurve(ie,z,G)},Ya.prototype.add=function(l){if(l.isEmpty())return null;l instanceof rs?this.addPolygon(l):l instanceof Yo?this.addLineString(l):l instanceof is?this.addPoint(l):(l instanceof ic||l instanceof Ll||l instanceof da||l instanceof go)&&this.addCollection(l)},Ya.prototype.isErodedCompletely=function(l,h){var y=l.getCoordinates();if(y.length<4)return h<0;if(4===y.length)return this.isTriangleErodedCompletely(y,h);var w=l.getEnvelopeInternal(),D=Math.min(w.getHeight(),w.getWidth());return h<0&&2*Math.abs(h)>D},Ya.prototype.addCollection=function(l){for(var h=0;h<l.getNumGeometries();h++){var y=l.getGeometryN(h);this.add(y)}},Ya.prototype.interfaces_=function(){return[]},Ya.prototype.getClass=function(){return Ya};var Xu=function(){};Xu.prototype.locate=function(l){},Xu.prototype.interfaces_=function(){return[]},Xu.prototype.getClass=function(){return Xu};var Ba=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var l=arguments[0];this._parent=l,this._atStart=!0,this._index=0,this._max=l.getNumGeometries()};Ba.prototype.next=function(){if(this._atStart)return this._atStart=!1,Ba.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new at;var l=this._parent.getGeometryN(this._index++);return l instanceof go?(this._subcollectionIterator=new Ba(l),this._subcollectionIterator.next()):l},Ba.prototype.remove=function(){throw new Error(this.getClass().getName())},Ba.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Ba.prototype.interfaces_=function(){return[je]},Ba.prototype.getClass=function(){return Ba},Ba.isAtomic=function(l){return!(l instanceof go)};var Da=function(){this._geom=null,this._geom=arguments[0]};Da.prototype.locate=function(l){return Da.locate(l,this._geom)},Da.prototype.interfaces_=function(){return[Xu]},Da.prototype.getClass=function(){return Da},Da.isPointInRing=function(l,h){return!!h.getEnvelopeInternal().intersects(l)&&Wt.isPointInRing(l,h.getCoordinates())},Da.containsPointInPolygon=function(l,h){if(h.isEmpty())return!1;var y=h.getExteriorRing();if(!Da.isPointInRing(l,y))return!1;for(var w=0;w<h.getNumInteriorRing();w++){var D=h.getInteriorRingN(w);if(Da.isPointInRing(l,D))return!1}return!0},Da.containsPoint=function(l,h){if(h instanceof rs)return Da.containsPointInPolygon(l,h);if(h instanceof go)for(var y=new Ba(h);y.hasNext();){var w=y.next();if(w!==h&&Da.containsPoint(l,w))return!0}return!1},Da.locate=function(l,h){return h.isEmpty()?Me.EXTERIOR:Da.containsPoint(l,h)?Me.INTERIOR:Me.EXTERIOR};var Ss=function(){this._edgeMap=new Mt,this._edgeList=null,this._ptInAreaLocation=[Me.NONE,Me.NONE]};Ss.prototype.getNextCW=function(l){this.getEdges();var h=this._edgeList.indexOf(l),y=h-1;return 0===h&&(y=this._edgeList.size()-1),this._edgeList.get(y)},Ss.prototype.propagateSideLabels=function(l){for(var h=Me.NONE,y=this.iterator();y.hasNext();){var w=y.next().getLabel();w.isArea(l)&&w.getLocation(l,nn.LEFT)!==Me.NONE&&(h=w.getLocation(l,nn.LEFT))}if(h===Me.NONE)return null;for(var D=h,z=this.iterator();z.hasNext();){var G=z.next(),ie=G.getLabel();if(ie.getLocation(l,nn.ON)===Me.NONE&&ie.setLocation(l,nn.ON,D),ie.isArea(l)){var Oe=ie.getLocation(l,nn.LEFT),lt=ie.getLocation(l,nn.RIGHT);if(lt!==Me.NONE){if(lt!==D)throw new vl("side location conflict",G.getCoordinate());Oe===Me.NONE&&le.shouldNeverReachHere("found single null side (at "+G.getCoordinate()+")"),D=Oe}else le.isTrue(ie.getLocation(l,nn.LEFT)===Me.NONE,"found single null side"),ie.setLocation(l,nn.RIGHT,D),ie.setLocation(l,nn.LEFT,D)}}},Ss.prototype.getCoordinate=function(){var l=this.iterator();return l.hasNext()?l.next().getCoordinate():null},Ss.prototype.print=function(l){Kt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var h=this.iterator();h.hasNext();)h.next().print(l)},Ss.prototype.isAreaLabelsConsistent=function(l){return this.computeEdgeEndLabels(l.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Ss.prototype.checkAreaLabelsConsistent=function(l){var h=this.getEdges();if(h.size()<=0)return!0;var y=h.size()-1,w=h.get(y).getLabel().getLocation(l,nn.LEFT);le.isTrue(w!==Me.NONE,"Found unlabelled area edge");for(var D=w,z=this.iterator();z.hasNext();){var G=z.next().getLabel();le.isTrue(G.isArea(l),"Found non-area edge");var ie=G.getLocation(l,nn.LEFT),Oe=G.getLocation(l,nn.RIGHT);if(ie===Oe||Oe!==D)return!1;D=ie}return!0},Ss.prototype.findIndex=function(l){this.iterator();for(var h=0;h<this._edgeList.size();h++)if(this._edgeList.get(h)===l)return h;return-1},Ss.prototype.iterator=function(){return this.getEdges().iterator()},Ss.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new ke(this._edgeMap.values())),this._edgeList},Ss.prototype.getLocation=function(l,h,y){return this._ptInAreaLocation[l]===Me.NONE&&(this._ptInAreaLocation[l]=Da.locate(h,y[l].getGeometry())),this._ptInAreaLocation[l]},Ss.prototype.toString=function(){var l=new Re;l.append("EdgeEndStar:   "+this.getCoordinate()),l.append("\n");for(var h=this.iterator();h.hasNext();){var y=h.next();l.append(y),l.append("\n")}return l.toString()},Ss.prototype.computeEdgeEndLabels=function(l){for(var h=this.iterator();h.hasNext();)h.next().computeLabel(l)},Ss.prototype.computeLabelling=function(l){this.computeEdgeEndLabels(l[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var h=[!1,!1],y=this.iterator();y.hasNext();)for(var w=y.next().getLabel(),D=0;D<2;D++)w.isLine(D)&&w.getLocation(D)===Me.BOUNDARY&&(h[D]=!0);for(var z=this.iterator();z.hasNext();)for(var G=z.next(),ie=G.getLabel(),Oe=0;Oe<2;Oe++)if(ie.isAnyNull(Oe)){var lt=Me.NONE;if(h[Oe])lt=Me.EXTERIOR;else{var kt=G.getCoordinate();lt=this.getLocation(Oe,kt,l)}ie.setAllLocationsIfNull(Oe,lt)}},Ss.prototype.getDegree=function(){return this._edgeMap.size()},Ss.prototype.insertEdgeEnd=function(l,h){this._edgeMap.put(l,h),this._edgeList=null},Ss.prototype.interfaces_=function(){return[]},Ss.prototype.getClass=function(){return Ss};var dm=function(l){function h(){l.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var y=null,w=null,D=this._SCANNING_FOR_INCOMING,z=0;z<this._resultAreaEdgeList.size();z++){var G=this._resultAreaEdgeList.get(z),ie=G.getSym();if(G.getLabel().isArea())switch(null===y&&G.isInResult()&&(y=G),D){case this._SCANNING_FOR_INCOMING:if(!ie.isInResult())continue;w=ie,D=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!G.isInResult())continue;w.setNext(G),D=this._SCANNING_FOR_INCOMING}}if(D===this._LINKING_TO_OUTGOING){if(null===y)throw new vl("no outgoing dirEdge found",this.getCoordinate());le.isTrue(y.isInResult(),"unable to link last incoming dirEdge"),w.setNext(y)}},h.prototype.insert=function(y){this.insertEdgeEnd(y,y)},h.prototype.getRightmostEdge=function(){var y=this.getEdges(),w=y.size();if(w<1)return null;var D=y.get(0);if(1===w)return D;var z=y.get(w-1),G=D.getQuadrant(),ie=z.getQuadrant();return Pi.isNorthern(G)&&Pi.isNorthern(ie)?D:Pi.isNorthern(G)||Pi.isNorthern(ie)?0!==D.getDy()?D:0!==z.getDy()?z:(le.shouldNeverReachHere("found two horizontal edges incident on node"),null):z},h.prototype.print=function(y){Kt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var w=this.iterator();w.hasNext();){var D=w.next();y.print("out "),D.print(y),y.println(),y.print("in "),D.getSym().print(y),y.println()}},h.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ke;for(var y=this.iterator();y.hasNext();){var w=y.next();(w.isInResult()||w.getSym().isInResult())&&this._resultAreaEdgeList.add(w)}return this._resultAreaEdgeList},h.prototype.updateLabelling=function(y){for(var w=this.iterator();w.hasNext();){var D=w.next().getLabel();D.setAllLocationsIfNull(0,y.getLocation(0)),D.setAllLocationsIfNull(1,y.getLocation(1))}},h.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var y=null,w=null,D=this._edgeList.size()-1;D>=0;D--){var z=this._edgeList.get(D),G=z.getSym();null===w&&(w=G),null!==y&&G.setNext(y),y=z}w.setNext(y)},h.prototype.computeDepths=function(){if(1===arguments.length){var y=arguments[0],w=this.findIndex(y),D=y.getDepth(nn.LEFT),z=y.getDepth(nn.RIGHT),G=this.computeDepths(w+1,this._edgeList.size(),D);if(this.computeDepths(0,w,G)!==z)throw new vl("depth mismatch at "+y.getCoordinate())}else if(3===arguments.length){for(var Oe=arguments[1],lt=arguments[2],kt=arguments[0];kt<Oe;kt++){var Zt=this._edgeList.get(kt);Zt.setEdgeDepths(nn.RIGHT,lt),lt=Zt.getDepth(nn.LEFT)}return lt}},h.prototype.mergeSymLabels=function(){for(var y=this.iterator();y.hasNext();){var w=y.next();w.getLabel().merge(w.getSym().getLabel())}},h.prototype.linkMinimalDirectedEdges=function(y){for(var w=null,D=null,z=this._SCANNING_FOR_INCOMING,G=this._resultAreaEdgeList.size()-1;G>=0;G--){var ie=this._resultAreaEdgeList.get(G),Oe=ie.getSym();switch(null===w&&ie.getEdgeRing()===y&&(w=ie),z){case this._SCANNING_FOR_INCOMING:if(Oe.getEdgeRing()!==y)continue;D=Oe,z=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ie.getEdgeRing()!==y)continue;D.setNextMin(ie),z=this._SCANNING_FOR_INCOMING}}z===this._LINKING_TO_OUTGOING&&(le.isTrue(null!==w,"found null for first outgoing dirEdge"),le.isTrue(w.getEdgeRing()===y,"unable to link last incoming dirEdge"),D.setNextMin(w))},h.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var y=0,w=this.iterator();w.hasNext();)w.next().isInResult()&&y++;return y}if(1===arguments.length){for(var D=arguments[0],z=0,G=this.iterator();G.hasNext();)G.next().getEdgeRing()===D&&z++;return z}},h.prototype.getLabel=function(){return this._label},h.prototype.findCoveredLineEdges=function(){for(var y=Me.NONE,w=this.iterator();w.hasNext();){var D=w.next(),z=D.getSym();if(!D.isLineEdge()){if(D.isInResult()){y=Me.INTERIOR;break}if(z.isInResult()){y=Me.EXTERIOR;break}}}if(y===Me.NONE)return null;for(var G=y,ie=this.iterator();ie.hasNext();){var Oe=ie.next(),lt=Oe.getSym();Oe.isLineEdge()?Oe.getEdge().setCovered(G===Me.INTERIOR):(Oe.isInResult()&&(G=Me.EXTERIOR),lt.isInResult()&&(G=Me.INTERIOR))}},h.prototype.computeLabelling=function(y){l.prototype.computeLabelling.call(this,y),this._label=new mr(Me.NONE);for(var w=this.iterator();w.hasNext();)for(var D=w.next().getEdge().getLabel(),z=0;z<2;z++){var G=D.getLocation(z);G!==Me.INTERIOR&&G!==Me.BOUNDARY||this._label.setLocation(z,Me.INTERIOR)}},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Ss),nu=function(l){function h(){l.apply(this,arguments)}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.createNode=function(y){return new pd(y,new dm)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Za),Cc=function l(){this._pts=null,this._orientation=null;var h=arguments[0];this._pts=h,this._orientation=l.orientation(h)};Cc.prototype.compareTo=function(l){return Cc.compareOriented(this._pts,this._orientation,l._pts,l._orientation)},Cc.prototype.interfaces_=function(){return[de]},Cc.prototype.getClass=function(){return Cc},Cc.orientation=function(l){return 1===Ye.increasingDirection(l)},Cc.compareOriented=function(l,h,y,w){for(var D=h?1:-1,z=w?1:-1,G=h?l.length:-1,ie=w?y.length:-1,Oe=h?0:l.length-1,lt=w?0:y.length-1;;){var kt=l[Oe].compareTo(y[lt]);if(0!==kt)return kt;var Zt=(Oe+=D)===G,Un=(lt+=z)===ie;if(Zt&&!Un)return-1;if(!Zt&&Un)return 1;if(Zt&&Un)return 0}};var Dt=function(){this._edges=new ke,this._ocaMap=new Mt};Dt.prototype.print=function(l){l.print("MULTILINESTRING ( ");for(var h=0;h<this._edges.size();h++){var y=this._edges.get(h);h>0&&l.print(","),l.print("(");for(var w=y.getCoordinates(),D=0;D<w.length;D++)D>0&&l.print(","),l.print(w[D].x+" "+w[D].y);l.println(")")}l.print(")  ")},Dt.prototype.addAll=function(l){for(var h=l.iterator();h.hasNext();)this.add(h.next())},Dt.prototype.findEdgeIndex=function(l){for(var h=0;h<this._edges.size();h++)if(this._edges.get(h).equals(l))return h;return-1},Dt.prototype.iterator=function(){return this._edges.iterator()},Dt.prototype.getEdges=function(){return this._edges},Dt.prototype.get=function(l){return this._edges.get(l)},Dt.prototype.findEqualEdge=function(l){var h=new Cc(l.getCoordinates());return this._ocaMap.get(h)},Dt.prototype.add=function(l){this._edges.add(l);var h=new Cc(l.getCoordinates());this._ocaMap.put(h,l)},Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt};var Sc=function(){};Sc.prototype.processIntersections=function(l,h,y,w){},Sc.prototype.isDone=function(){},Sc.prototype.interfaces_=function(){return[]},Sc.prototype.getClass=function(){return Sc};var Rn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]};Rn.prototype.isTrivialIntersection=function(l,h,y,w){if(l===y&&1===this._li.getIntersectionNum()){if(Rn.isAdjacentSegments(h,w))return!0;if(l.isClosed()){var D=l.size()-1;if(0===h&&w===D||0===w&&h===D)return!0}}return!1},Rn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Rn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Rn.prototype.getLineIntersector=function(){return this._li},Rn.prototype.hasProperIntersection=function(){return this._hasProper},Rn.prototype.processIntersections=function(l,h,y,w){if(l===y&&h===w)return null;this.numTests++;var D=l.getCoordinates()[h],z=l.getCoordinates()[h+1],G=y.getCoordinates()[w],ie=y.getCoordinates()[w+1];this._li.computeIntersection(D,z,G,ie),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(l,h,y,w)||(this._hasIntersection=!0,l.addIntersections(this._li,h,0),y.addIntersections(this._li,w,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Rn.prototype.hasIntersection=function(){return this._hasIntersection},Rn.prototype.isDone=function(){return!1},Rn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Rn.prototype.interfaces_=function(){return[Sc]},Rn.prototype.getClass=function(){return Rn},Rn.isAdjacentSegments=function(l,h){return 1===Math.abs(l-h)};var Ka=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var h=arguments[1],y=arguments[2];this.coord=new ne(arguments[0]),this.segmentIndex=h,this.dist=y};Ka.prototype.getSegmentIndex=function(){return this.segmentIndex},Ka.prototype.getCoordinate=function(){return this.coord},Ka.prototype.print=function(l){l.print(this.coord),l.print(" seg # = "+this.segmentIndex),l.println(" dist = "+this.dist)},Ka.prototype.compareTo=function(l){return this.compare(l.segmentIndex,l.dist)},Ka.prototype.isEndPoint=function(l){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===l},Ka.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Ka.prototype.getDistance=function(){return this.dist},Ka.prototype.compare=function(l,h){return this.segmentIndex<l?-1:this.segmentIndex>l?1:this.dist<h?-1:this.dist>h?1:0},Ka.prototype.interfaces_=function(){return[de]},Ka.prototype.getClass=function(){return Ka};var El=function(){this._nodeMap=new Mt,this.edge=null,this.edge=arguments[0]};El.prototype.print=function(l){l.println("Intersections:");for(var h=this.iterator();h.hasNext();)h.next().print(l)},El.prototype.iterator=function(){return this._nodeMap.values().iterator()},El.prototype.addSplitEdges=function(l){this.addEndpoints();for(var h=this.iterator(),y=h.next();h.hasNext();){var w=h.next(),D=this.createSplitEdge(y,w);l.add(D),y=w}},El.prototype.addEndpoints=function(){var l=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[l],l,0)},El.prototype.createSplitEdge=function(l,h){var y=h.segmentIndex-l.segmentIndex+2,D=h.dist>0||!h.coord.equals2D(this.edge.pts[h.segmentIndex]);D||y--;var z=new Array(y).fill(null),G=0;z[G++]=new ne(l.coord);for(var ie=l.segmentIndex+1;ie<=h.segmentIndex;ie++)z[G++]=this.edge.pts[ie];return D&&(z[G]=h.coord),new Qa(z,new mr(this.edge._label))},El.prototype.add=function(l,h,y){var w=new Ka(l,h,y),D=this._nodeMap.get(w);return null!==D?D:(this._nodeMap.put(w,w),w)},El.prototype.isIntersection=function(l){for(var h=this.iterator();h.hasNext();)if(h.next().coord.equals(l))return!0;return!1},El.prototype.interfaces_=function(){return[]},El.prototype.getClass=function(){return El};var sc=function(){};sc.prototype.getChainStartIndices=function(l){var h=0,y=new ke;y.add(new it(h));do{var w=this.findChainEnd(l,h);y.add(new it(w)),h=w}while(h<l.length-1);return sc.toIntArray(y)},sc.prototype.findChainEnd=function(l,h){for(var y=Pi.quadrant(l[h],l[h+1]),w=h+1;w<l.length&&Pi.quadrant(l[w-1],l[w])===y;)w++;return w-1},sc.prototype.interfaces_=function(){return[]},sc.prototype.getClass=function(){return sc},sc.toIntArray=function(l){for(var h=new Array(l.size()).fill(null),y=0;y<h.length;y++)h[y]=l.get(y).intValue();return h};var Cl=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new mn,this.env2=new mn;var l=arguments[0];this.e=l,this.pts=l.getCoordinates();var h=new sc;this.startIndex=h.getChainStartIndices(this.pts)};Cl.prototype.getCoordinates=function(){return this.pts},Cl.prototype.getMaxX=function(l){var h=this.pts[this.startIndex[l]].x,y=this.pts[this.startIndex[l+1]].x;return h>y?h:y},Cl.prototype.getMinX=function(l){var h=this.pts[this.startIndex[l]].x,y=this.pts[this.startIndex[l+1]].x;return h<y?h:y},Cl.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var l=arguments[0],h=arguments[1],y=arguments[2];this.computeIntersectsForChain(this.startIndex[l],this.startIndex[l+1],h,h.startIndex[y],h.startIndex[y+1],arguments[3])}else if(6===arguments.length){var D=arguments[0],z=arguments[1],G=arguments[2],ie=arguments[3],Oe=arguments[4],lt=arguments[5],kt=this.pts[D],Zt=this.pts[z],Un=G.pts[ie],Fn=G.pts[Oe];if(z-D==1&&Oe-ie==1)return lt.addIntersections(this.e,D,G.e,ie),null;if(this.env1.init(kt,Zt),this.env2.init(Un,Fn),!this.env1.intersects(this.env2))return null;var Xn=Math.trunc((D+z)/2),hi=Math.trunc((ie+Oe)/2);D<Xn&&(ie<hi&&this.computeIntersectsForChain(D,Xn,G,ie,hi,lt),hi<Oe&&this.computeIntersectsForChain(D,Xn,G,hi,Oe,lt)),Xn<z&&(ie<hi&&this.computeIntersectsForChain(Xn,z,G,ie,hi,lt),hi<Oe&&this.computeIntersectsForChain(Xn,z,G,hi,Oe,lt))}},Cl.prototype.getStartIndexes=function(){return this.startIndex},Cl.prototype.computeIntersects=function(l,h){for(var y=0;y<this.startIndex.length-1;y++)for(var w=0;w<l.startIndex.length-1;w++)this.computeIntersectsForChain(y,l,w,h)},Cl.prototype.interfaces_=function(){return[]},Cl.prototype.getClass=function(){return Cl};var ms=function l(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var h=0;h<2;h++)for(var y=0;y<3;y++)this._depth[h][y]=l.NULL_VALUE},vh={NULL_VALUE:{configurable:!0}};ms.prototype.getDepth=function(l,h){return this._depth[l][h]},ms.prototype.setDepth=function(l,h,y){this._depth[l][h]=y},ms.prototype.isNull=function(){if(0===arguments.length){for(var l=0;l<2;l++)for(var h=0;h<3;h++)if(this._depth[l][h]!==ms.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===ms.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===ms.NULL_VALUE:void 0},ms.prototype.normalize=function(){for(var l=0;l<2;l++)if(!this.isNull(l)){var h=this._depth[l][1];this._depth[l][2]<h&&(h=this._depth[l][2]),h<0&&(h=0);for(var y=1;y<3;y++){var w=0;this._depth[l][y]>h&&(w=1),this._depth[l][y]=w}}},ms.prototype.getDelta=function(l){return this._depth[l][nn.RIGHT]-this._depth[l][nn.LEFT]},ms.prototype.getLocation=function(l,h){return this._depth[l][h]<=0?Me.EXTERIOR:Me.INTERIOR},ms.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ms.prototype.add=function(){if(1===arguments.length)for(var l=arguments[0],h=0;h<2;h++)for(var y=1;y<3;y++){var w=l.getLocation(h,y);w!==Me.EXTERIOR&&w!==Me.INTERIOR||(this.isNull(h,y)?this._depth[h][y]=ms.depthAtLocation(w):this._depth[h][y]+=ms.depthAtLocation(w))}else 3===arguments.length&&arguments[2]===Me.INTERIOR&&this._depth[arguments[0]][arguments[1]]++},ms.prototype.interfaces_=function(){return[]},ms.prototype.getClass=function(){return ms},ms.depthAtLocation=function(l){return l===Me.EXTERIOR?0:l===Me.INTERIOR?1:ms.NULL_VALUE},vh.NULL_VALUE.get=function(){return-1},Object.defineProperties(ms,vh);var Qa=function(l){function h(){if(l.call(this),this.pts=null,this._env=null,this.eiList=new El(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ms,this._depthDelta=0,1===arguments.length)h.call(this,arguments[0],null);else if(2===arguments.length){var D=arguments[1];this.pts=arguments[0],this._label=D}}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.getDepth=function(){return this._depth},h.prototype.getCollapsedEdge=function(){var y=new Array(2).fill(null);return y[0]=this.pts[0],y[1]=this.pts[1],new h(y,mr.toLineLabel(this._label))},h.prototype.isIsolated=function(){return this._isIsolated},h.prototype.getCoordinates=function(){return this.pts},h.prototype.setIsolated=function(y){this._isIsolated=y},h.prototype.setName=function(y){this._name=y},h.prototype.equals=function(y){if(!(y instanceof h))return!1;var w=y;if(this.pts.length!==w.pts.length)return!1;for(var D=!0,z=!0,G=this.pts.length,ie=0;ie<this.pts.length;ie++)if(this.pts[ie].equals2D(w.pts[ie])||(D=!1),this.pts[ie].equals2D(w.pts[--G])||(z=!1),!D&&!z)return!1;return!0},h.prototype.getCoordinate=function(){return 0===arguments.length?this.pts.length>0?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},h.prototype.print=function(y){y.print("edge "+this._name+": "),y.print("LINESTRING (");for(var w=0;w<this.pts.length;w++)w>0&&y.print(","),y.print(this.pts[w].x+" "+this.pts[w].y);y.print(")  "+this._label+" "+this._depthDelta)},h.prototype.computeIM=function(y){h.updateIM(this._label,y)},h.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},h.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},h.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},h.prototype.getDepthDelta=function(){return this._depthDelta},h.prototype.getNumPoints=function(){return this.pts.length},h.prototype.printReverse=function(y){y.print("edge "+this._name+": ");for(var w=this.pts.length-1;w>=0;w--)y.print(this.pts[w]+" ");y.println("")},h.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Cl(this)),this._mce},h.prototype.getEnvelope=function(){if(null===this._env){this._env=new mn;for(var y=0;y<this.pts.length;y++)this._env.expandToInclude(this.pts[y])}return this._env},h.prototype.addIntersection=function(y,w,D,z){var G=new ne(y.getIntersection(z)),ie=w,Oe=y.getEdgeDistance(D,z),lt=ie+1;lt<this.pts.length&&G.equals2D(this.pts[lt])&&(ie=lt,Oe=0),this.eiList.add(G,ie,Oe)},h.prototype.toString=function(){var y=new Re;y.append("edge "+this._name+": "),y.append("LINESTRING (");for(var w=0;w<this.pts.length;w++)w>0&&y.append(","),y.append(this.pts[w].x+" "+this.pts[w].y);return y.append(")  "+this._label+" "+this._depthDelta),y.toString()},h.prototype.isPointwiseEqual=function(y){if(this.pts.length!==y.pts.length)return!1;for(var w=0;w<this.pts.length;w++)if(!this.pts[w].equals2D(y.pts[w]))return!1;return!0},h.prototype.setDepthDelta=function(y){this._depthDelta=y},h.prototype.getEdgeIntersectionList=function(){return this.eiList},h.prototype.addIntersections=function(y,w,D){for(var z=0;z<y.getIntersectionNum();z++)this.addIntersection(y,w,D,z)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h.updateIM=function(){if(2!==arguments.length)return l.prototype.updateIM.apply(this,arguments);var y=arguments[0],w=arguments[1];w.setAtLeastIfValid(y.getLocation(0,nn.ON),y.getLocation(1,nn.ON),1),y.isArea()&&(w.setAtLeastIfValid(y.getLocation(0,nn.LEFT),y.getLocation(1,nn.LEFT),2),w.setAtLeastIfValid(y.getLocation(0,nn.RIGHT),y.getLocation(1,nn.RIGHT),2))},h}(Wa),Ps=function(l){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Dt,this._bufParams=l||null};Ps.prototype.setWorkingPrecisionModel=function(l){this._workingPrecisionModel=l},Ps.prototype.insertUniqueEdge=function(l){var h=this._edgeList.findEqualEdge(l);if(null!==h){var y=h.getLabel(),w=l.getLabel();h.isPointwiseEqual(l)||(w=new mr(l.getLabel())).flip(),y.merge(w);var D=Ps.depthDelta(w),z=h.getDepthDelta()+D;h.setDepthDelta(z)}else this._edgeList.add(l),l.setDepthDelta(Ps.depthDelta(l.getLabel()))},Ps.prototype.buildSubgraphs=function(l,h){for(var y=new ke,w=l.iterator();w.hasNext();){var D=w.next(),z=D.getRightmostCoordinate(),G=new Tu(y).getDepth(z);D.computeDepth(G),D.findResultEdges(),y.add(D),h.add(D.getDirectedEdges(),D.getNodes())}},Ps.prototype.createSubgraphs=function(l){for(var h=new ke,y=l.getNodes().iterator();y.hasNext();){var w=y.next();if(!w.isVisited()){var D=new Ts;D.create(w),h.add(D)}}return xi.sort(h,xi.reverseOrder()),h},Ps.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Ps.prototype.getNoder=function(l){if(null!==this._workingNoder)return this._workingNoder;var h=new Do,y=new Gt;return y.setPrecisionModel(l),h.setSegmentIntersector(new Rn(y)),h},Ps.prototype.buffer=function(l,h){var y=this._workingPrecisionModel;null===y&&(y=l.getPrecisionModel()),this._geomFact=l.getFactory();var w=new Ea(y,this._bufParams),D=new Ya(l,h,w).getCurves();if(D.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(D,y),this._graph=new Vo(new nu),this._graph.addEdges(this._edgeList.getEdges());var z=this.createSubgraphs(this._graph),G=new ia(this._geomFact);this.buildSubgraphs(z,G);var ie=G.getPolygons();return ie.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(ie)},Ps.prototype.computeNodedEdges=function(l,h){var y=this.getNoder(h);y.computeNodes(l);for(var w=y.getNodedSubstrings().iterator();w.hasNext();){var D=w.next(),z=D.getCoordinates();if(2!==z.length||!z[0].equals2D(z[1])){var G=D.getData(),ie=new Qa(D.getCoordinates(),new mr(G));this.insertUniqueEdge(ie)}}},Ps.prototype.setNoder=function(l){this._workingNoder=l},Ps.prototype.interfaces_=function(){return[]},Ps.prototype.getClass=function(){return Ps},Ps.depthDelta=function(l){var h=l.getLocation(0,nn.LEFT),y=l.getLocation(0,nn.RIGHT);return h===Me.INTERIOR&&y===Me.EXTERIOR?1:h===Me.EXTERIOR&&y===Me.INTERIOR?-1:0},Ps.convertSegStrings=function(l){for(var h=new gi,y=new ke;l.hasNext();){var w=l.next(),D=h.createLineString(w.getCoordinates());y.add(D)}return h.buildGeometry(y)};var Lo=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var h=arguments[1];this._noder=arguments[0],this._scaleFactor=h,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var w=arguments[1],D=arguments[2],z=arguments[3];this._noder=arguments[0],this._scaleFactor=w,this._offsetX=D,this._offsetY=z,this._isScaled=!this.isIntegerPrecision()}};Lo.prototype.rescale=function(){if(Lt(arguments[0],se))for(var l=arguments[0].iterator();l.hasNext();){var h=l.next();this.rescale(h.getCoordinates())}else if(arguments[0]instanceof Array){for(var y=arguments[0],w=0;w<y.length;w++)y[w].x=y[w].x/this._scaleFactor+this._offsetX,y[w].y=y[w].y/this._scaleFactor+this._offsetY;2===y.length&&y[0].equals2D(y[1])&&Kt.out.println(y)}},Lo.prototype.scale=function(){if(Lt(arguments[0],se)){for(var l=arguments[0],h=new ke,y=l.iterator();y.hasNext();){var w=y.next();h.add(new jo(this.scale(w.getCoordinates()),w.getData()))}return h}if(arguments[0]instanceof Array){for(var D=arguments[0],z=new Array(D.length).fill(null),G=0;G<D.length;G++)z[G]=new ne(Math.round((D[G].x-this._offsetX)*this._scaleFactor),Math.round((D[G].y-this._offsetY)*this._scaleFactor),D[G].z);return Ye.removeRepeatedPoints(z)}},Lo.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Lo.prototype.getNodedSubstrings=function(){var l=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(l),l},Lo.prototype.computeNodes=function(l){var h=l;this._isScaled&&(h=this.scale(l)),this._noder.computeNodes(h)},Lo.prototype.interfaces_=function(){return[Ec]},Lo.prototype.getClass=function(){return Lo};var Ms=function(){this._li=new Gt,this._segStrings=null,this._segStrings=arguments[0]},Rr={fact:{configurable:!0}};Ms.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var l=this._segStrings.iterator();l.hasNext();){var h=l.next().getCoordinates();this.checkEndPtVertexIntersections(h[0],this._segStrings),this.checkEndPtVertexIntersections(h[h.length-1],this._segStrings)}else if(2===arguments.length)for(var y=arguments[0],w=arguments[1].iterator();w.hasNext();)for(var D=w.next().getCoordinates(),z=1;z<D.length-1;z++)if(D[z].equals(y))throw new we("found endpt/interior pt intersection at index "+z+" :pt "+y)},Ms.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var l=this._segStrings.iterator();l.hasNext();)for(var h=l.next(),y=this._segStrings.iterator();y.hasNext();){var w=y.next();this.checkInteriorIntersections(h,w)}else if(2===arguments.length)for(var D=arguments[0],z=arguments[1],G=D.getCoordinates(),ie=z.getCoordinates(),Oe=0;Oe<G.length-1;Oe++)for(var lt=0;lt<ie.length-1;lt++)this.checkInteriorIntersections(D,Oe,z,lt);else if(4===arguments.length){var kt=arguments[0],Zt=arguments[1],Un=arguments[2],Fn=arguments[3];if(kt===Un&&Zt===Fn)return null;var Xn=kt.getCoordinates()[Zt],hi=kt.getCoordinates()[Zt+1],Sr=Un.getCoordinates()[Fn],On=Un.getCoordinates()[Fn+1];if(this._li.computeIntersection(Xn,hi,Sr,On),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Xn,hi)||this.hasInteriorIntersection(this._li,Sr,On)))throw new we("found non-noded intersection at "+Xn+"-"+hi+" and "+Sr+"-"+On)}},Ms.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Ms.prototype.checkCollapses=function(){if(0===arguments.length)for(var l=this._segStrings.iterator();l.hasNext();){var h=l.next();this.checkCollapses(h)}else if(1===arguments.length)for(var y=arguments[0].getCoordinates(),w=0;w<y.length-2;w++)this.checkCollapse(y[w],y[w+1],y[w+2])},Ms.prototype.hasInteriorIntersection=function(l,h,y){for(var w=0;w<l.getIntersectionNum();w++){var D=l.getIntersection(w);if(!D.equals(h)&&!D.equals(y))return!0}return!1},Ms.prototype.checkCollapse=function(l,h,y){if(l.equals(y))throw new we("found non-noded collapse at "+Ms.fact.createLineString([l,h,y]))},Ms.prototype.interfaces_=function(){return[]},Ms.prototype.getClass=function(){return Ms},Rr.fact.get=function(){return new gi},Object.defineProperties(Ms,Rr);var Rs=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var l=arguments[0],h=arguments[1],y=arguments[2];if(this._originalPt=l,this._pt=l,this._scaleFactor=h,this._li=y,h<=0)throw new ge("Scale factor must be non-zero");1!==h&&(this._pt=new ne(this.scale(l.x),this.scale(l.y)),this._p0Scaled=new ne,this._p1Scaled=new ne),this.initCorners(this._pt)},$d={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Rs.prototype.intersectsScaled=function(l,h){var y=Math.min(l.x,h.x),w=Math.max(l.x,h.x),D=Math.min(l.y,h.y),z=Math.max(l.y,h.y),G=this._maxx<y||this._minx>w||this._maxy<D||this._miny>z;if(G)return!1;var ie=this.intersectsToleranceSquare(l,h);return le.isTrue(!(G&&ie),"Found bad envelope test"),ie},Rs.prototype.initCorners=function(l){this._minx=l.x-.5,this._maxx=l.x+.5,this._miny=l.y-.5,this._maxy=l.y+.5,this._corner[0]=new ne(this._maxx,this._maxy),this._corner[1]=new ne(this._minx,this._maxy),this._corner[2]=new ne(this._minx,this._miny),this._corner[3]=new ne(this._maxx,this._miny)},Rs.prototype.intersects=function(l,h){return 1===this._scaleFactor?this.intersectsScaled(l,h):(this.copyScaled(l,this._p0Scaled),this.copyScaled(h,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Rs.prototype.scale=function(l){return Math.round(l*this._scaleFactor)},Rs.prototype.getCoordinate=function(){return this._originalPt},Rs.prototype.copyScaled=function(l,h){h.x=this.scale(l.x),h.y=this.scale(l.y)},Rs.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var l=Rs.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new mn(this._originalPt.x-l,this._originalPt.x+l,this._originalPt.y-l,this._originalPt.y+l)}return this._safeEnv},Rs.prototype.intersectsPixelClosure=function(l,h){return this._li.computeIntersection(l,h,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(l,h,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(l,h,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(l,h,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},Rs.prototype.intersectsToleranceSquare=function(l,h){var y=!1,w=!1;return this._li.computeIntersection(l,h,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(l,h,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(y=!0),this._li.computeIntersection(l,h,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(w=!0),this._li.computeIntersection(l,h,this._corner[3],this._corner[0]),this._li.isProper()||y&&w||l.equals(this._pt)||h.equals(this._pt)))))},Rs.prototype.addSnappedNode=function(l,h){var y=l.getCoordinate(h),w=l.getCoordinate(h+1);return!!this.intersects(y,w)&&(l.addIntersection(this.getCoordinate(),h),!0)},Rs.prototype.interfaces_=function(){return[]},Rs.prototype.getClass=function(){return Rs},$d.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Rs,$d);var iu=function(){this.tempEnv1=new mn,this.selectedSegment=new ci};iu.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},iu.prototype.interfaces_=function(){return[]},iu.prototype.getClass=function(){return iu};var Yu=function(){this._index=null,this._index=arguments[0]},ac={HotPixelSnapAction:{configurable:!0}};Yu.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var h=arguments[0],y=arguments[1],w=arguments[2],D=h.getSafeEnvelope(),z=new ru(h,y,w);return this._index.query(D,{interfaces_:function(){return[Xa]},visitItem:function(G){G.select(D,z)}}),z.isNodeAdded()}},Yu.prototype.interfaces_=function(){return[]},Yu.prototype.getClass=function(){return Yu},ac.HotPixelSnapAction.get=function(){return ru},Object.defineProperties(Yu,ac);var ru=function(l){function h(){l.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var w=arguments[1],D=arguments[2];this._hotPixel=arguments[0],this._parentEdge=w,this._hotPixelVertexIndex=D}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.isNodeAdded=function(){return this._isNodeAdded},h.prototype.select=function(){if(2!==arguments.length)return l.prototype.select.apply(this,arguments);var w=arguments[1],D=arguments[0].getContext();if(null!==this._parentEdge&&D===this._parentEdge&&w===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(D,w)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(iu),lc=function(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new ke};lc.prototype.processIntersections=function(l,h,y,w){if(l===y&&h===w)return null;var D=l.getCoordinates()[h],z=l.getCoordinates()[h+1],G=y.getCoordinates()[w],ie=y.getCoordinates()[w+1];if(this._li.computeIntersection(D,z,G,ie),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Oe=0;Oe<this._li.getIntersectionNum();Oe++)this._interiorIntersections.add(this._li.getIntersection(Oe));l.addIntersections(this._li,h,0),y.addIntersections(this._li,w,1)}},lc.prototype.isDone=function(){return!1},lc.prototype.getInteriorIntersections=function(){return this._interiorIntersections},lc.prototype.interfaces_=function(){return[Sc]},lc.prototype.getClass=function(){return lc};var jl=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var l=arguments[0];this._pm=l,this._li=new Gt,this._li.setPrecisionModel(l),this._scaleFactor=l.getScale()};jl.prototype.checkCorrectness=function(l){var h=jo.getNodedSubstrings(l),y=new Ms(h);try{y.checkValid()}catch(w){if(!(w instanceof zn))throw w;w.printStackTrace()}},jl.prototype.getNodedSubstrings=function(){return jo.getNodedSubstrings(this._nodedSegStrings)},jl.prototype.snapRound=function(l,h){var y=this.findInteriorIntersections(l,h);this.computeIntersectionSnaps(y),this.computeVertexSnaps(l)},jl.prototype.findInteriorIntersections=function(l,h){var y=new lc(h);return this._noder.setSegmentIntersector(y),this._noder.computeNodes(l),y.getInteriorIntersections()},jl.prototype.computeVertexSnaps=function(){if(Lt(arguments[0],se))for(var l=arguments[0].iterator();l.hasNext();){var h=l.next();this.computeVertexSnaps(h)}else if(arguments[0]instanceof jo)for(var y=arguments[0],w=y.getCoordinates(),D=0;D<w.length;D++){var z=new Rs(w[D],this._scaleFactor,this._li);this._pointSnapper.snap(z,y,D)&&y.addIntersection(w[D],D)}},jl.prototype.computeNodes=function(l){this._nodedSegStrings=l,this._noder=new Do,this._pointSnapper=new Yu(this._noder.getIndex()),this.snapRound(l,this._li)},jl.prototype.computeIntersectionSnaps=function(l){for(var h=l.iterator();h.hasNext();){var y=h.next(),w=new Rs(y,this._scaleFactor,this._li);this._pointSnapper.snap(w)}},jl.prototype.interfaces_=function(){return[Ec]},jl.prototype.getClass=function(){return jl};var Is=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Er,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var y=arguments[1];this._argGeom=arguments[0],this._bufParams=y}},Ku={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Is.prototype.bufferFixedPrecision=function(l){var h=new Lo(new jl(new tn(1)),l.getScale()),y=new Ps(this._bufParams);y.setWorkingPrecisionModel(l),y.setNoder(h),this._resultGeometry=y.buffer(this._argGeom,this._distance)},Is.prototype.bufferReducedPrecision=function(){var l=this;if(0===arguments.length){for(var h=Is.MAX_PRECISION_DIGITS;h>=0;h--){try{l.bufferReducedPrecision(h)}catch(z){if(!(z instanceof vl))throw z;l._saveException=z}if(null!==l._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var w=Is.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),D=new tn(w);this.bufferFixedPrecision(D)}},Is.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var l=this._argGeom.getFactory().getPrecisionModel();l.getType()===tn.FIXED?this.bufferFixedPrecision(l):this.bufferReducedPrecision()},Is.prototype.setQuadrantSegments=function(l){this._bufParams.setQuadrantSegments(l)},Is.prototype.bufferOriginalPrecision=function(){try{var l=new Ps(this._bufParams);this._resultGeometry=l.buffer(this._argGeom,this._distance)}catch(h){if(!(h instanceof we))throw h;this._saveException=h}},Is.prototype.getResultGeometry=function(l){return this._distance=l,this.computeGeometry(),this._resultGeometry},Is.prototype.setEndCapStyle=function(l){this._bufParams.setEndCapStyle(l)},Is.prototype.interfaces_=function(){return[]},Is.prototype.getClass=function(){return Is},Is.bufferOp=function(){if(2===arguments.length){var h=arguments[1];return new Is(arguments[0]).getResultGeometry(h)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Nn&&"number"==typeof arguments[1]){var w=arguments[1],D=arguments[2],z=new Is(arguments[0]);return z.setQuadrantSegments(D),z.getResultGeometry(w)}if(arguments[2]instanceof Er&&arguments[0]instanceof Nn&&"number"==typeof arguments[1]){var ie=arguments[1];return new Is(arguments[0],arguments[2]).getResultGeometry(ie)}}else if(4===arguments.length){var kt=arguments[1],Zt=arguments[2],Un=arguments[3],Fn=new Is(arguments[0]);return Fn.setQuadrantSegments(Zt),Fn.setEndCapStyle(Un),Fn.getResultGeometry(kt)}},Is.precisionScaleFactor=function(l,h,y){var w=l.getEnvelopeInternal(),D=Ee.max(Math.abs(w.getMaxX()),Math.abs(w.getMaxY()),Math.abs(w.getMinX()),Math.abs(w.getMinY()))+2*(h>0?h:0),z=y-Math.trunc(Math.log(D)/Math.log(10)+1);return Math.pow(10,z)},Ku.CAP_ROUND.get=function(){return Er.CAP_ROUND},Ku.CAP_BUTT.get=function(){return Er.CAP_FLAT},Ku.CAP_FLAT.get=function(){return Er.CAP_FLAT},Ku.CAP_SQUARE.get=function(){return Er.CAP_SQUARE},Ku.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Is,Ku);var oa=function(){this._pt=[new ne,new ne],this._distance=ue.NaN,this._isNull=!0};oa.prototype.getCoordinates=function(){return this._pt},oa.prototype.getCoordinate=function(l){return this._pt[l]},oa.prototype.setMinimum=function(){if(1===arguments.length){var l=arguments[0];this.setMinimum(l._pt[0],l._pt[1])}else if(2===arguments.length){var h=arguments[0],y=arguments[1];if(this._isNull)return this.initialize(h,y),null;var w=h.distance(y);w<this._distance&&this.initialize(h,y,w)}},oa.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var l=arguments[0],h=arguments[1];this._pt[0].setCoordinate(l),this._pt[1].setCoordinate(h),this._distance=l.distance(h),this._isNull=!1}else if(3===arguments.length){var w=arguments[1],D=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(w),this._distance=D,this._isNull=!1}},oa.prototype.getDistance=function(){return this._distance},oa.prototype.setMaximum=function(){if(1===arguments.length){var l=arguments[0];this.setMaximum(l._pt[0],l._pt[1])}else if(2===arguments.length){var h=arguments[0],y=arguments[1];if(this._isNull)return this.initialize(h,y),null;var w=h.distance(y);w>this._distance&&this.initialize(h,y,w)}},oa.prototype.interfaces_=function(){return[]},oa.prototype.getClass=function(){return oa};var Ja=function(){};Ja.prototype.interfaces_=function(){return[]},Ja.prototype.getClass=function(){return Ja},Ja.computeDistance=function(){if(arguments[2]instanceof oa&&arguments[0]instanceof Yo&&arguments[1]instanceof ne)for(var h=arguments[1],y=arguments[2],w=arguments[0].getCoordinates(),D=new ci,z=0;z<w.length-1;z++){D.setCoordinates(w[z],w[z+1]);var G=D.closestPoint(h);y.setMinimum(G,h)}else if(arguments[2]instanceof oa&&arguments[0]instanceof rs&&arguments[1]instanceof ne){var ie=arguments[0],Oe=arguments[1],lt=arguments[2];Ja.computeDistance(ie.getExteriorRing(),Oe,lt);for(var kt=0;kt<ie.getNumInteriorRing();kt++)Ja.computeDistance(ie.getInteriorRingN(kt),Oe,lt)}else if(arguments[2]instanceof oa&&arguments[0]instanceof Nn&&arguments[1]instanceof ne){var Zt=arguments[0],Un=arguments[1],Fn=arguments[2];if(Zt instanceof Yo)Ja.computeDistance(Zt,Un,Fn);else if(Zt instanceof rs)Ja.computeDistance(Zt,Un,Fn);else if(Zt instanceof go)for(var Xn=Zt,hi=0;hi<Xn.getNumGeometries();hi++){var Sr=Xn.getGeometryN(hi);Ja.computeDistance(Sr,Un,Fn)}else Fn.setMinimum(Zt.getCoordinate(),Un)}else if(arguments[2]instanceof oa&&arguments[0]instanceof ci&&arguments[1]instanceof ne){var Sa=arguments[1],hc=arguments[2],$l=arguments[0].closestPoint(Sa);hc.setMinimum($l,Sa)}};var Gl=function(l){this._maxPtDist=new oa,this._inputGeom=l||null},Hd={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Gl.prototype.computeMaxMidpointDistance=function(l){var h=new Mc(this._inputGeom);l.apply(h),this._maxPtDist.setMaximum(h.getMaxPointDistance())},Gl.prototype.computeMaxVertexDistance=function(l){var h=new Lc(this._inputGeom);l.apply(h),this._maxPtDist.setMaximum(h.getMaxPointDistance())},Gl.prototype.findDistance=function(l){return this.computeMaxVertexDistance(l),this.computeMaxMidpointDistance(l),this._maxPtDist.getDistance()},Gl.prototype.getDistancePoints=function(){return this._maxPtDist},Gl.prototype.interfaces_=function(){return[]},Gl.prototype.getClass=function(){return Gl},Hd.MaxPointDistanceFilter.get=function(){return Lc},Hd.MaxMidpointDistanceFilter.get=function(){return Mc},Object.defineProperties(Gl,Hd);var Lc=function(l){this._maxPtDist=new oa,this._minPtDist=new oa,this._geom=l||null};Lc.prototype.filter=function(l){this._minPtDist.initialize(),Ja.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Lc.prototype.getMaxPointDistance=function(){return this._maxPtDist},Lc.prototype.interfaces_=function(){return[nr]},Lc.prototype.getClass=function(){return Lc};var Mc=function(l){this._maxPtDist=new oa,this._minPtDist=new oa,this._geom=l||null};Mc.prototype.filter=function(l,h){if(0===h)return null;var y=l.getCoordinate(h-1),w=l.getCoordinate(h),D=new ne((y.x+w.x)/2,(y.y+w.y)/2);this._minPtDist.initialize(),Ja.computeDistance(this._geom,D,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Mc.prototype.isDone=function(){return!1},Mc.prototype.isGeometryChanged=function(){return!1},Mc.prototype.getMaxPointDistance=function(){return this._maxPtDist},Mc.prototype.interfaces_=function(){return[wo]},Mc.prototype.getClass=function(){return Mc};var al=function(l){this._comps=l||null};al.prototype.filter=function(l){l instanceof rs&&this._comps.add(l)},al.prototype.interfaces_=function(){return[ta]},al.prototype.getClass=function(){return al},al.getPolygons=function(){if(1===arguments.length)return al.getPolygons(arguments[0],new ke);if(2===arguments.length){var h=arguments[0],y=arguments[1];return h instanceof rs?y.add(h):h instanceof go&&h.apply(new al(y)),y}};var pa=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var y=arguments[1];this._lines=arguments[0],this._isForcedToLineString=y}};pa.prototype.filter=function(l){if(this._isForcedToLineString&&l instanceof ka){var h=l.getFactory().createLineString(l.getCoordinateSequence());return this._lines.add(h),null}l instanceof Yo&&this._lines.add(l)},pa.prototype.setForceToLineString=function(l){this._isForcedToLineString=l},pa.prototype.interfaces_=function(){return[Ni]},pa.prototype.getClass=function(){return pa},pa.getGeometry=function(){if(1===arguments.length){var l=arguments[0];return l.getFactory().buildGeometry(pa.getLines(l))}if(2===arguments.length){var h=arguments[0],y=arguments[1];return h.getFactory().buildGeometry(pa.getLines(h,y))}},pa.getLines=function(){if(1===arguments.length)return pa.getLines(arguments[0],!1);if(2===arguments.length){if(Lt(arguments[0],se)&&Lt(arguments[1],se)){for(var y=arguments[1],w=arguments[0].iterator();w.hasNext();){var D=w.next();pa.getLines(D,y)}return y}if(arguments[0]instanceof Nn&&"boolean"==typeof arguments[1]){var z=arguments[0],G=arguments[1],ie=new ke;return z.apply(new pa(ie,G)),ie}if(arguments[0]instanceof Nn&&Lt(arguments[1],se)){var Oe=arguments[0],lt=arguments[1];return Oe instanceof Yo?lt.add(Oe):Oe.apply(new pa(lt)),lt}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Lt(arguments[0],se)&&Lt(arguments[1],se)){for(var Zt=arguments[1],Un=arguments[2],Fn=arguments[0].iterator();Fn.hasNext();){var Xn=Fn.next();pa.getLines(Xn,Zt,Un)}return Zt}if("boolean"==typeof arguments[2]&&arguments[0]instanceof Nn&&Lt(arguments[1],se)){var Sr=arguments[1];return arguments[0].apply(new pa(Sr,arguments[2])),Sr}}};var Os=function(){if(this._boundaryRule=cr.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var l=arguments[0];if(null===l)throw new ge("Rule must be non-null");this._boundaryRule=l}};Os.prototype.locateInternal=function(){if(arguments[0]instanceof ne&&arguments[1]instanceof rs){var l=arguments[0],h=arguments[1];if(h.isEmpty())return Me.EXTERIOR;var y=h.getExteriorRing(),w=this.locateInPolygonRing(l,y);if(w===Me.EXTERIOR)return Me.EXTERIOR;if(w===Me.BOUNDARY)return Me.BOUNDARY;for(var D=0;D<h.getNumInteriorRing();D++){var z=h.getInteriorRingN(D),G=this.locateInPolygonRing(l,z);if(G===Me.INTERIOR)return Me.EXTERIOR;if(G===Me.BOUNDARY)return Me.BOUNDARY}return Me.INTERIOR}if(arguments[0]instanceof ne&&arguments[1]instanceof Yo){var ie=arguments[0],Oe=arguments[1];if(!Oe.getEnvelopeInternal().intersects(ie))return Me.EXTERIOR;var lt=Oe.getCoordinates();return Oe.isClosed()||!ie.equals(lt[0])&&!ie.equals(lt[lt.length-1])?Wt.isOnLine(ie,lt)?Me.INTERIOR:Me.EXTERIOR:Me.BOUNDARY}if(arguments[0]instanceof ne&&arguments[1]instanceof is){var kt=arguments[0];return arguments[1].getCoordinate().equals2D(kt)?Me.INTERIOR:Me.EXTERIOR}},Os.prototype.locateInPolygonRing=function(l,h){return h.getEnvelopeInternal().intersects(l)?Wt.locatePointInRing(l,h.getCoordinates()):Me.EXTERIOR},Os.prototype.intersects=function(l,h){return this.locate(l,h)!==Me.EXTERIOR},Os.prototype.updateLocationInfo=function(l){l===Me.INTERIOR&&(this._isIn=!0),l===Me.BOUNDARY&&this._numBoundaries++},Os.prototype.computeLocation=function(l,h){if(h instanceof is&&this.updateLocationInfo(this.locateInternal(l,h)),h instanceof Yo)this.updateLocationInfo(this.locateInternal(l,h));else if(h instanceof rs)this.updateLocationInfo(this.locateInternal(l,h));else if(h instanceof Ll)for(var y=h,w=0;w<y.getNumGeometries();w++){var D=y.getGeometryN(w);this.updateLocationInfo(this.locateInternal(l,D))}else if(h instanceof da)for(var z=h,G=0;G<z.getNumGeometries();G++){var ie=z.getGeometryN(G);this.updateLocationInfo(this.locateInternal(l,ie))}else if(h instanceof go)for(var Oe=new Ba(h);Oe.hasNext();){var lt=Oe.next();lt!==h&&this.computeLocation(l,lt)}},Os.prototype.locate=function(l,h){return h.isEmpty()?Me.EXTERIOR:h instanceof Yo||h instanceof rs?this.locateInternal(l,h):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(l,h),this._boundaryRule.isInBoundary(this._numBoundaries)?Me.BOUNDARY:this._numBoundaries>0||this._isIn?Me.INTERIOR:Me.EXTERIOR)},Os.prototype.interfaces_=function(){return[]},Os.prototype.getClass=function(){return Os};var Ta=function l(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)l.call(this,arguments[0],l.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var D=arguments[1],z=arguments[2];this._component=arguments[0],this._segIndex=D,this._pt=z}},pf={INSIDE_AREA:{configurable:!0}};Ta.prototype.isInsideArea=function(){return this._segIndex===Ta.INSIDE_AREA},Ta.prototype.getCoordinate=function(){return this._pt},Ta.prototype.getGeometryComponent=function(){return this._component},Ta.prototype.getSegmentIndex=function(){return this._segIndex},Ta.prototype.interfaces_=function(){return[]},Ta.prototype.getClass=function(){return Ta},pf.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Ta,pf);var ou=function(l){this._pts=l||null};ou.prototype.filter=function(l){l instanceof is&&this._pts.add(l)},ou.prototype.interfaces_=function(){return[ta]},ou.prototype.getClass=function(){return ou},ou.getPoints=function(){if(1===arguments.length){var l=arguments[0];return l instanceof is?xi.singletonList(l):ou.getPoints(l,new ke)}if(2===arguments.length){var h=arguments[0],y=arguments[1];return h instanceof is?y.add(h):h instanceof go&&h.apply(new ou(y)),y}};var Au=function(){this._locations=null,this._locations=arguments[0]};Au.prototype.filter=function(l){(l instanceof is||l instanceof Yo||l instanceof rs)&&this._locations.add(new Ta(l,0,l.getCoordinate()))},Au.prototype.interfaces_=function(){return[ta]},Au.prototype.getClass=function(){return Au},Au.getLocations=function(l){var h=new ke;return l.apply(new Au(h)),h};var ks=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Os,this._minDistanceLocation=null,this._minDistance=ue.MAX_VALUE,2===arguments.length)this._geom=[arguments[0],arguments[1]],this._terminateDistance=0;else if(3===arguments.length){var y=arguments[0],w=arguments[1],D=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=y,this._geom[1]=w,this._terminateDistance=D}};ks.prototype.computeContainmentDistance=function(){if(0===arguments.length){var l=new Array(2).fill(null);if(this.computeContainmentDistance(0,l),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,l)}else if(2===arguments.length){var h=arguments[0],y=arguments[1],w=1-h,D=al.getPolygons(this._geom[h]);if(D.size()>0){var z=Au.getLocations(this._geom[w]);if(this.computeContainmentDistance(z,D,y),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[w]=y[0],this._minDistanceLocation[h]=y[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Lt(arguments[0],et)&&Lt(arguments[1],et)){for(var G=arguments[0],ie=arguments[1],Oe=arguments[2],lt=0;lt<G.size();lt++)for(var kt=G.get(lt),Zt=0;Zt<ie.size();Zt++)if(this.computeContainmentDistance(kt,ie.get(Zt),Oe),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ta&&arguments[1]instanceof rs){var Un=arguments[0],Fn=arguments[1],Xn=arguments[2],hi=Un.getCoordinate();if(Me.EXTERIOR!==this._ptLocator.locate(hi,Fn))return this._minDistance=0,Xn[0]=Un,Xn[1]=new Ta(Fn,hi),null}},ks.prototype.computeMinDistanceLinesPoints=function(l,h,y){for(var w=0;w<l.size();w++)for(var D=l.get(w),z=0;z<h.size();z++){var G=h.get(z);if(this.computeMinDistance(D,G,y),this._minDistance<=this._terminateDistance)return null}},ks.prototype.computeFacetDistance=function(){var l=new Array(2).fill(null),h=pa.getLines(this._geom[0]),y=pa.getLines(this._geom[1]),w=ou.getPoints(this._geom[0]),D=ou.getPoints(this._geom[1]);return this.computeMinDistanceLines(h,y,l),this.updateMinDistance(l,!1),this._minDistance<=this._terminateDistance?null:(l[0]=null,l[1]=null,this.computeMinDistanceLinesPoints(h,D,l),this.updateMinDistance(l,!1),this._minDistance<=this._terminateDistance?null:(l[0]=null,l[1]=null,this.computeMinDistanceLinesPoints(y,w,l),this.updateMinDistance(l,!0),this._minDistance<=this._terminateDistance?null:(l[0]=null,l[1]=null,this.computeMinDistancePoints(w,D,l),void this.updateMinDistance(l,!1))))},ks.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},ks.prototype.updateMinDistance=function(l,h){if(null===l[0])return null;h?(this._minDistanceLocation[0]=l[1],this._minDistanceLocation[1]=l[0]):(this._minDistanceLocation[0]=l[0],this._minDistanceLocation[1]=l[1])},ks.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},ks.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Yo&&arguments[1]instanceof is){var l=arguments[0],h=arguments[1],y=arguments[2];if(l.getEnvelopeInternal().distance(h.getEnvelopeInternal())>this._minDistance)return null;for(var w=l.getCoordinates(),D=h.getCoordinate(),z=0;z<w.length-1;z++){var G=Wt.distancePointLine(D,w[z],w[z+1]);if(G<this._minDistance){this._minDistance=G;var ie=new ci(w[z],w[z+1]).closestPoint(D);y[0]=new Ta(l,z,ie),y[1]=new Ta(h,0,D)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Yo&&arguments[1]instanceof Yo){var Oe=arguments[0],lt=arguments[1],kt=arguments[2];if(Oe.getEnvelopeInternal().distance(lt.getEnvelopeInternal())>this._minDistance)return null;for(var Zt=Oe.getCoordinates(),Un=lt.getCoordinates(),Fn=0;Fn<Zt.length-1;Fn++)for(var Xn=0;Xn<Un.length-1;Xn++){var hi=Wt.distanceLineLine(Zt[Fn],Zt[Fn+1],Un[Xn],Un[Xn+1]);if(hi<this._minDistance){this._minDistance=hi;var Sr=new ci(Zt[Fn],Zt[Fn+1]),On=new ci(Un[Xn],Un[Xn+1]),Sa=Sr.closestPoints(On);kt[0]=new Ta(Oe,Fn,Sa[0]),kt[1]=new Ta(lt,Xn,Sa[1])}if(this._minDistance<=this._terminateDistance)return null}}},ks.prototype.computeMinDistancePoints=function(l,h,y){for(var w=0;w<l.size();w++)for(var D=l.get(w),z=0;z<h.size();z++){var G=h.get(z),ie=D.getCoordinate().distance(G.getCoordinate());if(ie<this._minDistance&&(this._minDistance=ie,y[0]=new Ta(D,0,D.getCoordinate()),y[1]=new Ta(G,0,G.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},ks.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new ge("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},ks.prototype.computeMinDistanceLines=function(l,h,y){for(var w=0;w<l.size();w++)for(var D=l.get(w),z=0;z<h.size();z++){var G=h.get(z);if(this.computeMinDistance(D,G,y),this._minDistance<=this._terminateDistance)return null}},ks.prototype.interfaces_=function(){return[]},ks.prototype.getClass=function(){return ks},ks.distance=function(l,h){return new ks(l,h).distance()},ks.isWithinDistance=function(l,h,y){return new ks(l,h,y).distance()<=y},ks.nearestPoints=function(l,h){return new ks(l,h).nearestPoints()};var Ds=function(){this._pt=[new ne,new ne],this._distance=ue.NaN,this._isNull=!0};Ds.prototype.getCoordinates=function(){return this._pt},Ds.prototype.getCoordinate=function(l){return this._pt[l]},Ds.prototype.setMinimum=function(){if(1===arguments.length){var l=arguments[0];this.setMinimum(l._pt[0],l._pt[1])}else if(2===arguments.length){var h=arguments[0],y=arguments[1];if(this._isNull)return this.initialize(h,y),null;var w=h.distance(y);w<this._distance&&this.initialize(h,y,w)}},Ds.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var l=arguments[0],h=arguments[1];this._pt[0].setCoordinate(l),this._pt[1].setCoordinate(h),this._distance=l.distance(h),this._isNull=!1}else if(3===arguments.length){var w=arguments[1],D=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(w),this._distance=D,this._isNull=!1}},Ds.prototype.toString=function(){return _t.toLineString(this._pt[0],this._pt[1])},Ds.prototype.getDistance=function(){return this._distance},Ds.prototype.setMaximum=function(){if(1===arguments.length){var l=arguments[0];this.setMaximum(l._pt[0],l._pt[1])}else if(2===arguments.length){var h=arguments[0],y=arguments[1];if(this._isNull)return this.initialize(h,y),null;var w=h.distance(y);w>this._distance&&this.initialize(h,y,w)}},Ds.prototype.interfaces_=function(){return[]},Ds.prototype.getClass=function(){return Ds};var Sl=function(){};Sl.prototype.interfaces_=function(){return[]},Sl.prototype.getClass=function(){return Sl},Sl.computeDistance=function(){if(arguments[2]instanceof Ds&&arguments[0]instanceof Yo&&arguments[1]instanceof ne)for(var l=arguments[0],h=arguments[1],y=arguments[2],w=new ci,D=l.getCoordinates(),z=0;z<D.length-1;z++){w.setCoordinates(D[z],D[z+1]);var G=w.closestPoint(h);y.setMinimum(G,h)}else if(arguments[2]instanceof Ds&&arguments[0]instanceof rs&&arguments[1]instanceof ne){var ie=arguments[0],Oe=arguments[1],lt=arguments[2];Sl.computeDistance(ie.getExteriorRing(),Oe,lt);for(var kt=0;kt<ie.getNumInteriorRing();kt++)Sl.computeDistance(ie.getInteriorRingN(kt),Oe,lt)}else if(arguments[2]instanceof Ds&&arguments[0]instanceof Nn&&arguments[1]instanceof ne){var Zt=arguments[0],Un=arguments[1],Fn=arguments[2];if(Zt instanceof Yo)Sl.computeDistance(Zt,Un,Fn);else if(Zt instanceof rs)Sl.computeDistance(Zt,Un,Fn);else if(Zt instanceof go)for(var Xn=Zt,hi=0;hi<Xn.getNumGeometries();hi++){var Sr=Xn.getGeometryN(hi);Sl.computeDistance(Sr,Un,Fn)}else Fn.setMinimum(Zt.getCoordinate(),Un)}else if(arguments[2]instanceof Ds&&arguments[0]instanceof ci&&arguments[1]instanceof ne){var Sa=arguments[1],hc=arguments[2],$l=arguments[0].closestPoint(Sa);hc.setMinimum($l,Sa)}};var ll=function(){this._g0=null,this._g1=null,this._ptDist=new Ds,this._densifyFrac=0;var h=arguments[1];this._g0=arguments[0],this._g1=h},Ic={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};ll.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},ll.prototype.setDensifyFraction=function(l){if(l>1||l<=0)throw new ge("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=l},ll.prototype.compute=function(l,h){this.computeOrientedDistance(l,h,this._ptDist),this.computeOrientedDistance(h,l,this._ptDist)},ll.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},ll.prototype.computeOrientedDistance=function(l,h,y){var w=new Nc(h);if(l.apply(w),y.setMaximum(w.getMaxPointDistance()),this._densifyFrac>0){var D=new Gi(h,this._densifyFrac);l.apply(D),y.setMaximum(D.getMaxPointDistance())}},ll.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},ll.prototype.interfaces_=function(){return[]},ll.prototype.getClass=function(){return ll},ll.distance=function(){if(2===arguments.length)return new ll(arguments[0],arguments[1]).distance();if(3===arguments.length){var D=arguments[2],z=new ll(arguments[0],arguments[1]);return z.setDensifyFraction(D),z.distance()}},Ic.MaxPointDistanceFilter.get=function(){return Nc},Ic.MaxDensifiedByFractionDistanceFilter.get=function(){return Gi},Object.defineProperties(ll,Ic);var Nc=function(){this._maxPtDist=new Ds,this._minPtDist=new Ds,this._euclideanDist=new Sl,this._geom=null,this._geom=arguments[0]};Nc.prototype.filter=function(l){this._minPtDist.initialize(),Sl.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Nc.prototype.getMaxPointDistance=function(){return this._maxPtDist},Nc.prototype.interfaces_=function(){return[nr]},Nc.prototype.getClass=function(){return Nc};var Gi=function(){this._maxPtDist=new Ds,this._minPtDist=new Ds,this._geom=null,this._numSubSegs=0;var h=arguments[1];this._geom=arguments[0],this._numSubSegs=Math.trunc(Math.round(1/h))};Gi.prototype.filter=function(l,h){if(0===h)return null;for(var y=l.getCoordinate(h-1),w=l.getCoordinate(h),D=(w.x-y.x)/this._numSubSegs,z=(w.y-y.y)/this._numSubSegs,G=0;G<this._numSubSegs;G++){var lt=new ne(y.x+G*D,y.y+G*z);this._minPtDist.initialize(),Sl.computeDistance(this._geom,lt,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Gi.prototype.isDone=function(){return!1},Gi.prototype.isGeometryChanged=function(){return!1},Gi.prototype.getMaxPointDistance=function(){return this._maxPtDist},Gi.prototype.interfaces_=function(){return[wo]},Gi.prototype.getClass=function(){return Gi};var ma=function(l,h,y){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=l||null,this._bufDistance=h||null,this._result=y||null},xh={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ma.prototype.checkMaximumDistance=function(l,h,y){var w=new ll(h,l);if(w.setDensifyFraction(.25),this._maxDistanceFound=w.orientedDistance(),this._maxDistanceFound>y){this._isValid=!1;var D=w.getCoordinates();this._errorLocation=D[1],this._errorIndicator=l.getFactory().createLineString(D),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+_t.toLineString(D[0],D[1])+")"}},ma.prototype.isValid=function(){var l=Math.abs(this._bufDistance),h=ma.MAX_DISTANCE_DIFF_FRAC*l;return this._minValidDistance=l-h,this._maxValidDistance=l+h,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ma.VERBOSE&&Kt.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ma.prototype.checkNegativeValid=function(){if(!(this._input instanceof rs||this._input instanceof da||this._input instanceof go))return null;var l=this.getPolygonLines(this._input);if(this.checkMinimumDistance(l,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(l,this._result,this._maxValidDistance)},ma.prototype.getErrorIndicator=function(){return this._errorIndicator},ma.prototype.checkMinimumDistance=function(l,h,y){var w=new ks(l,h,y);if(this._minDistanceFound=w.distance(),this._minDistanceFound<y){this._isValid=!1;var D=w.nearestPoints();this._errorLocation=w.nearestPoints()[1],this._errorIndicator=l.getFactory().createLineString(D),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+_t.toLineString(D[0],D[1])+" )"}},ma.prototype.checkPositiveValid=function(){var l=this._result.getBoundary();if(this.checkMinimumDistance(this._input,l,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,l,this._maxValidDistance)},ma.prototype.getErrorLocation=function(){return this._errorLocation},ma.prototype.getPolygonLines=function(l){for(var h=new ke,y=new pa(h),w=al.getPolygons(l).iterator();w.hasNext();)w.next().apply(y);return l.getFactory().buildGeometry(h)},ma.prototype.getErrorMessage=function(){return this._errMsg},ma.prototype.interfaces_=function(){return[]},ma.prototype.getClass=function(){return ma},xh.VERBOSE.get=function(){return!1},xh.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ma,xh);var ss=function(l,h,y){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=l||null,this._distance=h||null,this._result=y||null},xr={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ss.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},ss.prototype.checkEnvelope=function(){if(this._distance<0)return null;var l=this._distance*ss.MAX_ENV_DIFF_FRAC;0===l&&(l=.001);var h=new mn(this._input.getEnvelopeInternal());h.expandBy(this._distance);var y=new mn(this._result.getEnvelopeInternal());y.expandBy(l),y.contains(h)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(y)),this.report("Envelope")},ss.prototype.checkDistance=function(){var l=new ma(this._input,this._distance,this._result);l.isValid()||(this._isValid=!1,this._errorMsg=l.getErrorMessage(),this._errorLocation=l.getErrorLocation(),this._errorIndicator=l.getErrorIndicator()),this.report("Distance")},ss.prototype.checkArea=function(){var l=this._input.getArea(),h=this._result.getArea();this._distance>0&&l>h&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&l<h&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ss.prototype.checkPolygonal=function(){this._result instanceof rs||this._result instanceof da||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ss.prototype.getErrorIndicator=function(){return this._errorIndicator},ss.prototype.getErrorLocation=function(){return this._errorLocation},ss.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ss.prototype.report=function(l){if(!ss.VERBOSE)return null;Kt.out.println("Check "+l+": "+(this._isValid?"passed":"FAILED"))},ss.prototype.getErrorMessage=function(){return this._errorMsg},ss.prototype.interfaces_=function(){return[]},ss.prototype.getClass=function(){return ss},ss.isValidMsg=function(l,h,y){var w=new ss(l,h,y);return w.isValid()?null:w.getErrorMessage()},ss.isValid=function(l,h,y){return!!new ss(l,h,y).isValid()},xr.VERBOSE.get=function(){return!1},xr.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ss,xr);var cl=function(){this._pts=null,this._data=null;var h=arguments[1];this._pts=arguments[0],this._data=h};cl.prototype.getCoordinates=function(){return this._pts},cl.prototype.size=function(){return this._pts.length},cl.prototype.getCoordinate=function(l){return this._pts[l]},cl.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},cl.prototype.getSegmentOctant=function(l){return l===this._pts.length-1?-1:wc.octant(this.getCoordinate(l),this.getCoordinate(l+1))},cl.prototype.setData=function(l){this._data=l},cl.prototype.getData=function(){return this._data},cl.prototype.toString=function(){return _t.toLineString(new Ko(this._pts))},cl.prototype.interfaces_=function(){return[Na]},cl.prototype.getClass=function(){return cl};var gs=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new ke,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null};gs.prototype.getInteriorIntersection=function(){return this._interiorIntersection},gs.prototype.setCheckEndSegmentsOnly=function(l){this._isCheckEndSegmentsOnly=l},gs.prototype.getIntersectionSegments=function(){return this._intSegments},gs.prototype.count=function(){return this._intersectionCount},gs.prototype.getIntersections=function(){return this._intersections},gs.prototype.setFindAllIntersections=function(l){this._findAllIntersections=l},gs.prototype.setKeepIntersections=function(l){this._keepIntersections=l},gs.prototype.processIntersections=function(l,h,y,w){if(!this._findAllIntersections&&this.hasIntersection()||l===y&&h===w||this._isCheckEndSegmentsOnly&&!this.isEndSegment(l,h)&&!this.isEndSegment(y,w))return null;var D=l.getCoordinates()[h],z=l.getCoordinates()[h+1],G=y.getCoordinates()[w],ie=y.getCoordinates()[w+1];this._li.computeIntersection(D,z,G,ie),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=D,this._intSegments[1]=z,this._intSegments[2]=G,this._intSegments[3]=ie,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},gs.prototype.isEndSegment=function(l,h){return 0===h||h>=l.size()-2},gs.prototype.hasIntersection=function(){return null!==this._interiorIntersection},gs.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},gs.prototype.interfaces_=function(){return[Sc]},gs.prototype.getClass=function(){return gs},gs.createAllIntersectionsFinder=function(l){var h=new gs(l);return h.setFindAllIntersections(!0),h},gs.createAnyIntersectionFinder=function(l){return new gs(l)},gs.createIntersectionCounter=function(l){var h=new gs(l);return h.setFindAllIntersections(!0),h.setKeepIntersections(!1),h};var vn=function(){this._li=new Gt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]};vn.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},vn.prototype.getIntersections=function(){return this._segInt.getIntersections()},vn.prototype.isValid=function(){return this.execute(),this._isValid},vn.prototype.setFindAllIntersections=function(l){this._findAllIntersections=l},vn.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new gs(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var l=new Do;if(l.setSegmentIntersector(this._segInt),l.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},vn.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new vl(this.getErrorMessage(),this._segInt.getInteriorIntersection())},vn.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var l=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+_t.toLineString(l[0],l[1])+" and "+_t.toLineString(l[2],l[3])},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn},vn.computeIntersections=function(l){var h=new vn(l);return h.setFindAllIntersections(!0),h.isValid(),h.getIntersections()};var _s=function l(){this._nv=null,this._nv=new vn(l.toSegmentStrings(arguments[0]))};_s.prototype.checkValid=function(){this._nv.checkValid()},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s},_s.toSegmentStrings=function(l){for(var h=new ke,y=l.iterator();y.hasNext();){var w=y.next();h.add(new cl(w.getCoordinates(),w))}return h},_s.checkValid=function(l){new _s(l).checkValid()};var _r=function(l){this._mapOp=l};_r.prototype.map=function(l){for(var h=new ke,y=0;y<l.getNumGeometries();y++){var w=this._mapOp.map(l.getGeometryN(y));w.isEmpty()||h.add(w)}return l.getFactory().createGeometryCollection(gi.toGeometryArray(h))},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r},_r.map=function(l,h){return new _r(h).map(l)};var Eo=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new ke,this._resultLineList=new ke;var h=arguments[1],y=arguments[2];this._op=arguments[0],this._geometryFactory=h,this._ptLocator=y};Eo.prototype.collectLines=function(l){for(var h=this._op.getGraph().getEdgeEnds().iterator();h.hasNext();){var y=h.next();this.collectLineEdge(y,l,this._lineEdgesList),this.collectBoundaryTouchEdge(y,l,this._lineEdgesList)}},Eo.prototype.labelIsolatedLine=function(l,h){var y=this._ptLocator.locate(l.getCoordinate(),this._op.getArgGeometry(h));l.getLabel().setLocation(h,y)},Eo.prototype.build=function(l){return this.findCoveredLineEdges(),this.collectLines(l),this.buildLines(l),this._resultLineList},Eo.prototype.collectLineEdge=function(l,h,y){var w=l.getLabel(),D=l.getEdge();l.isLineEdge()&&(l.isVisited()||!jn.isResultOfOp(w,h)||D.isCovered()||(y.add(D),l.setVisitedEdge(!0)))},Eo.prototype.findCoveredLineEdges=function(){for(var l=this._op.getGraph().getNodes().iterator();l.hasNext();)l.next().getEdges().findCoveredLineEdges();for(var h=this._op.getGraph().getEdgeEnds().iterator();h.hasNext();){var y=h.next(),w=y.getEdge();if(y.isLineEdge()&&!w.isCoveredSet()){var D=this._op.isCoveredByA(y.getCoordinate());w.setCovered(D)}}},Eo.prototype.labelIsolatedLines=function(l){for(var h=l.iterator();h.hasNext();){var y=h.next(),w=y.getLabel();y.isIsolated()&&(w.isNull(0)?this.labelIsolatedLine(y,0):this.labelIsolatedLine(y,1))}},Eo.prototype.buildLines=function(l){for(var h=this._lineEdgesList.iterator();h.hasNext();){var y=h.next(),w=this._geometryFactory.createLineString(y.getCoordinates());this._resultLineList.add(w),y.setInResult(!0)}},Eo.prototype.collectBoundaryTouchEdge=function(l,h,y){var w=l.getLabel();return l.isLineEdge()||l.isVisited()||l.isInteriorAreaEdge()||l.getEdge().isInResult()?null:(le.isTrue(!(l.isInResult()||l.getSym().isInResult())||!l.getEdge().isInResult()),void(jn.isResultOfOp(w,h)&&h===jn.INTERSECTION&&(y.add(l.getEdge()),l.setVisitedEdge(!0))))},Eo.prototype.interfaces_=function(){return[]},Eo.prototype.getClass=function(){return Eo};var as=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new ke;var h=arguments[1];this._op=arguments[0],this._geometryFactory=h};as.prototype.filterCoveredNodeToPoint=function(l){var h=l.getCoordinate();if(!this._op.isCoveredByLA(h)){var y=this._geometryFactory.createPoint(h);this._resultPointList.add(y)}},as.prototype.extractNonCoveredResultNodes=function(l){for(var h=this._op.getGraph().getNodes().iterator();h.hasNext();){var y=h.next();if(!(y.isInResult()||y.isIncidentEdgeInResult()||0!==y.getEdges().getDegree()&&l!==jn.INTERSECTION)){var w=y.getLabel();jn.isResultOfOp(w,l)&&this.filterCoveredNodeToPoint(y)}}},as.prototype.build=function(l){return this.extractNonCoveredResultNodes(l),this._resultPointList},as.prototype.interfaces_=function(){return[]},as.prototype.getClass=function(){return as};var Ls=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Ls.prototype.transformPoint=function(l,h){return this._factory.createPoint(this.transformCoordinates(l.getCoordinateSequence(),l))},Ls.prototype.transformPolygon=function(l,h){var y=!0,w=this.transformLinearRing(l.getExteriorRing(),l);null!==w&&w instanceof ka&&!w.isEmpty()||(y=!1);for(var D=new ke,z=0;z<l.getNumInteriorRing();z++){var G=this.transformLinearRing(l.getInteriorRingN(z),l);null===G||G.isEmpty()||(G instanceof ka||(y=!1),D.add(G))}if(y)return this._factory.createPolygon(w,D.toArray([]));var ie=new ke;return null!==w&&ie.add(w),ie.addAll(D),this._factory.buildGeometry(ie)},Ls.prototype.createCoordinateSequence=function(l){return this._factory.getCoordinateSequenceFactory().create(l)},Ls.prototype.getInputGeometry=function(){return this._inputGeom},Ls.prototype.transformMultiLineString=function(l,h){for(var y=new ke,w=0;w<l.getNumGeometries();w++){var D=this.transformLineString(l.getGeometryN(w),l);null!==D&&(D.isEmpty()||y.add(D))}return this._factory.buildGeometry(y)},Ls.prototype.transformCoordinates=function(l,h){return this.copy(l)},Ls.prototype.transformLineString=function(l,h){return this._factory.createLineString(this.transformCoordinates(l.getCoordinateSequence(),l))},Ls.prototype.transformMultiPoint=function(l,h){for(var y=new ke,w=0;w<l.getNumGeometries();w++){var D=this.transformPoint(l.getGeometryN(w),l);null!==D&&(D.isEmpty()||y.add(D))}return this._factory.buildGeometry(y)},Ls.prototype.transformMultiPolygon=function(l,h){for(var y=new ke,w=0;w<l.getNumGeometries();w++){var D=this.transformPolygon(l.getGeometryN(w),l);null!==D&&(D.isEmpty()||y.add(D))}return this._factory.buildGeometry(y)},Ls.prototype.copy=function(l){return l.copy()},Ls.prototype.transformGeometryCollection=function(l,h){for(var y=new ke,w=0;w<l.getNumGeometries();w++){var D=this.transform(l.getGeometryN(w));null!==D&&(this._pruneEmptyGeometry&&D.isEmpty()||y.add(D))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(gi.toGeometryArray(y)):this._factory.buildGeometry(y)},Ls.prototype.transform=function(l){if(this._inputGeom=l,this._factory=l.getFactory(),l instanceof is)return this.transformPoint(l,null);if(l instanceof ic)return this.transformMultiPoint(l,null);if(l instanceof ka)return this.transformLinearRing(l,null);if(l instanceof Yo)return this.transformLineString(l,null);if(l instanceof Ll)return this.transformMultiLineString(l,null);if(l instanceof rs)return this.transformPolygon(l,null);if(l instanceof da)return this.transformMultiPolygon(l,null);if(l instanceof go)return this.transformGeometryCollection(l,null);throw new ge("Unknown Geometry subtype: "+l.getClass().getName())},Ls.prototype.transformLinearRing=function(l,h){var y=this.transformCoordinates(l.getCoordinateSequence(),l);if(null===y)return this._factory.createLinearRing(null);var w=y.size();return w>0&&w<4&&!this._preserveType?this._factory.createLineString(y):this._factory.createLinearRing(y)},Ls.prototype.interfaces_=function(){return[]},Ls.prototype.getClass=function(){return Ls};var ls=function l(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ci,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Yo&&"number"==typeof arguments[1]){var y=arguments[1];l.call(this,arguments[0].getCoordinates(),y)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var w=arguments[0],D=arguments[1];this._srcPts=w,this._isClosed=l.isClosed(w),this._snapTolerance=D}};ls.prototype.snapVertices=function(l,h){for(var y=this._isClosed?l.size()-1:l.size(),w=0;w<y;w++){var D=l.get(w),z=this.findSnapForVertex(D,h);null!==z&&(l.set(w,new ne(z)),0===w&&this._isClosed&&l.set(l.size()-1,new ne(z)))}},ls.prototype.findSnapForVertex=function(l,h){for(var y=0;y<h.length;y++){if(l.equals2D(h[y]))return null;if(l.distance(h[y])<this._snapTolerance)return h[y]}return null},ls.prototype.snapTo=function(l){var h=new It(this._srcPts);return this.snapVertices(h,l),this.snapSegments(h,l),h.toCoordinateArray()},ls.prototype.snapSegments=function(l,h){if(0===h.length)return null;var y=h.length;h[0].equals2D(h[h.length-1])&&(y=h.length-1);for(var w=0;w<y;w++){var D=h[w],z=this.findSegmentIndexToSnap(D,l);z>=0&&l.add(z+1,new ne(D),!1)}},ls.prototype.findSegmentIndexToSnap=function(l,h){for(var y=ue.MAX_VALUE,w=-1,D=0;D<h.size()-1;D++){if(this._seg.p0=h.get(D),this._seg.p1=h.get(D+1),this._seg.p0.equals2D(l)||this._seg.p1.equals2D(l)){if(this._allowSnappingToSourceVertices)continue;return-1}var z=this._seg.distance(l);z<this._snapTolerance&&z<y&&(y=z,w=D)}return w},ls.prototype.setAllowSnappingToSourceVertices=function(l){this._allowSnappingToSourceVertices=l},ls.prototype.interfaces_=function(){return[]},ls.prototype.getClass=function(){return ls},ls.isClosed=function(l){return!(l.length<=1)&&l[0].equals2D(l[l.length-1])};var Fr=function(l){this._srcGeom=l||null},bh={SNAP_PRECISION_FACTOR:{configurable:!0}};Fr.prototype.snapTo=function(l,h){var y=this.extractTargetCoordinates(l);return new Pu(h,y).transform(this._srcGeom)},Fr.prototype.snapToSelf=function(l,h){var y=this.extractTargetCoordinates(this._srcGeom),w=new Pu(l,y,!0).transform(this._srcGeom),D=w;return h&&Lt(D,xa)&&(D=w.buffer(0)),D},Fr.prototype.computeSnapTolerance=function(l){return this.computeMinimumSegmentLength(l)/10},Fr.prototype.extractTargetCoordinates=function(l){for(var h=new Rt,y=l.getCoordinates(),w=0;w<y.length;w++)h.add(y[w]);return h.toArray(new Array(0).fill(null))},Fr.prototype.computeMinimumSegmentLength=function(l){for(var h=ue.MAX_VALUE,y=0;y<l.length-1;y++){var w=l[y].distance(l[y+1]);w<h&&(h=w)}return h},Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr},Fr.snap=function(l,h,y){var w=new Array(2).fill(null),D=new Fr(l);w[0]=D.snapTo(h,y);var z=new Fr(h);return w[1]=z.snapTo(w[0],y),w},Fr.computeOverlaySnapTolerance=function(){if(1===arguments.length){var l=arguments[0],h=Fr.computeSizeBasedSnapTolerance(l),y=l.getPrecisionModel();if(y.getType()===tn.FIXED){var w=1/y.getScale()*2/1.415;w>h&&(h=w)}return h}if(2===arguments.length){var z=arguments[1];return Math.min(Fr.computeOverlaySnapTolerance(arguments[0]),Fr.computeOverlaySnapTolerance(z))}},Fr.computeSizeBasedSnapTolerance=function(l){var h=l.getEnvelopeInternal();return Math.min(h.getHeight(),h.getWidth())*Fr.SNAP_PRECISION_FACTOR},Fr.snapToSelf=function(l,h,y){return new Fr(l).snapToSelf(h,y)},bh.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Fr,bh);var Pu=function(l){function h(y,w,D){l.call(this),this._snapTolerance=y||null,this._snapPts=w||null,this._isSelfSnap=void 0!==D&&D}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.snapLine=function(y,w){var D=new ls(y,this._snapTolerance);return D.setAllowSnappingToSourceVertices(this._isSelfSnap),D.snapTo(w)},h.prototype.transformCoordinates=function(y,w){var D=y.toCoordinateArray(),z=this.snapLine(D,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(z)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Ls),Ns=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Ns.prototype.getCommon=function(){return ue.longBitsToDouble(this._commonBits)},Ns.prototype.add=function(l){var h=ue.doubleToLongBits(l);return this._isFirst?(this._commonBits=h,this._commonSignExp=Ns.signExpBits(this._commonBits),this._isFirst=!1,null):Ns.signExpBits(h)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Ns.numCommonMostSigMantissaBits(this._commonBits,h),void(this._commonBits=Ns.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Ns.prototype.toString=function(){if(1===arguments.length){var l=arguments[0],h=ue.longBitsToDouble(l),y="0000000000000000000000000000000000000000000000000000000000000000"+ue.toBinaryString(l),w=y.substring(y.length-64);return w.substring(0,1)+"  "+w.substring(1,12)+"(exp) "+w.substring(12)+" [ "+h+" ]"}},Ns.prototype.interfaces_=function(){return[]},Ns.prototype.getClass=function(){return Ns},Ns.getBit=function(l,h){return l&1<<h?1:0},Ns.signExpBits=function(l){return l>>52},Ns.zeroLowerBits=function(l,h){return l&~((1<<h)-1)},Ns.numCommonMostSigMantissaBits=function(l,h){for(var y=0,w=52;w>=0;w--){if(Ns.getBit(l,w)!==Ns.getBit(h,w))return y;y++}return 52};var Ml=function(){this._commonCoord=null,this._ccFilter=new Zn},cs={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Ml.prototype.addCommonBits=function(l){var h=new ki(this._commonCoord);l.apply(h),l.geometryChanged()},Ml.prototype.removeCommonBits=function(l){if(0===this._commonCoord.x&&0===this._commonCoord.y)return l;var h=new ne(this._commonCoord);h.x=-h.x,h.y=-h.y;var y=new ki(h);return l.apply(y),l.geometryChanged(),l},Ml.prototype.getCommonCoordinate=function(){return this._commonCoord},Ml.prototype.add=function(l){l.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Ml.prototype.interfaces_=function(){return[]},Ml.prototype.getClass=function(){return Ml},cs.CommonCoordinateFilter.get=function(){return Zn},cs.Translater.get=function(){return ki},Object.defineProperties(Ml,cs);var Zn=function(){this._commonBitsX=new Ns,this._commonBitsY=new Ns};Zn.prototype.filter=function(l){this._commonBitsX.add(l.x),this._commonBitsY.add(l.y)},Zn.prototype.getCommonCoordinate=function(){return new ne(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Zn.prototype.interfaces_=function(){return[nr]},Zn.prototype.getClass=function(){return Zn};var ki=function(){this.trans=null,this.trans=arguments[0]};ki.prototype.filter=function(l,h){var y=l.getOrdinate(h,0)+this.trans.x,w=l.getOrdinate(h,1)+this.trans.y;l.setOrdinate(h,0,y),l.setOrdinate(h,1,w)},ki.prototype.isDone=function(){return!1},ki.prototype.isGeometryChanged=function(){return!0},ki.prototype.interfaces_=function(){return[wo]},ki.prototype.getClass=function(){return ki};var Qi=function(l,h){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=l,this._geom[1]=h,this.computeSnapTolerance()};Qi.prototype.selfSnap=function(l){return new Fr(l).snapTo(l,this._snapTolerance)},Qi.prototype.removeCommonBits=function(l){this._cbr=new Ml,this._cbr.add(l[0]),this._cbr.add(l[1]);var h=new Array(2).fill(null);return h[0]=this._cbr.removeCommonBits(l[0].copy()),h[1]=this._cbr.removeCommonBits(l[1].copy()),h},Qi.prototype.prepareResult=function(l){return this._cbr.addCommonBits(l),l},Qi.prototype.getResultGeometry=function(l){var h=this.snap(this._geom),y=jn.overlayOp(h[0],h[1],l);return this.prepareResult(y)},Qi.prototype.checkValid=function(l){l.isValid()||Kt.out.println("Snapped geometry is invalid")},Qi.prototype.computeSnapTolerance=function(){this._snapTolerance=Fr.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Qi.prototype.snap=function(l){var h=this.removeCommonBits(l);return Fr.snap(h[0],h[1],this._snapTolerance)},Qi.prototype.interfaces_=function(){return[]},Qi.prototype.getClass=function(){return Qi},Qi.overlayOp=function(l,h,y){return new Qi(l,h).getResultGeometry(y)},Qi.union=function(l,h){return Qi.overlayOp(l,h,jn.UNION)},Qi.intersection=function(l,h){return Qi.overlayOp(l,h,jn.INTERSECTION)},Qi.symDifference=function(l,h){return Qi.overlayOp(l,h,jn.SYMDIFFERENCE)},Qi.difference=function(l,h){return Qi.overlayOp(l,h,jn.DIFFERENCE)};var Co=function(l,h){this._geom=new Array(2).fill(null),this._geom[0]=l,this._geom[1]=h};Co.prototype.getResultGeometry=function(l){var h=null,y=!1,w=null;try{h=jn.overlayOp(this._geom[0],this._geom[1],l),y=!0}catch(D){if(!(D instanceof we))throw D;w=D}if(!y)try{h=Qi.overlayOp(this._geom[0],this._geom[1],l)}catch(D){throw D instanceof we?w:D}return h},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co},Co.overlayOp=function(l,h,y){return new Co(l,h).getResultGeometry(y)},Co.union=function(l,h){return Co.overlayOp(l,h,jn.UNION)},Co.intersection=function(l,h){return Co.overlayOp(l,h,jn.INTERSECTION)},Co.symDifference=function(l,h){return Co.overlayOp(l,h,jn.SYMDIFFERENCE)},Co.difference=function(l,h){return Co.overlayOp(l,h,jn.DIFFERENCE)};var Vn=function(){this.mce=null,this.chainIndex=null;var h=arguments[1];this.mce=arguments[0],this.chainIndex=h};Vn.prototype.computeIntersections=function(l,h){this.mce.computeIntersectsForChain(this.chainIndex,l.mce,l.chainIndex,h)},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn};var yr=function l(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var h=arguments[0],y=arguments[1];this._eventType=l.DELETE,this._xValue=h,this._insertEvent=y}else if(3===arguments.length){var w=arguments[0],D=arguments[1],z=arguments[2];this._eventType=l.INSERT,this._label=w,this._xValue=D,this._obj=z}},su={INSERT:{configurable:!0},DELETE:{configurable:!0}};yr.prototype.isDelete=function(){return this._eventType===yr.DELETE},yr.prototype.setDeleteEventIndex=function(l){this._deleteEventIndex=l},yr.prototype.getObject=function(){return this._obj},yr.prototype.compareTo=function(l){return this._xValue<l._xValue?-1:this._xValue>l._xValue?1:this._eventType<l._eventType?-1:this._eventType>l._eventType?1:0},yr.prototype.getInsertEvent=function(){return this._insertEvent},yr.prototype.isInsert=function(){return this._eventType===yr.INSERT},yr.prototype.isSameLabel=function(l){return null!==this._label&&this._label===l._label},yr.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},yr.prototype.interfaces_=function(){return[de]},yr.prototype.getClass=function(){return yr},su.INSERT.get=function(){return 1},su.DELETE.get=function(){return 2},Object.defineProperties(yr,su);var Go=function(){};Go.prototype.interfaces_=function(){return[]},Go.prototype.getClass=function(){return Go};var So=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var h=arguments[1],y=arguments[2];this._li=arguments[0],this._includeProper=h,this._recordIsolated=y};So.prototype.isTrivialIntersection=function(l,h,y,w){if(l===y&&1===this._li.getIntersectionNum()){if(So.isAdjacentSegments(h,w))return!0;if(l.isClosed()){var D=l.getNumPoints()-1;if(0===h&&w===D||0===w&&h===D)return!0}}return!1},So.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},So.prototype.setIsDoneIfProperInt=function(l){this._isDoneWhenProperInt=l},So.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},So.prototype.isBoundaryPointInternal=function(l,h){for(var y=h.iterator();y.hasNext();){var w=y.next().getCoordinate();if(l.isIntersection(w))return!0}return!1},So.prototype.hasProperIntersection=function(){return this._hasProper},So.prototype.hasIntersection=function(){return this._hasIntersection},So.prototype.isDone=function(){return this._isDone},So.prototype.isBoundaryPoint=function(l,h){return!(null===h||!this.isBoundaryPointInternal(l,h[0])&&!this.isBoundaryPointInternal(l,h[1]))},So.prototype.setBoundaryNodes=function(l,h){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=l,this._bdyNodes[1]=h},So.prototype.addIntersections=function(l,h,y,w){if(l===y&&h===w)return null;this.numTests++;var D=l.getCoordinates()[h],z=l.getCoordinates()[h+1],G=y.getCoordinates()[w],ie=y.getCoordinates()[w+1];this._li.computeIntersection(D,z,G,ie),this._li.hasIntersection()&&(this._recordIsolated&&(l.setIsolated(!1),y.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(l,h,y,w)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(l.addIntersections(this._li,h,0),y.addIntersections(this._li,w,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},So.prototype.interfaces_=function(){return[]},So.prototype.getClass=function(){return So},So.isAdjacentSegments=function(l,h){return 1===Math.abs(l-h)};var Fs=function(l){function h(){l.call(this),this.events=new ke,this.nOverlaps=null}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.prepareEvents=function(){xi.sort(this.events);for(var y=0;y<this.events.size();y++){var w=this.events.get(y);w.isDelete()&&w.getInsertEvent().setDeleteEventIndex(y)}},h.prototype.computeIntersections=function(){if(1===arguments.length){var y=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var w=0;w<this.events.size();w++){var D=this.events.get(w);if(D.isInsert()&&this.processOverlaps(w,D.getDeleteEventIndex(),D,y),y.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof So&&Lt(arguments[0],et)&&Lt(arguments[1],et)){var z=arguments[0],G=arguments[1],ie=arguments[2];this.addEdges(z,z),this.addEdges(G,G),this.computeIntersections(ie)}else if("boolean"==typeof arguments[2]&&Lt(arguments[0],et)&&arguments[1]instanceof So){var Oe=arguments[0],lt=arguments[1];arguments[2]?this.addEdges(Oe,null):this.addEdges(Oe),this.computeIntersections(lt)}},h.prototype.addEdge=function(y,w){for(var D=y.getMonotoneChainEdge(),z=D.getStartIndexes(),G=0;G<z.length-1;G++){var ie=new Vn(D,G),Oe=new yr(w,D.getMinX(G),ie);this.events.add(Oe),this.events.add(new yr(D.getMaxX(G),Oe))}},h.prototype.processOverlaps=function(y,w,D,z){for(var G=D.getObject(),ie=y;ie<w;ie++){var Oe=this.events.get(ie);if(Oe.isInsert()){var lt=Oe.getObject();D.isSameLabel(Oe)||(G.computeIntersections(lt,z),this.nOverlaps++)}}},h.prototype.addEdges=function(){if(1===arguments.length)for(var y=arguments[0].iterator();y.hasNext();){var w=y.next();this.addEdge(w,w)}else if(2===arguments.length)for(var z=arguments[1],G=arguments[0].iterator();G.hasNext();){var ie=G.next();this.addEdge(ie,z)}},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Go),Si=function(){this._min=ue.POSITIVE_INFINITY,this._max=ue.NEGATIVE_INFINITY},au={NodeComparator:{configurable:!0}};Si.prototype.getMin=function(){return this._min},Si.prototype.intersects=function(l,h){return!(this._min>h||this._max<l)},Si.prototype.getMax=function(){return this._max},Si.prototype.toString=function(){return _t.toLineString(new ne(this._min,0),new ne(this._max,0))},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si},au.NodeComparator.get=function(){return Ru},Object.defineProperties(Si,au);var Ru=function(){};Ru.prototype.compare=function(l,h){var D=(l._min+l._max)/2,z=(h._min+h._max)/2;return D<z?-1:D>z?1:0},Ru.prototype.interfaces_=function(){return[Ae]},Ru.prototype.getClass=function(){return Ru};var lu=function(l){function h(){l.call(this),this._item=null;var w=arguments[1],D=arguments[2];this._min=arguments[0],this._max=w,this._item=D}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.query=function(y,w,D){if(!this.intersects(y,w))return null;D.visitItem(this._item)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Si),Ys=function(l){function h(){l.call(this),this._node1=null,this._node2=null;var w=arguments[1];this._node1=arguments[0],this._node2=w,this.buildExtent(this._node1,this._node2)}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.buildExtent=function(y,w){this._min=Math.min(y._min,w._min),this._max=Math.max(y._max,w._max)},h.prototype.query=function(y,w,D){if(!this.intersects(y,w))return null;null!==this._node1&&this._node1.query(y,w,D),null!==this._node2&&this._node2.query(y,w,D)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(Si),Aa=function(){this._leaves=new ke,this._root=null,this._level=0};Aa.prototype.buildTree=function(){xi.sort(this._leaves,new Si.NodeComparator);for(var l=this._leaves,h=null,y=new ke;;){if(this.buildLevel(l,y),1===y.size())return y.get(0);h=l,l=y,y=h}},Aa.prototype.insert=function(l,h,y){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new lu(l,h,y))},Aa.prototype.query=function(l,h,y){this.init(),this._root.query(l,h,y)},Aa.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Aa.prototype.printNode=function(l){Kt.out.println(_t.toLineString(new ne(l._min,this._level),new ne(l._max,this._level)))},Aa.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Aa.prototype.buildLevel=function(l,h){this._level++,h.clear();for(var y=0;y<l.size();y+=2){var w=l.get(y);if(null===(y+1<l.size()?l.get(y):null))h.add(w);else{var D=new Ys(l.get(y),l.get(y+1));h.add(D)}}},Aa.prototype.interfaces_=function(){return[]},Aa.prototype.getClass=function(){return Aa};var el=function(){this._items=new ke};el.prototype.visitItem=function(l){this._items.add(l)},el.prototype.getItems=function(){return this._items},el.prototype.interfaces_=function(){return[Xa]},el.prototype.getClass=function(){return el};var za=function(){this._index=null;var l=arguments[0];if(!Lt(l,xa))throw new ge("Argument must be Polygonal");this._index=new ga(l)},Qu={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};za.prototype.locate=function(l){var h=new cn(l),y=new Ou(h);return this._index.query(l.y,l.y,y),h.getLocation()},za.prototype.interfaces_=function(){return[Xu]},za.prototype.getClass=function(){return za},Qu.SegmentVisitor.get=function(){return Ou},Qu.IntervalIndexedGeometry.get=function(){return ga},Object.defineProperties(za,Qu);var Ou=function(){this._counter=null,this._counter=arguments[0]};Ou.prototype.visitItem=function(l){var h=l;this._counter.countSegment(h.getCoordinate(0),h.getCoordinate(1))},Ou.prototype.interfaces_=function(){return[Xa]},Ou.prototype.getClass=function(){return Ou};var ga=function(){this._index=new Aa,this.init(arguments[0])};ga.prototype.init=function(l){for(var h=pa.getLines(l).iterator();h.hasNext();){var y=h.next().getCoordinates();this.addLine(y)}},ga.prototype.addLine=function(l){for(var h=1;h<l.length;h++){var y=new ci(l[h-1],l[h]),w=Math.min(y.p0.y,y.p1.y),D=Math.max(y.p0.y,y.p1.y);this._index.insert(w,D,y)}},ga.prototype.query=function(){if(2===arguments.length){var l=arguments[0],h=arguments[1],y=new el;return this._index.query(l,h,y),y.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},ga.prototype.interfaces_=function(){return[]},ga.prototype.getClass=function(){return ga};var ul=function(l){function h(){if(l.call(this),this._parentGeom=null,this._lineEdgeMap=new eu,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Os,2===arguments.length){var w=arguments[1],D=cr.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0],this._parentGeom=w,this._boundaryNodeRule=D,null!==w&&this.add(w)}else if(3===arguments.length){var G=arguments[1],ie=arguments[2];this._argIndex=arguments[0],this._parentGeom=G,this._boundaryNodeRule=ie,null!==G&&this.add(G)}}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.insertBoundaryPoint=function(y,w){var D=this._nodes.addNode(w).getLabel(),z=1;D.getLocation(y,nn.ON)===Me.BOUNDARY&&z++;var G=h.determineBoundary(this._boundaryNodeRule,z);D.setLocation(y,G)},h.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var z=arguments[1],G=arguments[2],ie=new So(arguments[0],!0,!1);return ie.setIsDoneIfProperInt(G),this.createEdgeSetIntersector().computeIntersections(this._edges,ie,z||!(this._parentGeom instanceof ka||this._parentGeom instanceof rs||this._parentGeom instanceof da)),this.addSelfIntersectionNodes(this._argIndex),ie}},h.prototype.computeSplitEdges=function(y){for(var w=this._edges.iterator();w.hasNext();)w.next().eiList.addSplitEdges(y)},h.prototype.computeEdgeIntersections=function(y,w,D){var z=new So(w,D,!0);return z.setBoundaryNodes(this.getBoundaryNodes(),y.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,y._edges,z),z},h.prototype.getGeometry=function(){return this._parentGeom},h.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},h.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},h.prototype.addPoint=function(){if(arguments[0]instanceof is){var y=arguments[0].getCoordinate();this.insertPoint(this._argIndex,y,Me.INTERIOR)}else arguments[0]instanceof ne&&this.insertPoint(this._argIndex,arguments[0],Me.INTERIOR)},h.prototype.addPolygon=function(y){this.addPolygonRing(y.getExteriorRing(),Me.EXTERIOR,Me.INTERIOR);for(var w=0;w<y.getNumInteriorRing();w++){var D=y.getInteriorRingN(w);this.addPolygonRing(D,Me.INTERIOR,Me.EXTERIOR)}},h.prototype.addEdge=function(y){this.insertEdge(y);var w=y.getCoordinates();this.insertPoint(this._argIndex,w[0],Me.BOUNDARY),this.insertPoint(this._argIndex,w[w.length-1],Me.BOUNDARY)},h.prototype.addLineString=function(y){var w=Ye.removeRepeatedPoints(y.getCoordinates());if(w.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=w[0],null;var D=new Qa(w,new mr(this._argIndex,Me.INTERIOR));this._lineEdgeMap.put(y,D),this.insertEdge(D),le.isTrue(w.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,w[0]),this.insertBoundaryPoint(this._argIndex,w[w.length-1])},h.prototype.getInvalidPoint=function(){return this._invalidPoint},h.prototype.getBoundaryPoints=function(){for(var y=this.getBoundaryNodes(),w=new Array(y.size()).fill(null),D=0,z=y.iterator();z.hasNext();){var G=z.next();w[D++]=G.getCoordinate().copy()}return w},h.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},h.prototype.addSelfIntersectionNode=function(y,w,D){if(this.isBoundaryNode(y,w))return null;D===Me.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(y,w):this.insertPoint(y,w,D)},h.prototype.addPolygonRing=function(y,w,D){if(y.isEmpty())return null;var z=Ye.removeRepeatedPoints(y.getCoordinates());if(z.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=z[0],null;var G=w,ie=D;Wt.isCCW(z)&&(G=D,ie=w);var Oe=new Qa(z,new mr(this._argIndex,Me.BOUNDARY,G,ie));this._lineEdgeMap.put(y,Oe),this.insertEdge(Oe),this.insertPoint(this._argIndex,z[0],Me.BOUNDARY)},h.prototype.insertPoint=function(y,w,D){var z=this._nodes.addNode(w),G=z.getLabel();null===G?z._label=new mr(y,D):G.setLocation(y,D)},h.prototype.createEdgeSetIntersector=function(){return new Fs},h.prototype.addSelfIntersectionNodes=function(y){for(var w=this._edges.iterator();w.hasNext();)for(var D=w.next(),z=D.getLabel().getLocation(y),G=D.eiList.iterator();G.hasNext();){var ie=G.next();this.addSelfIntersectionNode(y,ie.coord,z)}},h.prototype.add=function(){if(1!==arguments.length)return l.prototype.add.apply(this,arguments);var y=arguments[0];if(y.isEmpty())return null;if(y instanceof da&&(this._useBoundaryDeterminationRule=!1),y instanceof rs)this.addPolygon(y);else if(y instanceof Yo)this.addLineString(y);else if(y instanceof is)this.addPoint(y);else if(y instanceof ic)this.addCollection(y);else if(y instanceof Ll)this.addCollection(y);else if(y instanceof da)this.addCollection(y);else{if(!(y instanceof go))throw new Error(y.getClass().getName());this.addCollection(y)}},h.prototype.addCollection=function(y){for(var w=0;w<y.getNumGeometries();w++){var D=y.getGeometryN(w);this.add(D)}},h.prototype.locate=function(y){return Lt(this._parentGeom,xa)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new za(this._parentGeom)),this._areaPtLocator.locate(y)):this._ptLocator.locate(y,this._parentGeom)},h.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):l.prototype.findEdge.apply(this,arguments)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h.determineBoundary=function(y,w){return y.isInBoundary(w)?Me.BOUNDARY:Me.INTERIOR},h}(Vo),cc=function(){if(this._li=new Gt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var l=arguments[0];this.setComputationPrecision(l.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new ul(0,l)}else if(2===arguments.length){var h=arguments[0],y=arguments[1],w=cr.OGC_SFS_BOUNDARY_RULE;h.getPrecisionModel().compareTo(y.getPrecisionModel())>=0?this.setComputationPrecision(h.getPrecisionModel()):this.setComputationPrecision(y.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ul(0,h,w),this._arg[1]=new ul(1,y,w)}else if(3===arguments.length){var D=arguments[0],z=arguments[1],G=arguments[2];D.getPrecisionModel().compareTo(z.getPrecisionModel())>=0?this.setComputationPrecision(D.getPrecisionModel()):this.setComputationPrecision(z.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new ul(0,D,G),this._arg[1]=new ul(1,z,G)}};cc.prototype.getArgGeometry=function(l){return this._arg[l].getGeometry()},cc.prototype.setComputationPrecision=function(l){this._resultPrecisionModel=l,this._li.setPrecisionModel(this._resultPrecisionModel)},cc.prototype.interfaces_=function(){return[]},cc.prototype.getClass=function(){return cc};var Il=function(){};Il.prototype.interfaces_=function(){return[]},Il.prototype.getClass=function(){return Il},Il.map=function(){if(arguments[0]instanceof Nn&&Lt(arguments[1],Il.MapOp)){for(var l=arguments[0],h=arguments[1],y=new ke,w=0;w<l.getNumGeometries();w++){var D=h.map(l.getGeometryN(w));null!==D&&y.add(D)}return l.getFactory().buildGeometry(y)}if(Lt(arguments[0],se)&&Lt(arguments[1],Il.MapOp)){for(var z=arguments[0],G=arguments[1],ie=new ke,Oe=z.iterator();Oe.hasNext();){var lt=Oe.next(),kt=G.map(lt);null!==kt&&ie.add(kt)}return ie}},Il.MapOp=function(){};var jn=function(l){function h(){var y=arguments[0];l.call(this,y,arguments[1]),this._ptLocator=new Os,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Dt,this._resultPolyList=new ke,this._resultLineList=new ke,this._resultPointList=new ke,this._graph=new Vo(new nu),this._geomFact=y.getFactory()}return l&&(h.__proto__=l),(h.prototype=Object.create(l&&l.prototype)).constructor=h,h.prototype.insertUniqueEdge=function(y){var w=this._edgeList.findEqualEdge(y);if(null!==w){var D=w.getLabel(),z=y.getLabel();w.isPointwiseEqual(y)||(z=new mr(y.getLabel())).flip();var G=w.getDepth();G.isNull()&&G.add(D),G.add(z),D.merge(z)}else this._edgeList.add(y)},h.prototype.getGraph=function(){return this._graph},h.prototype.cancelDuplicateResultEdges=function(){for(var y=this._graph.getEdgeEnds().iterator();y.hasNext();){var w=y.next(),D=w.getSym();w.isInResult()&&D.isInResult()&&(w.setInResult(!1),D.setInResult(!1))}},h.prototype.isCoveredByLA=function(y){return!!this.isCovered(y,this._resultLineList)||!!this.isCovered(y,this._resultPolyList)},h.prototype.computeGeometry=function(y,w,D,z){var G=new ke;return G.addAll(y),G.addAll(w),G.addAll(D),G.isEmpty()?h.createEmptyResult(z,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(G)},h.prototype.mergeSymLabels=function(){for(var y=this._graph.getNodes().iterator();y.hasNext();)y.next().getEdges().mergeSymLabels()},h.prototype.isCovered=function(y,w){for(var D=w.iterator();D.hasNext();){var z=D.next();if(this._ptLocator.locate(y,z)!==Me.EXTERIOR)return!0}return!1},h.prototype.replaceCollapsedEdges=function(){for(var y=new ke,w=this._edgeList.iterator();w.hasNext();){var D=w.next();D.isCollapsed()&&(w.remove(),y.add(D.getCollapsedEdge()))}this._edgeList.addAll(y)},h.prototype.updateNodeLabelling=function(){for(var y=this._graph.getNodes().iterator();y.hasNext();){var w=y.next(),D=w.getEdges().getLabel();w.getLabel().merge(D)}},h.prototype.getResultGeometry=function(y){return this.computeOverlay(y),this._resultGeom},h.prototype.insertUniqueEdges=function(y){for(var w=y.iterator();w.hasNext();){var D=w.next();this.insertUniqueEdge(D)}},h.prototype.computeOverlay=function(y){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var w=new ke;this._arg[0].computeSplitEdges(w),this._arg[1].computeSplitEdges(w),this.insertUniqueEdges(w),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),_s.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(y),this.cancelDuplicateResultEdges();var D=new ia(this._geomFact);D.add(this._graph),this._resultPolyList=D.getPolygons();var z=new Eo(this,this._geomFact,this._ptLocator);this._resultLineList=z.build(y);var G=new as(this,this._geomFact,this._ptLocator);this._resultPointList=G.build(y),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,y)},h.prototype.labelIncompleteNode=function(y,w){var D=this._ptLocator.locate(y.getCoordinate(),this._arg[w].getGeometry());y.getLabel().setLocation(w,D)},h.prototype.copyPoints=function(y){for(var w=this._arg[y].getNodeIterator();w.hasNext();){var D=w.next();this._graph.addNode(D.getCoordinate()).setLabel(y,D.getLabel().getLocation(y))}},h.prototype.findResultAreaEdges=function(y){for(var w=this._graph.getEdgeEnds().iterator();w.hasNext();){var D=w.next(),z=D.getLabel();z.isArea()&&!D.isInteriorAreaEdge()&&h.isResultOfOp(z.getLocation(0,nn.RIGHT),z.getLocation(1,nn.RIGHT),y)&&D.setInResult(!0)}},h.prototype.computeLabelsFromDepths=function(){for(var y=this._edgeList.iterator();y.hasNext();){var w=y.next(),D=w.getLabel(),z=w.getDepth();if(!z.isNull()){z.normalize();for(var G=0;G<2;G++)D.isNull(G)||!D.isArea()||z.isNull(G)||(0===z.getDelta(G)?D.toLine(G):(le.isTrue(!z.isNull(G,nn.LEFT),"depth of LEFT side has not been initialized"),D.setLocation(G,nn.LEFT,z.getLocation(G,nn.LEFT)),le.isTrue(!z.isNull(G,nn.RIGHT),"depth of RIGHT side has not been initialized"),D.setLocation(G,nn.RIGHT,z.getLocation(G,nn.RIGHT))))}}},h.prototype.computeLabelling=function(){for(var y=this._graph.getNodes().iterator();y.hasNext();)y.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},h.prototype.labelIncompleteNodes=function(){for(var y=this._graph.getNodes().iterator();y.hasNext();){var w=y.next(),D=w.getLabel();w.isIsolated()&&(D.isNull(0)?this.labelIncompleteNode(w,0):this.labelIncompleteNode(w,1)),w.getEdges().updateLabelling(D)}},h.prototype.isCoveredByA=function(y){return!!this.isCovered(y,this._resultPolyList)},h.prototype.interfaces_=function(){return[]},h.prototype.getClass=function(){return h},h}(cc);jn.overlayOp=function(l,h,y){return new jn(l,h).getResultGeometry(y)},jn.intersection=function(l,h){if(l.isEmpty()||h.isEmpty())return jn.createEmptyResult(jn.INTERSECTION,l,h,l.getFactory());if(l.isGeometryCollection()){var y=h;return _r.map(l,{interfaces_:function(){return[Il.MapOp]},map:function(w){return w.intersection(y)}})}return l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(h),Co.overlayOp(l,h,jn.INTERSECTION)},jn.symDifference=function(l,h){if(l.isEmpty()||h.isEmpty()){if(l.isEmpty()&&h.isEmpty())return jn.createEmptyResult(jn.SYMDIFFERENCE,l,h,l.getFactory());if(l.isEmpty())return h.copy();if(h.isEmpty())return l.copy()}return l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(h),Co.overlayOp(l,h,jn.SYMDIFFERENCE)},jn.resultDimension=function(l,h,y){var w=h.getDimension(),D=y.getDimension(),z=-1;switch(l){case jn.INTERSECTION:z=Math.min(w,D);break;case jn.UNION:z=Math.max(w,D);break;case jn.DIFFERENCE:z=w;break;case jn.SYMDIFFERENCE:z=Math.max(w,D)}return z},jn.createEmptyResult=function(l,h,y,w){var D=null;switch(jn.resultDimension(l,h,y)){case-1:D=w.createGeometryCollection(new Array(0).fill(null));break;case 0:D=w.createPoint();break;case 1:D=w.createLineString();break;case 2:D=w.createPolygon()}return D},jn.difference=function(l,h){return l.isEmpty()?jn.createEmptyResult(jn.DIFFERENCE,l,h,l.getFactory()):h.isEmpty()?l.copy():(l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(h),Co.overlayOp(l,h,jn.DIFFERENCE))},jn.isResultOfOp=function(){if(2===arguments.length){var l=arguments[0],h=arguments[1],y=l.getLocation(0),w=l.getLocation(1);return jn.isResultOfOp(y,w,h)}if(3===arguments.length){var D=arguments[0],z=arguments[1];switch(D===Me.BOUNDARY&&(D=Me.INTERIOR),z===Me.BOUNDARY&&(z=Me.INTERIOR),arguments[2]){case jn.INTERSECTION:return D===Me.INTERIOR&&z===Me.INTERIOR;case jn.UNION:return D===Me.INTERIOR||z===Me.INTERIOR;case jn.DIFFERENCE:return D===Me.INTERIOR&&z!==Me.INTERIOR;case jn.SYMDIFFERENCE:return D===Me.INTERIOR&&z!==Me.INTERIOR||D!==Me.INTERIOR&&z===Me.INTERIOR}return!1}},jn.INTERSECTION=1,jn.UNION=2,jn.DIFFERENCE=3,jn.SYMDIFFERENCE=4;var uc=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Os,this._seg=new ci;var l=arguments[0],h=arguments[1];this._g=l,this._boundaryDistanceTolerance=h,this._linework=this.extractLinework(l)};uc.prototype.isWithinToleranceOfBoundary=function(l){for(var h=0;h<this._linework.getNumGeometries();h++)for(var y=this._linework.getGeometryN(h).getCoordinateSequence(),w=0;w<y.size()-1;w++)if(y.getCoordinate(w,this._seg.p0),y.getCoordinate(w+1,this._seg.p1),this._seg.distance(l)<=this._boundaryDistanceTolerance)return!0;return!1},uc.prototype.getLocation=function(l){return this.isWithinToleranceOfBoundary(l)?Me.BOUNDARY:this._ptLocator.locate(l,this._g)},uc.prototype.extractLinework=function(l){var h=new dc;l.apply(h);var y=h.getLinework(),w=gi.toLineStringArray(y);return l.getFactory().createMultiLineString(w)},uc.prototype.interfaces_=function(){return[]},uc.prototype.getClass=function(){return uc};var dc=function(){this._linework=null,this._linework=new ke};dc.prototype.getLinework=function(){return this._linework},dc.prototype.filter=function(l){if(l instanceof rs){var h=l;this._linework.add(h.getExteriorRing());for(var y=0;y<h.getNumInteriorRing();y++)this._linework.add(h.getInteriorRingN(y))}},dc.prototype.interfaces_=function(){return[ta]},dc.prototype.getClass=function(){return dc};var Dc=function(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]};Dc.prototype.extractPoints=function(l,h,y){for(var w=l.getCoordinates(),D=0;D<w.length-1;D++)this.computeOffsetPoints(w[D],w[D+1],h,y)},Dc.prototype.setSidesToGenerate=function(l,h){this._doLeft=l,this._doRight=h},Dc.prototype.getPoints=function(l){for(var h=new ke,y=pa.getLines(this._g).iterator();y.hasNext();){var w=y.next();this.extractPoints(w,l,h)}return h},Dc.prototype.computeOffsetPoints=function(l,h,y,w){var D=h.x-l.x,z=h.y-l.y,G=Math.sqrt(D*D+z*z),ie=y*D/G,Oe=y*z/G,lt=(h.x+l.x)/2,kt=(h.y+l.y)/2;if(this._doLeft){var Zt=new ne(lt-Oe,kt+ie);w.add(Zt)}if(this._doRight){var Un=new ne(lt+Oe,kt-ie);w.add(Un)}},Dc.prototype.interfaces_=function(){return[]},Dc.prototype.getClass=function(){return Dc};var ys=function l(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=l.TOLERANCE,this._testCoords=new ke;var h=arguments[0],y=arguments[1],w=arguments[2];this._boundaryDistanceTolerance=l.computeBoundaryDistanceTolerance(h,y),this._geom=[h,y,w],this._locFinder=[new uc(this._geom[0],this._boundaryDistanceTolerance),new uc(this._geom[1],this._boundaryDistanceTolerance),new uc(this._geom[2],this._boundaryDistanceTolerance)]},Ju={TOLERANCE:{configurable:!0}};ys.prototype.reportResult=function(l,h,y){Kt.out.println("Overlay result invalid - A:"+Me.toLocationSymbol(h[0])+" B:"+Me.toLocationSymbol(h[1])+" expected:"+(y?"i":"e")+" actual:"+Me.toLocationSymbol(h[2]))},ys.prototype.isValid=function(l){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(l)},ys.prototype.checkValid=function(){if(1===arguments.length){for(var l=arguments[0],h=0;h<this._testCoords.size();h++){var y=this._testCoords.get(h);if(!this.checkValid(l,y))return this._invalidLocation=y,!1}return!0}if(2===arguments.length){var w=arguments[0],D=arguments[1];return this._location[0]=this._locFinder[0].getLocation(D),this._location[1]=this._locFinder[1].getLocation(D),this._location[2]=this._locFinder[2].getLocation(D),!!ys.hasLocation(this._location,Me.BOUNDARY)||this.isValidResult(w,this._location)}},ys.prototype.addTestPts=function(l){var h=new Dc(l);this._testCoords.addAll(h.getPoints(5*this._boundaryDistanceTolerance))},ys.prototype.isValidResult=function(l,h){var y=jn.isResultOfOp(h[0],h[1],l),w=!(y^h[2]===Me.INTERIOR);return w||this.reportResult(l,h,y),w},ys.prototype.getInvalidLocation=function(){return this._invalidLocation},ys.prototype.interfaces_=function(){return[]},ys.prototype.getClass=function(){return ys},ys.hasLocation=function(l,h){for(var y=0;y<3;y++)if(l[y]===h)return!0;return!1},ys.computeBoundaryDistanceTolerance=function(l,h){return Math.min(Fr.computeSizeBasedSnapTolerance(l),Fr.computeSizeBasedSnapTolerance(h))},ys.isValid=function(l,h,y,w){return new ys(l,h,w).isValid(y)},Ju.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(ys,Ju);var sa=function l(h){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=l.extractFactory(h),this._inputGeoms=h};sa.prototype.extractElements=function(l,h){if(null===l)return null;for(var y=0;y<l.getNumGeometries();y++){var w=l.getGeometryN(y);this._skipEmpty&&w.isEmpty()||h.add(w)}},sa.prototype.combine=function(){for(var l=new ke,h=this._inputGeoms.iterator();h.hasNext();){var y=h.next();this.extractElements(y,l)}return 0===l.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(l)},sa.prototype.interfaces_=function(){return[]},sa.prototype.getClass=function(){return sa},sa.combine=function(){return 1===arguments.length?new sa(arguments[0]).combine():2===arguments.length?new sa(sa.createList(arguments[0],arguments[1])).combine():3===arguments.length?new sa(sa.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},sa.extractFactory=function(l){return l.isEmpty()?null:l.iterator().next().getFactory()},sa.createList=function(){if(2===arguments.length){var l=arguments[0],h=arguments[1],y=new ke;return y.add(l),y.add(h),y}if(3===arguments.length){var w=arguments[0],D=arguments[1],z=arguments[2],G=new ke;return G.add(w),G.add(D),G.add(z),G}};var Or=function(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new ke)},Ca={STRTREE_NODE_CAPACITY:{configurable:!0}};Or.prototype.reduceToGeometries=function(l){for(var h=new ke,y=l.iterator();y.hasNext();){var w=y.next(),D=null;Lt(w,et)?D=this.unionTree(w):w instanceof Nn&&(D=w),h.add(D)}return h},Or.prototype.extractByEnvelope=function(l,h,y){for(var w=new ke,D=0;D<h.getNumGeometries();D++){var z=h.getGeometryN(D);z.getEnvelopeInternal().intersects(l)?w.add(z):y.add(z)}return this._geomFactory.buildGeometry(w)},Or.prototype.unionOptimized=function(l,h){var y=l.getEnvelopeInternal(),w=h.getEnvelopeInternal();if(!y.intersects(w))return sa.combine(l,h);if(l.getNumGeometries()<=1&&h.getNumGeometries()<=1)return this.unionActual(l,h);var D=y.intersection(w);return this.unionUsingEnvelopeIntersection(l,h,D)},Or.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var l=new wr(Or.STRTREE_NODE_CAPACITY),h=this._inputPolys.iterator();h.hasNext();){var y=h.next();l.insert(y.getEnvelopeInternal(),y)}this._inputPolys=null;var w=l.itemsTree();return this.unionTree(w)},Or.prototype.binaryUnion=function(){if(1===arguments.length){var l=arguments[0];return this.binaryUnion(l,0,l.size())}if(3===arguments.length){var h=arguments[0],y=arguments[1],w=arguments[2];if(w-y<=1){var D=Or.getGeometry(h,y);return this.unionSafe(D,null)}if(w-y==2)return this.unionSafe(Or.getGeometry(h,y),Or.getGeometry(h,y+1));var z=Math.trunc((w+y)/2),G=this.binaryUnion(h,y,z),ie=this.binaryUnion(h,z,w);return this.unionSafe(G,ie)}},Or.prototype.repeatedUnion=function(l){for(var h=null,y=l.iterator();y.hasNext();){var w=y.next();h=null===h?w.copy():h.union(w)}return h},Or.prototype.unionSafe=function(l,h){return null===l&&null===h?null:null===l?h.copy():null===h?l.copy():this.unionOptimized(l,h)},Or.prototype.unionActual=function(l,h){return Or.restrictToPolygons(l.union(h))},Or.prototype.unionTree=function(l){var h=this.reduceToGeometries(l);return this.binaryUnion(h)},Or.prototype.unionUsingEnvelopeIntersection=function(l,h,y){var w=new ke,D=this.extractByEnvelope(y,l,w),z=this.extractByEnvelope(y,h,w),G=this.unionActual(D,z);return w.add(G),sa.combine(w)},Or.prototype.bufferUnion=function(){if(1===arguments.length){var l=arguments[0];return l.get(0).getFactory().buildGeometry(l).buffer(0)}if(2===arguments.length){var h=arguments[0],y=arguments[1];return h.getFactory().createGeometryCollection([h,y]).buffer(0)}},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Or.restrictToPolygons=function(l){if(Lt(l,xa))return l;var h=al.getPolygons(l);return 1===h.size()?h.get(0):l.getFactory().createMultiPolygon(gi.toPolygonArray(h))},Or.getGeometry=function(l,h){return h>=l.size()?null:l.get(h)},Or.union=function(l){return new Or(l).union()},Ca.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Or,Ca);var qd=function(){};qd.prototype.interfaces_=function(){return[]},qd.prototype.getClass=function(){return qd},qd.union=function(l,h){if(l.isEmpty()||h.isEmpty()){if(l.isEmpty()&&h.isEmpty())return jn.createEmptyResult(jn.UNION,l,h,l.getFactory());if(l.isEmpty())return h.copy();if(h.isEmpty())return l.copy()}return l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(h),Co.overlayOp(l,h,jn.UNION)},Ve.GeoJSONReader=Io,Ve.GeoJSONWriter=hf,Ve.OverlayOp=jn,Ve.UnionOp=qd,Ve.BufferOp=Is,Object.defineProperty(Ve,"__esModule",{value:!0})}(vt)}},un=>{un(un.s=3596)}]);